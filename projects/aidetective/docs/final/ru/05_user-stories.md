# Пользовательские истории и требования

## 1. Основные пользовательские истории

### 1.1 Регистрация и управление профилем

#### US-1.1.1: Регистрация нового пользователя

Как новый пользователь
Я хочу создать профиль детектива,
Чтобы начать расследовать дела.

**Критерии приёмки:**

* Команда /start запускает процесс
* Бот собирает имя, уровень опыта
* Приветственное сообщение и обучающий модуль
* Профиль в БД
* Доступ к первому бесплатному делу

#### US-1.1.2: Настройка профиля детектива

Как детектив
Я хочу настроить свой стиль расследования,
Чтобы создать уникальный образ.

**Критерии приёмки:**

* Выбор предпочтительных методов
* Биография детектива
* Специализация (криминалистика, допрос)
* Обновления профиля влияют на будущее расследование
* Изменения сохраняются немедленно

### 1.2 Система расследования

#### US-1.2.1: Выбор дела

Как детектив
Я хочу просмотреть доступные дела,
Чтобы выбрать интересную загадку.

**Критерии приёмки:**

* Список дел со сложностью
* Категории (убийство, кража и т.д.)
* Разделение на бесплатные и премиум дела
* Прогноз времени прохождения
* Предварительный брифинг

#### US-1.2.2: Сбор улик

Как следователь
Я хочу собирать и анализировать улики,
Чтобы раскрыть дело.

**Критерии приёмки:**

* Детальный осмотр места преступления
* Сохранение улик в инвентарь
* Заметки
* Перекрёстный анализ улик
* ИИ-оценка улик

#### US-1.2.3: Допрос подозреваемого

Как детектив
Я хочу допрашивать подозреваемых,
Чтобы собрать информацию и установить виновного.

**Критерии приёмки:**

* Естественные диалоги
* Возможность предъявлять улики
* Реакции зависят от контекста и личности
* Отслеживание истории диалога
* Доступ к дополнительным вопросам

### 1.3 Особенности сюжетов

#### US-1.3.1: «Тайна библиотечных теней»

Как детектив
Я хочу расследовать убийство в библиотеке,
Чтобы раскрыть тайну запертой комнаты.

**Критерии приёмки:**

* План библиотеки
* Изучение редких книг и символов
* Опрос персонала
* Отслеживание алиби и показаний
* Анализ чернильных следов, царапин на двери
* Структура сюжета:
    * > = 3 точек выбора в главе

    * Макс. 5 глав
    * Автосохранение в ключевых точках

#### US-1.3.2: «Исчезнувшая коллекция»

Как детектив
Я хочу расследовать кражу произведений искусства,
Чтобы вернуть украденные картины.

**Критерии приёмки:**

* Доступ к записям камер галереи
* Анализ документов по страховке картин
* Отслеживание перемещений и хронология
* Следы ног, остатки краски
* Интервью с персоналом
* Структура:
    * > = 3 точек выбора в главе

    * Макс. 5 глав
    * Автосохранение в ключевых точках

### 1.4 Премиум-функции

#### US-1.4.1: Премиум-подписка

Как бесплатный пользователь
Я хочу перейти на премиум,
Чтобы получить расширенный функционал.

**Критерии приёмки:**

* Отображение преимуществ подписки и уровней:
    * **Бесплатно**: 3 базовые истории, текст, без подсказок
    * **Премиум (299 руб./мес.)**: 10 продвинутых историй, мультимедиа, ограниченные подсказки, сохранение прогресса
    * **VIP (799 руб./мес.)**: Неограниченное число историй, полная мультимедиа, неограниченные подсказки, приоритетная поддержка, эксклюзив
* Удобная оплата через YooMoney
* Немедленный доступ к премиум-контенту
* Отслеживание статуса и уведомление о его изменении

#### US-1.4.2: Расширенные инструменты расследования

Как премиум-пользователь
Я хочу воспользоваться специализированными инструментами,
Чтобы эффективнее решать дела.

**Критерии приёмки:**

* Построитель временной шкалы
* Расширенный анализ улик
* Карта отношений персонажей
* Улучшенная система подсказок
* Мультимедийные заметки

## 2. Сценарии расследования

### 2.1 Базовый процесс

```markdown
Сценарий: Первое дело
1. Пользователь выбирает дело
2. Получает брифинг и стартовые улики
3. Осматривает место преступления
4. Собирает улики
5. Допрашивает подозреваемых
6. Формирует теорию
7. Выносит вердикт

Критерии успеха:
- Понятная навигация
- Интуитивный сбор улик
- Естественные диалоги
- Логичное обоснование версии
- Удовлетворительное решение
```

### 2.2 Премиум-расследование

```markdown
Сценарий: Расширенное расследование
1. Активация премиум-инструментов
2. Создание детальной временной шкалы
3. Построение карты отношений
4. Анализ улик расширенными средствами
5. Сопоставление всех данных
6. ИИ-подсказки
7. Окончательное раскрытие дела

Критерии успеха:
- Интеграция инструментов
- Точная временная шкала
- Детальная визуализация связей
- Продвинутый анализ улик
- Выводы с помощью ИИ
```

## 3. Обработка ошибок и крайние случаи

### 3.1 Прерывание расследования

```markdown
Сценарий: Потеря соединения
1. Соединение обрывается
2. Система сохраняет состояние
3. Пользователь переподключается
4. Состояние восстанавливается
5. Продолжение с последней точки

Критерии успеха:
- Корректное сохранение
- Нет потери улик
- Ясные сообщения об ошибках
- Плавное возобновление
```

### 3.2 Недопустимые действия

```markdown
Сценарий: Неверное действие
1. Пользователь пытается выполнить невозможное
2. Система выдает понятное сообщение
3. Предлагает альтернативы
4. Прогресс не теряется

Критерии успеха:
- Чёткая ошибка
- Сохранение состояния
- Подсказки по допустимым действиям
```

## 4. Истории, связанные с функционалом

### 4.1 Система улик

#### US-4.1.1: Управление уликами

Как детектив
Я хочу организовать и анализировать улики,
Чтобы отслеживать ход расследования.

**Критерии приёмки:**

* Категоризация улик
* Пользовательские теги
* Поиск по коллекции
* Связь между уликами
* Отчёты по уликам

#### US-4.1.2: Мультимедийные улики

Как следователь
Я хочу изучать мультимедийные улики,
Чтобы находить скрытые детали.

**Критерии приёмки:**

* Просмотр и зум изображений
* Аудио с таймингом
* Видео с покадровым анализом
* Спецификации:
    * Изображения: до 2 МБ (JPG, PNG)
    * Аудио: до 2 минут (MP3)
    * Видео: до 1 минуты, 10 МБ (MP4)
* Возможность делать скриншоты или заметки

### 4.2 AI-функции

#### US-4.2.1: Динамичные взаимодействия с NPC

Как детектив
Мне нужны реалистичные беседы с подозреваемыми,
Чтобы собирать достоверную информацию.

**Критерии приёмки:**

* Ответы, учитывающие контекст
* Согласованные личности
* Память о предыдущих диалогах
* Эмоциональное состояние
* Обработка естественного языка

#### US-4.2.2: Анализ улик с помощью ИИ

Как следователь
Я хочу, чтобы ИИ помогал в анализе улик,
Чтобы эффективно обрабатывать сложные данные.

**Критерии приёмки:**

* Распознавание паттернов
* Поиск связей
* Обнаружение аномалий
* Генерация гипотез с оценкой достоверности