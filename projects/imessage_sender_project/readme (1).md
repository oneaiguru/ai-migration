# Система рассылки iMessage

![Версия](https://img.shields.io/badge/версия-1.0.0-blue.svg)
![macOS](https://img.shields.io/badge/macOS-12.0%2B-green.svg)
![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg)

## Описание

Система для автоматизированной рассылки сообщений через iMessage на macOS с удобным графическим интерфейсом. Позволяет загружать списки контактов из различных форматов, создавать шаблоны сообщений, отправлять персонализированные сообщения и контролировать процесс отправки с подробным логированием и отчетами.

## Возможности

- **Работа с контактами**
  - Загрузка контактов из файлов CSV, Excel и TXT
  - Валидация и форматирование номеров телефонов
  - Дедупликация контактов
  - Экспорт контактов

- **Шаблонизация сообщений**
  - Создание и редактирование шаблонов
  - Поддержка переменных для персонализации (имя, компания, дата и т.д.)
  - Предварительный просмотр сообщений
  - Импорт и экспорт шаблонов

- **Отправка сообщений**
  - Отправка одиночных тестовых сообщений
  - Массовая рассылка на список контактов
  - Настраиваемые интервалы между отправками для избежания блокировок
  - Поддержка медиафайлов (изображения, видео, документы)

- **Логирование и отчеты**
  - Детальное логирование процесса отправки
  - Генерация отчетов в различных форматах (TXT, HTML, JSON)
  - Фильтрация и поиск в логах
  - Просмотр и экспорт статистики отправки

- **Гибкая настройка**
  - Настройка интервалов отправки
  - Настройка путей к директориям
  - Настройка параметров логирования
  - Экспорт и импорт настроек

## Требования

- macOS 12.0 или новее
- Python 3.7 или новее
- Messages.app с настроенным iMessage
- Установленные зависимости (см. файл `requirements.txt`)

## Установка

### Автоматическая установка

1. Скачайте и распакуйте архив с проектом
2. Откройте Terminal и перейдите в директорию проекта
3. Запустите установочный скрипт:

```bash
python3 setup.py
```

Скрипт установит необходимые зависимости, создаст структуру директорий и ярлык на рабочем столе.

### Ручная установка

1. Скачайте и распакуйте архив с проектом
2. Установите зависимости:

```bash
pip3 install -r requirements.txt
```

3. Создайте необходимые директории:

```bash
mkdir -p logs templates reports
```

4. Запустите приложение:

```bash
python3 gui.py
```

## Быстрый старт

### 1. Загрузка контактов

1. Перейдите на вкладку "Контакты"
2. Нажмите кнопку "Загрузить контакты"
3. Выберите файл с контактами (CSV, Excel или TXT)
4. После загрузки контакты отобразятся в таблице

### 2. Создание шаблона сообщения

1. Перейдите на вкладку "Шаблоны"
2. Нажмите кнопку "Новый"
3. Введите имя шаблона
4. Напишите текст сообщения, используя переменные в формате `{{ имя_переменной }}`
5. Используйте предпросмотр для проверки шаблона
6. Сохраните шаблон кнопкой "Сохранить"

### 3. Отправка сообщений

1. Перейдите на вкладку "Отправка"
2. Выберите контакты и шаблон с помощью соответствующих кнопок
3. При необходимости выберите медиафайл
4. Настройте интервалы между отправками
5. Для проверки отправьте тестовое сообщение на один контакт
6. Для массовой рассылки нажмите "Начать рассылку"
7. Следите за прогрессом отправки и журналом сообщений

## Структура проекта

```
imessage_sender/
├── config.py             # Модуль конфигурации
├── contact_manager.py    # Модуль управления контактами
├── gui.py                # Графический интерфейс
├── imessage_sender.py    # Модуль отправки сообщений
├── logger.py             # Модуль логирования
├── message_template.py   # Модуль шаблонизации сообщений
├── requirements.txt      # Зависимости проекта
├── setup.py              # Скрипт установки
├── tests/                # Модульные тесты
├── logs/                 # Директория для логов
├── templates/            # Директория для шаблонов
└── reports/              # Директория для отчетов
```

## Технические особенности

### Как работает отправка сообщений

Система использует AppleScript для взаимодействия с приложением Messages.app на macOS. Это позволяет отправлять сообщения через официальное приложение Apple, что обеспечивает надежность и минимизирует риск блокировки.

```python
# Пример скрипта для отправки сообщения
script = '''
tell application "Messages"
    set targetService to 1st service whose service type = iMessage
    set targetBuddy to buddy "{phone_number}" of targetService
    send "{message}" to targetBuddy
end tell
'''
```

### Защита от блокировок

Система использует следующие механизмы для предотвращения блокировки:

1. **Случайные интервалы между отправками** - сообщения отправляются с переменной задержкой, что имитирует поведение реального пользователя.
2. **Контроль скорости отправки** - ограничение количества сообщений в единицу времени.
3. **Персонализация сообщений** - уникальные сообщения для каждого получателя снижают вероятность блокировки.

### Шаблонизация сообщений

Система использует простой шаблонизатор с поддержкой переменных в формате `{{ имя_переменной }}`. Поддерживаются следующие типы переменных:

- **Данные контакта**: имя, телефон, компания и другие поля из файла контактов
- **Системные переменные**: дата, время, год, месяц и т.д.
- **Вложенные объекты**: поддержка доступа к вложенным данным через точку, например `{{ user.name }}`

## Примеры использования

### Загрузка контактов из CSV-файла

Создайте CSV-файл со следующими столбцами:

```csv
phone,name,company,event
+79161234567,Иван Иванов,ООО Компания,важном событии
+79162345678,Мария Петрова,ИП Сидоров,встрече
+79163456789,Петр Николаев,ЗАО Инновации,презентации
```

### Пример шаблона сообщения

```
Здравствуйте, {{ name }}!

Напоминаем Вам о {{ event }} от {{ date }}.

С уважением,
{{ company }}
{{ phone }}
```

## Известные ограничения

- Работает только на macOS с установленным и настроенным приложением Messages.app
- Требуется активный Apple ID с настроенным iMessage
- Возможна блокировка отправки большого количества сообщений со стороны Apple
- Не поддерживает групповые чаты в текущей версии

## Часто задаваемые вопросы

### Будет ли работать на Windows или Linux?

Нет, система работает только на macOS, так как использует нативное приложение Messages.app для отправки сообщений.

### Можно ли отправлять сообщения на обычные номера (SMS)?

Да, но только если ваш Mac настроен для отправки SMS через iPhone (функция SMS Relay/Text Message Forwarding).

### Как увеличить количество сообщений без риска блокировки?

- Увеличьте интервалы между отправками (рекомендуется 5-10 секунд)
- Разбейте большие списки на несколько меньших рассылок
- Используйте максимально персонализированные шаблоны
- Не отправляйте одинаковые сообщения большому количеству получателей

### Моя учетная запись была заблокирована. Что делать?

Если ваш аккаунт был ограничен для отправки сообщений:

1. Немедленно прекратите отправку сообщений
2. Подождите 24-48 часов, ограничения обычно снимаются автоматически
3. В будущем используйте более консервативные настройки интервалов

## Лицензия

Данный проект распространяется под лицензией MIT.

## Автор

Михаил

---

**Disclaimer**: Данная система предназначена для легитимных рассылок с получением согласия от получателей. Автор не несет ответственности за использование системы для спама или других нарушений условий использования iMessage и законодательства.
