var G4=Object.defineProperty;var q4=(t,e,r)=>e in t?G4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var wt=(t,e,r)=>q4(t,typeof e!="symbol"?e+"":e,r);function Y4(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function gm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var kx={exports:{}},Nf={},Sx={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nS;function K4(){if(nS)return zt;nS=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;function m(W){return W===null||typeof W!="object"?null:(W=h&&W[h]||W["@@iterator"],typeof W=="function"?W:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function w(W,F,X){this.props=W,this.context=F,this.refs=x,this.updater=X||g}w.prototype.isReactComponent={},w.prototype.setState=function(W,F){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,F,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function S(){}S.prototype=w.prototype;function T(W,F,X){this.props=W,this.context=F,this.refs=x,this.updater=X||g}var _=T.prototype=new S;_.constructor=T,v(_,w.prototype),_.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,O={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function A(W,F,X){var Z,q={},ce=null,Ce=null;if(F!=null)for(Z in F.ref!==void 0&&(Ce=F.ref),F.key!==void 0&&(ce=""+F.key),F)D.call(F,Z)&&!E.hasOwnProperty(Z)&&(q[Z]=F[Z]);var pe=arguments.length-2;if(pe===1)q.children=X;else if(1<pe){for(var ue=Array(pe),Se=0;Se<pe;Se++)ue[Se]=arguments[Se+2];q.children=ue}if(W&&W.defaultProps)for(Z in pe=W.defaultProps,pe)q[Z]===void 0&&(q[Z]=pe[Z]);return{$$typeof:t,type:W,key:ce,ref:Ce,props:q,_owner:O.current}}function N(W,F){return{$$typeof:t,type:W.type,key:F,ref:W.ref,props:W.props,_owner:W._owner}}function P(W){return typeof W=="object"&&W!==null&&W.$$typeof===t}function B(W){var F={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(X){return F[X]})}var I=/\/+/g;function ee(W,F){return typeof W=="object"&&W!==null&&W.key!=null?B(""+W.key):F.toString(36)}function oe(W,F,X,Z,q){var ce=typeof W;(ce==="undefined"||ce==="boolean")&&(W=null);var Ce=!1;if(W===null)Ce=!0;else switch(ce){case"string":case"number":Ce=!0;break;case"object":switch(W.$$typeof){case t:case e:Ce=!0}}if(Ce)return Ce=W,q=q(Ce),W=Z===""?"."+ee(Ce,0):Z,M(q)?(X="",W!=null&&(X=W.replace(I,"$&/")+"/"),oe(q,F,X,"",function(Se){return Se})):q!=null&&(P(q)&&(q=N(q,X+(!q.key||Ce&&Ce.key===q.key?"":(""+q.key).replace(I,"$&/")+"/")+W)),F.push(q)),1;if(Ce=0,Z=Z===""?".":Z+":",M(W))for(var pe=0;pe<W.length;pe++){ce=W[pe];var ue=Z+ee(ce,pe);Ce+=oe(ce,F,X,ue,q)}else if(ue=m(W),typeof ue=="function")for(W=ue.call(W),pe=0;!(ce=W.next()).done;)ce=ce.value,ue=Z+ee(ce,pe++),Ce+=oe(ce,F,X,ue,q);else if(ce==="object")throw F=String(W),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return Ce}function re(W,F,X){if(W==null)return W;var Z=[],q=0;return oe(W,Z,"","",function(ce){return F.call(X,ce,q++)}),Z}function fe(W){if(W._status===-1){var F=W._result;F=F(),F.then(function(X){(W._status===0||W._status===-1)&&(W._status=1,W._result=X)},function(X){(W._status===0||W._status===-1)&&(W._status=2,W._result=X)}),W._status===-1&&(W._status=0,W._result=F)}if(W._status===1)return W._result.default;throw W._result}var se={current:null},xe={transition:null},H={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:xe,ReactCurrentOwner:O};function ve(){throw Error("act(...) is not supported in production builds of React.")}return zt.Children={map:re,forEach:function(W,F,X){re(W,function(){F.apply(this,arguments)},X)},count:function(W){var F=0;return re(W,function(){F++}),F},toArray:function(W){return re(W,function(F){return F})||[]},only:function(W){if(!P(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},zt.Component=w,zt.Fragment=r,zt.Profiler=i,zt.PureComponent=T,zt.StrictMode=n,zt.Suspense=l,zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,zt.act=ve,zt.cloneElement=function(W,F,X){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var Z=v({},W.props),q=W.key,ce=W.ref,Ce=W._owner;if(F!=null){if(F.ref!==void 0&&(ce=F.ref,Ce=O.current),F.key!==void 0&&(q=""+F.key),W.type&&W.type.defaultProps)var pe=W.type.defaultProps;for(ue in F)D.call(F,ue)&&!E.hasOwnProperty(ue)&&(Z[ue]=F[ue]===void 0&&pe!==void 0?pe[ue]:F[ue])}var ue=arguments.length-2;if(ue===1)Z.children=X;else if(1<ue){pe=Array(ue);for(var Se=0;Se<ue;Se++)pe[Se]=arguments[Se+2];Z.children=pe}return{$$typeof:t,type:W.type,key:q,ref:ce,props:Z,_owner:Ce}},zt.createContext=function(W){return W={$$typeof:a,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},zt.createElement=A,zt.createFactory=function(W){var F=A.bind(null,W);return F.type=W,F},zt.createRef=function(){return{current:null}},zt.forwardRef=function(W){return{$$typeof:o,render:W}},zt.isValidElement=P,zt.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:fe}},zt.memo=function(W,F){return{$$typeof:u,type:W,compare:F===void 0?null:F}},zt.startTransition=function(W){var F=xe.transition;xe.transition={};try{W()}finally{xe.transition=F}},zt.unstable_act=ve,zt.useCallback=function(W,F){return se.current.useCallback(W,F)},zt.useContext=function(W){return se.current.useContext(W)},zt.useDebugValue=function(){},zt.useDeferredValue=function(W){return se.current.useDeferredValue(W)},zt.useEffect=function(W,F){return se.current.useEffect(W,F)},zt.useId=function(){return se.current.useId()},zt.useImperativeHandle=function(W,F,X){return se.current.useImperativeHandle(W,F,X)},zt.useInsertionEffect=function(W,F){return se.current.useInsertionEffect(W,F)},zt.useLayoutEffect=function(W,F){return se.current.useLayoutEffect(W,F)},zt.useMemo=function(W,F){return se.current.useMemo(W,F)},zt.useReducer=function(W,F,X){return se.current.useReducer(W,F,X)},zt.useRef=function(W){return se.current.useRef(W)},zt.useState=function(W){return se.current.useState(W)},zt.useSyncExternalStore=function(W,F,X){return se.current.useSyncExternalStore(W,F,X)},zt.useTransition=function(){return se.current.useTransition()},zt.version="18.3.1",zt}var iS;function ny(){return iS||(iS=1,Sx.exports=K4()),Sx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sS;function X4(){if(sS)return Nf;sS=1;var t=ny(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,u){var d,h={},m=null,g=null;u!==void 0&&(m=""+u),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(g=l.ref);for(d in l)n.call(l,d)&&!s.hasOwnProperty(d)&&(h[d]=l[d]);if(o&&o.defaultProps)for(d in l=o.defaultProps,l)h[d]===void 0&&(h[d]=l[d]);return{$$typeof:e,type:o,key:m,ref:g,props:h,_owner:i.current}}return Nf.Fragment=r,Nf.jsx=a,Nf.jsxs=a,Nf}var aS;function Z4(){return aS||(aS=1,kx.exports=X4()),kx.exports}var b=Z4(),z=ny();const xt=gm(z),fT=Y4({__proto__:null,default:xt},[z]);var g0={},_x={exports:{}},_i={},Cx={exports:{}},Ex={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS;function J4(){return oS||(oS=1,(function(t){function e(xe,H){var ve=xe.length;xe.push(H);e:for(;0<ve;){var W=ve-1>>>1,F=xe[W];if(0<i(F,H))xe[W]=H,xe[ve]=F,ve=W;else break e}}function r(xe){return xe.length===0?null:xe[0]}function n(xe){if(xe.length===0)return null;var H=xe[0],ve=xe.pop();if(ve!==H){xe[0]=ve;e:for(var W=0,F=xe.length,X=F>>>1;W<X;){var Z=2*(W+1)-1,q=xe[Z],ce=Z+1,Ce=xe[ce];if(0>i(q,ve))ce<F&&0>i(Ce,q)?(xe[W]=Ce,xe[ce]=ve,W=ce):(xe[W]=q,xe[Z]=ve,W=Z);else if(ce<F&&0>i(Ce,ve))xe[W]=Ce,xe[ce]=ve,W=ce;else break e}}return H}function i(xe,H){var ve=xe.sortIndex-H.sortIndex;return ve!==0?ve:xe.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,h=null,m=3,g=!1,v=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(xe){for(var H=r(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=xe)n(u),H.sortIndex=H.expirationTime,e(l,H);else break;H=r(u)}}function M(xe){if(x=!1,_(xe),!v)if(r(l)!==null)v=!0,fe(D);else{var H=r(u);H!==null&&se(M,H.startTime-xe)}}function D(xe,H){v=!1,x&&(x=!1,S(A),A=-1),g=!0;var ve=m;try{for(_(H),h=r(l);h!==null&&(!(h.expirationTime>H)||xe&&!B());){var W=h.callback;if(typeof W=="function"){h.callback=null,m=h.priorityLevel;var F=W(h.expirationTime<=H);H=t.unstable_now(),typeof F=="function"?h.callback=F:h===r(l)&&n(l),_(H)}else n(l);h=r(l)}if(h!==null)var X=!0;else{var Z=r(u);Z!==null&&se(M,Z.startTime-H),X=!1}return X}finally{h=null,m=ve,g=!1}}var O=!1,E=null,A=-1,N=5,P=-1;function B(){return!(t.unstable_now()-P<N)}function I(){if(E!==null){var xe=t.unstable_now();P=xe;var H=!0;try{H=E(!0,xe)}finally{H?ee():(O=!1,E=null)}}else O=!1}var ee;if(typeof T=="function")ee=function(){T(I)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,re=oe.port2;oe.port1.onmessage=I,ee=function(){re.postMessage(null)}}else ee=function(){w(I,0)};function fe(xe){E=xe,O||(O=!0,ee())}function se(xe,H){A=w(function(){xe(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(xe){xe.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,fe(D))},t.unstable_forceFrameRate=function(xe){0>xe||125<xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<xe?Math.floor(1e3/xe):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(xe){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var ve=m;m=H;try{return xe()}finally{m=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(xe,H){switch(xe){case 1:case 2:case 3:case 4:case 5:break;default:xe=3}var ve=m;m=xe;try{return H()}finally{m=ve}},t.unstable_scheduleCallback=function(xe,H,ve){var W=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?W+ve:W):ve=W,xe){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ve+F,xe={id:d++,callback:H,priorityLevel:xe,startTime:ve,expirationTime:F,sortIndex:-1},ve>W?(xe.sortIndex=ve,e(u,xe),r(l)===null&&xe===r(u)&&(x?(S(A),A=-1):x=!0,se(M,ve-W))):(xe.sortIndex=F,e(l,xe),v||g||(v=!0,fe(D))),xe},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(xe){var H=m;return function(){var ve=m;m=H;try{return xe.apply(this,arguments)}finally{m=ve}}}})(Ex)),Ex}var lS;function Q4(){return lS||(lS=1,Cx.exports=J4()),Cx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function eI(){if(cS)return _i;cS=1;var t=ny(),e=Q4();function r(c){for(var f="https://reactjs.org/docs/error-decoder.html?invariant="+c,p=1;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(c,f){a(c,f),a(c+"Capture",f)}function a(c,f){for(i[c]=f,c=0;c<f.length;c++)n.add(f[c])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function m(c){return l.call(h,c)?!0:l.call(d,c)?!1:u.test(c)?h[c]=!0:(d[c]=!0,!1)}function g(c,f,p,y){if(p!==null&&p.type===0)return!1;switch(typeof f){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function v(c,f,p,y){if(f===null||typeof f>"u"||g(c,f,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!f;case 4:return f===!1;case 5:return isNaN(f);case 6:return isNaN(f)||1>f}return!1}function x(c,f,p,y,k,C,R){this.acceptsBooleans=f===2||f===3||f===4,this.attributeName=y,this.attributeNamespace=k,this.mustUseProperty=p,this.propertyName=c,this.type=f,this.sanitizeURL=C,this.removeEmptyString=R}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){w[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var f=c[0];w[f]=new x(f,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){w[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){w[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){w[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){w[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){w[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){w[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){w[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var f=c.replace(S,T);w[f]=new x(f,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var f=c.replace(S,T);w[f]=new x(f,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var f=c.replace(S,T);w[f]=new x(f,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){w[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function _(c,f,p,y){var k=w.hasOwnProperty(f)?w[f]:null;(k!==null?k.type!==0:y||!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(v(f,p,k,y)&&(p=null),y||k===null?m(f)&&(p===null?c.removeAttribute(f):c.setAttribute(f,""+p)):k.mustUseProperty?c[k.propertyName]=p===null?k.type===3?!1:"":p:(f=k.attributeName,y=k.attributeNamespace,p===null?c.removeAttribute(f):(k=k.type,p=k===3||k===4&&p===!0?"":""+p,y?c.setAttributeNS(y,f,p):c.setAttribute(f,p))))}var M=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),O=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),B=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),xe=Symbol.iterator;function H(c){return c===null||typeof c!="object"?null:(c=xe&&c[xe]||c["@@iterator"],typeof c=="function"?c:null)}var ve=Object.assign,W;function F(c){if(W===void 0)try{throw Error()}catch(p){var f=p.stack.trim().match(/\n( *(at )?)/);W=f&&f[1]||""}return`
`+W+c}var X=!1;function Z(c,f){if(!c||X)return"";X=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(f)if(f=function(){throw Error()},Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(_e){var y=_e}Reflect.construct(c,[],f)}else{try{f.call()}catch(_e){y=_e}c.call(f.prototype)}else{try{throw Error()}catch(_e){y=_e}c()}}catch(_e){if(_e&&y&&typeof _e.stack=="string"){for(var k=_e.stack.split(`
`),C=y.stack.split(`
`),R=k.length-1,Q=C.length-1;1<=R&&0<=Q&&k[R]!==C[Q];)Q--;for(;1<=R&&0<=Q;R--,Q--)if(k[R]!==C[Q]){if(R!==1||Q!==1)do if(R--,Q--,0>Q||k[R]!==C[Q]){var ne=`
`+k[R].replace(" at new "," at ");return c.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",c.displayName)),ne}while(1<=R&&0<=Q);break}}}finally{X=!1,Error.prepareStackTrace=p}return(c=c?c.displayName||c.name:"")?F(c):""}function q(c){switch(c.tag){case 5:return F(c.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return c=Z(c.type,!1),c;case 11:return c=Z(c.type.render,!1),c;case 1:return c=Z(c.type,!0),c;default:return""}}function ce(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case E:return"Fragment";case O:return"Portal";case N:return"Profiler";case A:return"StrictMode";case ee:return"Suspense";case oe:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case B:return(c.displayName||"Context")+".Consumer";case P:return(c._context.displayName||"Context")+".Provider";case I:var f=c.render;return c=c.displayName,c||(c=f.displayName||f.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case re:return f=c.displayName||null,f!==null?f:ce(c.type)||"Memo";case fe:f=c._payload,c=c._init;try{return ce(c(f))}catch{}}return null}function Ce(c){var f=c.type;switch(c.tag){case 24:return"Cache";case 9:return(f.displayName||"Context")+".Consumer";case 10:return(f._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=f.render,c=c.displayName||c.name||"",f.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return f;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(f);case 8:return f===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f}return null}function pe(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function ue(c){var f=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function Se(c){var f=ue(c)?"checked":"value",p=Object.getOwnPropertyDescriptor(c.constructor.prototype,f),y=""+c[f];if(!c.hasOwnProperty(f)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var k=p.get,C=p.set;return Object.defineProperty(c,f,{configurable:!0,get:function(){return k.call(this)},set:function(R){y=""+R,C.call(this,R)}}),Object.defineProperty(c,f,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(R){y=""+R},stopTracking:function(){c._valueTracker=null,delete c[f]}}}}function ze(c){c._valueTracker||(c._valueTracker=Se(c))}function j(c){if(!c)return!1;var f=c._valueTracker;if(!f)return!0;var p=f.getValue(),y="";return c&&(y=ue(c)?c.checked?"true":"false":c.value),c=y,c!==p?(f.setValue(c),!0):!1}function tt(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Ne(c,f){var p=f.checked;return ve({},f,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??c._wrapperState.initialChecked})}function qe(c,f){var p=f.defaultValue==null?"":f.defaultValue,y=f.checked!=null?f.checked:f.defaultChecked;p=pe(f.value!=null?f.value:p),c._wrapperState={initialChecked:y,initialValue:p,controlled:f.type==="checkbox"||f.type==="radio"?f.checked!=null:f.value!=null}}function Le(c,f){f=f.checked,f!=null&&_(c,"checked",f,!1)}function Te(c,f){Le(c,f);var p=pe(f.value),y=f.type;if(p!=null)y==="number"?(p===0&&c.value===""||c.value!=p)&&(c.value=""+p):c.value!==""+p&&(c.value=""+p);else if(y==="submit"||y==="reset"){c.removeAttribute("value");return}f.hasOwnProperty("value")?gt(c,f.type,p):f.hasOwnProperty("defaultValue")&&gt(c,f.type,pe(f.defaultValue)),f.checked==null&&f.defaultChecked!=null&&(c.defaultChecked=!!f.defaultChecked)}function at(c,f,p){if(f.hasOwnProperty("value")||f.hasOwnProperty("defaultValue")){var y=f.type;if(!(y!=="submit"&&y!=="reset"||f.value!==void 0&&f.value!==null))return;f=""+c._wrapperState.initialValue,p||f===c.value||(c.value=f),c.defaultValue=f}p=c.name,p!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,p!==""&&(c.name=p)}function gt(c,f,p){(f!=="number"||tt(c.ownerDocument)!==c)&&(p==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+p&&(c.defaultValue=""+p))}var J=Array.isArray;function le(c,f,p,y){if(c=c.options,f){f={};for(var k=0;k<p.length;k++)f["$"+p[k]]=!0;for(p=0;p<c.length;p++)k=f.hasOwnProperty("$"+c[p].value),c[p].selected!==k&&(c[p].selected=k),k&&y&&(c[p].defaultSelected=!0)}else{for(p=""+pe(p),f=null,k=0;k<c.length;k++){if(c[k].value===p){c[k].selected=!0,y&&(c[k].defaultSelected=!0);return}f!==null||c[k].disabled||(f=c[k])}f!==null&&(f.selected=!0)}}function be(c,f){if(f.dangerouslySetInnerHTML!=null)throw Error(r(91));return ve({},f,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Ve(c,f){var p=f.value;if(p==null){if(p=f.children,f=f.defaultValue,p!=null){if(f!=null)throw Error(r(92));if(J(p)){if(1<p.length)throw Error(r(93));p=p[0]}f=p}f==null&&(f=""),p=f}c._wrapperState={initialValue:pe(p)}}function Me(c,f){var p=pe(f.value),y=pe(f.defaultValue);p!=null&&(p=""+p,p!==c.value&&(c.value=p),f.defaultValue==null&&c.defaultValue!==p&&(c.defaultValue=p)),y!=null&&(c.defaultValue=""+y)}function Ae(c){var f=c.textContent;f===c._wrapperState.initialValue&&f!==""&&f!==null&&(c.value=f)}function $e(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function et(c,f){return c==null||c==="http://www.w3.org/1999/xhtml"?$e(f):c==="http://www.w3.org/2000/svg"&&f==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var st,Nt=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(f,p,y,k){MSApp.execUnsafeLocalFunction(function(){return c(f,p,y,k)})}:c})(function(c,f){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=f;else{for(st=st||document.createElement("div"),st.innerHTML="<svg>"+f.valueOf().toString()+"</svg>",f=st.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;f.firstChild;)c.appendChild(f.firstChild)}});function rt(c,f){if(f){var p=c.firstChild;if(p&&p===c.lastChild&&p.nodeType===3){p.nodeValue=f;return}}c.textContent=f}var Tt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];Object.keys(Tt).forEach(function(c){ar.forEach(function(f){f=f+c.charAt(0).toUpperCase()+c.substring(1),Tt[f]=Tt[c]})});function $t(c,f,p){return f==null||typeof f=="boolean"||f===""?"":p||typeof f!="number"||f===0||Tt.hasOwnProperty(c)&&Tt[c]?(""+f).trim():f+"px"}function Mr(c,f){c=c.style;for(var p in f)if(f.hasOwnProperty(p)){var y=p.indexOf("--")===0,k=$t(p,f[p],y);p==="float"&&(p="cssFloat"),y?c.setProperty(p,k):c[p]=k}}var ba=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pn(c,f){if(f){if(ba[c]&&(f.children!=null||f.dangerouslySetInnerHTML!=null))throw Error(r(137,c));if(f.dangerouslySetInnerHTML!=null){if(f.children!=null)throw Error(r(60));if(typeof f.dangerouslySetInnerHTML!="object"||!("__html"in f.dangerouslySetInnerHTML))throw Error(r(61))}if(f.style!=null&&typeof f.style!="object")throw Error(r(62))}}function xi(c,f){if(c.indexOf("-")===-1)return typeof f.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sn=null;function Fi(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var to=null,Vs=null,_n=null;function vi(c){if(c=pf(c)){if(typeof to!="function")throw Error(r(280));var f=c.stateNode;f&&(f=Dh(f),to(c.stateNode,c.type,f))}}function cl(c){Vs?_n?_n.push(c):_n=[c]:Vs=c}function yc(){if(Vs){var c=Vs,f=_n;if(_n=Vs=null,vi(c),f)for(c=0;c<f.length;c++)vi(f[c])}}function wc(c,f){return c(f)}function bc(){}var ro=!1;function ul(c,f,p){if(ro)return c(f,p);ro=!0;try{return wc(c,f,p)}finally{ro=!1,(Vs!==null||_n!==null)&&(bc(),yc())}}function ka(c,f){var p=c.stateNode;if(p===null)return null;var y=Dh(p);if(y===null)return null;p=y[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(c=c.type,y=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!y;break e;default:c=!1}if(c)return null;if(p&&typeof p!="function")throw Error(r(231,f,typeof p));return p}var no=!1;if(o)try{var vs={};Object.defineProperty(vs,"passive",{get:function(){no=!0}}),window.addEventListener("test",vs,vs),window.removeEventListener("test",vs,vs)}catch{no=!1}function $s(c,f,p,y,k,C,R,Q,ne){var _e=Array.prototype.slice.call(arguments,3);try{f.apply(p,_e)}catch(Fe){this.onError(Fe)}}var ys=!1,Ii=null,L=!1,Y=null,V={onError:function(c){ys=!0,Ii=c}};function U(c,f,p,y,k,C,R,Q,ne){ys=!1,Ii=null,$s.apply(V,arguments)}function G(c,f,p,y,k,C,R,Q,ne){if(U.apply(this,arguments),ys){if(ys){var _e=Ii;ys=!1,Ii=null}else throw Error(r(198));L||(L=!0,Y=_e)}}function K(c){var f=c,p=c;if(c.alternate)for(;f.return;)f=f.return;else{c=f;do f=c,(f.flags&4098)!==0&&(p=f.return),c=f.return;while(c)}return f.tag===3?p:null}function me(c){if(c.tag===13){var f=c.memoizedState;if(f===null&&(c=c.alternate,c!==null&&(f=c.memoizedState)),f!==null)return f.dehydrated}return null}function Ee(c){if(K(c)!==c)throw Error(r(188))}function ge(c){var f=c.alternate;if(!f){if(f=K(c),f===null)throw Error(r(188));return f!==c?null:c}for(var p=c,y=f;;){var k=p.return;if(k===null)break;var C=k.alternate;if(C===null){if(y=k.return,y!==null){p=y;continue}break}if(k.child===C.child){for(C=k.child;C;){if(C===p)return Ee(k),c;if(C===y)return Ee(k),f;C=C.sibling}throw Error(r(188))}if(p.return!==y.return)p=k,y=C;else{for(var R=!1,Q=k.child;Q;){if(Q===p){R=!0,p=k,y=C;break}if(Q===y){R=!0,y=k,p=C;break}Q=Q.sibling}if(!R){for(Q=C.child;Q;){if(Q===p){R=!0,p=C,y=k;break}if(Q===y){R=!0,y=C,p=k;break}Q=Q.sibling}if(!R)throw Error(r(189))}}if(p.alternate!==y)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?c:f}function ye(c){return c=ge(c),c!==null?ke(c):null}function ke(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var f=ke(c);if(f!==null)return f;c=c.sibling}return null}var Re=e.unstable_scheduleCallback,Ge=e.unstable_cancelCallback,Ye=e.unstable_shouldYield,Be=e.unstable_requestPaint,Pe=e.unstable_now,St=e.unstable_getCurrentPriorityLevel,or=e.unstable_ImmediatePriority,Ut=e.unstable_UserBlockingPriority,xr=e.unstable_NormalPriority,ws=e.unstable_LowPriority,Us=e.unstable_IdlePriority,Ki=null,Hr=null;function fl(c){if(Hr&&typeof Hr.onCommitFiberRoot=="function")try{Hr.onCommitFiberRoot(Ki,c,void 0,(c.current.flags&128)===128)}catch{}}var vr=Math.clz32?Math.clz32:Ym,hh=Math.log,Yu=Math.LN2;function Ym(c){return c>>>=0,c===0?32:31-(hh(c)/Yu|0)|0}var kc=64,Sc=4194304;function io(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function _c(c,f){var p=c.pendingLanes;if(p===0)return 0;var y=0,k=c.suspendedLanes,C=c.pingedLanes,R=p&268435455;if(R!==0){var Q=R&~k;Q!==0?y=io(Q):(C&=R,C!==0&&(y=io(C)))}else R=p&~k,R!==0?y=io(R):C!==0&&(y=io(C));if(y===0)return 0;if(f!==0&&f!==y&&(f&k)===0&&(k=y&-y,C=f&-f,k>=C||k===16&&(C&4194240)!==0))return f;if((y&4)!==0&&(y|=p&16),f=c.entangledLanes,f!==0)for(c=c.entanglements,f&=y;0<f;)p=31-vr(f),k=1<<p,y|=c[p],f&=~k;return y}function ph(c,f){switch(c){case 1:case 2:case 4:return f+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Km(c,f){for(var p=c.suspendedLanes,y=c.pingedLanes,k=c.expirationTimes,C=c.pendingLanes;0<C;){var R=31-vr(C),Q=1<<R,ne=k[R];ne===-1?((Q&p)===0||(Q&y)!==0)&&(k[R]=ph(Q,f)):ne<=f&&(c.expiredLanes|=Q),C&=~Q}}function Ku(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Xu(){var c=kc;return kc<<=1,(kc&4194240)===0&&(kc=64),c}function Zu(c){for(var f=[],p=0;31>p;p++)f.push(c);return f}function Sa(c,f,p){c.pendingLanes|=f,f!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,f=31-vr(f),c[f]=p}function Xm(c,f){var p=c.pendingLanes&~f;c.pendingLanes=f,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=f,c.mutableReadLanes&=f,c.entangledLanes&=f,f=c.entanglements;var y=c.eventTimes;for(c=c.expirationTimes;0<p;){var k=31-vr(p),C=1<<k;f[k]=0,y[k]=-1,c[k]=-1,p&=~C}}function Ju(c,f){var p=c.entangledLanes|=f;for(c=c.entanglements;p;){var y=31-vr(p),k=1<<y;k&f|c[y]&f&&(c[y]|=f),p&=~k}}var Zt=0;function mh(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var gh,Cc,Qu,xh,vh,ef=!1,Ec=[],Hs=null,Ws=null,Gs=null,dl=new Map,bs=new Map,qs=[],tf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yh(c,f){switch(c){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":Ws=null;break;case"mouseover":case"mouseout":Gs=null;break;case"pointerover":case"pointerout":dl.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":bs.delete(f.pointerId)}}function hl(c,f,p,y,k,C){return c===null||c.nativeEvent!==C?(c={blockedOn:f,domEventName:p,eventSystemFlags:y,nativeEvent:C,targetContainers:[k]},f!==null&&(f=pf(f),f!==null&&Cc(f)),c):(c.eventSystemFlags|=y,f=c.targetContainers,k!==null&&f.indexOf(k)===-1&&f.push(k),c)}function te(c,f,p,y,k){switch(f){case"focusin":return Hs=hl(Hs,c,f,p,y,k),!0;case"dragenter":return Ws=hl(Ws,c,f,p,y,k),!0;case"mouseover":return Gs=hl(Gs,c,f,p,y,k),!0;case"pointerover":var C=k.pointerId;return dl.set(C,hl(dl.get(C)||null,c,f,p,y,k)),!0;case"gotpointercapture":return C=k.pointerId,bs.set(C,hl(bs.get(C)||null,c,f,p,y,k)),!0}return!1}function ae(c){var f=pl(c.target);if(f!==null){var p=K(f);if(p!==null){if(f=p.tag,f===13){if(f=me(p),f!==null){c.blockedOn=f,vh(c.priority,function(){Qu(p)});return}}else if(f===3&&p.stateNode.current.memoizedState.isDehydrated){c.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}c.blockedOn=null}function de(c){if(c.blockedOn!==null)return!1;for(var f=c.targetContainers;0<f.length;){var p=dn(c.domEventName,c.eventSystemFlags,f[0],c.nativeEvent);if(p===null){p=c.nativeEvent;var y=new p.constructor(p.type,p);Sn=y,p.target.dispatchEvent(y),Sn=null}else return f=pf(p),f!==null&&Cc(f),c.blockedOn=p,!1;f.shift()}return!0}function De(c,f,p){de(c)&&p.delete(f)}function We(){ef=!1,Hs!==null&&de(Hs)&&(Hs=null),Ws!==null&&de(Ws)&&(Ws=null),Gs!==null&&de(Gs)&&(Gs=null),dl.forEach(De),bs.forEach(De)}function ot(c,f){c.blockedOn===f&&(c.blockedOn=null,ef||(ef=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,We)))}function Rt(c){function f(k){return ot(k,c)}if(0<Ec.length){ot(Ec[0],c);for(var p=1;p<Ec.length;p++){var y=Ec[p];y.blockedOn===c&&(y.blockedOn=null)}}for(Hs!==null&&ot(Hs,c),Ws!==null&&ot(Ws,c),Gs!==null&&ot(Gs,c),dl.forEach(f),bs.forEach(f),p=0;p<qs.length;p++)y=qs[p],y.blockedOn===c&&(y.blockedOn=null);for(;0<qs.length&&(p=qs[0],p.blockedOn===null);)ae(p),p.blockedOn===null&&qs.shift()}var Lt=M.ReactCurrentBatchConfig,fr=!0;function tn(c,f,p,y){var k=Zt,C=Lt.transition;Lt.transition=null;try{Zt=1,kt(c,f,p,y)}finally{Zt=k,Lt.transition=C}}function Dr(c,f,p,y){var k=Zt,C=Lt.transition;Lt.transition=null;try{Zt=4,kt(c,f,p,y)}finally{Zt=k,Lt.transition=C}}function kt(c,f,p,y){if(fr){var k=dn(c,f,p,y);if(k===null)dg(c,f,y,fn,p),yh(c,y);else if(te(k,c,f,p,y))y.stopPropagation();else if(yh(c,y),f&4&&-1<tf.indexOf(c)){for(;k!==null;){var C=pf(k);if(C!==null&&gh(C),C=dn(c,f,p,y),C===null&&dg(c,f,y,fn,p),C===k)break;k=C}k!==null&&y.stopPropagation()}else dg(c,f,y,null,p)}}var fn=null;function dn(c,f,p,y){if(fn=null,c=Fi(y),c=pl(c),c!==null)if(f=K(c),f===null)c=null;else if(p=f.tag,p===13){if(c=me(f),c!==null)return c;c=null}else if(p===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;c=null}else f!==c&&(c=null);return fn=c,null}function Sr(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(St()){case or:return 1;case Ut:return 4;case xr:case ws:return 16;case Us:return 536870912;default:return 16}default:return 16}}var Ln=null,so=null,Ys=null;function wh(){if(Ys)return Ys;var c,f=so,p=f.length,y,k="value"in Ln?Ln.value:Ln.textContent,C=k.length;for(c=0;c<p&&f[c]===k[c];c++);var R=p-c;for(y=1;y<=R&&f[p-y]===k[C-y];y++);return Ys=k.slice(c,1<y?1-y:void 0)}function bh(c){var f=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&f===13&&(c=13)):c=f,c===10&&(c=13),32<=c||c===13?c:0}function kh(){return!0}function Ww(){return!1}function Ri(c){function f(p,y,k,C,R){this._reactName=p,this._targetInst=k,this.type=y,this.nativeEvent=C,this.target=R,this.currentTarget=null;for(var Q in c)c.hasOwnProperty(Q)&&(p=c[Q],this[Q]=p?p(C):C[Q]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?kh:Ww,this.isPropagationStopped=Ww,this}return ve(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=kh)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=kh)},persist:function(){},isPersistent:kh}),f}var Tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zm=Ri(Tc),rf=ve({},Tc,{view:0,detail:0}),yF=Ri(rf),Jm,Qm,nf,Sh=ve({},rf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tg,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==nf&&(nf&&c.type==="mousemove"?(Jm=c.screenX-nf.screenX,Qm=c.screenY-nf.screenY):Qm=Jm=0,nf=c),Jm)},movementY:function(c){return"movementY"in c?c.movementY:Qm}}),Gw=Ri(Sh),wF=ve({},Sh,{dataTransfer:0}),bF=Ri(wF),kF=ve({},rf,{relatedTarget:0}),eg=Ri(kF),SF=ve({},Tc,{animationName:0,elapsedTime:0,pseudoElement:0}),_F=Ri(SF),CF=ve({},Tc,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),EF=Ri(CF),TF=ve({},Tc,{data:0}),qw=Ri(TF),AF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DF(c){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(c):(c=MF[c])?!!f[c]:!1}function tg(){return DF}var OF=ve({},rf,{key:function(c){if(c.key){var f=AF[c.key]||c.key;if(f!=="Unidentified")return f}return c.type==="keypress"?(c=bh(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?NF[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tg,charCode:function(c){return c.type==="keypress"?bh(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?bh(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),FF=Ri(OF),IF=ve({},Sh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yw=Ri(IF),RF=ve({},rf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tg}),PF=Ri(RF),LF=ve({},Tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),BF=Ri(LF),jF=ve({},Sh,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),zF=Ri(jF),VF=[9,13,27,32],rg=o&&"CompositionEvent"in window,sf=null;o&&"documentMode"in document&&(sf=document.documentMode);var $F=o&&"TextEvent"in window&&!sf,Kw=o&&(!rg||sf&&8<sf&&11>=sf),Xw=" ",Zw=!1;function Jw(c,f){switch(c){case"keyup":return VF.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qw(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Ac=!1;function UF(c,f){switch(c){case"compositionend":return Qw(f);case"keypress":return f.which!==32?null:(Zw=!0,Xw);case"textInput":return c=f.data,c===Xw&&Zw?null:c;default:return null}}function HF(c,f){if(Ac)return c==="compositionend"||!rg&&Jw(c,f)?(c=wh(),Ys=so=Ln=null,Ac=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Kw&&f.locale!=="ko"?null:f.data;default:return null}}var WF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eb(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f==="input"?!!WF[c.type]:f==="textarea"}function tb(c,f,p,y){cl(y),f=Ah(f,"onChange"),0<f.length&&(p=new Zm("onChange","change",null,p,y),c.push({event:p,listeners:f}))}var af=null,of=null;function GF(c){yb(c,0)}function _h(c){var f=Fc(c);if(j(f))return c}function qF(c,f){if(c==="change")return f}var rb=!1;if(o){var ng;if(o){var ig="oninput"in document;if(!ig){var nb=document.createElement("div");nb.setAttribute("oninput","return;"),ig=typeof nb.oninput=="function"}ng=ig}else ng=!1;rb=ng&&(!document.documentMode||9<document.documentMode)}function ib(){af&&(af.detachEvent("onpropertychange",sb),of=af=null)}function sb(c){if(c.propertyName==="value"&&_h(of)){var f=[];tb(f,of,c,Fi(c)),ul(GF,f)}}function YF(c,f,p){c==="focusin"?(ib(),af=f,of=p,af.attachEvent("onpropertychange",sb)):c==="focusout"&&ib()}function KF(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return _h(of)}function XF(c,f){if(c==="click")return _h(f)}function ZF(c,f){if(c==="input"||c==="change")return _h(f)}function JF(c,f){return c===f&&(c!==0||1/c===1/f)||c!==c&&f!==f}var ks=typeof Object.is=="function"?Object.is:JF;function lf(c,f){if(ks(c,f))return!0;if(typeof c!="object"||c===null||typeof f!="object"||f===null)return!1;var p=Object.keys(c),y=Object.keys(f);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var k=p[y];if(!l.call(f,k)||!ks(c[k],f[k]))return!1}return!0}function ab(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function ob(c,f){var p=ab(c);c=0;for(var y;p;){if(p.nodeType===3){if(y=c+p.textContent.length,c<=f&&y>=f)return{node:p,offset:f-c};c=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=ab(p)}}function lb(c,f){return c&&f?c===f?!0:c&&c.nodeType===3?!1:f&&f.nodeType===3?lb(c,f.parentNode):"contains"in c?c.contains(f):c.compareDocumentPosition?!!(c.compareDocumentPosition(f)&16):!1:!1}function cb(){for(var c=window,f=tt();f instanceof c.HTMLIFrameElement;){try{var p=typeof f.contentWindow.location.href=="string"}catch{p=!1}if(p)c=f.contentWindow;else break;f=tt(c.document)}return f}function sg(c){var f=c&&c.nodeName&&c.nodeName.toLowerCase();return f&&(f==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||f==="textarea"||c.contentEditable==="true")}function QF(c){var f=cb(),p=c.focusedElem,y=c.selectionRange;if(f!==p&&p&&p.ownerDocument&&lb(p.ownerDocument.documentElement,p)){if(y!==null&&sg(p)){if(f=y.start,c=y.end,c===void 0&&(c=f),"selectionStart"in p)p.selectionStart=f,p.selectionEnd=Math.min(c,p.value.length);else if(c=(f=p.ownerDocument||document)&&f.defaultView||window,c.getSelection){c=c.getSelection();var k=p.textContent.length,C=Math.min(y.start,k);y=y.end===void 0?C:Math.min(y.end,k),!c.extend&&C>y&&(k=y,y=C,C=k),k=ob(p,C);var R=ob(p,y);k&&R&&(c.rangeCount!==1||c.anchorNode!==k.node||c.anchorOffset!==k.offset||c.focusNode!==R.node||c.focusOffset!==R.offset)&&(f=f.createRange(),f.setStart(k.node,k.offset),c.removeAllRanges(),C>y?(c.addRange(f),c.extend(R.node,R.offset)):(f.setEnd(R.node,R.offset),c.addRange(f)))}}for(f=[],c=p;c=c.parentNode;)c.nodeType===1&&f.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<f.length;p++)c=f[p],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var e4=o&&"documentMode"in document&&11>=document.documentMode,Nc=null,ag=null,cf=null,og=!1;function ub(c,f,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;og||Nc==null||Nc!==tt(y)||(y=Nc,"selectionStart"in y&&sg(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),cf&&lf(cf,y)||(cf=y,y=Ah(ag,"onSelect"),0<y.length&&(f=new Zm("onSelect","select",null,f,p),c.push({event:f,listeners:y}),f.target=Nc)))}function Ch(c,f){var p={};return p[c.toLowerCase()]=f.toLowerCase(),p["Webkit"+c]="webkit"+f,p["Moz"+c]="moz"+f,p}var Mc={animationend:Ch("Animation","AnimationEnd"),animationiteration:Ch("Animation","AnimationIteration"),animationstart:Ch("Animation","AnimationStart"),transitionend:Ch("Transition","TransitionEnd")},lg={},fb={};o&&(fb=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function Eh(c){if(lg[c])return lg[c];if(!Mc[c])return c;var f=Mc[c],p;for(p in f)if(f.hasOwnProperty(p)&&p in fb)return lg[c]=f[p];return c}var db=Eh("animationend"),hb=Eh("animationiteration"),pb=Eh("animationstart"),mb=Eh("transitionend"),gb=new Map,xb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ao(c,f){gb.set(c,f),s(f,[c])}for(var cg=0;cg<xb.length;cg++){var ug=xb[cg],t4=ug.toLowerCase(),r4=ug[0].toUpperCase()+ug.slice(1);ao(t4,"on"+r4)}ao(db,"onAnimationEnd"),ao(hb,"onAnimationIteration"),ao(pb,"onAnimationStart"),ao("dblclick","onDoubleClick"),ao("focusin","onFocus"),ao("focusout","onBlur"),ao(mb,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n4=new Set("cancel close invalid load scroll toggle".split(" ").concat(uf));function vb(c,f,p){var y=c.type||"unknown-event";c.currentTarget=p,G(y,f,void 0,c),c.currentTarget=null}function yb(c,f){f=(f&4)!==0;for(var p=0;p<c.length;p++){var y=c[p],k=y.event;y=y.listeners;e:{var C=void 0;if(f)for(var R=y.length-1;0<=R;R--){var Q=y[R],ne=Q.instance,_e=Q.currentTarget;if(Q=Q.listener,ne!==C&&k.isPropagationStopped())break e;vb(k,Q,_e),C=ne}else for(R=0;R<y.length;R++){if(Q=y[R],ne=Q.instance,_e=Q.currentTarget,Q=Q.listener,ne!==C&&k.isPropagationStopped())break e;vb(k,Q,_e),C=ne}}}if(L)throw c=Y,L=!1,Y=null,c}function yr(c,f){var p=f[vg];p===void 0&&(p=f[vg]=new Set);var y=c+"__bubble";p.has(y)||(wb(f,c,2,!1),p.add(y))}function fg(c,f,p){var y=0;f&&(y|=4),wb(p,c,y,f)}var Th="_reactListening"+Math.random().toString(36).slice(2);function ff(c){if(!c[Th]){c[Th]=!0,n.forEach(function(p){p!=="selectionchange"&&(n4.has(p)||fg(p,!1,c),fg(p,!0,c))});var f=c.nodeType===9?c:c.ownerDocument;f===null||f[Th]||(f[Th]=!0,fg("selectionchange",!1,f))}}function wb(c,f,p,y){switch(Sr(f)){case 1:var k=tn;break;case 4:k=Dr;break;default:k=kt}p=k.bind(null,f,p,c),k=void 0,!no||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(k=!0),y?k!==void 0?c.addEventListener(f,p,{capture:!0,passive:k}):c.addEventListener(f,p,!0):k!==void 0?c.addEventListener(f,p,{passive:k}):c.addEventListener(f,p,!1)}function dg(c,f,p,y,k){var C=y;if((f&1)===0&&(f&2)===0&&y!==null)e:for(;;){if(y===null)return;var R=y.tag;if(R===3||R===4){var Q=y.stateNode.containerInfo;if(Q===k||Q.nodeType===8&&Q.parentNode===k)break;if(R===4)for(R=y.return;R!==null;){var ne=R.tag;if((ne===3||ne===4)&&(ne=R.stateNode.containerInfo,ne===k||ne.nodeType===8&&ne.parentNode===k))return;R=R.return}for(;Q!==null;){if(R=pl(Q),R===null)return;if(ne=R.tag,ne===5||ne===6){y=C=R;continue e}Q=Q.parentNode}}y=y.return}ul(function(){var _e=C,Fe=Fi(p),je=[];e:{var Oe=gb.get(c);if(Oe!==void 0){var Ze=Zm,lt=c;switch(c){case"keypress":if(bh(p)===0)break e;case"keydown":case"keyup":Ze=FF;break;case"focusin":lt="focus",Ze=eg;break;case"focusout":lt="blur",Ze=eg;break;case"beforeblur":case"afterblur":Ze=eg;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Gw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=bF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=PF;break;case db:case hb:case pb:Ze=_F;break;case mb:Ze=BF;break;case"scroll":Ze=yF;break;case"wheel":Ze=zF;break;case"copy":case"cut":case"paste":Ze=EF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Yw}var ut=(f&4)!==0,Lr=!ut&&c==="scroll",he=ut?Oe!==null?Oe+"Capture":null:Oe;ut=[];for(var ie=_e,we;ie!==null;){we=ie;var Ue=we.stateNode;if(we.tag===5&&Ue!==null&&(we=Ue,he!==null&&(Ue=ka(ie,he),Ue!=null&&ut.push(df(ie,Ue,we)))),Lr)break;ie=ie.return}0<ut.length&&(Oe=new Ze(Oe,lt,null,p,Fe),je.push({event:Oe,listeners:ut}))}}if((f&7)===0){e:{if(Oe=c==="mouseover"||c==="pointerover",Ze=c==="mouseout"||c==="pointerout",Oe&&p!==Sn&&(lt=p.relatedTarget||p.fromElement)&&(pl(lt)||lt[_a]))break e;if((Ze||Oe)&&(Oe=Fe.window===Fe?Fe:(Oe=Fe.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Ze?(lt=p.relatedTarget||p.toElement,Ze=_e,lt=lt?pl(lt):null,lt!==null&&(Lr=K(lt),lt!==Lr||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(Ze=null,lt=_e),Ze!==lt)){if(ut=Gw,Ue="onMouseLeave",he="onMouseEnter",ie="mouse",(c==="pointerout"||c==="pointerover")&&(ut=Yw,Ue="onPointerLeave",he="onPointerEnter",ie="pointer"),Lr=Ze==null?Oe:Fc(Ze),we=lt==null?Oe:Fc(lt),Oe=new ut(Ue,ie+"leave",Ze,p,Fe),Oe.target=Lr,Oe.relatedTarget=we,Ue=null,pl(Fe)===_e&&(ut=new ut(he,ie+"enter",lt,p,Fe),ut.target=we,ut.relatedTarget=Lr,Ue=ut),Lr=Ue,Ze&&lt)t:{for(ut=Ze,he=lt,ie=0,we=ut;we;we=Dc(we))ie++;for(we=0,Ue=he;Ue;Ue=Dc(Ue))we++;for(;0<ie-we;)ut=Dc(ut),ie--;for(;0<we-ie;)he=Dc(he),we--;for(;ie--;){if(ut===he||he!==null&&ut===he.alternate)break t;ut=Dc(ut),he=Dc(he)}ut=null}else ut=null;Ze!==null&&bb(je,Oe,Ze,ut,!1),lt!==null&&Lr!==null&&bb(je,Lr,lt,ut,!0)}}e:{if(Oe=_e?Fc(_e):window,Ze=Oe.nodeName&&Oe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Oe.type==="file")var dt=qF;else if(eb(Oe))if(rb)dt=ZF;else{dt=KF;var vt=YF}else(Ze=Oe.nodeName)&&Ze.toLowerCase()==="input"&&(Oe.type==="checkbox"||Oe.type==="radio")&&(dt=XF);if(dt&&(dt=dt(c,_e))){tb(je,dt,p,Fe);break e}vt&&vt(c,Oe,_e),c==="focusout"&&(vt=Oe._wrapperState)&&vt.controlled&&Oe.type==="number"&&gt(Oe,"number",Oe.value)}switch(vt=_e?Fc(_e):window,c){case"focusin":(eb(vt)||vt.contentEditable==="true")&&(Nc=vt,ag=_e,cf=null);break;case"focusout":cf=ag=Nc=null;break;case"mousedown":og=!0;break;case"contextmenu":case"mouseup":case"dragend":og=!1,ub(je,p,Fe);break;case"selectionchange":if(e4)break;case"keydown":case"keyup":ub(je,p,Fe)}var yt;if(rg)e:{switch(c){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else Ac?Jw(c,p)&&(At="onCompositionEnd"):c==="keydown"&&p.keyCode===229&&(At="onCompositionStart");At&&(Kw&&p.locale!=="ko"&&(Ac||At!=="onCompositionStart"?At==="onCompositionEnd"&&Ac&&(yt=wh()):(Ln=Fe,so="value"in Ln?Ln.value:Ln.textContent,Ac=!0)),vt=Ah(_e,At),0<vt.length&&(At=new qw(At,c,null,p,Fe),je.push({event:At,listeners:vt}),yt?At.data=yt:(yt=Qw(p),yt!==null&&(At.data=yt)))),(yt=$F?UF(c,p):HF(c,p))&&(_e=Ah(_e,"onBeforeInput"),0<_e.length&&(Fe=new qw("onBeforeInput","beforeinput",null,p,Fe),je.push({event:Fe,listeners:_e}),Fe.data=yt))}yb(je,f)})}function df(c,f,p){return{instance:c,listener:f,currentTarget:p}}function Ah(c,f){for(var p=f+"Capture",y=[];c!==null;){var k=c,C=k.stateNode;k.tag===5&&C!==null&&(k=C,C=ka(c,p),C!=null&&y.unshift(df(c,C,k)),C=ka(c,f),C!=null&&y.push(df(c,C,k))),c=c.return}return y}function Dc(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function bb(c,f,p,y,k){for(var C=f._reactName,R=[];p!==null&&p!==y;){var Q=p,ne=Q.alternate,_e=Q.stateNode;if(ne!==null&&ne===y)break;Q.tag===5&&_e!==null&&(Q=_e,k?(ne=ka(p,C),ne!=null&&R.unshift(df(p,ne,Q))):k||(ne=ka(p,C),ne!=null&&R.push(df(p,ne,Q)))),p=p.return}R.length!==0&&c.push({event:f,listeners:R})}var i4=/\r\n?/g,s4=/\u0000|\uFFFD/g;function kb(c){return(typeof c=="string"?c:""+c).replace(i4,`
`).replace(s4,"")}function Nh(c,f,p){if(f=kb(f),kb(c)!==f&&p)throw Error(r(425))}function Mh(){}var hg=null,pg=null;function mg(c,f){return c==="textarea"||c==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var gg=typeof setTimeout=="function"?setTimeout:void 0,a4=typeof clearTimeout=="function"?clearTimeout:void 0,Sb=typeof Promise=="function"?Promise:void 0,o4=typeof queueMicrotask=="function"?queueMicrotask:typeof Sb<"u"?function(c){return Sb.resolve(null).then(c).catch(l4)}:gg;function l4(c){setTimeout(function(){throw c})}function xg(c,f){var p=f,y=0;do{var k=p.nextSibling;if(c.removeChild(p),k&&k.nodeType===8)if(p=k.data,p==="/$"){if(y===0){c.removeChild(k),Rt(f);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=k}while(p);Rt(f)}function oo(c){for(;c!=null;c=c.nextSibling){var f=c.nodeType;if(f===1||f===3)break;if(f===8){if(f=c.data,f==="$"||f==="$!"||f==="$?")break;if(f==="/$")return null}}return c}function _b(c){c=c.previousSibling;for(var f=0;c;){if(c.nodeType===8){var p=c.data;if(p==="$"||p==="$!"||p==="$?"){if(f===0)return c;f--}else p==="/$"&&f++}c=c.previousSibling}return null}var Oc=Math.random().toString(36).slice(2),Ks="__reactFiber$"+Oc,hf="__reactProps$"+Oc,_a="__reactContainer$"+Oc,vg="__reactEvents$"+Oc,c4="__reactListeners$"+Oc,u4="__reactHandles$"+Oc;function pl(c){var f=c[Ks];if(f)return f;for(var p=c.parentNode;p;){if(f=p[_a]||p[Ks]){if(p=f.alternate,f.child!==null||p!==null&&p.child!==null)for(c=_b(c);c!==null;){if(p=c[Ks])return p;c=_b(c)}return f}c=p,p=c.parentNode}return null}function pf(c){return c=c[Ks]||c[_a],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function Fc(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(r(33))}function Dh(c){return c[hf]||null}var yg=[],Ic=-1;function lo(c){return{current:c}}function wr(c){0>Ic||(c.current=yg[Ic],yg[Ic]=null,Ic--)}function pr(c,f){Ic++,yg[Ic]=c.current,c.current=f}var co={},Bn=lo(co),yi=lo(!1),ml=co;function Rc(c,f){var p=c.type.contextTypes;if(!p)return co;var y=c.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===f)return y.__reactInternalMemoizedMaskedChildContext;var k={},C;for(C in p)k[C]=f[C];return y&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=f,c.__reactInternalMemoizedMaskedChildContext=k),k}function wi(c){return c=c.childContextTypes,c!=null}function Oh(){wr(yi),wr(Bn)}function Cb(c,f,p){if(Bn.current!==co)throw Error(r(168));pr(Bn,f),pr(yi,p)}function Eb(c,f,p){var y=c.stateNode;if(f=f.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var k in y)if(!(k in f))throw Error(r(108,Ce(c)||"Unknown",k));return ve({},p,y)}function Fh(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||co,ml=Bn.current,pr(Bn,c),pr(yi,yi.current),!0}function Tb(c,f,p){var y=c.stateNode;if(!y)throw Error(r(169));p?(c=Eb(c,f,ml),y.__reactInternalMemoizedMergedChildContext=c,wr(yi),wr(Bn),pr(Bn,c)):wr(yi),pr(yi,p)}var Ca=null,Ih=!1,wg=!1;function Ab(c){Ca===null?Ca=[c]:Ca.push(c)}function f4(c){Ih=!0,Ab(c)}function uo(){if(!wg&&Ca!==null){wg=!0;var c=0,f=Zt;try{var p=Ca;for(Zt=1;c<p.length;c++){var y=p[c];do y=y(!0);while(y!==null)}Ca=null,Ih=!1}catch(k){throw Ca!==null&&(Ca=Ca.slice(c+1)),Re(or,uo),k}finally{Zt=f,wg=!1}}return null}var Pc=[],Lc=0,Rh=null,Ph=0,Xi=[],Zi=0,gl=null,Ea=1,Ta="";function xl(c,f){Pc[Lc++]=Ph,Pc[Lc++]=Rh,Rh=c,Ph=f}function Nb(c,f,p){Xi[Zi++]=Ea,Xi[Zi++]=Ta,Xi[Zi++]=gl,gl=c;var y=Ea;c=Ta;var k=32-vr(y)-1;y&=~(1<<k),p+=1;var C=32-vr(f)+k;if(30<C){var R=k-k%5;C=(y&(1<<R)-1).toString(32),y>>=R,k-=R,Ea=1<<32-vr(f)+k|p<<k|y,Ta=C+c}else Ea=1<<C|p<<k|y,Ta=c}function bg(c){c.return!==null&&(xl(c,1),Nb(c,1,0))}function kg(c){for(;c===Rh;)Rh=Pc[--Lc],Pc[Lc]=null,Ph=Pc[--Lc],Pc[Lc]=null;for(;c===gl;)gl=Xi[--Zi],Xi[Zi]=null,Ta=Xi[--Zi],Xi[Zi]=null,Ea=Xi[--Zi],Xi[Zi]=null}var Pi=null,Li=null,_r=!1,Ss=null;function Mb(c,f){var p=ts(5,null,null,0);p.elementType="DELETED",p.stateNode=f,p.return=c,f=c.deletions,f===null?(c.deletions=[p],c.flags|=16):f.push(p)}function Db(c,f){switch(c.tag){case 5:var p=c.type;return f=f.nodeType!==1||p.toLowerCase()!==f.nodeName.toLowerCase()?null:f,f!==null?(c.stateNode=f,Pi=c,Li=oo(f.firstChild),!0):!1;case 6:return f=c.pendingProps===""||f.nodeType!==3?null:f,f!==null?(c.stateNode=f,Pi=c,Li=null,!0):!1;case 13:return f=f.nodeType!==8?null:f,f!==null?(p=gl!==null?{id:Ea,overflow:Ta}:null,c.memoizedState={dehydrated:f,treeContext:p,retryLane:1073741824},p=ts(18,null,null,0),p.stateNode=f,p.return=c,c.child=p,Pi=c,Li=null,!0):!1;default:return!1}}function Sg(c){return(c.mode&1)!==0&&(c.flags&128)===0}function _g(c){if(_r){var f=Li;if(f){var p=f;if(!Db(c,f)){if(Sg(c))throw Error(r(418));f=oo(p.nextSibling);var y=Pi;f&&Db(c,f)?Mb(y,p):(c.flags=c.flags&-4097|2,_r=!1,Pi=c)}}else{if(Sg(c))throw Error(r(418));c.flags=c.flags&-4097|2,_r=!1,Pi=c}}}function Ob(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Pi=c}function Lh(c){if(c!==Pi)return!1;if(!_r)return Ob(c),_r=!0,!1;var f;if((f=c.tag!==3)&&!(f=c.tag!==5)&&(f=c.type,f=f!=="head"&&f!=="body"&&!mg(c.type,c.memoizedProps)),f&&(f=Li)){if(Sg(c))throw Fb(),Error(r(418));for(;f;)Mb(c,f),f=oo(f.nextSibling)}if(Ob(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(r(317));e:{for(c=c.nextSibling,f=0;c;){if(c.nodeType===8){var p=c.data;if(p==="/$"){if(f===0){Li=oo(c.nextSibling);break e}f--}else p!=="$"&&p!=="$!"&&p!=="$?"||f++}c=c.nextSibling}Li=null}}else Li=Pi?oo(c.stateNode.nextSibling):null;return!0}function Fb(){for(var c=Li;c;)c=oo(c.nextSibling)}function Bc(){Li=Pi=null,_r=!1}function Cg(c){Ss===null?Ss=[c]:Ss.push(c)}var d4=M.ReactCurrentBatchConfig;function mf(c,f,p){if(c=p.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var y=p.stateNode}if(!y)throw Error(r(147,c));var k=y,C=""+c;return f!==null&&f.ref!==null&&typeof f.ref=="function"&&f.ref._stringRef===C?f.ref:(f=function(R){var Q=k.refs;R===null?delete Q[C]:Q[C]=R},f._stringRef=C,f)}if(typeof c!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,c))}return c}function Bh(c,f){throw c=Object.prototype.toString.call(f),Error(r(31,c==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":c))}function Ib(c){var f=c._init;return f(c._payload)}function Rb(c){function f(he,ie){if(c){var we=he.deletions;we===null?(he.deletions=[ie],he.flags|=16):we.push(ie)}}function p(he,ie){if(!c)return null;for(;ie!==null;)f(he,ie),ie=ie.sibling;return null}function y(he,ie){for(he=new Map;ie!==null;)ie.key!==null?he.set(ie.key,ie):he.set(ie.index,ie),ie=ie.sibling;return he}function k(he,ie){return he=yo(he,ie),he.index=0,he.sibling=null,he}function C(he,ie,we){return he.index=we,c?(we=he.alternate,we!==null?(we=we.index,we<ie?(he.flags|=2,ie):we):(he.flags|=2,ie)):(he.flags|=1048576,ie)}function R(he){return c&&he.alternate===null&&(he.flags|=2),he}function Q(he,ie,we,Ue){return ie===null||ie.tag!==6?(ie=gx(we,he.mode,Ue),ie.return=he,ie):(ie=k(ie,we),ie.return=he,ie)}function ne(he,ie,we,Ue){var dt=we.type;return dt===E?Fe(he,ie,we.props.children,Ue,we.key):ie!==null&&(ie.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===fe&&Ib(dt)===ie.type)?(Ue=k(ie,we.props),Ue.ref=mf(he,ie,we),Ue.return=he,Ue):(Ue=l0(we.type,we.key,we.props,null,he.mode,Ue),Ue.ref=mf(he,ie,we),Ue.return=he,Ue)}function _e(he,ie,we,Ue){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==we.containerInfo||ie.stateNode.implementation!==we.implementation?(ie=xx(we,he.mode,Ue),ie.return=he,ie):(ie=k(ie,we.children||[]),ie.return=he,ie)}function Fe(he,ie,we,Ue,dt){return ie===null||ie.tag!==7?(ie=Cl(we,he.mode,Ue,dt),ie.return=he,ie):(ie=k(ie,we),ie.return=he,ie)}function je(he,ie,we){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=gx(""+ie,he.mode,we),ie.return=he,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case D:return we=l0(ie.type,ie.key,ie.props,null,he.mode,we),we.ref=mf(he,null,ie),we.return=he,we;case O:return ie=xx(ie,he.mode,we),ie.return=he,ie;case fe:var Ue=ie._init;return je(he,Ue(ie._payload),we)}if(J(ie)||H(ie))return ie=Cl(ie,he.mode,we,null),ie.return=he,ie;Bh(he,ie)}return null}function Oe(he,ie,we,Ue){var dt=ie!==null?ie.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return dt!==null?null:Q(he,ie,""+we,Ue);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case D:return we.key===dt?ne(he,ie,we,Ue):null;case O:return we.key===dt?_e(he,ie,we,Ue):null;case fe:return dt=we._init,Oe(he,ie,dt(we._payload),Ue)}if(J(we)||H(we))return dt!==null?null:Fe(he,ie,we,Ue,null);Bh(he,we)}return null}function Ze(he,ie,we,Ue,dt){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return he=he.get(we)||null,Q(ie,he,""+Ue,dt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case D:return he=he.get(Ue.key===null?we:Ue.key)||null,ne(ie,he,Ue,dt);case O:return he=he.get(Ue.key===null?we:Ue.key)||null,_e(ie,he,Ue,dt);case fe:var vt=Ue._init;return Ze(he,ie,we,vt(Ue._payload),dt)}if(J(Ue)||H(Ue))return he=he.get(we)||null,Fe(ie,he,Ue,dt,null);Bh(ie,Ue)}return null}function lt(he,ie,we,Ue){for(var dt=null,vt=null,yt=ie,At=ie=0,mn=null;yt!==null&&At<we.length;At++){yt.index>At?(mn=yt,yt=null):mn=yt.sibling;var nr=Oe(he,yt,we[At],Ue);if(nr===null){yt===null&&(yt=mn);break}c&&yt&&nr.alternate===null&&f(he,yt),ie=C(nr,ie,At),vt===null?dt=nr:vt.sibling=nr,vt=nr,yt=mn}if(At===we.length)return p(he,yt),_r&&xl(he,At),dt;if(yt===null){for(;At<we.length;At++)yt=je(he,we[At],Ue),yt!==null&&(ie=C(yt,ie,At),vt===null?dt=yt:vt.sibling=yt,vt=yt);return _r&&xl(he,At),dt}for(yt=y(he,yt);At<we.length;At++)mn=Ze(yt,he,At,we[At],Ue),mn!==null&&(c&&mn.alternate!==null&&yt.delete(mn.key===null?At:mn.key),ie=C(mn,ie,At),vt===null?dt=mn:vt.sibling=mn,vt=mn);return c&&yt.forEach(function(wo){return f(he,wo)}),_r&&xl(he,At),dt}function ut(he,ie,we,Ue){var dt=H(we);if(typeof dt!="function")throw Error(r(150));if(we=dt.call(we),we==null)throw Error(r(151));for(var vt=dt=null,yt=ie,At=ie=0,mn=null,nr=we.next();yt!==null&&!nr.done;At++,nr=we.next()){yt.index>At?(mn=yt,yt=null):mn=yt.sibling;var wo=Oe(he,yt,nr.value,Ue);if(wo===null){yt===null&&(yt=mn);break}c&&yt&&wo.alternate===null&&f(he,yt),ie=C(wo,ie,At),vt===null?dt=wo:vt.sibling=wo,vt=wo,yt=mn}if(nr.done)return p(he,yt),_r&&xl(he,At),dt;if(yt===null){for(;!nr.done;At++,nr=we.next())nr=je(he,nr.value,Ue),nr!==null&&(ie=C(nr,ie,At),vt===null?dt=nr:vt.sibling=nr,vt=nr);return _r&&xl(he,At),dt}for(yt=y(he,yt);!nr.done;At++,nr=we.next())nr=Ze(yt,he,At,nr.value,Ue),nr!==null&&(c&&nr.alternate!==null&&yt.delete(nr.key===null?At:nr.key),ie=C(nr,ie,At),vt===null?dt=nr:vt.sibling=nr,vt=nr);return c&&yt.forEach(function(W4){return f(he,W4)}),_r&&xl(he,At),dt}function Lr(he,ie,we,Ue){if(typeof we=="object"&&we!==null&&we.type===E&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case D:e:{for(var dt=we.key,vt=ie;vt!==null;){if(vt.key===dt){if(dt=we.type,dt===E){if(vt.tag===7){p(he,vt.sibling),ie=k(vt,we.props.children),ie.return=he,he=ie;break e}}else if(vt.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===fe&&Ib(dt)===vt.type){p(he,vt.sibling),ie=k(vt,we.props),ie.ref=mf(he,vt,we),ie.return=he,he=ie;break e}p(he,vt);break}else f(he,vt);vt=vt.sibling}we.type===E?(ie=Cl(we.props.children,he.mode,Ue,we.key),ie.return=he,he=ie):(Ue=l0(we.type,we.key,we.props,null,he.mode,Ue),Ue.ref=mf(he,ie,we),Ue.return=he,he=Ue)}return R(he);case O:e:{for(vt=we.key;ie!==null;){if(ie.key===vt)if(ie.tag===4&&ie.stateNode.containerInfo===we.containerInfo&&ie.stateNode.implementation===we.implementation){p(he,ie.sibling),ie=k(ie,we.children||[]),ie.return=he,he=ie;break e}else{p(he,ie);break}else f(he,ie);ie=ie.sibling}ie=xx(we,he.mode,Ue),ie.return=he,he=ie}return R(he);case fe:return vt=we._init,Lr(he,ie,vt(we._payload),Ue)}if(J(we))return lt(he,ie,we,Ue);if(H(we))return ut(he,ie,we,Ue);Bh(he,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,ie!==null&&ie.tag===6?(p(he,ie.sibling),ie=k(ie,we),ie.return=he,he=ie):(p(he,ie),ie=gx(we,he.mode,Ue),ie.return=he,he=ie),R(he)):p(he,ie)}return Lr}var jc=Rb(!0),Pb=Rb(!1),jh=lo(null),zh=null,zc=null,Eg=null;function Tg(){Eg=zc=zh=null}function Ag(c){var f=jh.current;wr(jh),c._currentValue=f}function Ng(c,f,p){for(;c!==null;){var y=c.alternate;if((c.childLanes&f)!==f?(c.childLanes|=f,y!==null&&(y.childLanes|=f)):y!==null&&(y.childLanes&f)!==f&&(y.childLanes|=f),c===p)break;c=c.return}}function Vc(c,f){zh=c,Eg=zc=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&f)!==0&&(bi=!0),c.firstContext=null)}function Ji(c){var f=c._currentValue;if(Eg!==c)if(c={context:c,memoizedValue:f,next:null},zc===null){if(zh===null)throw Error(r(308));zc=c,zh.dependencies={lanes:0,firstContext:c}}else zc=zc.next=c;return f}var vl=null;function Mg(c){vl===null?vl=[c]:vl.push(c)}function Lb(c,f,p,y){var k=f.interleaved;return k===null?(p.next=p,Mg(f)):(p.next=k.next,k.next=p),f.interleaved=p,Aa(c,y)}function Aa(c,f){c.lanes|=f;var p=c.alternate;for(p!==null&&(p.lanes|=f),p=c,c=c.return;c!==null;)c.childLanes|=f,p=c.alternate,p!==null&&(p.childLanes|=f),p=c,c=c.return;return p.tag===3?p.stateNode:null}var fo=!1;function Dg(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bb(c,f){c=c.updateQueue,f.updateQueue===c&&(f.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Na(c,f){return{eventTime:c,lane:f,tag:0,payload:null,callback:null,next:null}}function ho(c,f,p){var y=c.updateQueue;if(y===null)return null;if(y=y.shared,(Jt&2)!==0){var k=y.pending;return k===null?f.next=f:(f.next=k.next,k.next=f),y.pending=f,Aa(c,p)}return k=y.interleaved,k===null?(f.next=f,Mg(y)):(f.next=k.next,k.next=f),y.interleaved=f,Aa(c,p)}function Vh(c,f,p){if(f=f.updateQueue,f!==null&&(f=f.shared,(p&4194240)!==0)){var y=f.lanes;y&=c.pendingLanes,p|=y,f.lanes=p,Ju(c,p)}}function jb(c,f){var p=c.updateQueue,y=c.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var k=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var R={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};C===null?k=C=R:C=C.next=R,p=p.next}while(p!==null);C===null?k=C=f:C=C.next=f}else k=C=f;p={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:C,shared:y.shared,effects:y.effects},c.updateQueue=p;return}c=p.lastBaseUpdate,c===null?p.firstBaseUpdate=f:c.next=f,p.lastBaseUpdate=f}function $h(c,f,p,y){var k=c.updateQueue;fo=!1;var C=k.firstBaseUpdate,R=k.lastBaseUpdate,Q=k.shared.pending;if(Q!==null){k.shared.pending=null;var ne=Q,_e=ne.next;ne.next=null,R===null?C=_e:R.next=_e,R=ne;var Fe=c.alternate;Fe!==null&&(Fe=Fe.updateQueue,Q=Fe.lastBaseUpdate,Q!==R&&(Q===null?Fe.firstBaseUpdate=_e:Q.next=_e,Fe.lastBaseUpdate=ne))}if(C!==null){var je=k.baseState;R=0,Fe=_e=ne=null,Q=C;do{var Oe=Q.lane,Ze=Q.eventTime;if((y&Oe)===Oe){Fe!==null&&(Fe=Fe.next={eventTime:Ze,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var lt=c,ut=Q;switch(Oe=f,Ze=p,ut.tag){case 1:if(lt=ut.payload,typeof lt=="function"){je=lt.call(Ze,je,Oe);break e}je=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ut.payload,Oe=typeof lt=="function"?lt.call(Ze,je,Oe):lt,Oe==null)break e;je=ve({},je,Oe);break e;case 2:fo=!0}}Q.callback!==null&&Q.lane!==0&&(c.flags|=64,Oe=k.effects,Oe===null?k.effects=[Q]:Oe.push(Q))}else Ze={eventTime:Ze,lane:Oe,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Fe===null?(_e=Fe=Ze,ne=je):Fe=Fe.next=Ze,R|=Oe;if(Q=Q.next,Q===null){if(Q=k.shared.pending,Q===null)break;Oe=Q,Q=Oe.next,Oe.next=null,k.lastBaseUpdate=Oe,k.shared.pending=null}}while(!0);if(Fe===null&&(ne=je),k.baseState=ne,k.firstBaseUpdate=_e,k.lastBaseUpdate=Fe,f=k.shared.interleaved,f!==null){k=f;do R|=k.lane,k=k.next;while(k!==f)}else C===null&&(k.shared.lanes=0);bl|=R,c.lanes=R,c.memoizedState=je}}function zb(c,f,p){if(c=f.effects,f.effects=null,c!==null)for(f=0;f<c.length;f++){var y=c[f],k=y.callback;if(k!==null){if(y.callback=null,y=p,typeof k!="function")throw Error(r(191,k));k.call(y)}}}var gf={},Xs=lo(gf),xf=lo(gf),vf=lo(gf);function yl(c){if(c===gf)throw Error(r(174));return c}function Og(c,f){switch(pr(vf,f),pr(xf,c),pr(Xs,gf),c=f.nodeType,c){case 9:case 11:f=(f=f.documentElement)?f.namespaceURI:et(null,"");break;default:c=c===8?f.parentNode:f,f=c.namespaceURI||null,c=c.tagName,f=et(f,c)}wr(Xs),pr(Xs,f)}function $c(){wr(Xs),wr(xf),wr(vf)}function Vb(c){yl(vf.current);var f=yl(Xs.current),p=et(f,c.type);f!==p&&(pr(xf,c),pr(Xs,p))}function Fg(c){xf.current===c&&(wr(Xs),wr(xf))}var Er=lo(0);function Uh(c){for(var f=c;f!==null;){if(f.tag===13){var p=f.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var Ig=[];function Rg(){for(var c=0;c<Ig.length;c++)Ig[c]._workInProgressVersionPrimary=null;Ig.length=0}var Hh=M.ReactCurrentDispatcher,Pg=M.ReactCurrentBatchConfig,wl=0,Tr=null,rn=null,hn=null,Wh=!1,yf=!1,wf=0,h4=0;function jn(){throw Error(r(321))}function Lg(c,f){if(f===null)return!1;for(var p=0;p<f.length&&p<c.length;p++)if(!ks(c[p],f[p]))return!1;return!0}function Bg(c,f,p,y,k,C){if(wl=C,Tr=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Hh.current=c===null||c.memoizedState===null?x4:v4,c=p(y,k),yf){C=0;do{if(yf=!1,wf=0,25<=C)throw Error(r(301));C+=1,hn=rn=null,f.updateQueue=null,Hh.current=y4,c=p(y,k)}while(yf)}if(Hh.current=Yh,f=rn!==null&&rn.next!==null,wl=0,hn=rn=Tr=null,Wh=!1,f)throw Error(r(300));return c}function jg(){var c=wf!==0;return wf=0,c}function Zs(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Tr.memoizedState=hn=c:hn=hn.next=c,hn}function Qi(){if(rn===null){var c=Tr.alternate;c=c!==null?c.memoizedState:null}else c=rn.next;var f=hn===null?Tr.memoizedState:hn.next;if(f!==null)hn=f,rn=c;else{if(c===null)throw Error(r(310));rn=c,c={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},hn===null?Tr.memoizedState=hn=c:hn=hn.next=c}return hn}function bf(c,f){return typeof f=="function"?f(c):f}function zg(c){var f=Qi(),p=f.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var y=rn,k=y.baseQueue,C=p.pending;if(C!==null){if(k!==null){var R=k.next;k.next=C.next,C.next=R}y.baseQueue=k=C,p.pending=null}if(k!==null){C=k.next,y=y.baseState;var Q=R=null,ne=null,_e=C;do{var Fe=_e.lane;if((wl&Fe)===Fe)ne!==null&&(ne=ne.next={lane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),y=_e.hasEagerState?_e.eagerState:c(y,_e.action);else{var je={lane:Fe,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null};ne===null?(Q=ne=je,R=y):ne=ne.next=je,Tr.lanes|=Fe,bl|=Fe}_e=_e.next}while(_e!==null&&_e!==C);ne===null?R=y:ne.next=Q,ks(y,f.memoizedState)||(bi=!0),f.memoizedState=y,f.baseState=R,f.baseQueue=ne,p.lastRenderedState=y}if(c=p.interleaved,c!==null){k=c;do C=k.lane,Tr.lanes|=C,bl|=C,k=k.next;while(k!==c)}else k===null&&(p.lanes=0);return[f.memoizedState,p.dispatch]}function Vg(c){var f=Qi(),p=f.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=c;var y=p.dispatch,k=p.pending,C=f.memoizedState;if(k!==null){p.pending=null;var R=k=k.next;do C=c(C,R.action),R=R.next;while(R!==k);ks(C,f.memoizedState)||(bi=!0),f.memoizedState=C,f.baseQueue===null&&(f.baseState=C),p.lastRenderedState=C}return[C,y]}function $b(){}function Ub(c,f){var p=Tr,y=Qi(),k=f(),C=!ks(y.memoizedState,k);if(C&&(y.memoizedState=k,bi=!0),y=y.queue,$g(Gb.bind(null,p,y,c),[c]),y.getSnapshot!==f||C||hn!==null&&hn.memoizedState.tag&1){if(p.flags|=2048,kf(9,Wb.bind(null,p,y,k,f),void 0,null),pn===null)throw Error(r(349));(wl&30)!==0||Hb(p,f,k)}return k}function Hb(c,f,p){c.flags|=16384,c={getSnapshot:f,value:p},f=Tr.updateQueue,f===null?(f={lastEffect:null,stores:null},Tr.updateQueue=f,f.stores=[c]):(p=f.stores,p===null?f.stores=[c]:p.push(c))}function Wb(c,f,p,y){f.value=p,f.getSnapshot=y,qb(f)&&Yb(c)}function Gb(c,f,p){return p(function(){qb(f)&&Yb(c)})}function qb(c){var f=c.getSnapshot;c=c.value;try{var p=f();return!ks(c,p)}catch{return!0}}function Yb(c){var f=Aa(c,1);f!==null&&Ts(f,c,1,-1)}function Kb(c){var f=Zs();return typeof c=="function"&&(c=c()),f.memoizedState=f.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bf,lastRenderedState:c},f.queue=c,c=c.dispatch=g4.bind(null,Tr,c),[f.memoizedState,c]}function kf(c,f,p,y){return c={tag:c,create:f,destroy:p,deps:y,next:null},f=Tr.updateQueue,f===null?(f={lastEffect:null,stores:null},Tr.updateQueue=f,f.lastEffect=c.next=c):(p=f.lastEffect,p===null?f.lastEffect=c.next=c:(y=p.next,p.next=c,c.next=y,f.lastEffect=c)),c}function Xb(){return Qi().memoizedState}function Gh(c,f,p,y){var k=Zs();Tr.flags|=c,k.memoizedState=kf(1|f,p,void 0,y===void 0?null:y)}function qh(c,f,p,y){var k=Qi();y=y===void 0?null:y;var C=void 0;if(rn!==null){var R=rn.memoizedState;if(C=R.destroy,y!==null&&Lg(y,R.deps)){k.memoizedState=kf(f,p,C,y);return}}Tr.flags|=c,k.memoizedState=kf(1|f,p,C,y)}function Zb(c,f){return Gh(8390656,8,c,f)}function $g(c,f){return qh(2048,8,c,f)}function Jb(c,f){return qh(4,2,c,f)}function Qb(c,f){return qh(4,4,c,f)}function ek(c,f){if(typeof f=="function")return c=c(),f(c),function(){f(null)};if(f!=null)return c=c(),f.current=c,function(){f.current=null}}function tk(c,f,p){return p=p!=null?p.concat([c]):null,qh(4,4,ek.bind(null,f,c),p)}function Ug(){}function rk(c,f){var p=Qi();f=f===void 0?null:f;var y=p.memoizedState;return y!==null&&f!==null&&Lg(f,y[1])?y[0]:(p.memoizedState=[c,f],c)}function nk(c,f){var p=Qi();f=f===void 0?null:f;var y=p.memoizedState;return y!==null&&f!==null&&Lg(f,y[1])?y[0]:(c=c(),p.memoizedState=[c,f],c)}function ik(c,f,p){return(wl&21)===0?(c.baseState&&(c.baseState=!1,bi=!0),c.memoizedState=p):(ks(p,f)||(p=Xu(),Tr.lanes|=p,bl|=p,c.baseState=!0),f)}function p4(c,f){var p=Zt;Zt=p!==0&&4>p?p:4,c(!0);var y=Pg.transition;Pg.transition={};try{c(!1),f()}finally{Zt=p,Pg.transition=y}}function sk(){return Qi().memoizedState}function m4(c,f,p){var y=xo(c);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},ak(c))ok(f,p);else if(p=Lb(c,f,p,y),p!==null){var k=ii();Ts(p,c,y,k),lk(p,f,y)}}function g4(c,f,p){var y=xo(c),k={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(ak(c))ok(f,k);else{var C=c.alternate;if(c.lanes===0&&(C===null||C.lanes===0)&&(C=f.lastRenderedReducer,C!==null))try{var R=f.lastRenderedState,Q=C(R,p);if(k.hasEagerState=!0,k.eagerState=Q,ks(Q,R)){var ne=f.interleaved;ne===null?(k.next=k,Mg(f)):(k.next=ne.next,ne.next=k),f.interleaved=k;return}}catch{}finally{}p=Lb(c,f,k,y),p!==null&&(k=ii(),Ts(p,c,y,k),lk(p,f,y))}}function ak(c){var f=c.alternate;return c===Tr||f!==null&&f===Tr}function ok(c,f){yf=Wh=!0;var p=c.pending;p===null?f.next=f:(f.next=p.next,p.next=f),c.pending=f}function lk(c,f,p){if((p&4194240)!==0){var y=f.lanes;y&=c.pendingLanes,p|=y,f.lanes=p,Ju(c,p)}}var Yh={readContext:Ji,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},x4={readContext:Ji,useCallback:function(c,f){return Zs().memoizedState=[c,f===void 0?null:f],c},useContext:Ji,useEffect:Zb,useImperativeHandle:function(c,f,p){return p=p!=null?p.concat([c]):null,Gh(4194308,4,ek.bind(null,f,c),p)},useLayoutEffect:function(c,f){return Gh(4194308,4,c,f)},useInsertionEffect:function(c,f){return Gh(4,2,c,f)},useMemo:function(c,f){var p=Zs();return f=f===void 0?null:f,c=c(),p.memoizedState=[c,f],c},useReducer:function(c,f,p){var y=Zs();return f=p!==void 0?p(f):f,y.memoizedState=y.baseState=f,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:f},y.queue=c,c=c.dispatch=m4.bind(null,Tr,c),[y.memoizedState,c]},useRef:function(c){var f=Zs();return c={current:c},f.memoizedState=c},useState:Kb,useDebugValue:Ug,useDeferredValue:function(c){return Zs().memoizedState=c},useTransition:function(){var c=Kb(!1),f=c[0];return c=p4.bind(null,c[1]),Zs().memoizedState=c,[f,c]},useMutableSource:function(){},useSyncExternalStore:function(c,f,p){var y=Tr,k=Zs();if(_r){if(p===void 0)throw Error(r(407));p=p()}else{if(p=f(),pn===null)throw Error(r(349));(wl&30)!==0||Hb(y,f,p)}k.memoizedState=p;var C={value:p,getSnapshot:f};return k.queue=C,Zb(Gb.bind(null,y,C,c),[c]),y.flags|=2048,kf(9,Wb.bind(null,y,C,p,f),void 0,null),p},useId:function(){var c=Zs(),f=pn.identifierPrefix;if(_r){var p=Ta,y=Ea;p=(y&~(1<<32-vr(y)-1)).toString(32)+p,f=":"+f+"R"+p,p=wf++,0<p&&(f+="H"+p.toString(32)),f+=":"}else p=h4++,f=":"+f+"r"+p.toString(32)+":";return c.memoizedState=f},unstable_isNewReconciler:!1},v4={readContext:Ji,useCallback:rk,useContext:Ji,useEffect:$g,useImperativeHandle:tk,useInsertionEffect:Jb,useLayoutEffect:Qb,useMemo:nk,useReducer:zg,useRef:Xb,useState:function(){return zg(bf)},useDebugValue:Ug,useDeferredValue:function(c){var f=Qi();return ik(f,rn.memoizedState,c)},useTransition:function(){var c=zg(bf)[0],f=Qi().memoizedState;return[c,f]},useMutableSource:$b,useSyncExternalStore:Ub,useId:sk,unstable_isNewReconciler:!1},y4={readContext:Ji,useCallback:rk,useContext:Ji,useEffect:$g,useImperativeHandle:tk,useInsertionEffect:Jb,useLayoutEffect:Qb,useMemo:nk,useReducer:Vg,useRef:Xb,useState:function(){return Vg(bf)},useDebugValue:Ug,useDeferredValue:function(c){var f=Qi();return rn===null?f.memoizedState=c:ik(f,rn.memoizedState,c)},useTransition:function(){var c=Vg(bf)[0],f=Qi().memoizedState;return[c,f]},useMutableSource:$b,useSyncExternalStore:Ub,useId:sk,unstable_isNewReconciler:!1};function _s(c,f){if(c&&c.defaultProps){f=ve({},f),c=c.defaultProps;for(var p in c)f[p]===void 0&&(f[p]=c[p]);return f}return f}function Hg(c,f,p,y){f=c.memoizedState,p=p(y,f),p=p==null?f:ve({},f,p),c.memoizedState=p,c.lanes===0&&(c.updateQueue.baseState=p)}var Kh={isMounted:function(c){return(c=c._reactInternals)?K(c)===c:!1},enqueueSetState:function(c,f,p){c=c._reactInternals;var y=ii(),k=xo(c),C=Na(y,k);C.payload=f,p!=null&&(C.callback=p),f=ho(c,C,k),f!==null&&(Ts(f,c,k,y),Vh(f,c,k))},enqueueReplaceState:function(c,f,p){c=c._reactInternals;var y=ii(),k=xo(c),C=Na(y,k);C.tag=1,C.payload=f,p!=null&&(C.callback=p),f=ho(c,C,k),f!==null&&(Ts(f,c,k,y),Vh(f,c,k))},enqueueForceUpdate:function(c,f){c=c._reactInternals;var p=ii(),y=xo(c),k=Na(p,y);k.tag=2,f!=null&&(k.callback=f),f=ho(c,k,y),f!==null&&(Ts(f,c,y,p),Vh(f,c,y))}};function ck(c,f,p,y,k,C,R){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(y,C,R):f.prototype&&f.prototype.isPureReactComponent?!lf(p,y)||!lf(k,C):!0}function uk(c,f,p){var y=!1,k=co,C=f.contextType;return typeof C=="object"&&C!==null?C=Ji(C):(k=wi(f)?ml:Bn.current,y=f.contextTypes,C=(y=y!=null)?Rc(c,k):co),f=new f(p,C),c.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Kh,c.stateNode=f,f._reactInternals=c,y&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=k,c.__reactInternalMemoizedMaskedChildContext=C),f}function fk(c,f,p,y){c=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(p,y),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(p,y),f.state!==c&&Kh.enqueueReplaceState(f,f.state,null)}function Wg(c,f,p,y){var k=c.stateNode;k.props=p,k.state=c.memoizedState,k.refs={},Dg(c);var C=f.contextType;typeof C=="object"&&C!==null?k.context=Ji(C):(C=wi(f)?ml:Bn.current,k.context=Rc(c,C)),k.state=c.memoizedState,C=f.getDerivedStateFromProps,typeof C=="function"&&(Hg(c,f,C,p),k.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(f=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),f!==k.state&&Kh.enqueueReplaceState(k,k.state,null),$h(c,p,k,y),k.state=c.memoizedState),typeof k.componentDidMount=="function"&&(c.flags|=4194308)}function Uc(c,f){try{var p="",y=f;do p+=q(y),y=y.return;while(y);var k=p}catch(C){k=`
Error generating stack: `+C.message+`
`+C.stack}return{value:c,source:f,stack:k,digest:null}}function Gg(c,f,p){return{value:c,source:null,stack:p??null,digest:f??null}}function qg(c,f){try{console.error(f.value)}catch(p){setTimeout(function(){throw p})}}var w4=typeof WeakMap=="function"?WeakMap:Map;function dk(c,f,p){p=Na(-1,p),p.tag=3,p.payload={element:null};var y=f.value;return p.callback=function(){r0||(r0=!0,lx=y),qg(c,f)},p}function hk(c,f,p){p=Na(-1,p),p.tag=3;var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var k=f.value;p.payload=function(){return y(k)},p.callback=function(){qg(c,f)}}var C=c.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(p.callback=function(){qg(c,f),typeof y!="function"&&(mo===null?mo=new Set([this]):mo.add(this));var R=f.stack;this.componentDidCatch(f.value,{componentStack:R!==null?R:""})}),p}function pk(c,f,p){var y=c.pingCache;if(y===null){y=c.pingCache=new w4;var k=new Set;y.set(f,k)}else k=y.get(f),k===void 0&&(k=new Set,y.set(f,k));k.has(p)||(k.add(p),c=I4.bind(null,c,f,p),f.then(c,c))}function mk(c){do{var f;if((f=c.tag===13)&&(f=c.memoizedState,f=f!==null?f.dehydrated!==null:!0),f)return c;c=c.return}while(c!==null);return null}function gk(c,f,p,y,k){return(c.mode&1)===0?(c===f?c.flags|=65536:(c.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(f=Na(-1,1),f.tag=2,ho(p,f,1))),p.lanes|=1),c):(c.flags|=65536,c.lanes=k,c)}var b4=M.ReactCurrentOwner,bi=!1;function ni(c,f,p,y){f.child=c===null?Pb(f,null,p,y):jc(f,c.child,p,y)}function xk(c,f,p,y,k){p=p.render;var C=f.ref;return Vc(f,k),y=Bg(c,f,p,y,C,k),p=jg(),c!==null&&!bi?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~k,Ma(c,f,k)):(_r&&p&&bg(f),f.flags|=1,ni(c,f,y,k),f.child)}function vk(c,f,p,y,k){if(c===null){var C=p.type;return typeof C=="function"&&!mx(C)&&C.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(f.tag=15,f.type=C,yk(c,f,C,y,k)):(c=l0(p.type,null,y,f,f.mode,k),c.ref=f.ref,c.return=f,f.child=c)}if(C=c.child,(c.lanes&k)===0){var R=C.memoizedProps;if(p=p.compare,p=p!==null?p:lf,p(R,y)&&c.ref===f.ref)return Ma(c,f,k)}return f.flags|=1,c=yo(C,y),c.ref=f.ref,c.return=f,f.child=c}function yk(c,f,p,y,k){if(c!==null){var C=c.memoizedProps;if(lf(C,y)&&c.ref===f.ref)if(bi=!1,f.pendingProps=y=C,(c.lanes&k)!==0)(c.flags&131072)!==0&&(bi=!0);else return f.lanes=c.lanes,Ma(c,f,k)}return Yg(c,f,p,y,k)}function wk(c,f,p){var y=f.pendingProps,k=y.children,C=c!==null?c.memoizedState:null;if(y.mode==="hidden")if((f.mode&1)===0)f.memoizedState={baseLanes:0,cachePool:null,transitions:null},pr(Wc,Bi),Bi|=p;else{if((p&1073741824)===0)return c=C!==null?C.baseLanes|p:p,f.lanes=f.childLanes=1073741824,f.memoizedState={baseLanes:c,cachePool:null,transitions:null},f.updateQueue=null,pr(Wc,Bi),Bi|=c,null;f.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=C!==null?C.baseLanes:p,pr(Wc,Bi),Bi|=y}else C!==null?(y=C.baseLanes|p,f.memoizedState=null):y=p,pr(Wc,Bi),Bi|=y;return ni(c,f,k,p),f.child}function bk(c,f){var p=f.ref;(c===null&&p!==null||c!==null&&c.ref!==p)&&(f.flags|=512,f.flags|=2097152)}function Yg(c,f,p,y,k){var C=wi(p)?ml:Bn.current;return C=Rc(f,C),Vc(f,k),p=Bg(c,f,p,y,C,k),y=jg(),c!==null&&!bi?(f.updateQueue=c.updateQueue,f.flags&=-2053,c.lanes&=~k,Ma(c,f,k)):(_r&&y&&bg(f),f.flags|=1,ni(c,f,p,k),f.child)}function kk(c,f,p,y,k){if(wi(p)){var C=!0;Fh(f)}else C=!1;if(Vc(f,k),f.stateNode===null)Zh(c,f),uk(f,p,y),Wg(f,p,y,k),y=!0;else if(c===null){var R=f.stateNode,Q=f.memoizedProps;R.props=Q;var ne=R.context,_e=p.contextType;typeof _e=="object"&&_e!==null?_e=Ji(_e):(_e=wi(p)?ml:Bn.current,_e=Rc(f,_e));var Fe=p.getDerivedStateFromProps,je=typeof Fe=="function"||typeof R.getSnapshotBeforeUpdate=="function";je||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Q!==y||ne!==_e)&&fk(f,R,y,_e),fo=!1;var Oe=f.memoizedState;R.state=Oe,$h(f,y,R,k),ne=f.memoizedState,Q!==y||Oe!==ne||yi.current||fo?(typeof Fe=="function"&&(Hg(f,p,Fe,y),ne=f.memoizedState),(Q=fo||ck(f,p,Q,y,Oe,ne,_e))?(je||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(f.flags|=4194308)):(typeof R.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=y,f.memoizedState=ne),R.props=y,R.state=ne,R.context=_e,y=Q):(typeof R.componentDidMount=="function"&&(f.flags|=4194308),y=!1)}else{R=f.stateNode,Bb(c,f),Q=f.memoizedProps,_e=f.type===f.elementType?Q:_s(f.type,Q),R.props=_e,je=f.pendingProps,Oe=R.context,ne=p.contextType,typeof ne=="object"&&ne!==null?ne=Ji(ne):(ne=wi(p)?ml:Bn.current,ne=Rc(f,ne));var Ze=p.getDerivedStateFromProps;(Fe=typeof Ze=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Q!==je||Oe!==ne)&&fk(f,R,y,ne),fo=!1,Oe=f.memoizedState,R.state=Oe,$h(f,y,R,k);var lt=f.memoizedState;Q!==je||Oe!==lt||yi.current||fo?(typeof Ze=="function"&&(Hg(f,p,Ze,y),lt=f.memoizedState),(_e=fo||ck(f,p,_e,y,Oe,lt,ne)||!1)?(Fe||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(y,lt,ne),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(y,lt,ne)),typeof R.componentDidUpdate=="function"&&(f.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof R.componentDidUpdate!="function"||Q===c.memoizedProps&&Oe===c.memoizedState||(f.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Q===c.memoizedProps&&Oe===c.memoizedState||(f.flags|=1024),f.memoizedProps=y,f.memoizedState=lt),R.props=y,R.state=lt,R.context=ne,y=_e):(typeof R.componentDidUpdate!="function"||Q===c.memoizedProps&&Oe===c.memoizedState||(f.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Q===c.memoizedProps&&Oe===c.memoizedState||(f.flags|=1024),y=!1)}return Kg(c,f,p,y,C,k)}function Kg(c,f,p,y,k,C){bk(c,f);var R=(f.flags&128)!==0;if(!y&&!R)return k&&Tb(f,p,!1),Ma(c,f,C);y=f.stateNode,b4.current=f;var Q=R&&typeof p.getDerivedStateFromError!="function"?null:y.render();return f.flags|=1,c!==null&&R?(f.child=jc(f,c.child,null,C),f.child=jc(f,null,Q,C)):ni(c,f,Q,C),f.memoizedState=y.state,k&&Tb(f,p,!0),f.child}function Sk(c){var f=c.stateNode;f.pendingContext?Cb(c,f.pendingContext,f.pendingContext!==f.context):f.context&&Cb(c,f.context,!1),Og(c,f.containerInfo)}function _k(c,f,p,y,k){return Bc(),Cg(k),f.flags|=256,ni(c,f,p,y),f.child}var Xg={dehydrated:null,treeContext:null,retryLane:0};function Zg(c){return{baseLanes:c,cachePool:null,transitions:null}}function Ck(c,f,p){var y=f.pendingProps,k=Er.current,C=!1,R=(f.flags&128)!==0,Q;if((Q=R)||(Q=c!==null&&c.memoizedState===null?!1:(k&2)!==0),Q?(C=!0,f.flags&=-129):(c===null||c.memoizedState!==null)&&(k|=1),pr(Er,k&1),c===null)return _g(f),c=f.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((f.mode&1)===0?f.lanes=1:c.data==="$!"?f.lanes=8:f.lanes=1073741824,null):(R=y.children,c=y.fallback,C?(y=f.mode,C=f.child,R={mode:"hidden",children:R},(y&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=R):C=c0(R,y,0,null),c=Cl(c,y,p,null),C.return=f,c.return=f,C.sibling=c,f.child=C,f.child.memoizedState=Zg(p),f.memoizedState=Xg,c):Jg(f,R));if(k=c.memoizedState,k!==null&&(Q=k.dehydrated,Q!==null))return k4(c,f,R,y,Q,k,p);if(C){C=y.fallback,R=f.mode,k=c.child,Q=k.sibling;var ne={mode:"hidden",children:y.children};return(R&1)===0&&f.child!==k?(y=f.child,y.childLanes=0,y.pendingProps=ne,f.deletions=null):(y=yo(k,ne),y.subtreeFlags=k.subtreeFlags&14680064),Q!==null?C=yo(Q,C):(C=Cl(C,R,p,null),C.flags|=2),C.return=f,y.return=f,y.sibling=C,f.child=y,y=C,C=f.child,R=c.child.memoizedState,R=R===null?Zg(p):{baseLanes:R.baseLanes|p,cachePool:null,transitions:R.transitions},C.memoizedState=R,C.childLanes=c.childLanes&~p,f.memoizedState=Xg,y}return C=c.child,c=C.sibling,y=yo(C,{mode:"visible",children:y.children}),(f.mode&1)===0&&(y.lanes=p),y.return=f,y.sibling=null,c!==null&&(p=f.deletions,p===null?(f.deletions=[c],f.flags|=16):p.push(c)),f.child=y,f.memoizedState=null,y}function Jg(c,f){return f=c0({mode:"visible",children:f},c.mode,0,null),f.return=c,c.child=f}function Xh(c,f,p,y){return y!==null&&Cg(y),jc(f,c.child,null,p),c=Jg(f,f.pendingProps.children),c.flags|=2,f.memoizedState=null,c}function k4(c,f,p,y,k,C,R){if(p)return f.flags&256?(f.flags&=-257,y=Gg(Error(r(422))),Xh(c,f,R,y)):f.memoizedState!==null?(f.child=c.child,f.flags|=128,null):(C=y.fallback,k=f.mode,y=c0({mode:"visible",children:y.children},k,0,null),C=Cl(C,k,R,null),C.flags|=2,y.return=f,C.return=f,y.sibling=C,f.child=y,(f.mode&1)!==0&&jc(f,c.child,null,R),f.child.memoizedState=Zg(R),f.memoizedState=Xg,C);if((f.mode&1)===0)return Xh(c,f,R,null);if(k.data==="$!"){if(y=k.nextSibling&&k.nextSibling.dataset,y)var Q=y.dgst;return y=Q,C=Error(r(419)),y=Gg(C,y,void 0),Xh(c,f,R,y)}if(Q=(R&c.childLanes)!==0,bi||Q){if(y=pn,y!==null){switch(R&-R){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(y.suspendedLanes|R))!==0?0:k,k!==0&&k!==C.retryLane&&(C.retryLane=k,Aa(c,k),Ts(y,c,k,-1))}return px(),y=Gg(Error(r(421))),Xh(c,f,R,y)}return k.data==="$?"?(f.flags|=128,f.child=c.child,f=R4.bind(null,c),k._reactRetry=f,null):(c=C.treeContext,Li=oo(k.nextSibling),Pi=f,_r=!0,Ss=null,c!==null&&(Xi[Zi++]=Ea,Xi[Zi++]=Ta,Xi[Zi++]=gl,Ea=c.id,Ta=c.overflow,gl=f),f=Jg(f,y.children),f.flags|=4096,f)}function Ek(c,f,p){c.lanes|=f;var y=c.alternate;y!==null&&(y.lanes|=f),Ng(c.return,f,p)}function Qg(c,f,p,y,k){var C=c.memoizedState;C===null?c.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:k}:(C.isBackwards=f,C.rendering=null,C.renderingStartTime=0,C.last=y,C.tail=p,C.tailMode=k)}function Tk(c,f,p){var y=f.pendingProps,k=y.revealOrder,C=y.tail;if(ni(c,f,y.children,p),y=Er.current,(y&2)!==0)y=y&1|2,f.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=f.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Ek(c,p,f);else if(c.tag===19)Ek(c,p,f);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===f)break e;for(;c.sibling===null;){if(c.return===null||c.return===f)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}y&=1}if(pr(Er,y),(f.mode&1)===0)f.memoizedState=null;else switch(k){case"forwards":for(p=f.child,k=null;p!==null;)c=p.alternate,c!==null&&Uh(c)===null&&(k=p),p=p.sibling;p=k,p===null?(k=f.child,f.child=null):(k=p.sibling,p.sibling=null),Qg(f,!1,k,p,C);break;case"backwards":for(p=null,k=f.child,f.child=null;k!==null;){if(c=k.alternate,c!==null&&Uh(c)===null){f.child=k;break}c=k.sibling,k.sibling=p,p=k,k=c}Qg(f,!0,p,null,C);break;case"together":Qg(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function Zh(c,f){(f.mode&1)===0&&c!==null&&(c.alternate=null,f.alternate=null,f.flags|=2)}function Ma(c,f,p){if(c!==null&&(f.dependencies=c.dependencies),bl|=f.lanes,(p&f.childLanes)===0)return null;if(c!==null&&f.child!==c.child)throw Error(r(153));if(f.child!==null){for(c=f.child,p=yo(c,c.pendingProps),f.child=p,p.return=f;c.sibling!==null;)c=c.sibling,p=p.sibling=yo(c,c.pendingProps),p.return=f;p.sibling=null}return f.child}function S4(c,f,p){switch(f.tag){case 3:Sk(f),Bc();break;case 5:Vb(f);break;case 1:wi(f.type)&&Fh(f);break;case 4:Og(f,f.stateNode.containerInfo);break;case 10:var y=f.type._context,k=f.memoizedProps.value;pr(jh,y._currentValue),y._currentValue=k;break;case 13:if(y=f.memoizedState,y!==null)return y.dehydrated!==null?(pr(Er,Er.current&1),f.flags|=128,null):(p&f.child.childLanes)!==0?Ck(c,f,p):(pr(Er,Er.current&1),c=Ma(c,f,p),c!==null?c.sibling:null);pr(Er,Er.current&1);break;case 19:if(y=(p&f.childLanes)!==0,(c.flags&128)!==0){if(y)return Tk(c,f,p);f.flags|=128}if(k=f.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),pr(Er,Er.current),y)break;return null;case 22:case 23:return f.lanes=0,wk(c,f,p)}return Ma(c,f,p)}var Ak,ex,Nk,Mk;Ak=function(c,f){for(var p=f.child;p!==null;){if(p.tag===5||p.tag===6)c.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},ex=function(){},Nk=function(c,f,p,y){var k=c.memoizedProps;if(k!==y){c=f.stateNode,yl(Xs.current);var C=null;switch(p){case"input":k=Ne(c,k),y=Ne(c,y),C=[];break;case"select":k=ve({},k,{value:void 0}),y=ve({},y,{value:void 0}),C=[];break;case"textarea":k=be(c,k),y=be(c,y),C=[];break;default:typeof k.onClick!="function"&&typeof y.onClick=="function"&&(c.onclick=Mh)}Pn(p,y);var R;p=null;for(_e in k)if(!y.hasOwnProperty(_e)&&k.hasOwnProperty(_e)&&k[_e]!=null)if(_e==="style"){var Q=k[_e];for(R in Q)Q.hasOwnProperty(R)&&(p||(p={}),p[R]="")}else _e!=="dangerouslySetInnerHTML"&&_e!=="children"&&_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(i.hasOwnProperty(_e)?C||(C=[]):(C=C||[]).push(_e,null));for(_e in y){var ne=y[_e];if(Q=k!=null?k[_e]:void 0,y.hasOwnProperty(_e)&&ne!==Q&&(ne!=null||Q!=null))if(_e==="style")if(Q){for(R in Q)!Q.hasOwnProperty(R)||ne&&ne.hasOwnProperty(R)||(p||(p={}),p[R]="");for(R in ne)ne.hasOwnProperty(R)&&Q[R]!==ne[R]&&(p||(p={}),p[R]=ne[R])}else p||(C||(C=[]),C.push(_e,p)),p=ne;else _e==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Q=Q?Q.__html:void 0,ne!=null&&Q!==ne&&(C=C||[]).push(_e,ne)):_e==="children"?typeof ne!="string"&&typeof ne!="number"||(C=C||[]).push(_e,""+ne):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&(i.hasOwnProperty(_e)?(ne!=null&&_e==="onScroll"&&yr("scroll",c),C||Q===ne||(C=[])):(C=C||[]).push(_e,ne))}p&&(C=C||[]).push("style",p);var _e=C;(f.updateQueue=_e)&&(f.flags|=4)}},Mk=function(c,f,p,y){p!==y&&(f.flags|=4)};function Sf(c,f){if(!_r)switch(c.tailMode){case"hidden":f=c.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c.tail=null:p.sibling=null;break;case"collapsed":p=c.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?f||c.tail===null?c.tail=null:c.tail.sibling=null:y.sibling=null}}function zn(c){var f=c.alternate!==null&&c.alternate.child===c.child,p=0,y=0;if(f)for(var k=c.child;k!==null;)p|=k.lanes|k.childLanes,y|=k.subtreeFlags&14680064,y|=k.flags&14680064,k.return=c,k=k.sibling;else for(k=c.child;k!==null;)p|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=c,k=k.sibling;return c.subtreeFlags|=y,c.childLanes=p,f}function _4(c,f,p){var y=f.pendingProps;switch(kg(f),f.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(f),null;case 1:return wi(f.type)&&Oh(),zn(f),null;case 3:return y=f.stateNode,$c(),wr(yi),wr(Bn),Rg(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(c===null||c.child===null)&&(Lh(f)?f.flags|=4:c===null||c.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Ss!==null&&(fx(Ss),Ss=null))),ex(c,f),zn(f),null;case 5:Fg(f);var k=yl(vf.current);if(p=f.type,c!==null&&f.stateNode!=null)Nk(c,f,p,y,k),c.ref!==f.ref&&(f.flags|=512,f.flags|=2097152);else{if(!y){if(f.stateNode===null)throw Error(r(166));return zn(f),null}if(c=yl(Xs.current),Lh(f)){y=f.stateNode,p=f.type;var C=f.memoizedProps;switch(y[Ks]=f,y[hf]=C,c=(f.mode&1)!==0,p){case"dialog":yr("cancel",y),yr("close",y);break;case"iframe":case"object":case"embed":yr("load",y);break;case"video":case"audio":for(k=0;k<uf.length;k++)yr(uf[k],y);break;case"source":yr("error",y);break;case"img":case"image":case"link":yr("error",y),yr("load",y);break;case"details":yr("toggle",y);break;case"input":qe(y,C),yr("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!C.multiple},yr("invalid",y);break;case"textarea":Ve(y,C),yr("invalid",y)}Pn(p,C),k=null;for(var R in C)if(C.hasOwnProperty(R)){var Q=C[R];R==="children"?typeof Q=="string"?y.textContent!==Q&&(C.suppressHydrationWarning!==!0&&Nh(y.textContent,Q,c),k=["children",Q]):typeof Q=="number"&&y.textContent!==""+Q&&(C.suppressHydrationWarning!==!0&&Nh(y.textContent,Q,c),k=["children",""+Q]):i.hasOwnProperty(R)&&Q!=null&&R==="onScroll"&&yr("scroll",y)}switch(p){case"input":ze(y),at(y,C,!0);break;case"textarea":ze(y),Ae(y);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(y.onclick=Mh)}y=k,f.updateQueue=y,y!==null&&(f.flags|=4)}else{R=k.nodeType===9?k:k.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=$e(p)),c==="http://www.w3.org/1999/xhtml"?p==="script"?(c=R.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof y.is=="string"?c=R.createElement(p,{is:y.is}):(c=R.createElement(p),p==="select"&&(R=c,y.multiple?R.multiple=!0:y.size&&(R.size=y.size))):c=R.createElementNS(c,p),c[Ks]=f,c[hf]=y,Ak(c,f,!1,!1),f.stateNode=c;e:{switch(R=xi(p,y),p){case"dialog":yr("cancel",c),yr("close",c),k=y;break;case"iframe":case"object":case"embed":yr("load",c),k=y;break;case"video":case"audio":for(k=0;k<uf.length;k++)yr(uf[k],c);k=y;break;case"source":yr("error",c),k=y;break;case"img":case"image":case"link":yr("error",c),yr("load",c),k=y;break;case"details":yr("toggle",c),k=y;break;case"input":qe(c,y),k=Ne(c,y),yr("invalid",c);break;case"option":k=y;break;case"select":c._wrapperState={wasMultiple:!!y.multiple},k=ve({},y,{value:void 0}),yr("invalid",c);break;case"textarea":Ve(c,y),k=be(c,y),yr("invalid",c);break;default:k=y}Pn(p,k),Q=k;for(C in Q)if(Q.hasOwnProperty(C)){var ne=Q[C];C==="style"?Mr(c,ne):C==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&Nt(c,ne)):C==="children"?typeof ne=="string"?(p!=="textarea"||ne!=="")&&rt(c,ne):typeof ne=="number"&&rt(c,""+ne):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(i.hasOwnProperty(C)?ne!=null&&C==="onScroll"&&yr("scroll",c):ne!=null&&_(c,C,ne,R))}switch(p){case"input":ze(c),at(c,y,!1);break;case"textarea":ze(c),Ae(c);break;case"option":y.value!=null&&c.setAttribute("value",""+pe(y.value));break;case"select":c.multiple=!!y.multiple,C=y.value,C!=null?le(c,!!y.multiple,C,!1):y.defaultValue!=null&&le(c,!!y.multiple,y.defaultValue,!0);break;default:typeof k.onClick=="function"&&(c.onclick=Mh)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(f.flags|=4)}f.ref!==null&&(f.flags|=512,f.flags|=2097152)}return zn(f),null;case 6:if(c&&f.stateNode!=null)Mk(c,f,c.memoizedProps,y);else{if(typeof y!="string"&&f.stateNode===null)throw Error(r(166));if(p=yl(vf.current),yl(Xs.current),Lh(f)){if(y=f.stateNode,p=f.memoizedProps,y[Ks]=f,(C=y.nodeValue!==p)&&(c=Pi,c!==null))switch(c.tag){case 3:Nh(y.nodeValue,p,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Nh(y.nodeValue,p,(c.mode&1)!==0)}C&&(f.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[Ks]=f,f.stateNode=y}return zn(f),null;case 13:if(wr(Er),y=f.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(_r&&Li!==null&&(f.mode&1)!==0&&(f.flags&128)===0)Fb(),Bc(),f.flags|=98560,C=!1;else if(C=Lh(f),y!==null&&y.dehydrated!==null){if(c===null){if(!C)throw Error(r(318));if(C=f.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));C[Ks]=f}else Bc(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;zn(f),C=!1}else Ss!==null&&(fx(Ss),Ss=null),C=!0;if(!C)return f.flags&65536?f:null}return(f.flags&128)!==0?(f.lanes=p,f):(y=y!==null,y!==(c!==null&&c.memoizedState!==null)&&y&&(f.child.flags|=8192,(f.mode&1)!==0&&(c===null||(Er.current&1)!==0?nn===0&&(nn=3):px())),f.updateQueue!==null&&(f.flags|=4),zn(f),null);case 4:return $c(),ex(c,f),c===null&&ff(f.stateNode.containerInfo),zn(f),null;case 10:return Ag(f.type._context),zn(f),null;case 17:return wi(f.type)&&Oh(),zn(f),null;case 19:if(wr(Er),C=f.memoizedState,C===null)return zn(f),null;if(y=(f.flags&128)!==0,R=C.rendering,R===null)if(y)Sf(C,!1);else{if(nn!==0||c!==null&&(c.flags&128)!==0)for(c=f.child;c!==null;){if(R=Uh(c),R!==null){for(f.flags|=128,Sf(C,!1),y=R.updateQueue,y!==null&&(f.updateQueue=y,f.flags|=4),f.subtreeFlags=0,y=p,p=f.child;p!==null;)C=p,c=y,C.flags&=14680066,R=C.alternate,R===null?(C.childLanes=0,C.lanes=c,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=R.childLanes,C.lanes=R.lanes,C.child=R.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=R.memoizedProps,C.memoizedState=R.memoizedState,C.updateQueue=R.updateQueue,C.type=R.type,c=R.dependencies,C.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),p=p.sibling;return pr(Er,Er.current&1|2),f.child}c=c.sibling}C.tail!==null&&Pe()>Gc&&(f.flags|=128,y=!0,Sf(C,!1),f.lanes=4194304)}else{if(!y)if(c=Uh(R),c!==null){if(f.flags|=128,y=!0,p=c.updateQueue,p!==null&&(f.updateQueue=p,f.flags|=4),Sf(C,!0),C.tail===null&&C.tailMode==="hidden"&&!R.alternate&&!_r)return zn(f),null}else 2*Pe()-C.renderingStartTime>Gc&&p!==1073741824&&(f.flags|=128,y=!0,Sf(C,!1),f.lanes=4194304);C.isBackwards?(R.sibling=f.child,f.child=R):(p=C.last,p!==null?p.sibling=R:f.child=R,C.last=R)}return C.tail!==null?(f=C.tail,C.rendering=f,C.tail=f.sibling,C.renderingStartTime=Pe(),f.sibling=null,p=Er.current,pr(Er,y?p&1|2:p&1),f):(zn(f),null);case 22:case 23:return hx(),y=f.memoizedState!==null,c!==null&&c.memoizedState!==null!==y&&(f.flags|=8192),y&&(f.mode&1)!==0?(Bi&1073741824)!==0&&(zn(f),f.subtreeFlags&6&&(f.flags|=8192)):zn(f),null;case 24:return null;case 25:return null}throw Error(r(156,f.tag))}function C4(c,f){switch(kg(f),f.tag){case 1:return wi(f.type)&&Oh(),c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 3:return $c(),wr(yi),wr(Bn),Rg(),c=f.flags,(c&65536)!==0&&(c&128)===0?(f.flags=c&-65537|128,f):null;case 5:return Fg(f),null;case 13:if(wr(Er),c=f.memoizedState,c!==null&&c.dehydrated!==null){if(f.alternate===null)throw Error(r(340));Bc()}return c=f.flags,c&65536?(f.flags=c&-65537|128,f):null;case 19:return wr(Er),null;case 4:return $c(),null;case 10:return Ag(f.type._context),null;case 22:case 23:return hx(),null;case 24:return null;default:return null}}var Jh=!1,Vn=!1,E4=typeof WeakSet=="function"?WeakSet:Set,it=null;function Hc(c,f){var p=c.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){Or(c,f,y)}else p.current=null}function tx(c,f,p){try{p()}catch(y){Or(c,f,y)}}var Dk=!1;function T4(c,f){if(hg=fr,c=cb(),sg(c)){if("selectionStart"in c)var p={start:c.selectionStart,end:c.selectionEnd};else e:{p=(p=c.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var k=y.anchorOffset,C=y.focusNode;y=y.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var R=0,Q=-1,ne=-1,_e=0,Fe=0,je=c,Oe=null;t:for(;;){for(var Ze;je!==p||k!==0&&je.nodeType!==3||(Q=R+k),je!==C||y!==0&&je.nodeType!==3||(ne=R+y),je.nodeType===3&&(R+=je.nodeValue.length),(Ze=je.firstChild)!==null;)Oe=je,je=Ze;for(;;){if(je===c)break t;if(Oe===p&&++_e===k&&(Q=R),Oe===C&&++Fe===y&&(ne=R),(Ze=je.nextSibling)!==null)break;je=Oe,Oe=je.parentNode}je=Ze}p=Q===-1||ne===-1?null:{start:Q,end:ne}}else p=null}p=p||{start:0,end:0}}else p=null;for(pg={focusedElem:c,selectionRange:p},fr=!1,it=f;it!==null;)if(f=it,c=f.child,(f.subtreeFlags&1028)!==0&&c!==null)c.return=f,it=c;else for(;it!==null;){f=it;try{var lt=f.alternate;if((f.flags&1024)!==0)switch(f.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ut=lt.memoizedProps,Lr=lt.memoizedState,he=f.stateNode,ie=he.getSnapshotBeforeUpdate(f.elementType===f.type?ut:_s(f.type,ut),Lr);he.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var we=f.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ue){Or(f,f.return,Ue)}if(c=f.sibling,c!==null){c.return=f.return,it=c;break}it=f.return}return lt=Dk,Dk=!1,lt}function _f(c,f,p){var y=f.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var k=y=y.next;do{if((k.tag&c)===c){var C=k.destroy;k.destroy=void 0,C!==void 0&&tx(f,p,C)}k=k.next}while(k!==y)}}function Qh(c,f){if(f=f.updateQueue,f=f!==null?f.lastEffect:null,f!==null){var p=f=f.next;do{if((p.tag&c)===c){var y=p.create;p.destroy=y()}p=p.next}while(p!==f)}}function rx(c){var f=c.ref;if(f!==null){var p=c.stateNode;switch(c.tag){case 5:c=p;break;default:c=p}typeof f=="function"?f(c):f.current=c}}function Ok(c){var f=c.alternate;f!==null&&(c.alternate=null,Ok(f)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(f=c.stateNode,f!==null&&(delete f[Ks],delete f[hf],delete f[vg],delete f[c4],delete f[u4])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Fk(c){return c.tag===5||c.tag===3||c.tag===4}function Ik(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Fk(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function nx(c,f,p){var y=c.tag;if(y===5||y===6)c=c.stateNode,f?p.nodeType===8?p.parentNode.insertBefore(c,f):p.insertBefore(c,f):(p.nodeType===8?(f=p.parentNode,f.insertBefore(c,p)):(f=p,f.appendChild(c)),p=p._reactRootContainer,p!=null||f.onclick!==null||(f.onclick=Mh));else if(y!==4&&(c=c.child,c!==null))for(nx(c,f,p),c=c.sibling;c!==null;)nx(c,f,p),c=c.sibling}function ix(c,f,p){var y=c.tag;if(y===5||y===6)c=c.stateNode,f?p.insertBefore(c,f):p.appendChild(c);else if(y!==4&&(c=c.child,c!==null))for(ix(c,f,p),c=c.sibling;c!==null;)ix(c,f,p),c=c.sibling}var Cn=null,Cs=!1;function po(c,f,p){for(p=p.child;p!==null;)Rk(c,f,p),p=p.sibling}function Rk(c,f,p){if(Hr&&typeof Hr.onCommitFiberUnmount=="function")try{Hr.onCommitFiberUnmount(Ki,p)}catch{}switch(p.tag){case 5:Vn||Hc(p,f);case 6:var y=Cn,k=Cs;Cn=null,po(c,f,p),Cn=y,Cs=k,Cn!==null&&(Cs?(c=Cn,p=p.stateNode,c.nodeType===8?c.parentNode.removeChild(p):c.removeChild(p)):Cn.removeChild(p.stateNode));break;case 18:Cn!==null&&(Cs?(c=Cn,p=p.stateNode,c.nodeType===8?xg(c.parentNode,p):c.nodeType===1&&xg(c,p),Rt(c)):xg(Cn,p.stateNode));break;case 4:y=Cn,k=Cs,Cn=p.stateNode.containerInfo,Cs=!0,po(c,f,p),Cn=y,Cs=k;break;case 0:case 11:case 14:case 15:if(!Vn&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){k=y=y.next;do{var C=k,R=C.destroy;C=C.tag,R!==void 0&&((C&2)!==0||(C&4)!==0)&&tx(p,f,R),k=k.next}while(k!==y)}po(c,f,p);break;case 1:if(!Vn&&(Hc(p,f),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(Q){Or(p,f,Q)}po(c,f,p);break;case 21:po(c,f,p);break;case 22:p.mode&1?(Vn=(y=Vn)||p.memoizedState!==null,po(c,f,p),Vn=y):po(c,f,p);break;default:po(c,f,p)}}function Pk(c){var f=c.updateQueue;if(f!==null){c.updateQueue=null;var p=c.stateNode;p===null&&(p=c.stateNode=new E4),f.forEach(function(y){var k=P4.bind(null,c,y);p.has(y)||(p.add(y),y.then(k,k))})}}function Es(c,f){var p=f.deletions;if(p!==null)for(var y=0;y<p.length;y++){var k=p[y];try{var C=c,R=f,Q=R;e:for(;Q!==null;){switch(Q.tag){case 5:Cn=Q.stateNode,Cs=!1;break e;case 3:Cn=Q.stateNode.containerInfo,Cs=!0;break e;case 4:Cn=Q.stateNode.containerInfo,Cs=!0;break e}Q=Q.return}if(Cn===null)throw Error(r(160));Rk(C,R,k),Cn=null,Cs=!1;var ne=k.alternate;ne!==null&&(ne.return=null),k.return=null}catch(_e){Or(k,f,_e)}}if(f.subtreeFlags&12854)for(f=f.child;f!==null;)Lk(f,c),f=f.sibling}function Lk(c,f){var p=c.alternate,y=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Es(f,c),Js(c),y&4){try{_f(3,c,c.return),Qh(3,c)}catch(ut){Or(c,c.return,ut)}try{_f(5,c,c.return)}catch(ut){Or(c,c.return,ut)}}break;case 1:Es(f,c),Js(c),y&512&&p!==null&&Hc(p,p.return);break;case 5:if(Es(f,c),Js(c),y&512&&p!==null&&Hc(p,p.return),c.flags&32){var k=c.stateNode;try{rt(k,"")}catch(ut){Or(c,c.return,ut)}}if(y&4&&(k=c.stateNode,k!=null)){var C=c.memoizedProps,R=p!==null?p.memoizedProps:C,Q=c.type,ne=c.updateQueue;if(c.updateQueue=null,ne!==null)try{Q==="input"&&C.type==="radio"&&C.name!=null&&Le(k,C),xi(Q,R);var _e=xi(Q,C);for(R=0;R<ne.length;R+=2){var Fe=ne[R],je=ne[R+1];Fe==="style"?Mr(k,je):Fe==="dangerouslySetInnerHTML"?Nt(k,je):Fe==="children"?rt(k,je):_(k,Fe,je,_e)}switch(Q){case"input":Te(k,C);break;case"textarea":Me(k,C);break;case"select":var Oe=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!C.multiple;var Ze=C.value;Ze!=null?le(k,!!C.multiple,Ze,!1):Oe!==!!C.multiple&&(C.defaultValue!=null?le(k,!!C.multiple,C.defaultValue,!0):le(k,!!C.multiple,C.multiple?[]:"",!1))}k[hf]=C}catch(ut){Or(c,c.return,ut)}}break;case 6:if(Es(f,c),Js(c),y&4){if(c.stateNode===null)throw Error(r(162));k=c.stateNode,C=c.memoizedProps;try{k.nodeValue=C}catch(ut){Or(c,c.return,ut)}}break;case 3:if(Es(f,c),Js(c),y&4&&p!==null&&p.memoizedState.isDehydrated)try{Rt(f.containerInfo)}catch(ut){Or(c,c.return,ut)}break;case 4:Es(f,c),Js(c);break;case 13:Es(f,c),Js(c),k=c.child,k.flags&8192&&(C=k.memoizedState!==null,k.stateNode.isHidden=C,!C||k.alternate!==null&&k.alternate.memoizedState!==null||(ox=Pe())),y&4&&Pk(c);break;case 22:if(Fe=p!==null&&p.memoizedState!==null,c.mode&1?(Vn=(_e=Vn)||Fe,Es(f,c),Vn=_e):Es(f,c),Js(c),y&8192){if(_e=c.memoizedState!==null,(c.stateNode.isHidden=_e)&&!Fe&&(c.mode&1)!==0)for(it=c,Fe=c.child;Fe!==null;){for(je=it=Fe;it!==null;){switch(Oe=it,Ze=Oe.child,Oe.tag){case 0:case 11:case 14:case 15:_f(4,Oe,Oe.return);break;case 1:Hc(Oe,Oe.return);var lt=Oe.stateNode;if(typeof lt.componentWillUnmount=="function"){y=Oe,p=Oe.return;try{f=y,lt.props=f.memoizedProps,lt.state=f.memoizedState,lt.componentWillUnmount()}catch(ut){Or(y,p,ut)}}break;case 5:Hc(Oe,Oe.return);break;case 22:if(Oe.memoizedState!==null){zk(je);continue}}Ze!==null?(Ze.return=Oe,it=Ze):zk(je)}Fe=Fe.sibling}e:for(Fe=null,je=c;;){if(je.tag===5){if(Fe===null){Fe=je;try{k=je.stateNode,_e?(C=k.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(Q=je.stateNode,ne=je.memoizedProps.style,R=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Q.style.display=$t("display",R))}catch(ut){Or(c,c.return,ut)}}}else if(je.tag===6){if(Fe===null)try{je.stateNode.nodeValue=_e?"":je.memoizedProps}catch(ut){Or(c,c.return,ut)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===c)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===c)break e;for(;je.sibling===null;){if(je.return===null||je.return===c)break e;Fe===je&&(Fe=null),je=je.return}Fe===je&&(Fe=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:Es(f,c),Js(c),y&4&&Pk(c);break;case 21:break;default:Es(f,c),Js(c)}}function Js(c){var f=c.flags;if(f&2){try{e:{for(var p=c.return;p!==null;){if(Fk(p)){var y=p;break e}p=p.return}throw Error(r(160))}switch(y.tag){case 5:var k=y.stateNode;y.flags&32&&(rt(k,""),y.flags&=-33);var C=Ik(c);ix(c,C,k);break;case 3:case 4:var R=y.stateNode.containerInfo,Q=Ik(c);nx(c,Q,R);break;default:throw Error(r(161))}}catch(ne){Or(c,c.return,ne)}c.flags&=-3}f&4096&&(c.flags&=-4097)}function A4(c,f,p){it=c,Bk(c)}function Bk(c,f,p){for(var y=(c.mode&1)!==0;it!==null;){var k=it,C=k.child;if(k.tag===22&&y){var R=k.memoizedState!==null||Jh;if(!R){var Q=k.alternate,ne=Q!==null&&Q.memoizedState!==null||Vn;Q=Jh;var _e=Vn;if(Jh=R,(Vn=ne)&&!_e)for(it=k;it!==null;)R=it,ne=R.child,R.tag===22&&R.memoizedState!==null?Vk(k):ne!==null?(ne.return=R,it=ne):Vk(k);for(;C!==null;)it=C,Bk(C),C=C.sibling;it=k,Jh=Q,Vn=_e}jk(c)}else(k.subtreeFlags&8772)!==0&&C!==null?(C.return=k,it=C):jk(c)}}function jk(c){for(;it!==null;){var f=it;if((f.flags&8772)!==0){var p=f.alternate;try{if((f.flags&8772)!==0)switch(f.tag){case 0:case 11:case 15:Vn||Qh(5,f);break;case 1:var y=f.stateNode;if(f.flags&4&&!Vn)if(p===null)y.componentDidMount();else{var k=f.elementType===f.type?p.memoizedProps:_s(f.type,p.memoizedProps);y.componentDidUpdate(k,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var C=f.updateQueue;C!==null&&zb(f,C,y);break;case 3:var R=f.updateQueue;if(R!==null){if(p=null,f.child!==null)switch(f.child.tag){case 5:p=f.child.stateNode;break;case 1:p=f.child.stateNode}zb(f,R,p)}break;case 5:var Q=f.stateNode;if(p===null&&f.flags&4){p=Q;var ne=f.memoizedProps;switch(f.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&p.focus();break;case"img":ne.src&&(p.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(f.memoizedState===null){var _e=f.alternate;if(_e!==null){var Fe=_e.memoizedState;if(Fe!==null){var je=Fe.dehydrated;je!==null&&Rt(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Vn||f.flags&512&&rx(f)}catch(Oe){Or(f,f.return,Oe)}}if(f===c){it=null;break}if(p=f.sibling,p!==null){p.return=f.return,it=p;break}it=f.return}}function zk(c){for(;it!==null;){var f=it;if(f===c){it=null;break}var p=f.sibling;if(p!==null){p.return=f.return,it=p;break}it=f.return}}function Vk(c){for(;it!==null;){var f=it;try{switch(f.tag){case 0:case 11:case 15:var p=f.return;try{Qh(4,f)}catch(ne){Or(f,p,ne)}break;case 1:var y=f.stateNode;if(typeof y.componentDidMount=="function"){var k=f.return;try{y.componentDidMount()}catch(ne){Or(f,k,ne)}}var C=f.return;try{rx(f)}catch(ne){Or(f,C,ne)}break;case 5:var R=f.return;try{rx(f)}catch(ne){Or(f,R,ne)}}}catch(ne){Or(f,f.return,ne)}if(f===c){it=null;break}var Q=f.sibling;if(Q!==null){Q.return=f.return,it=Q;break}it=f.return}}var N4=Math.ceil,e0=M.ReactCurrentDispatcher,sx=M.ReactCurrentOwner,es=M.ReactCurrentBatchConfig,Jt=0,pn=null,Wr=null,En=0,Bi=0,Wc=lo(0),nn=0,Cf=null,bl=0,t0=0,ax=0,Ef=null,ki=null,ox=0,Gc=1/0,Da=null,r0=!1,lx=null,mo=null,n0=!1,go=null,i0=0,Tf=0,cx=null,s0=-1,a0=0;function ii(){return(Jt&6)!==0?Pe():s0!==-1?s0:s0=Pe()}function xo(c){return(c.mode&1)===0?1:(Jt&2)!==0&&En!==0?En&-En:d4.transition!==null?(a0===0&&(a0=Xu()),a0):(c=Zt,c!==0||(c=window.event,c=c===void 0?16:Sr(c.type)),c)}function Ts(c,f,p,y){if(50<Tf)throw Tf=0,cx=null,Error(r(185));Sa(c,p,y),((Jt&2)===0||c!==pn)&&(c===pn&&((Jt&2)===0&&(t0|=p),nn===4&&vo(c,En)),Si(c,y),p===1&&Jt===0&&(f.mode&1)===0&&(Gc=Pe()+500,Ih&&uo()))}function Si(c,f){var p=c.callbackNode;Km(c,f);var y=_c(c,c===pn?En:0);if(y===0)p!==null&&Ge(p),c.callbackNode=null,c.callbackPriority=0;else if(f=y&-y,c.callbackPriority!==f){if(p!=null&&Ge(p),f===1)c.tag===0?f4(Uk.bind(null,c)):Ab(Uk.bind(null,c)),o4(function(){(Jt&6)===0&&uo()}),p=null;else{switch(mh(y)){case 1:p=or;break;case 4:p=Ut;break;case 16:p=xr;break;case 536870912:p=Us;break;default:p=xr}p=Zk(p,$k.bind(null,c))}c.callbackPriority=f,c.callbackNode=p}}function $k(c,f){if(s0=-1,a0=0,(Jt&6)!==0)throw Error(r(327));var p=c.callbackNode;if(qc()&&c.callbackNode!==p)return null;var y=_c(c,c===pn?En:0);if(y===0)return null;if((y&30)!==0||(y&c.expiredLanes)!==0||f)f=o0(c,y);else{f=y;var k=Jt;Jt|=2;var C=Wk();(pn!==c||En!==f)&&(Da=null,Gc=Pe()+500,Sl(c,f));do try{O4();break}catch(Q){Hk(c,Q)}while(!0);Tg(),e0.current=C,Jt=k,Wr!==null?f=0:(pn=null,En=0,f=nn)}if(f!==0){if(f===2&&(k=Ku(c),k!==0&&(y=k,f=ux(c,k))),f===1)throw p=Cf,Sl(c,0),vo(c,y),Si(c,Pe()),p;if(f===6)vo(c,y);else{if(k=c.current.alternate,(y&30)===0&&!M4(k)&&(f=o0(c,y),f===2&&(C=Ku(c),C!==0&&(y=C,f=ux(c,C))),f===1))throw p=Cf,Sl(c,0),vo(c,y),Si(c,Pe()),p;switch(c.finishedWork=k,c.finishedLanes=y,f){case 0:case 1:throw Error(r(345));case 2:_l(c,ki,Da);break;case 3:if(vo(c,y),(y&130023424)===y&&(f=ox+500-Pe(),10<f)){if(_c(c,0)!==0)break;if(k=c.suspendedLanes,(k&y)!==y){ii(),c.pingedLanes|=c.suspendedLanes&k;break}c.timeoutHandle=gg(_l.bind(null,c,ki,Da),f);break}_l(c,ki,Da);break;case 4:if(vo(c,y),(y&4194240)===y)break;for(f=c.eventTimes,k=-1;0<y;){var R=31-vr(y);C=1<<R,R=f[R],R>k&&(k=R),y&=~C}if(y=k,y=Pe()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*N4(y/1960))-y,10<y){c.timeoutHandle=gg(_l.bind(null,c,ki,Da),y);break}_l(c,ki,Da);break;case 5:_l(c,ki,Da);break;default:throw Error(r(329))}}}return Si(c,Pe()),c.callbackNode===p?$k.bind(null,c):null}function ux(c,f){var p=Ef;return c.current.memoizedState.isDehydrated&&(Sl(c,f).flags|=256),c=o0(c,f),c!==2&&(f=ki,ki=p,f!==null&&fx(f)),c}function fx(c){ki===null?ki=c:ki.push.apply(ki,c)}function M4(c){for(var f=c;;){if(f.flags&16384){var p=f.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var k=p[y],C=k.getSnapshot;k=k.value;try{if(!ks(C(),k))return!1}catch{return!1}}}if(p=f.child,f.subtreeFlags&16384&&p!==null)p.return=f,f=p;else{if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function vo(c,f){for(f&=~ax,f&=~t0,c.suspendedLanes|=f,c.pingedLanes&=~f,c=c.expirationTimes;0<f;){var p=31-vr(f),y=1<<p;c[p]=-1,f&=~y}}function Uk(c){if((Jt&6)!==0)throw Error(r(327));qc();var f=_c(c,0);if((f&1)===0)return Si(c,Pe()),null;var p=o0(c,f);if(c.tag!==0&&p===2){var y=Ku(c);y!==0&&(f=y,p=ux(c,y))}if(p===1)throw p=Cf,Sl(c,0),vo(c,f),Si(c,Pe()),p;if(p===6)throw Error(r(345));return c.finishedWork=c.current.alternate,c.finishedLanes=f,_l(c,ki,Da),Si(c,Pe()),null}function dx(c,f){var p=Jt;Jt|=1;try{return c(f)}finally{Jt=p,Jt===0&&(Gc=Pe()+500,Ih&&uo())}}function kl(c){go!==null&&go.tag===0&&(Jt&6)===0&&qc();var f=Jt;Jt|=1;var p=es.transition,y=Zt;try{if(es.transition=null,Zt=1,c)return c()}finally{Zt=y,es.transition=p,Jt=f,(Jt&6)===0&&uo()}}function hx(){Bi=Wc.current,wr(Wc)}function Sl(c,f){c.finishedWork=null,c.finishedLanes=0;var p=c.timeoutHandle;if(p!==-1&&(c.timeoutHandle=-1,a4(p)),Wr!==null)for(p=Wr.return;p!==null;){var y=p;switch(kg(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Oh();break;case 3:$c(),wr(yi),wr(Bn),Rg();break;case 5:Fg(y);break;case 4:$c();break;case 13:wr(Er);break;case 19:wr(Er);break;case 10:Ag(y.type._context);break;case 22:case 23:hx()}p=p.return}if(pn=c,Wr=c=yo(c.current,null),En=Bi=f,nn=0,Cf=null,ax=t0=bl=0,ki=Ef=null,vl!==null){for(f=0;f<vl.length;f++)if(p=vl[f],y=p.interleaved,y!==null){p.interleaved=null;var k=y.next,C=p.pending;if(C!==null){var R=C.next;C.next=k,y.next=R}p.pending=y}vl=null}return c}function Hk(c,f){do{var p=Wr;try{if(Tg(),Hh.current=Yh,Wh){for(var y=Tr.memoizedState;y!==null;){var k=y.queue;k!==null&&(k.pending=null),y=y.next}Wh=!1}if(wl=0,hn=rn=Tr=null,yf=!1,wf=0,sx.current=null,p===null||p.return===null){nn=1,Cf=f,Wr=null;break}e:{var C=c,R=p.return,Q=p,ne=f;if(f=En,Q.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var _e=ne,Fe=Q,je=Fe.tag;if((Fe.mode&1)===0&&(je===0||je===11||je===15)){var Oe=Fe.alternate;Oe?(Fe.updateQueue=Oe.updateQueue,Fe.memoizedState=Oe.memoizedState,Fe.lanes=Oe.lanes):(Fe.updateQueue=null,Fe.memoizedState=null)}var Ze=mk(R);if(Ze!==null){Ze.flags&=-257,gk(Ze,R,Q,C,f),Ze.mode&1&&pk(C,_e,f),f=Ze,ne=_e;var lt=f.updateQueue;if(lt===null){var ut=new Set;ut.add(ne),f.updateQueue=ut}else lt.add(ne);break e}else{if((f&1)===0){pk(C,_e,f),px();break e}ne=Error(r(426))}}else if(_r&&Q.mode&1){var Lr=mk(R);if(Lr!==null){(Lr.flags&65536)===0&&(Lr.flags|=256),gk(Lr,R,Q,C,f),Cg(Uc(ne,Q));break e}}C=ne=Uc(ne,Q),nn!==4&&(nn=2),Ef===null?Ef=[C]:Ef.push(C),C=R;do{switch(C.tag){case 3:C.flags|=65536,f&=-f,C.lanes|=f;var he=dk(C,ne,f);jb(C,he);break e;case 1:Q=ne;var ie=C.type,we=C.stateNode;if((C.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(mo===null||!mo.has(we)))){C.flags|=65536,f&=-f,C.lanes|=f;var Ue=hk(C,Q,f);jb(C,Ue);break e}}C=C.return}while(C!==null)}qk(p)}catch(dt){f=dt,Wr===p&&p!==null&&(Wr=p=p.return);continue}break}while(!0)}function Wk(){var c=e0.current;return e0.current=Yh,c===null?Yh:c}function px(){(nn===0||nn===3||nn===2)&&(nn=4),pn===null||(bl&268435455)===0&&(t0&268435455)===0||vo(pn,En)}function o0(c,f){var p=Jt;Jt|=2;var y=Wk();(pn!==c||En!==f)&&(Da=null,Sl(c,f));do try{D4();break}catch(k){Hk(c,k)}while(!0);if(Tg(),Jt=p,e0.current=y,Wr!==null)throw Error(r(261));return pn=null,En=0,nn}function D4(){for(;Wr!==null;)Gk(Wr)}function O4(){for(;Wr!==null&&!Ye();)Gk(Wr)}function Gk(c){var f=Xk(c.alternate,c,Bi);c.memoizedProps=c.pendingProps,f===null?qk(c):Wr=f,sx.current=null}function qk(c){var f=c;do{var p=f.alternate;if(c=f.return,(f.flags&32768)===0){if(p=_4(p,f,Bi),p!==null){Wr=p;return}}else{if(p=C4(p,f),p!==null){p.flags&=32767,Wr=p;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{nn=6,Wr=null;return}}if(f=f.sibling,f!==null){Wr=f;return}Wr=f=c}while(f!==null);nn===0&&(nn=5)}function _l(c,f,p){var y=Zt,k=es.transition;try{es.transition=null,Zt=1,F4(c,f,p,y)}finally{es.transition=k,Zt=y}return null}function F4(c,f,p,y){do qc();while(go!==null);if((Jt&6)!==0)throw Error(r(327));p=c.finishedWork;var k=c.finishedLanes;if(p===null)return null;if(c.finishedWork=null,c.finishedLanes=0,p===c.current)throw Error(r(177));c.callbackNode=null,c.callbackPriority=0;var C=p.lanes|p.childLanes;if(Xm(c,C),c===pn&&(Wr=pn=null,En=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||n0||(n0=!0,Zk(xr,function(){return qc(),null})),C=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||C){C=es.transition,es.transition=null;var R=Zt;Zt=1;var Q=Jt;Jt|=4,sx.current=null,T4(c,p),Lk(p,c),QF(pg),fr=!!hg,pg=hg=null,c.current=p,A4(p),Be(),Jt=Q,Zt=R,es.transition=C}else c.current=p;if(n0&&(n0=!1,go=c,i0=k),C=c.pendingLanes,C===0&&(mo=null),fl(p.stateNode),Si(c,Pe()),f!==null)for(y=c.onRecoverableError,p=0;p<f.length;p++)k=f[p],y(k.value,{componentStack:k.stack,digest:k.digest});if(r0)throw r0=!1,c=lx,lx=null,c;return(i0&1)!==0&&c.tag!==0&&qc(),C=c.pendingLanes,(C&1)!==0?c===cx?Tf++:(Tf=0,cx=c):Tf=0,uo(),null}function qc(){if(go!==null){var c=mh(i0),f=es.transition,p=Zt;try{if(es.transition=null,Zt=16>c?16:c,go===null)var y=!1;else{if(c=go,go=null,i0=0,(Jt&6)!==0)throw Error(r(331));var k=Jt;for(Jt|=4,it=c.current;it!==null;){var C=it,R=C.child;if((it.flags&16)!==0){var Q=C.deletions;if(Q!==null){for(var ne=0;ne<Q.length;ne++){var _e=Q[ne];for(it=_e;it!==null;){var Fe=it;switch(Fe.tag){case 0:case 11:case 15:_f(8,Fe,C)}var je=Fe.child;if(je!==null)je.return=Fe,it=je;else for(;it!==null;){Fe=it;var Oe=Fe.sibling,Ze=Fe.return;if(Ok(Fe),Fe===_e){it=null;break}if(Oe!==null){Oe.return=Ze,it=Oe;break}it=Ze}}}var lt=C.alternate;if(lt!==null){var ut=lt.child;if(ut!==null){lt.child=null;do{var Lr=ut.sibling;ut.sibling=null,ut=Lr}while(ut!==null)}}it=C}}if((C.subtreeFlags&2064)!==0&&R!==null)R.return=C,it=R;else e:for(;it!==null;){if(C=it,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:_f(9,C,C.return)}var he=C.sibling;if(he!==null){he.return=C.return,it=he;break e}it=C.return}}var ie=c.current;for(it=ie;it!==null;){R=it;var we=R.child;if((R.subtreeFlags&2064)!==0&&we!==null)we.return=R,it=we;else e:for(R=ie;it!==null;){if(Q=it,(Q.flags&2048)!==0)try{switch(Q.tag){case 0:case 11:case 15:Qh(9,Q)}}catch(dt){Or(Q,Q.return,dt)}if(Q===R){it=null;break e}var Ue=Q.sibling;if(Ue!==null){Ue.return=Q.return,it=Ue;break e}it=Q.return}}if(Jt=k,uo(),Hr&&typeof Hr.onPostCommitFiberRoot=="function")try{Hr.onPostCommitFiberRoot(Ki,c)}catch{}y=!0}return y}finally{Zt=p,es.transition=f}}return!1}function Yk(c,f,p){f=Uc(p,f),f=dk(c,f,1),c=ho(c,f,1),f=ii(),c!==null&&(Sa(c,1,f),Si(c,f))}function Or(c,f,p){if(c.tag===3)Yk(c,c,p);else for(;f!==null;){if(f.tag===3){Yk(f,c,p);break}else if(f.tag===1){var y=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(mo===null||!mo.has(y))){c=Uc(p,c),c=hk(f,c,1),f=ho(f,c,1),c=ii(),f!==null&&(Sa(f,1,c),Si(f,c));break}}f=f.return}}function I4(c,f,p){var y=c.pingCache;y!==null&&y.delete(f),f=ii(),c.pingedLanes|=c.suspendedLanes&p,pn===c&&(En&p)===p&&(nn===4||nn===3&&(En&130023424)===En&&500>Pe()-ox?Sl(c,0):ax|=p),Si(c,f)}function Kk(c,f){f===0&&((c.mode&1)===0?f=1:(f=Sc,Sc<<=1,(Sc&130023424)===0&&(Sc=4194304)));var p=ii();c=Aa(c,f),c!==null&&(Sa(c,f,p),Si(c,p))}function R4(c){var f=c.memoizedState,p=0;f!==null&&(p=f.retryLane),Kk(c,p)}function P4(c,f){var p=0;switch(c.tag){case 13:var y=c.stateNode,k=c.memoizedState;k!==null&&(p=k.retryLane);break;case 19:y=c.stateNode;break;default:throw Error(r(314))}y!==null&&y.delete(f),Kk(c,p)}var Xk;Xk=function(c,f,p){if(c!==null)if(c.memoizedProps!==f.pendingProps||yi.current)bi=!0;else{if((c.lanes&p)===0&&(f.flags&128)===0)return bi=!1,S4(c,f,p);bi=(c.flags&131072)!==0}else bi=!1,_r&&(f.flags&1048576)!==0&&Nb(f,Ph,f.index);switch(f.lanes=0,f.tag){case 2:var y=f.type;Zh(c,f),c=f.pendingProps;var k=Rc(f,Bn.current);Vc(f,p),k=Bg(null,f,y,c,k,p);var C=jg();return f.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(f.tag=1,f.memoizedState=null,f.updateQueue=null,wi(y)?(C=!0,Fh(f)):C=!1,f.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Dg(f),k.updater=Kh,f.stateNode=k,k._reactInternals=f,Wg(f,y,c,p),f=Kg(null,f,y,!0,C,p)):(f.tag=0,_r&&C&&bg(f),ni(null,f,k,p),f=f.child),f;case 16:y=f.elementType;e:{switch(Zh(c,f),c=f.pendingProps,k=y._init,y=k(y._payload),f.type=y,k=f.tag=B4(y),c=_s(y,c),k){case 0:f=Yg(null,f,y,c,p);break e;case 1:f=kk(null,f,y,c,p);break e;case 11:f=xk(null,f,y,c,p);break e;case 14:f=vk(null,f,y,_s(y.type,c),p);break e}throw Error(r(306,y,""))}return f;case 0:return y=f.type,k=f.pendingProps,k=f.elementType===y?k:_s(y,k),Yg(c,f,y,k,p);case 1:return y=f.type,k=f.pendingProps,k=f.elementType===y?k:_s(y,k),kk(c,f,y,k,p);case 3:e:{if(Sk(f),c===null)throw Error(r(387));y=f.pendingProps,C=f.memoizedState,k=C.element,Bb(c,f),$h(f,y,null,p);var R=f.memoizedState;if(y=R.element,C.isDehydrated)if(C={element:y,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},f.updateQueue.baseState=C,f.memoizedState=C,f.flags&256){k=Uc(Error(r(423)),f),f=_k(c,f,y,p,k);break e}else if(y!==k){k=Uc(Error(r(424)),f),f=_k(c,f,y,p,k);break e}else for(Li=oo(f.stateNode.containerInfo.firstChild),Pi=f,_r=!0,Ss=null,p=Pb(f,null,y,p),f.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Bc(),y===k){f=Ma(c,f,p);break e}ni(c,f,y,p)}f=f.child}return f;case 5:return Vb(f),c===null&&_g(f),y=f.type,k=f.pendingProps,C=c!==null?c.memoizedProps:null,R=k.children,mg(y,k)?R=null:C!==null&&mg(y,C)&&(f.flags|=32),bk(c,f),ni(c,f,R,p),f.child;case 6:return c===null&&_g(f),null;case 13:return Ck(c,f,p);case 4:return Og(f,f.stateNode.containerInfo),y=f.pendingProps,c===null?f.child=jc(f,null,y,p):ni(c,f,y,p),f.child;case 11:return y=f.type,k=f.pendingProps,k=f.elementType===y?k:_s(y,k),xk(c,f,y,k,p);case 7:return ni(c,f,f.pendingProps,p),f.child;case 8:return ni(c,f,f.pendingProps.children,p),f.child;case 12:return ni(c,f,f.pendingProps.children,p),f.child;case 10:e:{if(y=f.type._context,k=f.pendingProps,C=f.memoizedProps,R=k.value,pr(jh,y._currentValue),y._currentValue=R,C!==null)if(ks(C.value,R)){if(C.children===k.children&&!yi.current){f=Ma(c,f,p);break e}}else for(C=f.child,C!==null&&(C.return=f);C!==null;){var Q=C.dependencies;if(Q!==null){R=C.child;for(var ne=Q.firstContext;ne!==null;){if(ne.context===y){if(C.tag===1){ne=Na(-1,p&-p),ne.tag=2;var _e=C.updateQueue;if(_e!==null){_e=_e.shared;var Fe=_e.pending;Fe===null?ne.next=ne:(ne.next=Fe.next,Fe.next=ne),_e.pending=ne}}C.lanes|=p,ne=C.alternate,ne!==null&&(ne.lanes|=p),Ng(C.return,p,f),Q.lanes|=p;break}ne=ne.next}}else if(C.tag===10)R=C.type===f.type?null:C.child;else if(C.tag===18){if(R=C.return,R===null)throw Error(r(341));R.lanes|=p,Q=R.alternate,Q!==null&&(Q.lanes|=p),Ng(R,p,f),R=C.sibling}else R=C.child;if(R!==null)R.return=C;else for(R=C;R!==null;){if(R===f){R=null;break}if(C=R.sibling,C!==null){C.return=R.return,R=C;break}R=R.return}C=R}ni(c,f,k.children,p),f=f.child}return f;case 9:return k=f.type,y=f.pendingProps.children,Vc(f,p),k=Ji(k),y=y(k),f.flags|=1,ni(c,f,y,p),f.child;case 14:return y=f.type,k=_s(y,f.pendingProps),k=_s(y.type,k),vk(c,f,y,k,p);case 15:return yk(c,f,f.type,f.pendingProps,p);case 17:return y=f.type,k=f.pendingProps,k=f.elementType===y?k:_s(y,k),Zh(c,f),f.tag=1,wi(y)?(c=!0,Fh(f)):c=!1,Vc(f,p),uk(f,y,k),Wg(f,y,k,p),Kg(null,f,y,!0,c,p);case 19:return Tk(c,f,p);case 22:return wk(c,f,p)}throw Error(r(156,f.tag))};function Zk(c,f){return Re(c,f)}function L4(c,f,p,y){this.tag=c,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(c,f,p,y){return new L4(c,f,p,y)}function mx(c){return c=c.prototype,!(!c||!c.isReactComponent)}function B4(c){if(typeof c=="function")return mx(c)?1:0;if(c!=null){if(c=c.$$typeof,c===I)return 11;if(c===re)return 14}return 2}function yo(c,f){var p=c.alternate;return p===null?(p=ts(c.tag,f,c.key,c.mode),p.elementType=c.elementType,p.type=c.type,p.stateNode=c.stateNode,p.alternate=c,c.alternate=p):(p.pendingProps=f,p.type=c.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=c.flags&14680064,p.childLanes=c.childLanes,p.lanes=c.lanes,p.child=c.child,p.memoizedProps=c.memoizedProps,p.memoizedState=c.memoizedState,p.updateQueue=c.updateQueue,f=c.dependencies,p.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},p.sibling=c.sibling,p.index=c.index,p.ref=c.ref,p}function l0(c,f,p,y,k,C){var R=2;if(y=c,typeof c=="function")mx(c)&&(R=1);else if(typeof c=="string")R=5;else e:switch(c){case E:return Cl(p.children,k,C,f);case A:R=8,k|=8;break;case N:return c=ts(12,p,f,k|2),c.elementType=N,c.lanes=C,c;case ee:return c=ts(13,p,f,k),c.elementType=ee,c.lanes=C,c;case oe:return c=ts(19,p,f,k),c.elementType=oe,c.lanes=C,c;case se:return c0(p,k,C,f);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case P:R=10;break e;case B:R=9;break e;case I:R=11;break e;case re:R=14;break e;case fe:R=16,y=null;break e}throw Error(r(130,c==null?c:typeof c,""))}return f=ts(R,p,f,k),f.elementType=c,f.type=y,f.lanes=C,f}function Cl(c,f,p,y){return c=ts(7,c,y,f),c.lanes=p,c}function c0(c,f,p,y){return c=ts(22,c,y,f),c.elementType=se,c.lanes=p,c.stateNode={isHidden:!1},c}function gx(c,f,p){return c=ts(6,c,null,f),c.lanes=p,c}function xx(c,f,p){return f=ts(4,c.children!==null?c.children:[],c.key,f),f.lanes=p,f.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},f}function j4(c,f,p,y,k){this.tag=f,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zu(0),this.expirationTimes=Zu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zu(0),this.identifierPrefix=y,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function vx(c,f,p,y,k,C,R,Q,ne){return c=new j4(c,f,p,Q,ne),f===1?(f=1,C===!0&&(f|=8)):f=0,C=ts(3,null,null,f),c.current=C,C.stateNode=c,C.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dg(C),c}function z4(c,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:y==null?null:""+y,children:c,containerInfo:f,implementation:p}}function Jk(c){if(!c)return co;c=c._reactInternals;e:{if(K(c)!==c||c.tag!==1)throw Error(r(170));var f=c;do{switch(f.tag){case 3:f=f.stateNode.context;break e;case 1:if(wi(f.type)){f=f.stateNode.__reactInternalMemoizedMergedChildContext;break e}}f=f.return}while(f!==null);throw Error(r(171))}if(c.tag===1){var p=c.type;if(wi(p))return Eb(c,p,f)}return f}function Qk(c,f,p,y,k,C,R,Q,ne){return c=vx(p,y,!0,c,k,C,R,Q,ne),c.context=Jk(null),p=c.current,y=ii(),k=xo(p),C=Na(y,k),C.callback=f??null,ho(p,C,k),c.current.lanes=k,Sa(c,k,y),Si(c,y),c}function u0(c,f,p,y){var k=f.current,C=ii(),R=xo(k);return p=Jk(p),f.context===null?f.context=p:f.pendingContext=p,f=Na(C,R),f.payload={element:c},y=y===void 0?null:y,y!==null&&(f.callback=y),c=ho(k,f,R),c!==null&&(Ts(c,k,R,C),Vh(c,k,R)),R}function f0(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function eS(c,f){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var p=c.retryLane;c.retryLane=p!==0&&p<f?p:f}}function yx(c,f){eS(c,f),(c=c.alternate)&&eS(c,f)}function V4(){return null}var tS=typeof reportError=="function"?reportError:function(c){console.error(c)};function wx(c){this._internalRoot=c}d0.prototype.render=wx.prototype.render=function(c){var f=this._internalRoot;if(f===null)throw Error(r(409));u0(c,f,null,null)},d0.prototype.unmount=wx.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var f=c.containerInfo;kl(function(){u0(null,c,null,null)}),f[_a]=null}};function d0(c){this._internalRoot=c}d0.prototype.unstable_scheduleHydration=function(c){if(c){var f=xh();c={blockedOn:null,target:c,priority:f};for(var p=0;p<qs.length&&f!==0&&f<qs[p].priority;p++);qs.splice(p,0,c),p===0&&ae(c)}};function bx(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function h0(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function rS(){}function $4(c,f,p,y,k){if(k){if(typeof y=="function"){var C=y;y=function(){var _e=f0(R);C.call(_e)}}var R=Qk(f,y,c,0,null,!1,!1,"",rS);return c._reactRootContainer=R,c[_a]=R.current,ff(c.nodeType===8?c.parentNode:c),kl(),R}for(;k=c.lastChild;)c.removeChild(k);if(typeof y=="function"){var Q=y;y=function(){var _e=f0(ne);Q.call(_e)}}var ne=vx(c,0,!1,null,null,!1,!1,"",rS);return c._reactRootContainer=ne,c[_a]=ne.current,ff(c.nodeType===8?c.parentNode:c),kl(function(){u0(f,ne,p,y)}),ne}function p0(c,f,p,y,k){var C=p._reactRootContainer;if(C){var R=C;if(typeof k=="function"){var Q=k;k=function(){var ne=f0(R);Q.call(ne)}}u0(f,R,c,k)}else R=$4(p,f,c,k,y);return f0(R)}gh=function(c){switch(c.tag){case 3:var f=c.stateNode;if(f.current.memoizedState.isDehydrated){var p=io(f.pendingLanes);p!==0&&(Ju(f,p|1),Si(f,Pe()),(Jt&6)===0&&(Gc=Pe()+500,uo()))}break;case 13:kl(function(){var y=Aa(c,1);if(y!==null){var k=ii();Ts(y,c,1,k)}}),yx(c,1)}},Cc=function(c){if(c.tag===13){var f=Aa(c,134217728);if(f!==null){var p=ii();Ts(f,c,134217728,p)}yx(c,134217728)}},Qu=function(c){if(c.tag===13){var f=xo(c),p=Aa(c,f);if(p!==null){var y=ii();Ts(p,c,f,y)}yx(c,f)}},xh=function(){return Zt},vh=function(c,f){var p=Zt;try{return Zt=c,f()}finally{Zt=p}},to=function(c,f,p){switch(f){case"input":if(Te(c,p),f=p.name,p.type==="radio"&&f!=null){for(p=c;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+f)+'][type="radio"]'),f=0;f<p.length;f++){var y=p[f];if(y!==c&&y.form===c.form){var k=Dh(y);if(!k)throw Error(r(90));j(y),Te(y,k)}}}break;case"textarea":Me(c,p);break;case"select":f=p.value,f!=null&&le(c,!!p.multiple,f,!1)}},wc=dx,bc=kl;var U4={usingClientEntryPoint:!1,Events:[pf,Fc,Dh,cl,yc,dx]},Af={findFiberByHostInstance:pl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},H4={bundleType:Af.bundleType,version:Af.version,rendererPackageName:Af.rendererPackageName,rendererConfig:Af.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=ye(c),c===null?null:c.stateNode},findFiberByHostInstance:Af.findFiberByHostInstance||V4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var m0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!m0.isDisabled&&m0.supportsFiber)try{Ki=m0.inject(H4),Hr=m0}catch{}}return _i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U4,_i.createPortal=function(c,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bx(f))throw Error(r(200));return z4(c,f,null,p)},_i.createRoot=function(c,f){if(!bx(c))throw Error(r(299));var p=!1,y="",k=tS;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(y=f.identifierPrefix),f.onRecoverableError!==void 0&&(k=f.onRecoverableError)),f=vx(c,1,!1,null,null,p,!1,y,k),c[_a]=f.current,ff(c.nodeType===8?c.parentNode:c),new wx(f)},_i.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var f=c._reactInternals;if(f===void 0)throw typeof c.render=="function"?Error(r(188)):(c=Object.keys(c).join(","),Error(r(268,c)));return c=ye(f),c=c===null?null:c.stateNode,c},_i.flushSync=function(c){return kl(c)},_i.hydrate=function(c,f,p){if(!h0(f))throw Error(r(200));return p0(null,c,f,!0,p)},_i.hydrateRoot=function(c,f,p){if(!bx(c))throw Error(r(405));var y=p!=null&&p.hydratedSources||null,k=!1,C="",R=tS;if(p!=null&&(p.unstable_strictMode===!0&&(k=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onRecoverableError!==void 0&&(R=p.onRecoverableError)),f=Qk(f,null,c,1,p??null,k,!1,C,R),c[_a]=f.current,ff(c),y)for(c=0;c<y.length;c++)p=y[c],k=p._getVersion,k=k(p._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[p,k]:f.mutableSourceEagerHydrationData.push(p,k);return new d0(f)},_i.render=function(c,f,p){if(!h0(f))throw Error(r(200));return p0(null,c,f,!1,p)},_i.unmountComponentAtNode=function(c){if(!h0(c))throw Error(r(40));return c._reactRootContainer?(kl(function(){p0(null,null,c,!1,function(){c._reactRootContainer=null,c[_a]=null})}),!0):!1},_i.unstable_batchedUpdates=dx,_i.unstable_renderSubtreeIntoContainer=function(c,f,p,y){if(!h0(p))throw Error(r(200));if(c==null||c._reactInternals===void 0)throw Error(r(38));return p0(c,f,p,!1,y)},_i.version="18.3.1-next-f1338f8080-20240426",_i}var uS;function dT(){if(uS)return _x.exports;uS=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_x.exports=eI(),_x.exports}var fS;function tI(){if(fS)return g0;fS=1;var t=dT();return g0.createRoot=t.createRoot,g0.hydrateRoot=t.hydrateRoot,g0}var rI=tI();const nI=gm(rI);var eh=t=>t.type==="checkbox",Rl=t=>t instanceof Date,ai=t=>t==null;const hT=t=>typeof t=="object";var Jr=t=>!ai(t)&&!Array.isArray(t)&&hT(t)&&!Rl(t),pT=t=>Jr(t)&&t.target?eh(t.target)?t.target.checked:t.target.value:t,iI=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,mT=(t,e)=>t.has(iI(e)),sI=t=>{const e=t.constructor&&t.constructor.prototype;return Jr(e)&&e.hasOwnProperty("isPrototypeOf")},iy=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function sn(t){let e;const r=Array.isArray(t),n=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(iy&&(t instanceof Blob||n))&&(r||Jr(t)))if(e=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!sI(t))e=t;else for(const i in t)t.hasOwnProperty(i)&&(e[i]=sn(t[i]));else return t;return e}var xm=t=>/^\w*$/.test(t),zr=t=>t===void 0,sy=t=>Array.isArray(t)?t.filter(Boolean):[],ay=t=>sy(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ke=(t,e,r)=>{if(!e||!Jr(t))return r;const n=(xm(e)?[e]:ay(e)).reduce((i,s)=>ai(i)?i:i[s],t);return zr(n)||n===t?zr(t[e])?r:t[e]:n},ji=t=>typeof t=="boolean",lr=(t,e,r)=>{let n=-1;const i=xm(e)?[e]:ay(e),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let l=r;if(n!==a){const u=t[o];l=Jr(u)||Array.isArray(u)?u:isNaN(+i[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;t[o]=l,t=t[o]}};const wp={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ms={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Oa={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},gT=xt.createContext(null);gT.displayName="HookFormContext";const oy=()=>xt.useContext(gT);var xT=(t,e,r,n=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==Ms.all&&(e._proxyFormState[a]=!n||Ms.all),r&&(r[a]=!0),t[a]}});return i};const ly=typeof window<"u"?xt.useLayoutEffect:xt.useEffect;function aI(t){const e=oy(),{control:r=e.control,disabled:n,name:i,exact:s}=t||{},[a,o]=xt.useState(r._formState),l=xt.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return ly(()=>r._subscribe({name:i,formState:l.current,exact:s,callback:u=>{!n&&o({...r._formState,...u})}}),[i,n,s]),xt.useEffect(()=>{l.current.isValid&&r._setValid(!0)},[r]),xt.useMemo(()=>xT(a,r,l.current,!1),[a,r])}var $i=t=>typeof t=="string",vT=(t,e,r,n,i)=>$i(t)?(n&&e.watch.add(t),Ke(r,t,i)):Array.isArray(t)?t.map(s=>(n&&e.watch.add(s),Ke(r,s))):(n&&(e.watchAll=!0),r),Gv=t=>ai(t)||!hT(t);function Va(t,e,r=new WeakSet){if(Gv(t)||Gv(e))return t===e;if(Rl(t)&&Rl(e))return t.getTime()===e.getTime();const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;if(r.has(t)||r.has(e))return!0;r.add(t),r.add(e);for(const s of n){const a=t[s];if(!i.includes(s))return!1;if(s!=="ref"){const o=e[s];if(Rl(a)&&Rl(o)||Jr(a)&&Jr(o)||Array.isArray(a)&&Array.isArray(o)?!Va(a,o,r):a!==o)return!1}}return!0}function oI(t){const e=oy(),{control:r=e.control,name:n,defaultValue:i,disabled:s,exact:a,compute:o}=t||{},l=xt.useRef(i),u=xt.useRef(o),d=xt.useRef(void 0);u.current=o;const h=xt.useMemo(()=>r._getWatch(n,l.current),[r,n]),[m,g]=xt.useState(u.current?u.current(h):h);return ly(()=>r._subscribe({name:n,formState:{values:!0},exact:a,callback:v=>{if(!s){const x=vT(n,r._names,v.values||r._formValues,!1,l.current);if(u.current){const w=u.current(x);Va(w,d.current)||(g(w),d.current=w)}else g(x)}}}),[r,s,n,a]),xt.useEffect(()=>r._removeUnmounted()),m}function lI(t){const e=oy(),{name:r,disabled:n,control:i=e.control,shouldUnregister:s,defaultValue:a}=t,o=mT(i._names.array,r),l=xt.useMemo(()=>Ke(i._formValues,r,Ke(i._defaultValues,r,a)),[i,r,a]),u=oI({control:i,name:r,defaultValue:l,exact:!0}),d=aI({control:i,name:r,exact:!0}),h=xt.useRef(t),m=xt.useRef(void 0),g=xt.useRef(i.register(r,{...t.rules,value:u,...ji(t.disabled)?{disabled:t.disabled}:{}}));h.current=t;const v=xt.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ke(d.errors,r)},isDirty:{enumerable:!0,get:()=>!!Ke(d.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Ke(d.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Ke(d.validatingFields,r)},error:{enumerable:!0,get:()=>Ke(d.errors,r)}}),[d,r]),x=xt.useCallback(_=>g.current.onChange({target:{value:pT(_),name:r},type:wp.CHANGE}),[r]),w=xt.useCallback(()=>g.current.onBlur({target:{value:Ke(i._formValues,r),name:r},type:wp.BLUR}),[r,i._formValues]),S=xt.useCallback(_=>{const M=Ke(i._fields,r);M&&_&&(M._f.ref={focus:()=>_.focus&&_.focus(),select:()=>_.select&&_.select(),setCustomValidity:D=>_.setCustomValidity(D),reportValidity:()=>_.reportValidity()})},[i._fields,r]),T=xt.useMemo(()=>({name:r,value:u,...ji(n)||d.disabled?{disabled:d.disabled||n}:{},onChange:x,onBlur:w,ref:S}),[r,n,d.disabled,x,w,S,u]);return xt.useEffect(()=>{const _=i._options.shouldUnregister||s,M=m.current;M&&M!==r&&!o&&i.unregister(M),i.register(r,{...h.current.rules,...ji(h.current.disabled)?{disabled:h.current.disabled}:{}});const D=(O,E)=>{const A=Ke(i._fields,O);A&&A._f&&(A._f.mount=E)};if(D(r,!0),_){const O=sn(Ke(i._options.defaultValues,r,h.current.defaultValue));lr(i._defaultValues,r,O),zr(Ke(i._formValues,r))&&lr(i._formValues,r,O)}return!o&&i.register(r),m.current=r,()=>{(o?_&&!i._state.action:_)?i.unregister(r):D(r,!1)}},[r,i,o,s]),xt.useEffect(()=>{i._setDisabledField({disabled:n,name:r})},[n,r,i]),xt.useMemo(()=>({field:T,formState:d,fieldState:v}),[T,d,v])}const cI=t=>t.render(lI(t));var yT=(t,e,r,n,i)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[n]:i||!0}}:{},rd=t=>Array.isArray(t)?t:[t],dS=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}};function wT(t,e){const r={};for(const n in t)if(t.hasOwnProperty(n)){const i=t[n],s=e[n];if(i&&Jr(i)&&s){const a=wT(i,s);Jr(a)&&(r[n]=a)}else t[n]&&(r[n]=s)}return r}var Ti=t=>Jr(t)&&!Object.keys(t).length,cy=t=>t.type==="file",Ds=t=>typeof t=="function",bp=t=>{if(!iy)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},bT=t=>t.type==="select-multiple",uy=t=>t.type==="radio",uI=t=>uy(t)||eh(t),Tx=t=>bp(t)&&t.isConnected;function fI(t,e){const r=e.slice(0,-1).length;let n=0;for(;n<r;)t=zr(t)?n++:t[e[n++]];return t}function dI(t){for(const e in t)if(t.hasOwnProperty(e)&&!zr(t[e]))return!1;return!0}function qr(t,e){const r=Array.isArray(e)?e:xm(e)?[e]:ay(e),n=r.length===1?t:fI(t,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(Jr(n)&&Ti(n)||Array.isArray(n)&&dI(n))&&qr(t,r.slice(0,-1)),t}var hI=t=>{for(const e in t)if(Ds(t[e]))return!0;return!1};function kT(t){return Array.isArray(t)||Jr(t)&&!hI(t)}function qv(t,e={}){for(const r in t)kT(t[r])?(e[r]=Array.isArray(t[r])?[]:{},qv(t[r],e[r])):ai(t[r])||(e[r]=!0);return e}function au(t,e,r){r||(r=qv(e));for(const n in t)kT(t[n])?zr(e)||Gv(r[n])?r[n]=qv(t[n],Array.isArray(t[n])?[]:{}):au(t[n],ai(e)?{}:e[n],r[n]):r[n]=!Va(t[n],e[n]);return r}const hS={value:!1,isValid:!1},pS={value:!0,isValid:!0};var ST=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!zr(t[0].attributes.value)?zr(t[0].value)||t[0].value===""?pS:{value:t[0].value,isValid:!0}:pS:hS}return hS},_T=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:n})=>zr(t)?t:e?t===""?NaN:t&&+t:r&&$i(t)?new Date(t):n?n(t):t;const mS={isValid:!1,value:null};var CT=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,mS):mS;function gS(t){const e=t.ref;return cy(e)?e.files:uy(e)?CT(t.refs).value:bT(e)?[...e.selectedOptions].map(({value:r})=>r):eh(e)?ST(t.refs).value:_T(zr(e.value)?t.ref.value:e.value,t)}var pI=(t,e,r,n)=>{const i={};for(const s of t){const a=Ke(e,s);a&&lr(i,s,a._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:n}},kp=t=>t instanceof RegExp,Mf=t=>zr(t)?t:kp(t)?t.source:Jr(t)?kp(t.value)?t.value.source:t.value:t,xS=t=>({isOnSubmit:!t||t===Ms.onSubmit,isOnBlur:t===Ms.onBlur,isOnChange:t===Ms.onChange,isOnAll:t===Ms.all,isOnTouch:t===Ms.onTouched});const vS="AsyncFunction";var mI=t=>!!t&&!!t.validate&&!!(Ds(t.validate)&&t.validate.constructor.name===vS||Jr(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===vS)),gI=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),yS=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const nd=(t,e,r,n)=>{for(const i of r||Object.keys(t)){const s=Ke(t,i);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!n)return!0;if(a.ref&&e(a.ref,a.name)&&!n)return!0;if(nd(o,e))break}else if(Jr(o)&&nd(o,e))break}}};function wS(t,e,r){const n=Ke(t,r);if(n||xm(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=Ke(e,s),o=Ke(t,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};if(o&&o.root&&o.root.type)return{name:`${s}.root`,error:o.root};i.pop()}return{name:r}}var xI=(t,e,r,n)=>{r(t);const{name:i,...s}=t;return Ti(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!n||Ms.all))},vI=(t,e,r)=>!t||!e||t===e||rd(t).some(n=>n&&(r?n===e:n.startsWith(e)||e.startsWith(n))),yI=(t,e,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(e||t):(r?n.isOnBlur:i.isOnBlur)?!t:(r?n.isOnChange:i.isOnChange)?t:!0,wI=(t,e)=>!sy(Ke(t,e)).length&&qr(t,e),bI=(t,e,r)=>{const n=rd(Ke(t,r));return lr(n,"root",e[r]),lr(t,r,n),t};function bS(t,e,r="validate"){if($i(t)||Array.isArray(t)&&t.every($i)||ji(t)&&!t)return{type:r,message:$i(t)?t:"",ref:e}}var Yc=t=>Jr(t)&&!kp(t)?t:{value:t,message:""},kS=async(t,e,r,n,i,s)=>{const{ref:a,refs:o,required:l,maxLength:u,minLength:d,min:h,max:m,pattern:g,validate:v,name:x,valueAsNumber:w,mount:S}=t._f,T=Ke(r,x);if(!S||e.has(x))return{};const _=o?o[0]:a,M=I=>{i&&_.reportValidity&&(_.setCustomValidity(ji(I)?"":I||""),_.reportValidity())},D={},O=uy(a),E=eh(a),A=O||E,N=(w||cy(a))&&zr(a.value)&&zr(T)||bp(a)&&a.value===""||T===""||Array.isArray(T)&&!T.length,P=yT.bind(null,x,n,D),B=(I,ee,oe,re=Oa.maxLength,fe=Oa.minLength)=>{const se=I?ee:oe;D[x]={type:I?re:fe,message:se,ref:a,...P(I?re:fe,se)}};if(s?!Array.isArray(T)||!T.length:l&&(!A&&(N||ai(T))||ji(T)&&!T||E&&!ST(o).isValid||O&&!CT(o).isValid)){const{value:I,message:ee}=$i(l)?{value:!!l,message:l}:Yc(l);if(I&&(D[x]={type:Oa.required,message:ee,ref:_,...P(Oa.required,ee)},!n))return M(ee),D}if(!N&&(!ai(h)||!ai(m))){let I,ee;const oe=Yc(m),re=Yc(h);if(!ai(T)&&!isNaN(T)){const fe=a.valueAsNumber||T&&+T;ai(oe.value)||(I=fe>oe.value),ai(re.value)||(ee=fe<re.value)}else{const fe=a.valueAsDate||new Date(T),se=ve=>new Date(new Date().toDateString()+" "+ve),xe=a.type=="time",H=a.type=="week";$i(oe.value)&&T&&(I=xe?se(T)>se(oe.value):H?T>oe.value:fe>new Date(oe.value)),$i(re.value)&&T&&(ee=xe?se(T)<se(re.value):H?T<re.value:fe<new Date(re.value))}if((I||ee)&&(B(!!I,oe.message,re.message,Oa.max,Oa.min),!n))return M(D[x].message),D}if((u||d)&&!N&&($i(T)||s&&Array.isArray(T))){const I=Yc(u),ee=Yc(d),oe=!ai(I.value)&&T.length>+I.value,re=!ai(ee.value)&&T.length<+ee.value;if((oe||re)&&(B(oe,I.message,ee.message),!n))return M(D[x].message),D}if(g&&!N&&$i(T)){const{value:I,message:ee}=Yc(g);if(kp(I)&&!T.match(I)&&(D[x]={type:Oa.pattern,message:ee,ref:a,...P(Oa.pattern,ee)},!n))return M(ee),D}if(v){if(Ds(v)){const I=await v(T,r),ee=bS(I,_);if(ee&&(D[x]={...ee,...P(Oa.validate,ee.message)},!n))return M(ee.message),D}else if(Jr(v)){let I={};for(const ee in v){if(!Ti(I)&&!n)break;const oe=bS(await v[ee](T,r),_,ee);oe&&(I={...oe,...P(ee,oe.message)},M(oe.message),n&&(D[x]=I))}if(!Ti(I)&&(D[x]={ref:_,...I},!n))return D}}return M(!0),D};const kI={mode:Ms.onSubmit,reValidateMode:Ms.onChange,shouldFocusError:!0};function SI(t={}){let e={...kI,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ds(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},i=Jr(e.defaultValues)||Jr(e.values)?sn(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:sn(i),a={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const m={array:dS(),state:dS()},g=e.criteriaMode===Ms.all,v=J=>le=>{clearTimeout(u),u=setTimeout(J,le)},x=async J=>{if(!e.disabled&&(d.isValid||h.isValid||J)){const le=e.resolver?Ti((await E()).errors):await N(n,!0);le!==r.isValid&&m.state.next({isValid:le})}},w=(J,le)=>{!e.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((J||Array.from(o.mount)).forEach(be=>{be&&(le?lr(r.validatingFields,be,le):qr(r.validatingFields,be))}),m.state.next({validatingFields:r.validatingFields,isValidating:!Ti(r.validatingFields)}))},S=(J,le=[],be,Ve,Me=!0,Ae=!0)=>{if(Ve&&be&&!e.disabled){if(a.action=!0,Ae&&Array.isArray(Ke(n,J))){const $e=be(Ke(n,J),Ve.argA,Ve.argB);Me&&lr(n,J,$e)}if(Ae&&Array.isArray(Ke(r.errors,J))){const $e=be(Ke(r.errors,J),Ve.argA,Ve.argB);Me&&lr(r.errors,J,$e),wI(r.errors,J)}if((d.touchedFields||h.touchedFields)&&Ae&&Array.isArray(Ke(r.touchedFields,J))){const $e=be(Ke(r.touchedFields,J),Ve.argA,Ve.argB);Me&&lr(r.touchedFields,J,$e)}(d.dirtyFields||h.dirtyFields)&&(r.dirtyFields=au(i,s)),m.state.next({name:J,isDirty:B(J,le),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else lr(s,J,le)},T=(J,le)=>{lr(r.errors,J,le),m.state.next({errors:r.errors})},_=J=>{r.errors=J,m.state.next({errors:r.errors,isValid:!1})},M=(J,le,be,Ve)=>{const Me=Ke(n,J);if(Me){const Ae=Ke(s,J,zr(be)?Ke(i,J):be);zr(Ae)||Ve&&Ve.defaultChecked||le?lr(s,J,le?Ae:gS(Me._f)):oe(J,Ae),a.mount&&x()}},D=(J,le,be,Ve,Me)=>{let Ae=!1,$e=!1;const et={name:J};if(!e.disabled){if(!be||Ve){(d.isDirty||h.isDirty)&&($e=r.isDirty,r.isDirty=et.isDirty=B(),Ae=$e!==et.isDirty);const st=Va(Ke(i,J),le);$e=!!Ke(r.dirtyFields,J),st?qr(r.dirtyFields,J):lr(r.dirtyFields,J,!0),et.dirtyFields=r.dirtyFields,Ae=Ae||(d.dirtyFields||h.dirtyFields)&&$e!==!st}if(be){const st=Ke(r.touchedFields,J);st||(lr(r.touchedFields,J,be),et.touchedFields=r.touchedFields,Ae=Ae||(d.touchedFields||h.touchedFields)&&st!==be)}Ae&&Me&&m.state.next(et)}return Ae?et:{}},O=(J,le,be,Ve)=>{const Me=Ke(r.errors,J),Ae=(d.isValid||h.isValid)&&ji(le)&&r.isValid!==le;if(e.delayError&&be?(l=v(()=>T(J,be)),l(e.delayError)):(clearTimeout(u),l=null,be?lr(r.errors,J,be):qr(r.errors,J)),(be?!Va(Me,be):Me)||!Ti(Ve)||Ae){const $e={...Ve,...Ae&&ji(le)?{isValid:le}:{},errors:r.errors,name:J};r={...r,...$e},m.state.next($e)}},E=async J=>{w(J,!0);const le=await e.resolver(s,e.context,pI(J||o.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return w(J),le},A=async J=>{const{errors:le}=await E(J);if(J)for(const be of J){const Ve=Ke(le,be);Ve?lr(r.errors,be,Ve):qr(r.errors,be)}else r.errors=le;return le},N=async(J,le,be={valid:!0})=>{for(const Ve in J){const Me=J[Ve];if(Me){const{_f:Ae,...$e}=Me;if(Ae){const et=o.array.has(Ae.name),st=Me._f&&mI(Me._f);st&&d.validatingFields&&w([Ae.name],!0);const Nt=await kS(Me,o.disabled,s,g,e.shouldUseNativeValidation&&!le,et);if(st&&d.validatingFields&&w([Ae.name]),Nt[Ae.name]&&(be.valid=!1,le))break;!le&&(Ke(Nt,Ae.name)?et?bI(r.errors,Nt,Ae.name):lr(r.errors,Ae.name,Nt[Ae.name]):qr(r.errors,Ae.name))}!Ti($e)&&await N($e,le,be)}}return be.valid},P=()=>{for(const J of o.unMount){const le=Ke(n,J);le&&(le._f.refs?le._f.refs.every(be=>!Tx(be)):!Tx(le._f.ref))&&Ce(J)}o.unMount=new Set},B=(J,le)=>!e.disabled&&(J&&le&&lr(s,J,le),!Va(ve(),i)),I=(J,le,be)=>vT(J,o,{...a.mount?s:zr(le)?i:$i(J)?{[J]:le}:le},be,le),ee=J=>sy(Ke(a.mount?s:i,J,e.shouldUnregister?Ke(i,J,[]):[])),oe=(J,le,be={})=>{const Ve=Ke(n,J);let Me=le;if(Ve){const Ae=Ve._f;Ae&&(!Ae.disabled&&lr(s,J,_T(le,Ae)),Me=bp(Ae.ref)&&ai(le)?"":le,bT(Ae.ref)?[...Ae.ref.options].forEach($e=>$e.selected=Me.includes($e.value)):Ae.refs?eh(Ae.ref)?Ae.refs.forEach($e=>{(!$e.defaultChecked||!$e.disabled)&&(Array.isArray(Me)?$e.checked=!!Me.find(et=>et===$e.value):$e.checked=Me===$e.value||!!Me)}):Ae.refs.forEach($e=>$e.checked=$e.value===Me):cy(Ae.ref)?Ae.ref.value="":(Ae.ref.value=Me,Ae.ref.type||m.state.next({name:J,values:sn(s)})))}(be.shouldDirty||be.shouldTouch)&&D(J,Me,be.shouldTouch,be.shouldDirty,!0),be.shouldValidate&&H(J)},re=(J,le,be)=>{for(const Ve in le){if(!le.hasOwnProperty(Ve))return;const Me=le[Ve],Ae=J+"."+Ve,$e=Ke(n,Ae);(o.array.has(J)||Jr(Me)||$e&&!$e._f)&&!Rl(Me)?re(Ae,Me,be):oe(Ae,Me,be)}},fe=(J,le,be={})=>{const Ve=Ke(n,J),Me=o.array.has(J),Ae=sn(le);lr(s,J,Ae),Me?(m.array.next({name:J,values:sn(s)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&be.shouldDirty&&m.state.next({name:J,dirtyFields:au(i,s),isDirty:B(J,Ae)})):Ve&&!Ve._f&&!ai(Ae)?re(J,Ae,be):oe(J,Ae,be),yS(J,o)&&m.state.next({...r,name:J}),m.state.next({name:a.mount?J:void 0,values:sn(s)})},se=async J=>{a.mount=!0;const le=J.target;let be=le.name,Ve=!0;const Me=Ke(n,be),Ae=st=>{Ve=Number.isNaN(st)||Rl(st)&&isNaN(st.getTime())||Va(st,Ke(s,be,st))},$e=xS(e.mode),et=xS(e.reValidateMode);if(Me){let st,Nt;const rt=le.type?gS(Me._f):pT(J),Tt=J.type===wp.BLUR||J.type===wp.FOCUS_OUT,ar=!gI(Me._f)&&!e.resolver&&!Ke(r.errors,be)&&!Me._f.deps||yI(Tt,Ke(r.touchedFields,be),r.isSubmitted,et,$e),$t=yS(be,o,Tt);lr(s,be,rt),Tt?(!le||!le.readOnly)&&(Me._f.onBlur&&Me._f.onBlur(J),l&&l(0)):Me._f.onChange&&Me._f.onChange(J);const Mr=D(be,rt,Tt),ba=!Ti(Mr)||$t;if(!Tt&&m.state.next({name:be,type:J.type,values:sn(s)}),ar)return(d.isValid||h.isValid)&&(e.mode==="onBlur"?Tt&&x():Tt||x()),ba&&m.state.next({name:be,...$t?{}:Mr});if(!Tt&&$t&&m.state.next({...r}),e.resolver){const{errors:Pn}=await E([be]);if(Ae(rt),Ve){const xi=wS(r.errors,n,be),Sn=wS(Pn,n,xi.name||be);st=Sn.error,be=Sn.name,Nt=Ti(Pn)}}else w([be],!0),st=(await kS(Me,o.disabled,s,g,e.shouldUseNativeValidation))[be],w([be]),Ae(rt),Ve&&(st?Nt=!1:(d.isValid||h.isValid)&&(Nt=await N(n,!0)));Ve&&(Me._f.deps&&(!Array.isArray(Me._f.deps)||Me._f.deps.length>0)&&H(Me._f.deps),O(be,Nt,st,Mr))}},xe=(J,le)=>{if(Ke(r.errors,le)&&J.focus)return J.focus(),1},H=async(J,le={})=>{let be,Ve;const Me=rd(J);if(e.resolver){const Ae=await A(zr(J)?J:Me);be=Ti(Ae),Ve=J?!Me.some($e=>Ke(Ae,$e)):be}else J?(Ve=(await Promise.all(Me.map(async Ae=>{const $e=Ke(n,Ae);return await N($e&&$e._f?{[Ae]:$e}:$e)}))).every(Boolean),!(!Ve&&!r.isValid)&&x()):Ve=be=await N(n);return m.state.next({...!$i(J)||(d.isValid||h.isValid)&&be!==r.isValid?{}:{name:J},...e.resolver||!J?{isValid:be}:{},errors:r.errors}),le.shouldFocus&&!Ve&&nd(n,xe,J?Me:o.mount),Ve},ve=(J,le)=>{let be={...a.mount?s:i};return le&&(be=wT(le.dirtyFields?r.dirtyFields:r.touchedFields,be)),zr(J)?be:$i(J)?Ke(be,J):J.map(Ve=>Ke(be,Ve))},W=(J,le)=>({invalid:!!Ke((le||r).errors,J),isDirty:!!Ke((le||r).dirtyFields,J),error:Ke((le||r).errors,J),isValidating:!!Ke(r.validatingFields,J),isTouched:!!Ke((le||r).touchedFields,J)}),F=J=>{J&&rd(J).forEach(le=>qr(r.errors,le)),m.state.next({errors:J?r.errors:{}})},X=(J,le,be)=>{const Ve=(Ke(n,J,{_f:{}})._f||{}).ref,Me=Ke(r.errors,J)||{},{ref:Ae,message:$e,type:et,...st}=Me;lr(r.errors,J,{...st,...le,ref:Ve}),m.state.next({name:J,errors:r.errors,isValid:!1}),be&&be.shouldFocus&&Ve&&Ve.focus&&Ve.focus()},Z=(J,le)=>Ds(J)?m.state.subscribe({next:be=>"values"in be&&J(I(void 0,le),be)}):I(J,le,!0),q=J=>m.state.subscribe({next:le=>{vI(J.name,le.name,J.exact)&&xI(le,J.formState||d,Te,J.reRenderRoot)&&J.callback({values:{...s},...r,...le,defaultValues:i})}}).unsubscribe,ce=J=>(a.mount=!0,h={...h,...J.formState},q({...J,formState:h})),Ce=(J,le={})=>{for(const be of J?rd(J):o.mount)o.mount.delete(be),o.array.delete(be),le.keepValue||(qr(n,be),qr(s,be)),!le.keepError&&qr(r.errors,be),!le.keepDirty&&qr(r.dirtyFields,be),!le.keepTouched&&qr(r.touchedFields,be),!le.keepIsValidating&&qr(r.validatingFields,be),!e.shouldUnregister&&!le.keepDefaultValue&&qr(i,be);m.state.next({values:sn(s)}),m.state.next({...r,...le.keepDirty?{isDirty:B()}:{}}),!le.keepIsValid&&x()},pe=({disabled:J,name:le})=>{(ji(J)&&a.mount||J||o.disabled.has(le))&&(J?o.disabled.add(le):o.disabled.delete(le))},ue=(J,le={})=>{let be=Ke(n,J);const Ve=ji(le.disabled)||ji(e.disabled);return lr(n,J,{...be||{},_f:{...be&&be._f?be._f:{ref:{name:J}},name:J,mount:!0,...le}}),o.mount.add(J),be?pe({disabled:ji(le.disabled)?le.disabled:e.disabled,name:J}):M(J,!0,le.value),{...Ve?{disabled:le.disabled||e.disabled}:{},...e.progressive?{required:!!le.required,min:Mf(le.min),max:Mf(le.max),minLength:Mf(le.minLength),maxLength:Mf(le.maxLength),pattern:Mf(le.pattern)}:{},name:J,onChange:se,onBlur:se,ref:Me=>{if(Me){ue(J,le),be=Ke(n,J);const Ae=zr(Me.value)&&Me.querySelectorAll&&Me.querySelectorAll("input,select,textarea")[0]||Me,$e=uI(Ae),et=be._f.refs||[];if($e?et.find(st=>st===Ae):Ae===be._f.ref)return;lr(n,J,{_f:{...be._f,...$e?{refs:[...et.filter(Tx),Ae,...Array.isArray(Ke(i,J))?[{}]:[]],ref:{type:Ae.type,name:J}}:{ref:Ae}}}),M(J,!1,void 0,Ae)}else be=Ke(n,J,{}),be._f&&(be._f.mount=!1),(e.shouldUnregister||le.shouldUnregister)&&!(mT(o.array,J)&&a.action)&&o.unMount.add(J)}}},Se=()=>e.shouldFocusError&&nd(n,xe,o.mount),ze=J=>{ji(J)&&(m.state.next({disabled:J}),nd(n,(le,be)=>{const Ve=Ke(n,be);Ve&&(le.disabled=Ve._f.disabled||J,Array.isArray(Ve._f.refs)&&Ve._f.refs.forEach(Me=>{Me.disabled=Ve._f.disabled||J}))},0,!1))},j=(J,le)=>async be=>{let Ve;be&&(be.preventDefault&&be.preventDefault(),be.persist&&be.persist());let Me=sn(s);if(m.state.next({isSubmitting:!0}),e.resolver){const{errors:Ae,values:$e}=await E();r.errors=Ae,Me=sn($e)}else await N(n);if(o.disabled.size)for(const Ae of o.disabled)qr(Me,Ae);if(qr(r.errors,"root"),Ti(r.errors)){m.state.next({errors:{}});try{await J(Me,be)}catch(Ae){Ve=Ae}}else le&&await le({...r.errors},be),Se(),setTimeout(Se);if(m.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ti(r.errors)&&!Ve,submitCount:r.submitCount+1,errors:r.errors}),Ve)throw Ve},tt=(J,le={})=>{Ke(n,J)&&(zr(le.defaultValue)?fe(J,sn(Ke(i,J))):(fe(J,le.defaultValue),lr(i,J,sn(le.defaultValue))),le.keepTouched||qr(r.touchedFields,J),le.keepDirty||(qr(r.dirtyFields,J),r.isDirty=le.defaultValue?B(J,sn(Ke(i,J))):B()),le.keepError||(qr(r.errors,J),d.isValid&&x()),m.state.next({...r}))},Ne=(J,le={})=>{const be=J?sn(J):i,Ve=sn(be),Me=Ti(J),Ae=Me?i:Ve;if(le.keepDefaultValues||(i=be),!le.keepValues){if(le.keepDirtyValues){const $e=new Set([...o.mount,...Object.keys(au(i,s))]);for(const et of Array.from($e))Ke(r.dirtyFields,et)?lr(Ae,et,Ke(s,et)):fe(et,Ke(Ae,et))}else{if(iy&&zr(J))for(const $e of o.mount){const et=Ke(n,$e);if(et&&et._f){const st=Array.isArray(et._f.refs)?et._f.refs[0]:et._f.ref;if(bp(st)){const Nt=st.closest("form");if(Nt){Nt.reset();break}}}}if(le.keepFieldsRef)for(const $e of o.mount)fe($e,Ke(Ae,$e));else n={}}s=e.shouldUnregister?le.keepDefaultValues?sn(i):{}:sn(Ae),m.array.next({values:{...Ae}}),m.state.next({values:{...Ae}})}o={mount:le.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!d.isValid||!!le.keepIsValid||!!le.keepDirtyValues,a.watch=!!e.shouldUnregister,m.state.next({submitCount:le.keepSubmitCount?r.submitCount:0,isDirty:Me?!1:le.keepDirty?r.isDirty:!!(le.keepDefaultValues&&!Va(J,i)),isSubmitted:le.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Me?{}:le.keepDirtyValues?le.keepDefaultValues&&s?au(i,s):r.dirtyFields:le.keepDefaultValues&&J?au(i,J):le.keepDirty?r.dirtyFields:{},touchedFields:le.keepTouched?r.touchedFields:{},errors:le.keepErrors?r.errors:{},isSubmitSuccessful:le.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},qe=(J,le)=>Ne(Ds(J)?J(s):J,le),Le=(J,le={})=>{const be=Ke(n,J),Ve=be&&be._f;if(Ve){const Me=Ve.refs?Ve.refs[0]:Ve.ref;Me.focus&&(Me.focus(),le.shouldSelect&&Ds(Me.select)&&Me.select())}},Te=J=>{r={...r,...J}},gt={control:{register:ue,unregister:Ce,getFieldState:W,handleSubmit:j,setError:X,_subscribe:q,_runSchema:E,_focusError:Se,_getWatch:I,_getDirty:B,_setValid:x,_setFieldArray:S,_setDisabledField:pe,_setErrors:_,_getFieldArray:ee,_reset:Ne,_resetDefaultValues:()=>Ds(e.defaultValues)&&e.defaultValues().then(J=>{qe(J,e.resetOptions),m.state.next({isLoading:!1})}),_removeUnmounted:P,_disableForm:ze,_subjects:m,_proxyFormState:d,get _fields(){return n},get _formValues(){return s},get _state(){return a},set _state(J){a=J},get _defaultValues(){return i},get _names(){return o},set _names(J){o=J},get _formState(){return r},get _options(){return e},set _options(J){e={...e,...J}}},subscribe:ce,trigger:H,register:ue,handleSubmit:j,watch:Z,setValue:fe,getValues:ve,reset:qe,resetField:tt,clearErrors:F,unregister:Ce,setError:X,setFocus:Le,getFieldState:W};return{...gt,formControl:gt}}function ET(t={}){const e=xt.useRef(void 0),r=xt.useRef(void 0),[n,i]=xt.useState({isDirty:!1,isValidating:!1,isLoading:Ds(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Ds(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:n},t.defaultValues&&!Ds(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:a,...o}=SI(t);e.current={...o,formState:n}}const s=e.current.control;return s._options=t,ly(()=>{const a=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(o=>({...o,isReady:!0})),s._formState.isReady=!0,a},[s]),xt.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),xt.useEffect(()=>{t.mode&&(s._options.mode=t.mode),t.reValidateMode&&(s._options.reValidateMode=t.reValidateMode)},[s,t.mode,t.reValidateMode]),xt.useEffect(()=>{t.errors&&(s._setErrors(t.errors),s._focusError())},[s,t.errors]),xt.useEffect(()=>{t.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,t.shouldUnregister]),xt.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==n.isDirty&&s._subjects.state.next({isDirty:a})}},[s,n.isDirty]),xt.useEffect(()=>{t.values&&!Va(t.values,r.current)?(s._reset(t.values,{keepFieldsRef:!0,...s._options.resetOptions}),r.current=t.values,i(a=>({...a}))):s._resetDefaultValues()},[s,t.values]),xt.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=xT(n,s),e.current}function Vo(t,e,{checkForDefaultPrevented:r=!0}={}){return function(i){if(t==null||t(i),r===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function SS(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function TT(...t){return e=>{let r=!1;const n=t.map(i=>{const s=SS(i,e);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():SS(t[i],null)}}}}function uc(...t){return z.useCallback(TT(...t),t)}function _I(t,e){const r=z.createContext(e),n=s=>{const{children:a,...o}=s,l=z.useMemo(()=>o,Object.values(o));return b.jsx(r.Provider,{value:l,children:a})};n.displayName=t+"Provider";function i(s){const a=z.useContext(r);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[n,i]}function CI(t,e=[]){let r=[];function n(s,a){const o=z.createContext(a),l=r.length;r=[...r,a];const u=h=>{var S;const{scope:m,children:g,...v}=h,x=((S=m==null?void 0:m[t])==null?void 0:S[l])||o,w=z.useMemo(()=>v,Object.values(v));return b.jsx(x.Provider,{value:w,children:g})};u.displayName=s+"Provider";function d(h,m){var x;const g=((x=m==null?void 0:m[t])==null?void 0:x[l])||o,v=z.useContext(g);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[u,d]}const i=()=>{const s=r.map(a=>z.createContext(a));return function(o){const l=(o==null?void 0:o[t])||s;return z.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return i.scopeName=t,[n,EI(i,...e)]}function EI(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=n.reduce((o,{useScope:l,scopeName:u})=>{const h=l(s)[`__scope${u}`];return{...o,...h}},{});return z.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}var _d=globalThis!=null&&globalThis.document?z.useLayoutEffect:()=>{},TI=fT[" useId ".trim().toString()]||(()=>{}),AI=0;function Ax(t){const[e,r]=z.useState(TI());return _d(()=>{r(n=>n??String(AI++))},[t]),t||(e?`radix-${e}`:"")}var NI=fT[" useInsertionEffect ".trim().toString()]||_d;function MI({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[i,s,a]=DI({defaultProp:e,onChange:r}),o=t!==void 0,l=o?t:i;{const d=z.useRef(t!==void 0);z.useEffect(()=>{const h=d.current;h!==o&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=o},[o,n])}const u=z.useCallback(d=>{var h;if(o){const m=OI(d)?d(t):d;m!==t&&((h=a.current)==null||h.call(a,m))}else s(d)},[o,t,s,a]);return[l,u]}function DI({defaultProp:t,onChange:e}){const[r,n]=z.useState(t),i=z.useRef(r),s=z.useRef(e);return NI(()=>{s.current=e},[e]),z.useEffect(()=>{var a;i.current!==r&&((a=s.current)==null||a.call(s,r),i.current=r)},[r,i]),[r,n,s]}function OI(t){return typeof t=="function"}var fy=dT();const AT=gm(fy);function NT(t){const e=FI(t),r=z.forwardRef((n,i)=>{const{children:s,...a}=n,o=z.Children.toArray(s),l=o.find(RI);if(l){const u=l.props.children,d=o.map(h=>h===l?z.Children.count(u)>1?z.Children.only(null):z.isValidElement(u)?u.props.children:null:h);return b.jsx(e,{...a,ref:i,children:z.isValidElement(u)?z.cloneElement(u,void 0,d):null})}return b.jsx(e,{...a,ref:i,children:s})});return r.displayName=`${t}.Slot`,r}function FI(t){const e=z.forwardRef((r,n)=>{const{children:i,...s}=r;if(z.isValidElement(i)){const a=LI(i),o=PI(s,i.props);return i.type!==z.Fragment&&(o.ref=n?TT(n,a):a),z.cloneElement(i,o)}return z.Children.count(i)>1?z.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var II=Symbol("radix.slottable");function RI(t){return z.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===II}function PI(t,e){const r={...e};for(const n in e){const i=t[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...t,...r}}function LI(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var BI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xa=BI.reduce((t,e)=>{const r=NT(`Primitive.${e}`),n=z.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),b.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function jI(t,e){t&&fy.flushSync(()=>t.dispatchEvent(e))}function Cd(t){const e=z.useRef(t);return z.useEffect(()=>{e.current=t}),z.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function zI(t,e=globalThis==null?void 0:globalThis.document){const r=Cd(t);z.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var VI="DismissableLayer",Yv="dismissableLayer.update",$I="dismissableLayer.pointerDownOutside",UI="dismissableLayer.focusOutside",_S,MT=z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DT=z.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=t,u=z.useContext(MT),[d,h]=z.useState(null),m=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,g]=z.useState({}),v=uc(e,E=>h(E)),x=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),S=x.indexOf(w),T=d?x.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,M=T>=S,D=GI(E=>{const A=E.target,N=[...u.branches].some(P=>P.contains(A));!M||N||(i==null||i(E),a==null||a(E),E.defaultPrevented||o==null||o())},m),O=qI(E=>{const A=E.target;[...u.branches].some(P=>P.contains(A))||(s==null||s(E),a==null||a(E),E.defaultPrevented||o==null||o())},m);return zI(E=>{T===u.layers.size-1&&(n==null||n(E),!E.defaultPrevented&&o&&(E.preventDefault(),o()))},m),z.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(_S=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),CS(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=_S)}},[d,m,r,u]),z.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),CS())},[d,u]),z.useEffect(()=>{const E=()=>g({});return document.addEventListener(Yv,E),()=>document.removeEventListener(Yv,E)},[]),b.jsx(xa.div,{...l,ref:v,style:{pointerEvents:_?M?"auto":"none":void 0,...t.style},onFocusCapture:Vo(t.onFocusCapture,O.onFocusCapture),onBlurCapture:Vo(t.onBlurCapture,O.onBlurCapture),onPointerDownCapture:Vo(t.onPointerDownCapture,D.onPointerDownCapture)})});DT.displayName=VI;var HI="DismissableLayerBranch",WI=z.forwardRef((t,e)=>{const r=z.useContext(MT),n=z.useRef(null),i=uc(e,n);return z.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),b.jsx(xa.div,{...t,ref:i})});WI.displayName=HI;function GI(t,e=globalThis==null?void 0:globalThis.document){const r=Cd(t),n=z.useRef(!1),i=z.useRef(()=>{});return z.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){OT($I,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);n.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function qI(t,e=globalThis==null?void 0:globalThis.document){const r=Cd(t),n=z.useRef(!1);return z.useEffect(()=>{const i=s=>{s.target&&!n.current&&OT(UI,r,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function CS(){const t=new CustomEvent(Yv);document.dispatchEvent(t)}function OT(t,e,r,{discrete:n}){const i=r.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&i.addEventListener(t,e,{once:!0}),n?jI(i,s):i.dispatchEvent(s)}var Nx="focusScope.autoFocusOnMount",Mx="focusScope.autoFocusOnUnmount",ES={bubbles:!1,cancelable:!0},YI="FocusScope",FT=z.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=t,[o,l]=z.useState(null),u=Cd(i),d=Cd(s),h=z.useRef(null),m=uc(e,x=>l(x)),g=z.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;z.useEffect(()=>{if(n){let x=function(_){if(g.paused||!o)return;const M=_.target;o.contains(M)?h.current=M:So(h.current,{select:!0})},w=function(_){if(g.paused||!o)return;const M=_.relatedTarget;M!==null&&(o.contains(M)||So(h.current,{select:!0}))},S=function(_){if(document.activeElement===document.body)for(const D of _)D.removedNodes.length>0&&So(o)};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const T=new MutationObserver(S);return o&&T.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),T.disconnect()}}},[n,o,g.paused]),z.useEffect(()=>{if(o){AS.add(g);const x=document.activeElement;if(!o.contains(x)){const S=new CustomEvent(Nx,ES);o.addEventListener(Nx,u),o.dispatchEvent(S),S.defaultPrevented||(KI(eR(IT(o)),{select:!0}),document.activeElement===x&&So(o))}return()=>{o.removeEventListener(Nx,u),setTimeout(()=>{const S=new CustomEvent(Mx,ES);o.addEventListener(Mx,d),o.dispatchEvent(S),S.defaultPrevented||So(x??document.body,{select:!0}),o.removeEventListener(Mx,d),AS.remove(g)},0)}}},[o,u,d,g]);const v=z.useCallback(x=>{if(!r&&!n||g.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,S=document.activeElement;if(w&&S){const T=x.currentTarget,[_,M]=XI(T);_&&M?!x.shiftKey&&S===M?(x.preventDefault(),r&&So(_,{select:!0})):x.shiftKey&&S===_&&(x.preventDefault(),r&&So(M,{select:!0})):S===T&&x.preventDefault()}},[r,n,g.paused]);return b.jsx(xa.div,{tabIndex:-1,...a,ref:m,onKeyDown:v})});FT.displayName=YI;function KI(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(So(n,{select:e}),document.activeElement!==r)return}function XI(t){const e=IT(t),r=TS(e,t),n=TS(e.reverse(),t);return[r,n]}function IT(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function TS(t,e){for(const r of t)if(!ZI(r,{upTo:e}))return r}function ZI(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function JI(t){return t instanceof HTMLInputElement&&"select"in t}function So(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&JI(t)&&e&&t.select()}}var AS=QI();function QI(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=NS(t,e),t.unshift(e)},remove(e){var r;t=NS(t,e),(r=t[0])==null||r.resume()}}}function NS(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function eR(t){return t.filter(e=>e.tagName!=="A")}var tR="Portal",RT=z.forwardRef((t,e)=>{var o;const{container:r,...n}=t,[i,s]=z.useState(!1);_d(()=>s(!0),[]);const a=r||i&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?AT.createPortal(b.jsx(xa.div,{...n,ref:e}),a):null});RT.displayName=tR;function rR(t,e){return z.useReducer((r,n)=>e[r][n]??r,t)}var vm=t=>{const{present:e,children:r}=t,n=nR(e),i=typeof r=="function"?r({present:n.isPresent}):z.Children.only(r),s=uc(n.ref,iR(i));return typeof r=="function"||n.isPresent?z.cloneElement(i,{ref:s}):null};vm.displayName="Presence";function nR(t){const[e,r]=z.useState(),n=z.useRef(null),i=z.useRef(t),s=z.useRef("none"),a=t?"mounted":"unmounted",[o,l]=rR(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return z.useEffect(()=>{const u=x0(n.current);s.current=o==="mounted"?u:"none"},[o]),_d(()=>{const u=n.current,d=i.current;if(d!==t){const m=s.current,g=x0(u);t?l("MOUNT"):g==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(d&&m!==g?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),_d(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=g=>{const x=x0(n.current).includes(CSS.escape(g.animationName));if(g.target===e&&x&&(l("ANIMATION_END"),!i.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},m=g=>{g.target===e&&(s.current=x0(n.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:z.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function x0(t){return(t==null?void 0:t.animationName)||"none"}function iR(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Dx=0;function sR(){z.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??MS()),document.body.insertAdjacentElement("beforeend",t[1]??MS()),Dx++,()=>{Dx===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Dx--}},[])}function MS(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var oa=function(){return oa=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},oa.apply(this,arguments)};function PT(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function aR(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var lp="right-scroll-bar-position",cp="width-before-scroll-bar",oR="with-scroll-bars-hidden",lR="--removed-body-scroll-bar-size";function Ox(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function cR(t,e){var r=z.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=e,r.facade}var uR=typeof window<"u"?z.useLayoutEffect:z.useEffect,DS=new WeakMap;function fR(t,e){var r=cR(null,function(n){return t.forEach(function(i){return Ox(i,n)})});return uR(function(){var n=DS.get(r);if(n){var i=new Set(n),s=new Set(t),a=r.current;i.forEach(function(o){s.has(o)||Ox(o,null)}),s.forEach(function(o){i.has(o)||Ox(o,a)})}DS.set(r,t)},[t]),r}function dR(t){return t}function hR(t,e){e===void 0&&(e=dR);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(s){var a=e(s,n);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(n=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var l=function(){var d=a;a=[],d.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),r={push:function(d){a.push(d),u()},filter:function(d){return a=a.filter(d),r}}}};return i}function pR(t){t===void 0&&(t={});var e=hR(null);return e.options=oa({async:!0,ssr:!1},t),e}var LT=function(t){var e=t.sideCar,r=PT(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return z.createElement(n,oa({},r))};LT.isSideCarExport=!0;function mR(t,e){return t.useMedium(e),LT}var BT=pR(),Fx=function(){},ym=z.forwardRef(function(t,e){var r=z.useRef(null),n=z.useState({onScrollCapture:Fx,onWheelCapture:Fx,onTouchMoveCapture:Fx}),i=n[0],s=n[1],a=t.forwardProps,o=t.children,l=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,m=t.sideCar,g=t.noRelative,v=t.noIsolation,x=t.inert,w=t.allowPinchZoom,S=t.as,T=S===void 0?"div":S,_=t.gapMode,M=PT(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=m,O=fR([r,e]),E=oa(oa({},M),i);return z.createElement(z.Fragment,null,d&&z.createElement(D,{sideCar:BT,removeScrollBar:u,shards:h,noRelative:g,noIsolation:v,inert:x,setCallbacks:s,allowPinchZoom:!!w,lockRef:r,gapMode:_}),a?z.cloneElement(z.Children.only(o),oa(oa({},E),{ref:O})):z.createElement(T,oa({},E,{className:l,ref:O}),o))});ym.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};ym.classNames={fullWidth:cp,zeroRight:lp};var gR=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function xR(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=gR();return e&&t.setAttribute("nonce",e),t}function vR(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function yR(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var wR=function(){var t=0,e=null;return{add:function(r){t==0&&(e=xR())&&(vR(e,r),yR(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},bR=function(){var t=wR();return function(e,r){z.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},jT=function(){var t=bR(),e=function(r){var n=r.styles,i=r.dynamic;return t(n,i),null};return e},kR={left:0,top:0,right:0,gap:0},Ix=function(t){return parseInt(t||"",10)||0},SR=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[Ix(r),Ix(n),Ix(i)]},_R=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return kR;var e=SR(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},CR=jT(),pu="data-scroll-locked",ER=function(t,e,r,n){var i=t.left,s=t.top,a=t.right,o=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(oR,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(pu,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(lp,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(cp,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(lp," .").concat(lp,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(cp," .").concat(cp,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(pu,`] {
    `).concat(lR,": ").concat(o,`px;
  }
`)},OS=function(){var t=parseInt(document.body.getAttribute(pu)||"0",10);return isFinite(t)?t:0},TR=function(){z.useEffect(function(){return document.body.setAttribute(pu,(OS()+1).toString()),function(){var t=OS()-1;t<=0?document.body.removeAttribute(pu):document.body.setAttribute(pu,t.toString())}},[])},AR=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,i=n===void 0?"margin":n;TR();var s=z.useMemo(function(){return _R(i)},[i]);return z.createElement(CR,{styles:ER(s,!e,i,r?"":"!important")})},Kv=!1;if(typeof window<"u")try{var v0=Object.defineProperty({},"passive",{get:function(){return Kv=!0,!0}});window.addEventListener("test",v0,v0),window.removeEventListener("test",v0,v0)}catch{Kv=!1}var Kc=Kv?{passive:!1}:!1,NR=function(t){return t.tagName==="TEXTAREA"},zT=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!NR(t)&&r[e]==="visible")},MR=function(t){return zT(t,"overflowY")},DR=function(t){return zT(t,"overflowX")},FS=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=VT(t,n);if(i){var s=$T(t,n),a=s[1],o=s[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},OR=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},FR=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},VT=function(t,e){return t==="v"?MR(e):DR(e)},$T=function(t,e){return t==="v"?OR(e):FR(e)},IR=function(t,e){return t==="h"&&e==="rtl"?-1:1},RR=function(t,e,r,n,i){var s=IR(t,window.getComputedStyle(e).direction),a=s*n,o=r.target,l=e.contains(o),u=!1,d=a>0,h=0,m=0;do{if(!o)break;var g=$T(t,o),v=g[0],x=g[1],w=g[2],S=x-w-s*v;(v||S)&&VT(t,o)&&(h+=S,m+=v);var T=o.parentNode;o=T&&T.nodeType===Node.DOCUMENT_FRAGMENT_NODE?T.host:T}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(d&&Math.abs(h)<1||!d&&Math.abs(m)<1)&&(u=!0),u},y0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},IS=function(t){return[t.deltaX,t.deltaY]},RS=function(t){return t&&"current"in t?t.current:t},PR=function(t,e){return t[0]===e[0]&&t[1]===e[1]},LR=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},BR=0,Xc=[];function jR(t){var e=z.useRef([]),r=z.useRef([0,0]),n=z.useRef(),i=z.useState(BR++)[0],s=z.useState(jT)[0],a=z.useRef(t);z.useEffect(function(){a.current=t},[t]),z.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var x=aR([t.lockRef.current],(t.shards||[]).map(RS),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var o=z.useCallback(function(x,w){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!a.current.allowPinchZoom;var S=y0(x),T=r.current,_="deltaX"in x?x.deltaX:T[0]-S[0],M="deltaY"in x?x.deltaY:T[1]-S[1],D,O=x.target,E=Math.abs(_)>Math.abs(M)?"h":"v";if("touches"in x&&E==="h"&&O.type==="range")return!1;var A=FS(E,O);if(!A)return!0;if(A?D=E:(D=E==="v"?"h":"v",A=FS(E,O)),!A)return!1;if(!n.current&&"changedTouches"in x&&(_||M)&&(n.current=D),!D)return!0;var N=n.current||D;return RR(N,w,x,N==="h"?_:M)},[]),l=z.useCallback(function(x){var w=x;if(!(!Xc.length||Xc[Xc.length-1]!==s)){var S="deltaY"in w?IS(w):y0(w),T=e.current.filter(function(D){return D.name===w.type&&(D.target===w.target||w.target===D.shadowParent)&&PR(D.delta,S)})[0];if(T&&T.should){w.cancelable&&w.preventDefault();return}if(!T){var _=(a.current.shards||[]).map(RS).filter(Boolean).filter(function(D){return D.contains(w.target)}),M=_.length>0?o(w,_[0]):!a.current.noIsolation;M&&w.cancelable&&w.preventDefault()}}},[]),u=z.useCallback(function(x,w,S,T){var _={name:x,delta:w,target:S,should:T,shadowParent:zR(S)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(M){return M!==_})},1)},[]),d=z.useCallback(function(x){r.current=y0(x),n.current=void 0},[]),h=z.useCallback(function(x){u(x.type,IS(x),x.target,o(x,t.lockRef.current))},[]),m=z.useCallback(function(x){u(x.type,y0(x),x.target,o(x,t.lockRef.current))},[]);z.useEffect(function(){return Xc.push(s),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",l,Kc),document.addEventListener("touchmove",l,Kc),document.addEventListener("touchstart",d,Kc),function(){Xc=Xc.filter(function(x){return x!==s}),document.removeEventListener("wheel",l,Kc),document.removeEventListener("touchmove",l,Kc),document.removeEventListener("touchstart",d,Kc)}},[]);var g=t.removeScrollBar,v=t.inert;return z.createElement(z.Fragment,null,v?z.createElement(s,{styles:LR(i)}):null,g?z.createElement(AR,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function zR(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const VR=mR(BT,jR);var UT=z.forwardRef(function(t,e){return z.createElement(ym,oa({},t,{ref:e,sideCar:VR}))});UT.classNames=ym.classNames;var $R=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Zc=new WeakMap,w0=new WeakMap,b0={},Rx=0,HT=function(t){return t&&(t.host||HT(t.parentNode))},UR=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=HT(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},HR=function(t,e,r,n){var i=UR(e,Array.isArray(t)?t:[t]);b0[r]||(b0[r]=new WeakMap);var s=b0[r],a=[],o=new Set,l=new Set(i),u=function(h){!h||o.has(h)||(o.add(h),u(h.parentNode))};i.forEach(u);var d=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(m){if(o.has(m))d(m);else try{var g=m.getAttribute(n),v=g!==null&&g!=="false",x=(Zc.get(m)||0)+1,w=(s.get(m)||0)+1;Zc.set(m,x),s.set(m,w),a.push(m),x===1&&v&&w0.set(m,!0),w===1&&m.setAttribute(r,"true"),v||m.setAttribute(n,"true")}catch(S){console.error("aria-hidden: cannot operate on ",m,S)}})};return d(e),o.clear(),Rx++,function(){a.forEach(function(h){var m=Zc.get(h)-1,g=s.get(h)-1;Zc.set(h,m),s.set(h,g),m||(w0.has(h)||h.removeAttribute(n),w0.delete(h)),g||h.removeAttribute(r)}),Rx--,Rx||(Zc=new WeakMap,Zc=new WeakMap,w0=new WeakMap,b0={})}},WR=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),i=$R(t);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),HR(n,i,r,"aria-hidden")):function(){return null}},wm="Dialog",[WT]=CI(wm),[GR,Bs]=WT(wm),GT=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:i,onOpenChange:s,modal:a=!0}=t,o=z.useRef(null),l=z.useRef(null),[u,d]=MI({prop:n,defaultProp:i??!1,onChange:s,caller:wm});return b.jsx(GR,{scope:e,triggerRef:o,contentRef:l,contentId:Ax(),titleId:Ax(),descriptionId:Ax(),open:u,onOpenChange:d,onOpenToggle:z.useCallback(()=>d(h=>!h),[d]),modal:a,children:r})};GT.displayName=wm;var qT="DialogTrigger",YT=z.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=Bs(qT,r),s=uc(e,i.triggerRef);return b.jsx(xa.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":py(i.open),...n,ref:s,onClick:Vo(t.onClick,i.onOpenToggle)})});YT.displayName=qT;var dy="DialogPortal",[qR,KT]=WT(dy,{forceMount:void 0}),XT=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:i}=t,s=Bs(dy,e);return b.jsx(qR,{scope:e,forceMount:r,children:z.Children.map(n,a=>b.jsx(vm,{present:r||s.open,children:b.jsx(RT,{asChild:!0,container:i,children:a})}))})};XT.displayName=dy;var Sp="DialogOverlay",ZT=z.forwardRef((t,e)=>{const r=KT(Sp,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,s=Bs(Sp,t.__scopeDialog);return s.modal?b.jsx(vm,{present:n||s.open,children:b.jsx(KR,{...i,ref:e})}):null});ZT.displayName=Sp;var YR=NT("DialogOverlay.RemoveScroll"),KR=z.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=Bs(Sp,r);return b.jsx(UT,{as:YR,allowPinchZoom:!0,shards:[i.contentRef],children:b.jsx(xa.div,{"data-state":py(i.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),Xl="DialogContent",JT=z.forwardRef((t,e)=>{const r=KT(Xl,t.__scopeDialog),{forceMount:n=r.forceMount,...i}=t,s=Bs(Xl,t.__scopeDialog);return b.jsx(vm,{present:n||s.open,children:s.modal?b.jsx(XR,{...i,ref:e}):b.jsx(ZR,{...i,ref:e})})});JT.displayName=Xl;var XR=z.forwardRef((t,e)=>{const r=Bs(Xl,t.__scopeDialog),n=z.useRef(null),i=uc(e,r.contentRef,n);return z.useEffect(()=>{const s=n.current;if(s)return WR(s)},[]),b.jsx(QT,{...t,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vo(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Vo(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&s.preventDefault()}),onFocusOutside:Vo(t.onFocusOutside,s=>s.preventDefault())})}),ZR=z.forwardRef((t,e)=>{const r=Bs(Xl,t.__scopeDialog),n=z.useRef(!1),i=z.useRef(!1);return b.jsx(QT,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=t.onCloseAutoFocus)==null||a.call(t,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:s=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),QT=z.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=t,o=Bs(Xl,r),l=z.useRef(null),u=uc(e,l);return sR(),b.jsxs(b.Fragment,{children:[b.jsx(FT,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:s,children:b.jsx(DT,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":py(o.open),...a,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),b.jsxs(b.Fragment,{children:[b.jsx(JR,{titleId:o.titleId}),b.jsx(eP,{contentRef:l,descriptionId:o.descriptionId})]})]})}),hy="DialogTitle",eA=z.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=Bs(hy,r);return b.jsx(xa.h2,{id:i.titleId,...n,ref:e})});eA.displayName=hy;var tA="DialogDescription",rA=z.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=Bs(tA,r);return b.jsx(xa.p,{id:i.descriptionId,...n,ref:e})});rA.displayName=tA;var nA="DialogClose",iA=z.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,i=Bs(nA,r);return b.jsx(xa.button,{type:"button",...n,ref:e,onClick:Vo(t.onClick,()=>i.onOpenChange(!1))})});iA.displayName=nA;function py(t){return t?"open":"closed"}var sA="DialogTitleWarning",[Vre,aA]=_I(sA,{contentName:Xl,titleName:hy,docsSlug:"dialog"}),JR=({titleId:t})=>{const e=aA(sA),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return z.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},QR="DialogDescriptionWarning",eP=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${aA(QR).contentName}}.`;return z.useEffect(()=>{var s;const i=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},tP=GT,rP=YT,nP=XT,iP=ZT,sP=JT,oA=eA,lA=rA,aP=iA,oP=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lP="VisuallyHidden",cA=z.forwardRef((t,e)=>b.jsx(xa.span,{...t,ref:e,style:{...oP,...t.style}}));cA.displayName=lP;var Yn=cA;const cP=t=>t.join("-"),js=(...t)=>`var(--em-${cP(t)})`,Qr=t=>js("colors",t),en=t=>js("spacing",t),Zl=t=>js("radii",t),my=t=>js("shadows",t),uP=t=>js("durations",t),_p=t=>js("zIndex",t),fP=()=>js("colors","focusRing"),Vu=t=>js("typography",t),gy=t=>js("typography",t),$u=t=>js("typography",t),uA=t=>js("typography",t),dP={sm:{width:"min(420px, calc(100vw - 2 * var(--em-spacing-xl)))"},md:{width:"min(560px, calc(100vw - 2 * var(--em-spacing-xl)))"},lg:{width:"min(720px, calc(100vw - 2 * var(--em-spacing-xl)))"}},hP={position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:Qr("surface"),borderRadius:Zl("lg"),padding:`${en("xl")} ${en("2xl")}`,maxHeight:"calc(100vh - 2 * var(--em-spacing-2xl))",overflowY:"auto",boxShadow:my("lg"),zIndex:_p("modal")},pP={position:"fixed",top:0,right:0,bottom:0,width:"min(720px, 100vw)",backgroundColor:Qr("surface"),borderTopLeftRadius:Zl("lg"),borderBottomLeftRadius:Zl("lg"),borderLeft:`1px solid ${Qr("borderMuted")}`,padding:`${en("xl")} ${en("2xl")}`,overflowY:"auto",boxShadow:my("lg"),zIndex:_p("modal")},mP={modal:{position:"fixed",inset:0,backgroundColor:Qr("backdrop"),zIndex:_p("modal")},sheet:{position:"fixed",inset:0,backgroundColor:Qr("backdrop"),zIndex:_p("modal")}},gP={modal:hP,sheet:pP},xP={position:"absolute",top:en("sm"),right:en("sm"),border:"none",borderRadius:Zl("pill"),backgroundColor:"transparent",color:Qr("mutedForeground"),padding:en("xs"),cursor:"pointer",lineHeight:1,fontSize:"20px",transition:`color ${uP("fast")} ease`},vP={fontFamily:Vu("fontFamilyHeading"),fontSize:$u("sizeXl"),fontWeight:gy("fontWeightSemibold"),color:Qr("emphasisForeground"),margin:0,marginBottom:en("sm")},yP={fontFamily:Vu("fontFamily"),fontSize:$u("sizeSm"),lineHeight:uA("lineHeightRelaxed"),color:Qr("mutedForeground"),margin:0,marginBottom:en("lg")},wP={display:"grid",gap:en("lg"),marginBottom:en("xl")},bP={display:"flex",gap:en("sm"),justifyContent:"flex-end",alignItems:"center"};function kP({open:t,defaultOpen:e,onOpenChange:r,trigger:n,title:i,description:s,children:a,footer:o,size:l="md",variant:u="modal",testId:d,closeLabel:h="",preventClose:m=!1,overlayStyles:g,contentStyles:v,overlayClassName:x,contentClassName:w,closeOnOverlayClick:S=!0,closeOnEscape:T=!0,showCloseButton:_=!0,ariaLabelledBy:M,ariaDescribedBy:D,portalContainer:O,titleHidden:E=!1,descriptionHidden:A=!1}){const N=z.useId(),P=z.useId(),B=!!(i&&i.trim().length>0),I=!!(s&&s.trim().length>0),ee=M??(B?N:void 0),oe=D??(I?`${P}-desc`:void 0),re=M===void 0&&B,fe=D===void 0&&I,se=gP[u],xe=mP[u],H={...se,...dP[l],...v},ve={...xe,...g};return b.jsxs(tP,{open:t,defaultOpen:e,onOpenChange:r,children:[n?b.jsx(rP,{asChild:!0,children:n}):null,b.jsxs(nP,{container:O??void 0,children:[b.jsx(iP,{"data-testid":d?`${d}-overlay`:void 0,style:ve,className:x}),b.jsxs(sP,{"data-testid":d,"aria-describedby":oe,"aria-labelledby":ee,"data-variant":u,style:H,className:w,onPointerDownOutside:W=>{(m||!S)&&W.preventDefault()},onEscapeKeyDown:W=>{(m||!T)&&W.preventDefault()},children:[!m&&_&&b.jsx(aP,{asChild:!0,children:b.jsx("button",{type:"button","aria-label":h,style:xP,onFocus:W=>{W.currentTarget.style.boxShadow=`0 0 0 2px ${fP()}`},onBlur:W=>{W.currentTarget.style.boxShadow="none"},children:""})}),B?b.jsx(oA,{id:re?N:void 0,style:E?void 0:vP,asChild:E,children:E?b.jsx(Yn,{children:i}):i}):null,I?b.jsx(lA,{id:fe?`${P}-desc`:void 0,style:A?void 0:yP,asChild:A,children:A?b.jsx(Yn,{children:s}):s}):null,b.jsx("section",{style:wP,children:a}),o?b.jsx("footer",{style:bP,children:o}):null]})]})]})}const Jl=oA,Ql=lA;function ec({open:t,onOpenChange:e,variant:r="modal",title:n,description:i,preventClose:s=!1,children:a,testId:o,contentClassName:l,overlayClassName:u,ariaLabelledBy:d,ariaDescribedBy:h,closeOnOverlayClick:m=!0,closeOnEscape:g=!0,showCloseButton:v=!0,contentStyles:x,overlayStyles:w,titleHidden:S=!1,descriptionHidden:T=!1}){return t?b.jsx(kP,{open:!0,onOpenChange:_=>{_||e(!1)},variant:r==="sheet"?"sheet":"modal",title:n,description:i,preventClose:s,testId:o,contentStyles:{backgroundColor:"#ffffff",...x??{}},overlayStyles:w,overlayClassName:u,closeOnOverlayClick:m,closeOnEscape:g,showCloseButton:v,ariaLabelledBy:d,ariaDescribedBy:h,titleHidden:S,descriptionHidden:T,children:b.jsx("div",{className:r==="sheet"?l??"flex h-full flex-col overflow-y-auto":l,children:a})}):null}var up={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var SP=up.exports,PS;function _P(){return PS||(PS=1,(function(t,e){((r,n)=>{t.exports=n()})(SP,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,s=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,u={};function d(A){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(N){var P=D(N);P.chunkSize=parseInt(P.chunkSize),N.step||N.chunk||(P.chunkSize=null),this._handle=new x(P),(this._handle.streamer=this)._config=P}).call(this,A),this.parseChunk=function(N,P){var B=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<B){let ee=this._config.newline;ee||(I=this._config.quoteChar||'"',ee=this._handle.guessLineEndings(N,I)),N=[...N.split(ee).slice(B)].join(ee)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(I=this._config.beforeFirstChunk(N))!==void 0&&(N=I),this.isFirstChunk=!1,this._halted=!1;var B=this._partialLine+N,I=(this._partialLine="",this._handle.parse(B,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(N=I.meta.cursor,B=(this._finished||(this._partialLine=B.substring(N-this._baseIndex),this._baseIndex=N),I&&I.data&&(this._rowCount+=I.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:I,workerId:u.WORKER_ID,finished:B});else if(E(this._config.chunk)&&!P){if(this._config.chunk(I,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=I=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(I.data),this._completeResults.errors=this._completeResults.errors.concat(I.errors),this._completeResults.meta=I.meta),this._completed||!B||!E(this._config.complete)||I&&I.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),B||I&&I.meta.paused||this._nextChunk(),I}this._halted=!0},this._sendError=function(N){E(this._config.error)?this._config.error(N):a&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:N,finished:!1})}}function h(A){var N;(A=A||{}).chunkSize||(A.chunkSize=u.RemoteChunkSize),d.call(this,A),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(P){this._input=P,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(N=new XMLHttpRequest,this._config.withCredentials&&(N.withCredentials=this._config.withCredentials),s||(N.onload=O(this._chunkLoaded,this),N.onerror=O(this._chunkError,this)),N.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var P,B=this._config.downloadRequestHeaders;for(P in B)N.setRequestHeader(P,B[P])}var I;this._config.chunkSize&&(I=this._start+this._config.chunkSize-1,N.setRequestHeader("Range","bytes="+this._start+"-"+I));try{N.send(this._config.downloadRequestBody)}catch(ee){this._chunkError(ee.message)}s&&N.status===0&&this._chunkError()}},this._chunkLoaded=function(){N.readyState===4&&(N.status<200||400<=N.status?this._chunkError():(this._start+=this._config.chunkSize||N.responseText.length,this._finished=!this._config.chunkSize||this._start>=(P=>(P=P.getResponseHeader("Content-Range"))!==null?parseInt(P.substring(P.lastIndexOf("/")+1)):-1)(N),this.parseChunk(N.responseText)))},this._chunkError=function(P){P=N.statusText||P,this._sendError(new Error(P))}}function m(A){(A=A||{}).chunkSize||(A.chunkSize=u.LocalChunkSize),d.call(this,A);var N,P,B=typeof FileReader<"u";this.stream=function(I){this._input=I,P=I.slice||I.webkitSlice||I.mozSlice,B?((N=new FileReader).onload=O(this._chunkLoaded,this),N.onerror=O(this._chunkError,this)):N=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var I=this._input,ee=(this._config.chunkSize&&(ee=Math.min(this._start+this._config.chunkSize,this._input.size),I=P.call(I,this._start,ee)),N.readAsText(I,this._config.encoding));B||this._chunkLoaded({target:{result:ee}})},this._chunkLoaded=function(I){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(I.target.result)},this._chunkError=function(){this._sendError(N.error)}}function g(A){var N;d.call(this,A=A||{}),this.stream=function(P){return N=P,this._nextChunk()},this._nextChunk=function(){var P,B;if(!this._finished)return P=this._config.chunkSize,N=P?(B=N.substring(0,P),N.substring(P)):(B=N,""),this._finished=!N,this.parseChunk(B)}}function v(A){d.call(this,A=A||{});var N=[],P=!0,B=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(I){this._input=I,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&N.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),N.length?this.parseChunk(N.shift()):P=!0},this._streamData=O(function(I){try{N.push(typeof I=="string"?I:I.toString(this._config.encoding)),P&&(P=!1,this._checkIsFinished(),this.parseChunk(N.shift()))}catch(ee){this._streamError(ee)}},this),this._streamError=O(function(I){this._streamCleanUp(),this._sendError(I)},this),this._streamEnd=O(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=O(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(A){var N,P,B,I,ee=Math.pow(2,53),oe=-ee,re=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,se=this,xe=0,H=0,ve=!1,W=!1,F=[],X={data:[],errors:[],meta:{}};function Z(pe){return A.skipEmptyLines==="greedy"?pe.join("").trim()==="":pe.length===1&&pe[0].length===0}function q(){if(X&&B&&(Ce("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),B=!1),A.skipEmptyLines&&(X.data=X.data.filter(function(j){return!Z(j)})),ce()){let j=function(tt,Ne){E(A.transformHeader)&&(tt=A.transformHeader(tt,Ne)),F.push(tt)};var ze=j;if(X)if(Array.isArray(X.data[0])){for(var pe=0;ce()&&pe<X.data.length;pe++)X.data[pe].forEach(j);X.data.splice(0,1)}else X.data.forEach(j)}function ue(j,tt){for(var Ne=A.header?{}:[],qe=0;qe<j.length;qe++){var Le=qe,Te=j[qe],Te=((at,gt)=>(J=>(A.dynamicTypingFunction&&A.dynamicTyping[J]===void 0&&(A.dynamicTyping[J]=A.dynamicTypingFunction(J)),(A.dynamicTyping[J]||A.dynamicTyping)===!0))(at)?gt==="true"||gt==="TRUE"||gt!=="false"&&gt!=="FALSE"&&((J=>{if(re.test(J)&&(J=parseFloat(J),oe<J&&J<ee))return 1})(gt)?parseFloat(gt):fe.test(gt)?new Date(gt):gt===""?null:gt):gt)(Le=A.header?qe>=F.length?"__parsed_extra":F[qe]:Le,Te=A.transform?A.transform(Te,Le):Te);Le==="__parsed_extra"?(Ne[Le]=Ne[Le]||[],Ne[Le].push(Te)):Ne[Le]=Te}return A.header&&(qe>F.length?Ce("FieldMismatch","TooManyFields","Too many fields: expected "+F.length+" fields but parsed "+qe,H+tt):qe<F.length&&Ce("FieldMismatch","TooFewFields","Too few fields: expected "+F.length+" fields but parsed "+qe,H+tt)),Ne}var Se;X&&(A.header||A.dynamicTyping||A.transform)&&(Se=1,!X.data.length||Array.isArray(X.data[0])?(X.data=X.data.map(ue),Se=X.data.length):X.data=ue(X.data,0),A.header&&X.meta&&(X.meta.fields=F),H+=Se)}function ce(){return A.header&&F.length===0}function Ce(pe,ue,Se,ze){pe={type:pe,code:ue,message:Se},ze!==void 0&&(pe.row=ze),X.errors.push(pe)}E(A.step)&&(I=A.step,A.step=function(pe){X=pe,ce()?q():(q(),X.data.length!==0&&(xe+=pe.data.length,A.preview&&xe>A.preview?P.abort():(X.data=X.data[0],I(X,se))))}),this.parse=function(pe,ue,Se){var ze=A.quoteChar||'"',ze=(A.newline||(A.newline=this.guessLineEndings(pe,ze)),B=!1,A.delimiter?E(A.delimiter)&&(A.delimiter=A.delimiter(pe),X.meta.delimiter=A.delimiter):((ze=((j,tt,Ne,qe,Le)=>{var Te,at,gt,J;Le=Le||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var le=0;le<Le.length;le++){for(var be,Ve=Le[le],Me=0,Ae=0,$e=0,et=(gt=void 0,new S({comments:qe,delimiter:Ve,newline:tt,preview:10}).parse(j)),st=0;st<et.data.length;st++)Ne&&Z(et.data[st])?$e++:(be=et.data[st].length,Ae+=be,gt===void 0?gt=be:0<be&&(Me+=Math.abs(be-gt),gt=be));0<et.data.length&&(Ae/=et.data.length-$e),(at===void 0||Me<=at)&&(J===void 0||J<Ae)&&1.99<Ae&&(at=Me,Te=Ve,J=Ae)}return{successful:!!(A.delimiter=Te),bestDelimiter:Te}})(pe,A.newline,A.skipEmptyLines,A.comments,A.delimitersToGuess)).successful?A.delimiter=ze.bestDelimiter:(B=!0,A.delimiter=u.DefaultDelimiter),X.meta.delimiter=A.delimiter),D(A));return A.preview&&A.header&&ze.preview++,N=pe,P=new S(ze),X=P.parse(N,ue,Se),q(),ve?{meta:{paused:!0}}:X||{meta:{paused:!1}}},this.paused=function(){return ve},this.pause=function(){ve=!0,P.abort(),N=E(A.chunk)?"":N.substring(P.getCharIndex())},this.resume=function(){se.streamer._halted?(ve=!1,se.streamer.parseChunk(N,!0)):setTimeout(se.resume,3)},this.aborted=function(){return W},this.abort=function(){W=!0,P.abort(),X.meta.aborted=!0,E(A.complete)&&A.complete(X),N=""},this.guessLineEndings=function(j,ze){j=j.substring(0,1048576);var ze=new RegExp(w(ze)+"([^]*?)"+w(ze),"gm"),Se=(j=j.replace(ze,"")).split("\r"),ze=j.split(`
`),j=1<ze.length&&ze[0].length<Se[0].length;if(Se.length===1||j)return`
`;for(var tt=0,Ne=0;Ne<Se.length;Ne++)Se[Ne][0]===`
`&&tt++;return tt>=Se.length/2?`\r
`:"\r"}}function w(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function S(A){var N=(A=A||{}).delimiter,P=A.newline,B=A.comments,I=A.step,ee=A.preview,oe=A.fastMode,re=null,fe=!1,se=A.quoteChar==null?'"':A.quoteChar,xe=se;if(A.escapeChar!==void 0&&(xe=A.escapeChar),(typeof N!="string"||-1<u.BAD_DELIMITERS.indexOf(N))&&(N=","),B===N)throw new Error("Comment character same as delimiter");B===!0?B="#":(typeof B!="string"||-1<u.BAD_DELIMITERS.indexOf(B))&&(B=!1),P!==`
`&&P!=="\r"&&P!==`\r
`&&(P=`
`);var H=0,ve=!1;this.parse=function(W,F,X){if(typeof W!="string")throw new Error("Input must be a string");var Z=W.length,q=N.length,ce=P.length,Ce=B.length,pe=E(I),ue=[],Se=[],ze=[],j=H=0;if(!W)return Me();if(oe||oe!==!1&&W.indexOf(se)===-1){for(var tt=W.split(P),Ne=0;Ne<tt.length;Ne++){if(ze=tt[Ne],H+=ze.length,Ne!==tt.length-1)H+=P.length;else if(X)return Me();if(!B||ze.substring(0,Ce)!==B){if(pe){if(ue=[],J(ze.split(N)),Ae(),ve)return Me()}else J(ze.split(N));if(ee&&ee<=Ne)return ue=ue.slice(0,ee),Me(!0)}}return Me()}for(var qe=W.indexOf(N,H),Le=W.indexOf(P,H),Te=new RegExp(w(xe)+w(se),"g"),at=W.indexOf(se,H);;)if(W[H]===se)for(at=H,H++;;){if((at=W.indexOf(se,at+1))===-1)return X||Se.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ue.length,index:H}),be();if(at===Z-1)return be(W.substring(H,at).replace(Te,se));if(se===xe&&W[at+1]===xe)at++;else if(se===xe||at===0||W[at-1]!==xe){qe!==-1&&qe<at+1&&(qe=W.indexOf(N,at+1));var gt=le((Le=Le!==-1&&Le<at+1?W.indexOf(P,at+1):Le)===-1?qe:Math.min(qe,Le));if(W.substr(at+1+gt,q)===N){ze.push(W.substring(H,at).replace(Te,se)),W[H=at+1+gt+q]!==se&&(at=W.indexOf(se,H)),qe=W.indexOf(N,H),Le=W.indexOf(P,H);break}if(gt=le(Le),W.substring(at+1+gt,at+1+gt+ce)===P){if(ze.push(W.substring(H,at).replace(Te,se)),Ve(at+1+gt+ce),qe=W.indexOf(N,H),at=W.indexOf(se,H),pe&&(Ae(),ve))return Me();if(ee&&ue.length>=ee)return Me(!0);break}Se.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ue.length,index:H}),at++}}else if(B&&ze.length===0&&W.substring(H,H+Ce)===B){if(Le===-1)return Me();H=Le+ce,Le=W.indexOf(P,H),qe=W.indexOf(N,H)}else if(qe!==-1&&(qe<Le||Le===-1))ze.push(W.substring(H,qe)),H=qe+q,qe=W.indexOf(N,H);else{if(Le===-1)break;if(ze.push(W.substring(H,Le)),Ve(Le+ce),pe&&(Ae(),ve))return Me();if(ee&&ue.length>=ee)return Me(!0)}return be();function J($e){ue.push($e),j=H}function le($e){var et=0;return et=$e!==-1&&($e=W.substring(at+1,$e))&&$e.trim()===""?$e.length:et}function be($e){return X||($e===void 0&&($e=W.substring(H)),ze.push($e),H=Z,J(ze),pe&&Ae()),Me()}function Ve($e){H=$e,J(ze),ze=[],Le=W.indexOf(P,H)}function Me($e){if(A.header&&!F&&ue.length&&!fe){var et=ue[0],st=Object.create(null),Nt=new Set(et);let rt=!1;for(let Tt=0;Tt<et.length;Tt++){let ar=et[Tt];if(st[ar=E(A.transformHeader)?A.transformHeader(ar,Tt):ar]){let $t,Mr=st[ar];for(;$t=ar+"_"+Mr,Mr++,Nt.has($t););Nt.add($t),et[Tt]=$t,st[ar]++,rt=!0,(re=re===null?{}:re)[$t]=ar}else st[ar]=1,et[Tt]=ar;Nt.add(ar)}rt&&console.warn("Duplicate headers found and renamed."),fe=!0}return{data:ue,errors:Se,meta:{delimiter:N,linebreak:P,aborted:ve,truncated:!!$e,cursor:j+(F||0),renamedHeaders:re}}}function Ae(){I(Me()),ue=[],Se=[]}},this.abort=function(){ve=!0},this.getCharIndex=function(){return H}}function T(A){var N=A.data,P=o[N.workerId],B=!1;if(N.error)P.userError(N.error,N.file);else if(N.results&&N.results.data){var I={abort:function(){B=!0,_(N.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:M,resume:M};if(E(P.userStep)){for(var ee=0;ee<N.results.data.length&&(P.userStep({data:N.results.data[ee],errors:N.results.errors,meta:N.results.meta},I),!B);ee++);delete N.results}else E(P.userChunk)&&(P.userChunk(N.results,I,N.file),delete N.results)}N.finished&&!B&&_(N.workerId,N.results)}function _(A,N){var P=o[A];E(P.userComplete)&&P.userComplete(N),P.terminate(),delete o[A]}function M(){throw new Error("Not implemented.")}function D(A){if(typeof A!="object"||A===null)return A;var N,P=Array.isArray(A)?[]:{};for(N in A)P[N]=D(A[N]);return P}function O(A,N){return function(){A.apply(N,arguments)}}function E(A){return typeof A=="function"}return u.parse=function(A,N){var P=(N=N||{}).dynamicTyping||!1;if(E(P)&&(N.dynamicTypingFunction=P,P={}),N.dynamicTyping=P,N.transform=!!E(N.transform)&&N.transform,!N.worker||!u.WORKERS_SUPPORTED)return P=null,u.NODE_STREAM_INPUT,typeof A=="string"?(A=(B=>B.charCodeAt(0)!==65279?B:B.slice(1))(A),P=new(N.download?h:g)(N)):A.readable===!0&&E(A.read)&&E(A.on)?P=new v(N):(n.File&&A instanceof File||A instanceof Object)&&(P=new m(N)),P.stream(A);(P=(()=>{var B;return!!u.WORKERS_SUPPORTED&&(B=(()=>{var I=n.URL||n.webkitURL||null,ee=r.toString();return u.BLOB_URL||(u.BLOB_URL=I.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",ee,")();"],{type:"text/javascript"})))})(),(B=new n.Worker(B)).onmessage=T,B.id=l++,o[B.id]=B)})()).userStep=N.step,P.userChunk=N.chunk,P.userComplete=N.complete,P.userError=N.error,N.step=E(N.step),N.chunk=E(N.chunk),N.complete=E(N.complete),N.error=E(N.error),delete N.worker,P.postMessage({input:A,config:N,workerId:P.id})},u.unparse=function(A,N){var P=!1,B=!0,I=",",ee=`\r
`,oe='"',re=oe+oe,fe=!1,se=null,xe=!1,H=((()=>{if(typeof N=="object"){if(typeof N.delimiter!="string"||u.BAD_DELIMITERS.filter(function(F){return N.delimiter.indexOf(F)!==-1}).length||(I=N.delimiter),typeof N.quotes!="boolean"&&typeof N.quotes!="function"&&!Array.isArray(N.quotes)||(P=N.quotes),typeof N.skipEmptyLines!="boolean"&&typeof N.skipEmptyLines!="string"||(fe=N.skipEmptyLines),typeof N.newline=="string"&&(ee=N.newline),typeof N.quoteChar=="string"&&(oe=N.quoteChar),typeof N.header=="boolean"&&(B=N.header),Array.isArray(N.columns)){if(N.columns.length===0)throw new Error("Option columns is empty");se=N.columns}N.escapeChar!==void 0&&(re=N.escapeChar+oe),N.escapeFormulae instanceof RegExp?xe=N.escapeFormulae:typeof N.escapeFormulae=="boolean"&&N.escapeFormulae&&(xe=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(oe),"g"));if(typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(A)){if(!A.length||Array.isArray(A[0]))return ve(null,A,fe);if(typeof A[0]=="object")return ve(se||Object.keys(A[0]),A,fe)}else if(typeof A=="object")return typeof A.data=="string"&&(A.data=JSON.parse(A.data)),Array.isArray(A.data)&&(A.fields||(A.fields=A.meta&&A.meta.fields||se),A.fields||(A.fields=Array.isArray(A.data[0])?A.fields:typeof A.data[0]=="object"?Object.keys(A.data[0]):[]),Array.isArray(A.data[0])||typeof A.data[0]=="object"||(A.data=[A.data])),ve(A.fields||[],A.data||[],fe);throw new Error("Unable to serialize unrecognized input");function ve(F,X,Z){var q="",ce=(typeof F=="string"&&(F=JSON.parse(F)),typeof X=="string"&&(X=JSON.parse(X)),Array.isArray(F)&&0<F.length),Ce=!Array.isArray(X[0]);if(ce&&B){for(var pe=0;pe<F.length;pe++)0<pe&&(q+=I),q+=W(F[pe],pe);0<X.length&&(q+=ee)}for(var ue=0;ue<X.length;ue++){var Se=(ce?F:X[ue]).length,ze=!1,j=ce?Object.keys(X[ue]).length===0:X[ue].length===0;if(Z&&!ce&&(ze=Z==="greedy"?X[ue].join("").trim()==="":X[ue].length===1&&X[ue][0].length===0),Z==="greedy"&&ce){for(var tt=[],Ne=0;Ne<Se;Ne++){var qe=Ce?F[Ne]:Ne;tt.push(X[ue][qe])}ze=tt.join("").trim()===""}if(!ze){for(var Le=0;Le<Se;Le++){0<Le&&!j&&(q+=I);var Te=ce&&Ce?F[Le]:Le;q+=W(X[ue][Te],Le)}ue<X.length-1&&(!Z||0<Se&&!j)&&(q+=ee)}}return q}function W(F,X){var Z,q;return F==null?"":F.constructor===Date?JSON.stringify(F).slice(1,25):(q=!1,xe&&typeof F=="string"&&xe.test(F)&&(F="'"+F,q=!0),Z=F.toString().replace(H,re),(q=q||P===!0||typeof P=="function"&&P(F,X)||Array.isArray(P)&&P[X]||((ce,Ce)=>{for(var pe=0;pe<Ce.length;pe++)if(-1<ce.indexOf(Ce[pe]))return!0;return!1})(Z,u.BAD_DELIMITERS)||-1<Z.indexOf(I)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?oe+Z+oe:Z)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!s&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=S,u.ParserHandle=x,u.NetworkStreamer=h,u.FileStreamer=m,u.StringStreamer=g,u.ReadableStreamStreamer=v,n.jQuery&&((i=n.jQuery).fn.parse=function(A){var N=A.config||{},P=[];return this.each(function(ee){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var oe=0;oe<this.files.length;oe++)P.push({file:this.files[oe],inputElem:this,instanceConfig:i.extend({},N)})}),B(),this;function B(){if(P.length===0)E(A.complete)&&A.complete();else{var ee,oe,re,fe,se=P[0];if(E(A.before)){var xe=A.before(se.file,se.inputElem);if(typeof xe=="object"){if(xe.action==="abort")return ee="AbortError",oe=se.file,re=se.inputElem,fe=xe.reason,void(E(A.error)&&A.error({name:ee},oe,re,fe));if(xe.action==="skip")return void I();typeof xe.config=="object"&&(se.instanceConfig=i.extend(se.instanceConfig,xe.config))}else if(xe==="skip")return void I()}var H=se.instanceConfig.complete;se.instanceConfig.complete=function(ve){E(H)&&H(ve,se.file,se.inputElem),I()},u.parse(se.file,se.instanceConfig)}}function I(){P.splice(0,1),B()}}),a&&(n.onmessage=function(A){A=A.data,u.WORKER_ID===void 0&&A&&(u.WORKER_ID=A.workerId),typeof A.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(A.input,A.config),finished:!0}):(n.File&&A.input instanceof File||A.input instanceof Object)&&(A=u.parse(A.input,A.config))&&n.postMessage({workerId:u.WORKER_ID,results:A,finished:!0})}),(h.prototype=Object.create(d.prototype)).constructor=h,(m.prototype=Object.create(d.prototype)).constructor=m,(g.prototype=Object.create(g.prototype)).constructor=g,(v.prototype=Object.create(d.prototype)).constructor=v,u})})(up)),up.exports}var CP=_P();const xy=gm(CP);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var fA=1252,EP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yy=function(t){EP.indexOf(t)!=-1&&(fA=vy[0]=t)};function TP(){yy(1252)}var Is=function(t){yy(t)};function dA(){Is(1200),TP()}function LS(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function AP(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function hA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Hf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?AP(t.slice(2)):e==254&&r==255?hA(t.slice(2)):e==65279?t.slice(1):t},k0=function(e){return String.fromCharCode(e)},BS=function(e){return String.fromCharCode(e)},Ed,Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jS(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,i=t.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Do.charAt(s)+Do.charAt(a)+Do.charAt(o)+Do.charAt(l);return e}function Gi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Do.indexOf(t.charAt(u++)),a=Do.indexOf(t.charAt(u++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Do.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Do.indexOf(t.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),fc=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Xo(t){return Wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function zS(t){return Wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Os=function(e){return Wt?fc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function dc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function wy(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return wy(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var No=Wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:fc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function NP(t){for(var e=[],r=0,n=t.length+250,i=Xo(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Xo(65535),n=65530)}return e.push(i.slice(0,r)),No(e)}var ui=/\u0000/g,Wf=/[\u0001-\u0006]/g;function mu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Rs(t,e){var r=""+t;return r.length>=e?r:Fr("0",e-r.length)+r}function by(t,e){var r=""+t;return r.length>=e?r:Fr(" ",e-r.length)+r}function Cp(t,e){var r=""+t;return r.length>=e?r:r+Fr(" ",e-r.length)}function MP(t,e){var r=""+Math.round(t);return r.length>=e?r:Fr("0",e-r.length)+r}function DP(t,e){var r=""+t;return r.length>=e?r:Fr("0",e-r.length)+r}var VS=Math.pow(2,32);function Jc(t,e){if(t>VS||t<-VS)return MP(t,e);var r=Math.round(t);return DP(r,e)}function Ep(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var $S=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Px=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function OP(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var It={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},US={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Tp(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,u=0,d=0,h=Math.floor(i);u<e&&(h=Math.floor(i),o=h*a+s,d=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=d;if(d>e&&(u>e?(d=l,o=s):(d=u,o=a)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function Pl(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=jP(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var pA=new Date(1899,11,31,0,0,0),IP=pA.getTime(),RP=new Date(1900,2,1,0,0,0);function mA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=RP&&(r+=1440*60*1e3),(r-(IP+(t.getTimezoneOffset()-pA.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ky(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function PP(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LP(t){var e=t<0?12:11,r=ky(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function BP(t){var e=ky(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Td(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=LP(t):e===10?r=t.toFixed(10).substr(0,12):r=BP(t),ky(PP(r.toUpperCase()))}function tc(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Td(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ps(14,mA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function jP(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function zP(t,e,r,n){var i="",s=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Px[r.m-1][1];case 5:return Px[r.m-1][0];default:return Px[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return $S[r.q][0];default:return $S[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Rs(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Rs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?Rs(l,u):"";return d}function Oo(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var gA=/%/g;function VP(t,e,r){var n=e.replace(gA,""),i=e.length-n.length;return Wa(t,n,r*Math.pow(10,2*i))+Fr("%",i)}function $P(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function xA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xA(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vA=/# (\?+)( ?)\/( ?)(\d+)/;function UP(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Fr(" ",t[1].length+1+t[4].length):by(a,t[1].length)+t[2]+"/"+t[3]+Rs(o,t[4].length))}function HP(t,e,r){return r+(e===0?"":""+e)+Fr(" ",t[1].length+2+t[4].length)}var yA=/^#*0*\.([0#]+)/,wA=/\).*[0#]/,bA=/\(###\) ###\\?-####/;function oi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function HS(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function WS(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function WP(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function GP(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ss(t,e,r){if(t.charCodeAt(0)===40&&!e.match(wA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ss("n",n,r):"("+ss("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return $P(t,e,r);if(e.indexOf("%")!==-1)return VP(t,e,r);if(e.indexOf("E")!==-1)return xA(e,r);if(e.charCodeAt(0)===36)return"$"+ss(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Jc(l,e.length);if(e.match(/^[#?]+$/))return i=Jc(r,0),i==="0"&&(i=""),i.length>e.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(vA))return UP(s,l,u);if(e.match(/^#+0+$/))return u+Jc(l,e.length-e.indexOf("0"));if(s=e.match(yA))return i=HS(r,s[1].length).replace(/^([^\.]+)$/,"$1."+oi(s[1])).replace(/\.$/,"."+oi(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Fr("0",oi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+HS(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Oo(Jc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ss(t,e,-r):Oo(""+(Math.floor(r)+WP(r,s[1].length)))+"."+Rs(WS(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ss(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(ss(t,e.replace(/[\\-]/g,""),r)),a=0,mu(mu(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(bA))return i=ss(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Tp(l,Math.pow(10,a)-1,!1),i=""+u,d=Wa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Cp(o[2],a),d.length<s[4].length&&(d=oi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Tp(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?by(o[1],a)+s[2]+"/"+s[3]+Cp(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Jc(r,0),e.length<=i.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,m=e.length-i.length-h;return oi(e.substr(0,h)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=WS(r,s[1].length),r<0?"-"+ss(t,e,-r):Oo(GP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Rs(0,3-v.length):"")+v})+"."+Rs(a,s[1].length);switch(e){case"###,##0.00":return ss(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Oo(Jc(l,0));return g!=="0"?u+g:"";case"###,###.00":return ss(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ss(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function qP(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function YP(t,e,r){var n=e.replace(gA,""),i=e.length-n.length;return Wa(t,n,r*Math.pow(10,2*i))+Fr("%",i)}function kA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+kA(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function na(t,e,r){if(t.charCodeAt(0)===40&&!e.match(wA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?na("n",n,r):"("+na("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return qP(t,e,r);if(e.indexOf("%")!==-1)return YP(t,e,r);if(e.indexOf("E")!==-1)return kA(e,r);if(e.charCodeAt(0)===36)return"$"+na(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Rs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(vA))return HP(s,l,u);if(e.match(/^#+0+$/))return u+Rs(l,e.length-e.indexOf("0"));if(s=e.match(yA))return i=(""+r).replace(/^([^\.]+)$/,"$1."+oi(s[1])).replace(/\.$/,"."+oi(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Fr("0",oi(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Oo(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+na(t,e,-r):Oo(""+r)+"."+Fr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return na(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(na(t,e.replace(/[\\-]/g,""),r)),a=0,mu(mu(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(bA))return i=na(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Tp(l,Math.pow(10,a)-1,!1),i=""+u,d=Wa("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=Cp(o[2],a),d.length<s[4].length&&(d=oi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Tp(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?by(o[1],a)+s[2]+"/"+s[3]+Cp(o[2],a):Fr(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:oi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,m=e.length-i.length-h;return oi(e.substr(0,h)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+na(t,e,-r):Oo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Rs(0,3-v.length):"")+v})+"."+Rs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=Oo(""+l);return g!=="0"?u+g:"";default:if(e.match(/\.[0#?]*$/))return na(t,e.slice(0,e.lastIndexOf(".")),r)+oi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Wa(t,e,r){return(r|0)===r?na(t,e,r):ss(t,e,r)}function KP(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var SA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Uu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ep(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(SA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function XP(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",u,d,h,m="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Ep(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var g=t.charAt(++a),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=Pl(e,r,t.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Pl(e,r),u==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Pl(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",m="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",a+=5,m="h"):(x.t="t",++a),u==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(SA)){if(u==null&&(u=Pl(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Uu(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var w=0,S=0,T;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,l="h",w<1&&(w=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(S=Math.max(S,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",M;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=zP(i[a].t.charCodeAt(0),i[a].v,u,S),i[a].t="t";break;case"n":case"?":for(M=a+1;i[M]!=null&&((o=i[M].t)==="?"||o==="D"||(o===" "||o==="t")&&i[M+1]!=null&&(i[M+1].t==="?"||i[M+1].t==="t"&&i[M+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[M].v==="/"||i[M].v===" "&&i[M+1]!=null&&i[M+1].t=="?"));)i[a].v+=i[M].v,i[M]={v:"",t:";"},++M;_+=i[a].v,a=M-1;break;case"G":i[a].t="t",i[a].v=tc(e,r);break}var D="",O,E;if(_.length>0){_.charCodeAt(0)==40?(O=e<0&&_.charCodeAt(0)===45?-e:e,E=Wa("n",_,O)):(O=e<0&&n>1?-e:e,E=Wa("n",_,O),O<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),M=E.length-1;var A=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){A=a;break}var N=i.length;if(A===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(M>=i[a].v.length-1?(M-=i[a].v.length,i[a].v=E.substr(M+1,i[a].v.length)):M<0?i[a].v="":(i[a].v=E.substr(0,M+1),M=-1),i[a].t="t",N=a);M>=0&&N<i.length&&(i[N].v=E.substr(0,M+1)+i[N].v)}else if(A!==i.length&&E.indexOf("E")===-1){for(M=E.indexOf(".")-1,a=A;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(d+1);d>=0;--d)M>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(D=E.charAt(M--)+D);i[a].v=D,i[a].t="t",N=a}for(M>=0&&N<i.length&&(i[N].v=E.substr(0,M+1)+i[N].v),M=E.indexOf(".")+1,a=A;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==A)){for(d=i[a].v.indexOf(".")>-1&&a===A?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,d);d<i[a].v.length;++d)M<E.length&&(D+=E.charAt(M++));i[a].v=D,i[a].t="t",N=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(O=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Wa(i[a].t,i[a].v,O),i[a].t="t");var P="";for(a=0;a!==i.length;++a)i[a]!=null&&(P+=i[a].v);return P}var GS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qS(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function ZP(t,e){var r=KP(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(GS),o=r[1].match(GS);return qS(e,a)?[n,r[0]]:qS(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ps(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:It)[t],n==null&&(n=r.table&&r.table[US[t]]||It[US[t]]),n==null&&(n=FP[t]||"General");break}if(Ep(n,0))return tc(e,r);e instanceof Date&&(e=mA(e,r.date1904));var i=ZP(n,e);if(Ep(i[1]))return tc(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return XP(i[1],e,r,i[0])}function Vl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(It[r]==null){e<0&&(e=r);continue}if(It[r]==t){e=r;break}}e<0&&(e=391)}return It[e]=t,e}function _A(){It=OP()}var JP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},CA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function QP(t){var e=typeof t=="number"?It[t]:t;return e=e.replace(CA,"(\\d+)"),new RegExp("^"+e+"$")}function e3(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(CA)||[]).forEach(function(h,m){var g=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":a=g;break;case"s":l=g;break;case"m":a>=0?o=g:i=g;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var t3=(function(){var t={};t.version="1.2.0";function e(){for(var E=0,A=new Array(256),N=0;N!=256;++N)E=N,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,A[N]=E;return typeof Int32Array<"u"?new Int32Array(A):A}var r=e();function n(E){var A=0,N=0,P=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)B[P]=E[P];for(P=0;P!=256;++P)for(N=E[P],A=256+P;A<4096;A+=256)N=B[A]=N>>>8^E[N&255];var I=[];for(P=1;P!=16;++P)I[P-1]=typeof Int32Array<"u"?B.subarray(P*256,P*256+256):B.slice(P*256,P*256+256);return I}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],d=i[5],h=i[6],m=i[7],g=i[8],v=i[9],x=i[10],w=i[11],S=i[12],T=i[13],_=i[14];function M(E,A){for(var N=A^-1,P=0,B=E.length;P<B;)N=N>>>8^r[(N^E.charCodeAt(P++))&255];return~N}function D(E,A){for(var N=A^-1,P=E.length-15,B=0;B<P;)N=_[E[B++]^N&255]^T[E[B++]^N>>8&255]^S[E[B++]^N>>16&255]^w[E[B++]^N>>>24]^x[E[B++]]^v[E[B++]]^g[E[B++]]^m[E[B++]]^h[E[B++]]^d[E[B++]]^u[E[B++]]^l[E[B++]]^o[E[B++]]^a[E[B++]]^s[E[B++]]^r[E[B++]];for(P+=15;B<P;)N=N>>>8^r[(N^E[B++])&255];return~N}function O(E,A){for(var N=A^-1,P=0,B=E.length,I=0,ee=0;P<B;)I=E.charCodeAt(P++),I<128?N=N>>>8^r[(N^I)&255]:I<2048?(N=N>>>8^r[(N^(192|I>>6&31))&255],N=N>>>8^r[(N^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,ee=E.charCodeAt(P++)&1023,N=N>>>8^r[(N^(240|I>>8&7))&255],N=N>>>8^r[(N^(128|I>>2&63))&255],N=N>>>8^r[(N^(128|ee>>6&15|(I&3)<<4))&255],N=N>>>8^r[(N^(128|ee&63))&255]):(N=N>>>8^r[(N^(224|I>>12&15))&255],N=N>>>8^r[(N^(128|I>>6&63))&255],N=N>>>8^r[(N^(128|I&63))&255]);return~N}return t.table=r,t.bstr=M,t.buf=D,t.str=O,t})(),Kt=(function(){var e={};e.version="1.2.1";function r(L,Y){for(var V=L.split("/"),U=Y.split("/"),G=0,K=0,me=Math.min(V.length,U.length);G<me;++G){if(K=V[G].length-U[G].length)return K;if(V[G]!=U[G])return V[G]<U[G]?-1:1}return V.length-U.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(0,Y+1)}function i(L){if(L.charAt(L.length-1)=="/")return i(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(Y+1)}function s(L,Y){typeof Y=="string"&&(Y=new Date(Y));var V=Y.getHours();V=V<<6|Y.getMinutes(),V=V<<5|Y.getSeconds()>>>1,L.write_shift(2,V);var U=Y.getFullYear()-1980;U=U<<4|Y.getMonth()+1,U=U<<5|Y.getDate(),L.write_shift(2,U)}function a(L){var Y=L.read_shift(2)&65535,V=L.read_shift(2)&65535,U=new Date,G=V&31;V>>>=5;var K=V&15;V>>>=4,U.setMilliseconds(0),U.setFullYear(V+1980),U.setMonth(K-1),U.setDate(G);var me=Y&31;Y>>>=5;var Ee=Y&63;return Y>>>=6,U.setHours(Y),U.setMinutes(Ee),U.setSeconds(me<<1),U}function o(L){Mn(L,0);for(var Y={},V=0;L.l<=L.length-4;){var U=L.read_shift(2),G=L.read_shift(2),K=L.l+G,me={};switch(U){case 21589:V=L.read_shift(1),V&1&&(me.mtime=L.read_shift(4)),G>5&&(V&2&&(me.atime=L.read_shift(4)),V&4&&(me.ctime=L.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}L.l=K,Y[U]=me}return Y}var l;function u(){return l||(l={})}function d(L,Y){if(L[0]==80&&L[1]==75)return to(L,Y);if((L[0]|32)==109&&(L[1]|32)==105)return ul(L,Y);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var V=3,U=512,G=0,K=0,me=0,Ee=0,ge=0,ye=[],ke=L.slice(0,512);Mn(ke,0);var Re=h(ke);switch(V=Re[0],V){case 3:U=512;break;case 4:U=4096;break;case 0:if(Re[1]==0)return to(L,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}U!==512&&(ke=L.slice(0,U),Mn(ke,28));var Ge=L.slice(0,U);m(ke,V);var Ye=ke.read_shift(4,"i");if(V===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);ke.l+=4,me=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Ee=ke.read_shift(4,"i"),G=ke.read_shift(4,"i"),ge=ke.read_shift(4,"i"),K=ke.read_shift(4,"i");for(var Be=-1,Pe=0;Pe<109&&(Be=ke.read_shift(4,"i"),!(Be<0));++Pe)ye[Pe]=Be;var St=g(L,U);w(ge,K,St,U,ye);var or=T(St,me,ye,U);or[me].name="!Directory",G>0&&Ee!==ee&&(or[Ee].name="!MiniFAT"),or[ye[0]].name="!FAT",or.fat_addrs=ye,or.ssz=U;var Ut={},xr=[],ws=[],Us=[];_(me,or,St,xr,G,Ut,ws,Ee),v(ws,Us,xr),xr.shift();var Ki={FileIndex:ws,FullPaths:Us};return Y&&Y.raw&&(Ki.raw={header:Ge,sectors:St}),Ki}function h(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(oe,"Header Signature: "),L.l+=16;var Y=L.read_shift(2,"u");return[L.read_shift(2,"u"),Y]}function m(L,Y){var V=9;switch(L.l+=2,V=L.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function g(L,Y){for(var V=Math.ceil(L.length/Y)-1,U=[],G=1;G<V;++G)U[G-1]=L.slice(G*Y,(G+1)*Y);return U[V-1]=L.slice(V*Y),U}function v(L,Y,V){for(var U=0,G=0,K=0,me=0,Ee=0,ge=V.length,ye=[],ke=[];U<ge;++U)ye[U]=ke[U]=U,Y[U]=V[U];for(;Ee<ke.length;++Ee)U=ke[Ee],G=L[U].L,K=L[U].R,me=L[U].C,ye[U]===U&&(G!==-1&&ye[G]!==G&&(ye[U]=ye[G]),K!==-1&&ye[K]!==K&&(ye[U]=ye[K])),me!==-1&&(ye[me]=U),G!==-1&&U!=ye[U]&&(ye[G]=ye[U],ke.lastIndexOf(G)<Ee&&ke.push(G)),K!==-1&&U!=ye[U]&&(ye[K]=ye[U],ke.lastIndexOf(K)<Ee&&ke.push(K));for(U=1;U<ge;++U)ye[U]===U&&(K!==-1&&ye[K]!==K?ye[U]=ye[K]:G!==-1&&ye[G]!==G&&(ye[U]=ye[G]));for(U=1;U<ge;++U)if(L[U].type!==0){if(Ee=U,Ee!=ye[Ee])do Ee=ye[Ee],Y[U]=Y[Ee]+"/"+Y[U];while(Ee!==0&&ye[Ee]!==-1&&Ee!=ye[Ee]);ye[U]=-1}for(Y[0]+="/",U=1;U<ge;++U)L[U].type!==2&&(Y[U]+="/")}function x(L,Y,V){for(var U=L.start,G=L.size,K=[],me=U;V&&G>0&&me>=0;)K.push(Y.slice(me*I,me*I+I)),G-=I,me=Ol(V,me*4);return K.length===0?an(0):No(K).slice(0,L.size)}function w(L,Y,V,U,G){var K=ee;if(L===ee){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var me=V[L],Ee=(U>>>2)-1;if(!me)return;for(var ge=0;ge<Ee&&(K=Ol(me,ge*4))!==ee;++ge)G.push(K);w(Ol(me,U-4),Y-1,V,U,G)}}function S(L,Y,V,U,G){var K=[],me=[];G||(G=[]);var Ee=U-1,ge=0,ye=0;for(ge=Y;ge>=0;){G[ge]=!0,K[K.length]=ge,me.push(L[ge]);var ke=V[Math.floor(ge*4/U)];if(ye=ge*4&Ee,U<4+ye)throw new Error("FAT boundary crossed: "+ge+" 4 "+U);if(!L[ke])break;ge=Ol(L[ke],ye)}return{nodes:K,data:n_([me])}}function T(L,Y,V,U){var G=L.length,K=[],me=[],Ee=[],ge=[],ye=U-1,ke=0,Re=0,Ge=0,Ye=0;for(ke=0;ke<G;++ke)if(Ee=[],Ge=ke+Y,Ge>=G&&(Ge-=G),!me[Ge]){ge=[];var Be=[];for(Re=Ge;Re>=0;){Be[Re]=!0,me[Re]=!0,Ee[Ee.length]=Re,ge.push(L[Re]);var Pe=V[Math.floor(Re*4/U)];if(Ye=Re*4&ye,U<4+Ye)throw new Error("FAT boundary crossed: "+Re+" 4 "+U);if(!L[Pe]||(Re=Ol(L[Pe],Ye),Be[Re]))break}K[Ge]={nodes:Ee,data:n_([ge])}}return K}function _(L,Y,V,U,G,K,me,Ee){for(var ge=0,ye=U.length?2:0,ke=Y[L].data,Re=0,Ge=0,Ye;Re<ke.length;Re+=128){var Be=ke.slice(Re,Re+128);Mn(Be,64),Ge=Be.read_shift(2),Ye=Ty(Be,0,Ge-ye),U.push(Ye);var Pe={name:Ye,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},St=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);St!==0&&(Pe.ct=M(Be,Be.l-8));var or=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);or!==0&&(Pe.mt=M(Be,Be.l-8)),Pe.start=Be.read_shift(4,"i"),Pe.size=Be.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=ee,Pe.name=""),Pe.type===5?(ge=Pe.start,G>0&&ge!==ee&&(Y[ge].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",Y[Pe.start]===void 0&&(Y[Pe.start]=S(V,Pe.start,Y.fat_addrs,Y.ssz)),Y[Pe.start].name=Pe.name,Pe.content=Y[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ge!==ee&&Pe.start!==ee&&Y[ge]&&(Pe.content=x(Pe,Y[ge].data,(Y[Ee]||{}).data))),Pe.content&&Mn(Pe.content,0),K[Ye]=Pe,me.push(Pe)}}function M(L,Y){return new Date((Vi(L,Y+4)/1e7*Math.pow(2,32)+Vi(L,Y)/1e7-11644473600)*1e3)}function D(L,Y){return u(),d(l.readFileSync(L),Y)}function O(L,Y){var V=Y&&Y.type;switch(V||Wt&&Buffer.isBuffer(L)&&(V="buffer"),V||"base64"){case"file":return D(L,Y);case"base64":return d(Os(Gi(L)),Y);case"binary":return d(Os(L),Y)}return d(L,Y)}function E(L,Y){var V=Y||{},U=V.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=U+"/",L.FileIndex[0]={name:U,type:5}),V.CLSID&&(L.FileIndex[0].clsid=V.CLSID),A(L)}function A(L){var Y="Sh33tJ5";if(!Kt.find(L,"/"+Y)){var V=an(4);V[0]=55,V[1]=V[3]=50,V[2]=54,L.FileIndex.push({name:Y,type:2,content:V,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+Y),N(L)}}function N(L,Y){E(L);for(var V=!1,U=!1,G=L.FullPaths.length-1;G>=0;--G){var K=L.FileIndex[G];switch(K.type){case 0:U?V=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(K.R*K.L*K.C)&&(V=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!Y)){var me=new Date(1987,1,19),Ee=0,ge=Object.create?Object.create(null):{},ye=[];for(G=0;G<L.FullPaths.length;++G)ge[L.FullPaths[G]]=!0,L.FileIndex[G].type!==0&&ye.push([L.FullPaths[G],L.FileIndex[G]]);for(G=0;G<ye.length;++G){var ke=n(ye[G][0]);U=ge[ke],U||(ye.push([ke,{name:i(ke).replace("/",""),type:1,clsid:fe,ct:me,mt:me,content:null}]),ge[ke]=!0)}for(ye.sort(function(Ye,Be){return r(Ye[0],Be[0])}),L.FullPaths=[],L.FileIndex=[],G=0;G<ye.length;++G)L.FullPaths[G]=ye[G][0],L.FileIndex[G]=ye[G][1];for(G=0;G<ye.length;++G){var Re=L.FileIndex[G],Ge=L.FullPaths[G];if(Re.name=i(Ge).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||fe,G===0)Re.C=ye.length>1?1:-1,Re.size=0,Re.type=5;else if(Ge.slice(-1)=="/"){for(Ee=G+1;Ee<ye.length&&n(L.FullPaths[Ee])!=Ge;++Ee);for(Re.C=Ee>=ye.length?-1:Ee,Ee=G+1;Ee<ye.length&&n(L.FullPaths[Ee])!=n(Ge);++Ee);Re.R=Ee>=ye.length?-1:Ee,Re.type=1}else n(L.FullPaths[G+1]||"")==n(Ge)&&(Re.R=G+1),Re.type=2}}}function P(L,Y){var V=Y||{};if(V.fileType=="mad")return ka(L,V);switch(N(L),V.fileType){case"zip":return _n(L,V)}var U=(function(Ye){for(var Be=0,Pe=0,St=0;St<Ye.FileIndex.length;++St){var or=Ye.FileIndex[St];if(or.content){var Ut=or.content.length;Ut>0&&(Ut<4096?Be+=Ut+63>>6:Pe+=Ut+511>>9)}}for(var xr=Ye.FullPaths.length+3>>2,ws=Be+7>>3,Us=Be+127>>7,Ki=ws+Pe+xr+Us,Hr=Ki+127>>7,fl=Hr<=109?0:Math.ceil((Hr-109)/127);Ki+Hr+fl+127>>7>Hr;)fl=++Hr<=109?0:Math.ceil((Hr-109)/127);var vr=[1,fl,Hr,Us,xr,Pe,Be,0];return Ye.FileIndex[0].size=Be<<6,vr[7]=(Ye.FileIndex[0].start=vr[0]+vr[1]+vr[2]+vr[3]+vr[4]+vr[5])+(vr[6]+7>>3),vr})(L),G=an(U[7]<<9),K=0,me=0;{for(K=0;K<8;++K)G.write_shift(1,re[K]);for(K=0;K<8;++K)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),K=0;K<3;++K)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,U[2]),G.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:ee),G.write_shift(4,U[3]),G.write_shift(-4,U[1]?U[0]-1:ee),G.write_shift(4,U[1]),K=0;K<109;++K)G.write_shift(-4,K<U[2]?U[1]+K:-1)}if(U[1])for(me=0;me<U[1];++me){for(;K<236+me*127;++K)G.write_shift(-4,K<U[2]?U[1]+K:-1);G.write_shift(-4,me===U[1]-1?ee:me+1)}var Ee=function(Ye){for(me+=Ye;K<me-1;++K)G.write_shift(-4,K+1);Ye&&(++K,G.write_shift(-4,ee))};for(me=K=0,me+=U[1];K<me;++K)G.write_shift(-4,se.DIFSECT);for(me+=U[2];K<me;++K)G.write_shift(-4,se.FATSECT);Ee(U[3]),Ee(U[4]);for(var ge=0,ye=0,ke=L.FileIndex[0];ge<L.FileIndex.length;++ge)ke=L.FileIndex[ge],ke.content&&(ye=ke.content.length,!(ye<4096)&&(ke.start=me,Ee(ye+511>>9)));for(Ee(U[6]+7>>3);G.l&511;)G.write_shift(-4,se.ENDOFCHAIN);for(me=K=0,ge=0;ge<L.FileIndex.length;++ge)ke=L.FileIndex[ge],ke.content&&(ye=ke.content.length,!(!ye||ye>=4096)&&(ke.start=me,Ee(ye+63>>6)));for(;G.l&511;)G.write_shift(-4,se.ENDOFCHAIN);for(K=0;K<U[4]<<2;++K){var Re=L.FullPaths[K];if(!Re||Re.length===0){for(ge=0;ge<17;++ge)G.write_shift(4,0);for(ge=0;ge<3;++ge)G.write_shift(4,-1);for(ge=0;ge<12;++ge)G.write_shift(4,0);continue}ke=L.FileIndex[K],K===0&&(ke.start=ke.size?ke.start-1:ee);var Ge=K===0&&V.root||ke.name;if(ye=2*(Ge.length+1),G.write_shift(64,Ge,"utf16le"),G.write_shift(2,ye),G.write_shift(1,ke.type),G.write_shift(1,ke.color),G.write_shift(-4,ke.L),G.write_shift(-4,ke.R),G.write_shift(-4,ke.C),ke.clsid)G.write_shift(16,ke.clsid,"hex");else for(ge=0;ge<4;++ge)G.write_shift(4,0);G.write_shift(4,ke.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ke.start),G.write_shift(4,ke.size),G.write_shift(4,0)}for(K=1;K<L.FileIndex.length;++K)if(ke=L.FileIndex[K],ke.size>=4096)if(G.l=ke.start+1<<9,Wt&&Buffer.isBuffer(ke.content))ke.content.copy(G,G.l,0,ke.size),G.l+=ke.size+511&-512;else{for(ge=0;ge<ke.size;++ge)G.write_shift(1,ke.content[ge]);for(;ge&511;++ge)G.write_shift(1,0)}for(K=1;K<L.FileIndex.length;++K)if(ke=L.FileIndex[K],ke.size>0&&ke.size<4096)if(Wt&&Buffer.isBuffer(ke.content))ke.content.copy(G,G.l,0,ke.size),G.l+=ke.size+63&-64;else{for(ge=0;ge<ke.size;++ge)G.write_shift(1,ke.content[ge]);for(;ge&63;++ge)G.write_shift(1,0)}if(Wt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function B(L,Y){var V=L.FullPaths.map(function(ge){return ge.toUpperCase()}),U=V.map(function(ge){var ye=ge.split("/");return ye[ye.length-(ge.slice(-1)=="/"?2:1)]}),G=!1;Y.charCodeAt(0)===47?(G=!0,Y=V[0].slice(0,-1)+Y):G=Y.indexOf("/")!==-1;var K=Y.toUpperCase(),me=G===!0?V.indexOf(K):U.indexOf(K);if(me!==-1)return L.FileIndex[me];var Ee=!K.match(Wf);for(K=K.replace(ui,""),Ee&&(K=K.replace(Wf,"!")),me=0;me<V.length;++me)if((Ee?V[me].replace(Wf,"!"):V[me]).replace(ui,"")==K||(Ee?U[me].replace(Wf,"!"):U[me]).replace(ui,"")==K)return L.FileIndex[me];return null}var I=64,ee=-2,oe="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(L,Y,V){u();var U=P(L,V);l.writeFileSync(Y,U)}function H(L){for(var Y=new Array(L.length),V=0;V<L.length;++V)Y[V]=String.fromCharCode(L[V]);return Y.join("")}function ve(L,Y){var V=P(L,Y);switch(Y&&Y.type||"buffer"){case"file":return u(),l.writeFileSync(Y.filename,V),V;case"binary":return typeof V=="string"?V:H(V);case"base64":return jS(typeof V=="string"?V:H(V));case"buffer":if(Wt)return Buffer.isBuffer(V)?V:fc(V);case"array":return typeof V=="string"?Os(V):V}return V}var W;function F(L){try{var Y=L.InflateRaw,V=new Y;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)W=L;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function X(L,Y){if(!W)return Sn(L,Y);var V=W.InflateRaw,U=new V,G=U._processChunk(L.slice(L.l),U._finishFlushFlag);return L.l+=U.bytesRead,G}function Z(L){return W?W.deflateRawSync(L):rt(L)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(L){var Y=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var ue=typeof Uint8Array<"u",Se=ue?new Uint8Array(256):[],ze=0;ze<256;++ze)Se[ze]=pe(ze);function j(L,Y){var V=Se[L&255];return Y<=8?V>>>8-Y:(V=V<<8|Se[L>>8&255],Y<=16?V>>>16-Y:(V=V<<8|Se[L>>16&255],V>>>24-Y))}function tt(L,Y){var V=Y&7,U=Y>>>3;return(L[U]|(V<=6?0:L[U+1]<<8))>>>V&3}function Ne(L,Y){var V=Y&7,U=Y>>>3;return(L[U]|(V<=5?0:L[U+1]<<8))>>>V&7}function qe(L,Y){var V=Y&7,U=Y>>>3;return(L[U]|(V<=4?0:L[U+1]<<8))>>>V&15}function Le(L,Y){var V=Y&7,U=Y>>>3;return(L[U]|(V<=3?0:L[U+1]<<8))>>>V&31}function Te(L,Y){var V=Y&7,U=Y>>>3;return(L[U]|(V<=1?0:L[U+1]<<8))>>>V&127}function at(L,Y,V){var U=Y&7,G=Y>>>3,K=(1<<V)-1,me=L[G]>>>U;return V<8-U||(me|=L[G+1]<<8-U,V<16-U)||(me|=L[G+2]<<16-U,V<24-U)||(me|=L[G+3]<<24-U),me&K}function gt(L,Y,V){var U=Y&7,G=Y>>>3;return U<=5?L[G]|=(V&7)<<U:(L[G]|=V<<U&255,L[G+1]=(V&7)>>8-U),Y+3}function J(L,Y,V){var U=Y&7,G=Y>>>3;return V=(V&1)<<U,L[G]|=V,Y+1}function le(L,Y,V){var U=Y&7,G=Y>>>3;return V<<=U,L[G]|=V&255,V>>>=8,L[G+1]=V,Y+8}function be(L,Y,V){var U=Y&7,G=Y>>>3;return V<<=U,L[G]|=V&255,V>>>=8,L[G+1]=V&255,L[G+2]=V>>>8,Y+16}function Ve(L,Y){var V=L.length,U=2*V>Y?2*V:Y+5,G=0;if(V>=Y)return L;if(Wt){var K=zS(U);if(L.copy)L.copy(K);else for(;G<L.length;++G)K[G]=L[G];return K}else if(ue){var me=new Uint8Array(U);if(me.set)me.set(L);else for(;G<V;++G)me[G]=L[G];return me}return L.length=U,L}function Me(L){for(var Y=new Array(L),V=0;V<L;++V)Y[V]=0;return Y}function Ae(L,Y,V){var U=1,G=0,K=0,me=0,Ee=0,ge=L.length,ye=ue?new Uint16Array(32):Me(32);for(K=0;K<32;++K)ye[K]=0;for(K=ge;K<V;++K)L[K]=0;ge=L.length;var ke=ue?new Uint16Array(ge):Me(ge);for(K=0;K<ge;++K)ye[G=L[K]]++,U<G&&(U=G),ke[K]=0;for(ye[0]=0,K=1;K<=U;++K)ye[K+16]=Ee=Ee+ye[K-1]<<1;for(K=0;K<ge;++K)Ee=L[K],Ee!=0&&(ke[K]=ye[Ee+16]++);var Re=0;for(K=0;K<ge;++K)if(Re=L[K],Re!=0)for(Ee=j(ke[K],U)>>U-Re,me=(1<<U+4-Re)-1;me>=0;--me)Y[Ee|me<<Re]=Re&15|K<<4;return U}var $e=ue?new Uint16Array(512):Me(512),et=ue?new Uint16Array(32):Me(32);if(!ue){for(var st=0;st<512;++st)$e[st]=0;for(st=0;st<32;++st)et[st]=0}(function(){for(var L=[],Y=0;Y<32;Y++)L.push(5);Ae(L,et,32);var V=[];for(Y=0;Y<=143;Y++)V.push(8);for(;Y<=255;Y++)V.push(9);for(;Y<=279;Y++)V.push(7);for(;Y<=287;Y++)V.push(8);Ae(V,$e,288)})();var Nt=(function(){for(var Y=ue?new Uint8Array(32768):[],V=0,U=0;V<Ce.length-1;++V)for(;U<Ce[V+1];++U)Y[U]=V;for(;U<32768;++U)Y[U]=29;var G=ue?new Uint8Array(259):[];for(V=0,U=0;V<ce.length-1;++V)for(;U<ce[V+1];++U)G[U]=V;function K(Ee,ge){for(var ye=0;ye<Ee.length;){var ke=Math.min(65535,Ee.length-ye),Re=ye+ke==Ee.length;for(ge.write_shift(1,+Re),ge.write_shift(2,ke),ge.write_shift(2,~ke&65535);ke-- >0;)ge[ge.l++]=Ee[ye++]}return ge.l}function me(Ee,ge){for(var ye=0,ke=0,Re=ue?new Uint16Array(32768):[];ke<Ee.length;){var Ge=Math.min(65535,Ee.length-ke);if(Ge<10){for(ye=gt(ge,ye,+(ke+Ge==Ee.length)),ye&7&&(ye+=8-(ye&7)),ge.l=ye/8|0,ge.write_shift(2,Ge),ge.write_shift(2,~Ge&65535);Ge-- >0;)ge[ge.l++]=Ee[ke++];ye=ge.l*8;continue}ye=gt(ge,ye,+(ke+Ge==Ee.length)+2);for(var Ye=0;Ge-- >0;){var Be=Ee[ke];Ye=(Ye<<5^Be)&32767;var Pe=-1,St=0;if((Pe=Re[Ye])&&(Pe|=ke&-32768,Pe>ke&&(Pe-=32768),Pe<ke))for(;Ee[Pe+St]==Ee[ke+St]&&St<250;)++St;if(St>2){Be=G[St],Be<=22?ye=le(ge,ye,Se[Be+1]>>1)-1:(le(ge,ye,3),ye+=5,le(ge,ye,Se[Be-23]>>5),ye+=3);var or=Be<8?0:Be-4>>2;or>0&&(be(ge,ye,St-ce[Be]),ye+=or),Be=Y[ke-Pe],ye=le(ge,ye,Se[Be]>>3),ye-=3;var Ut=Be<4?0:Be-2>>1;Ut>0&&(be(ge,ye,ke-Pe-Ce[Be]),ye+=Ut);for(var xr=0;xr<St;++xr)Re[Ye]=ke&32767,Ye=(Ye<<5^Ee[ke])&32767,++ke;Ge-=St-1}else Be<=143?Be=Be+48:ye=J(ge,ye,1),ye=le(ge,ye,Se[Be]),Re[Ye]=ke&32767,++ke}ye=le(ge,ye,0)-1}return ge.l=(ye+7)/8|0,ge.l}return function(ge,ye){return ge.length<8?K(ge,ye):me(ge,ye)}})();function rt(L){var Y=an(50+Math.floor(L.length*1.1)),V=Nt(L,Y);return Y.slice(0,V)}var Tt=ue?new Uint16Array(32768):Me(32768),ar=ue?new Uint16Array(32768):Me(32768),$t=ue?new Uint16Array(128):Me(128),Mr=1,ba=1;function Pn(L,Y){var V=Le(L,Y)+257;Y+=5;var U=Le(L,Y)+1;Y+=5;var G=qe(L,Y)+4;Y+=4;for(var K=0,me=ue?new Uint8Array(19):Me(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,ye=ue?new Uint8Array(8):Me(8),ke=ue?new Uint8Array(8):Me(8),Re=me.length,Ge=0;Ge<G;++Ge)me[q[Ge]]=K=Ne(L,Y),ge<K&&(ge=K),ye[K]++,Y+=3;var Ye=0;for(ye[0]=0,Ge=1;Ge<=ge;++Ge)ke[Ge]=Ye=Ye+ye[Ge-1]<<1;for(Ge=0;Ge<Re;++Ge)(Ye=me[Ge])!=0&&(Ee[Ge]=ke[Ye]++);var Be=0;for(Ge=0;Ge<Re;++Ge)if(Be=me[Ge],Be!=0){Ye=Se[Ee[Ge]]>>8-Be;for(var Pe=(1<<7-Be)-1;Pe>=0;--Pe)$t[Ye|Pe<<Be]=Be&7|Ge<<3}var St=[];for(ge=1;St.length<V+U;)switch(Ye=$t[Te(L,Y)],Y+=Ye&7,Ye>>>=3){case 16:for(K=3+tt(L,Y),Y+=2,Ye=St[St.length-1];K-- >0;)St.push(Ye);break;case 17:for(K=3+Ne(L,Y),Y+=3;K-- >0;)St.push(0);break;case 18:for(K=11+Te(L,Y),Y+=7;K-- >0;)St.push(0);break;default:St.push(Ye),ge<Ye&&(ge=Ye);break}var or=St.slice(0,V),Ut=St.slice(V);for(Ge=V;Ge<286;++Ge)or[Ge]=0;for(Ge=U;Ge<30;++Ge)Ut[Ge]=0;return Mr=Ae(or,Tt,286),ba=Ae(Ut,ar,30),Y}function xi(L,Y){if(L[0]==3&&!(L[1]&3))return[Xo(Y),2];for(var V=0,U=0,G=zS(Y||1<<18),K=0,me=G.length>>>0,Ee=0,ge=0;(U&1)==0;){if(U=Ne(L,V),V+=3,U>>>1)U>>1==1?(Ee=9,ge=5):(V=Pn(L,V),Ee=Mr,ge=ba);else{V&7&&(V+=8-(V&7));var ye=L[V>>>3]|L[(V>>>3)+1]<<8;if(V+=32,ye>0)for(!Y&&me<K+ye&&(G=Ve(G,K+ye),me=G.length);ye-- >0;)G[K++]=L[V>>>3],V+=8;continue}for(;;){!Y&&me<K+32767&&(G=Ve(G,K+32767),me=G.length);var ke=at(L,V,Ee),Re=U>>>1==1?$e[ke]:Tt[ke];if(V+=Re&15,Re>>>=4,(Re>>>8&255)===0)G[K++]=Re;else{if(Re==256)break;Re-=257;var Ge=Re<8?0:Re-4>>2;Ge>5&&(Ge=0);var Ye=K+ce[Re];Ge>0&&(Ye+=at(L,V,Ge),V+=Ge),ke=at(L,V,ge),Re=U>>>1==1?et[ke]:ar[ke],V+=Re&15,Re>>>=4;var Be=Re<4?0:Re-2>>1,Pe=Ce[Re];for(Be>0&&(Pe+=at(L,V,Be),V+=Be),!Y&&me<Ye&&(G=Ve(G,Ye+100),me=G.length);K<Ye;)G[K]=G[K-Pe],++K}}}return Y?[G,V+7>>>3]:[G.slice(0,K),V+7>>>3]}function Sn(L,Y){var V=L.slice(L.l||0),U=xi(V,Y);return L.l+=U[1],U[0]}function Fi(L,Y){if(L)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function to(L,Y){var V=L;Mn(V,0);var U=[],G=[],K={FileIndex:U,FullPaths:G};E(K,{root:Y.root});for(var me=V.length-4;(V[me]!=80||V[me+1]!=75||V[me+2]!=5||V[me+3]!=6)&&me>=0;)--me;V.l=me+4,V.l+=4;var Ee=V.read_shift(2);V.l+=6;var ge=V.read_shift(4);for(V.l=ge,me=0;me<Ee;++me){V.l+=20;var ye=V.read_shift(4),ke=V.read_shift(4),Re=V.read_shift(2),Ge=V.read_shift(2),Ye=V.read_shift(2);V.l+=8;var Be=V.read_shift(4),Pe=o(V.slice(V.l+Re,V.l+Re+Ge));V.l+=Re+Ge+Ye;var St=V.l;V.l=Be+4,Vs(V,ye,ke,K,Pe),V.l=St}return K}function Vs(L,Y,V,U,G){L.l+=2;var K=L.read_shift(2),me=L.read_shift(2),Ee=a(L);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var ge=L.read_shift(4),ye=L.read_shift(4),ke=L.read_shift(4),Re=L.read_shift(2),Ge=L.read_shift(2),Ye="",Be=0;Be<Re;++Be)Ye+=String.fromCharCode(L[L.l++]);if(Ge){var Pe=o(L.slice(L.l,L.l+Ge));(Pe[21589]||{}).mt&&(Ee=Pe[21589].mt),((G||{})[21589]||{}).mt&&(Ee=G[21589].mt)}L.l+=Ge;var St=L.slice(L.l,L.l+ye);switch(me){case 8:St=X(L,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var or=!1;K&8&&(ge=L.read_shift(4),ge==134695760&&(ge=L.read_shift(4),or=!0),ye=L.read_shift(4),ke=L.read_shift(4)),ye!=Y&&Fi(or,"Bad compressed size: "+Y+" != "+ye),ke!=V&&Fi(or,"Bad uncompressed size: "+V+" != "+ke),vs(U,Ye,St,{unsafe:!0,mt:Ee})}function _n(L,Y){var V=Y||{},U=[],G=[],K=an(1),me=V.compression?8:0,Ee=0,ge=0,ye=0,ke=0,Re=0,Ge=L.FullPaths[0],Ye=Ge,Be=L.FileIndex[0],Pe=[],St=0;for(ge=1;ge<L.FullPaths.length;++ge)if(Ye=L.FullPaths[ge].slice(Ge.length),Be=L.FileIndex[ge],!(!Be.size||!Be.content||Ye=="Sh33tJ5")){var or=ke,Ut=an(Ye.length);for(ye=0;ye<Ye.length;++ye)Ut.write_shift(1,Ye.charCodeAt(ye)&127);Ut=Ut.slice(0,Ut.l),Pe[Re]=t3.buf(Be.content,0);var xr=Be.content;me==8&&(xr=Z(xr)),K=an(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,Ee),K.write_shift(2,me),Be.mt?s(K,Be.mt):K.write_shift(4,0),K.write_shift(-4,Pe[Re]),K.write_shift(4,xr.length),K.write_shift(4,Be.content.length),K.write_shift(2,Ut.length),K.write_shift(2,0),ke+=K.length,U.push(K),ke+=Ut.length,U.push(Ut),ke+=xr.length,U.push(xr),K=an(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,Ee),K.write_shift(2,me),K.write_shift(4,0),K.write_shift(-4,Pe[Re]),K.write_shift(4,xr.length),K.write_shift(4,Be.content.length),K.write_shift(2,Ut.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,or),St+=K.l,G.push(K),St+=Ut.length,G.push(Ut),++Re}return K=an(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Re),K.write_shift(2,Re),K.write_shift(4,St),K.write_shift(4,ke),K.write_shift(2,0),No([No(U),No(G),K])}var vi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function cl(L,Y){if(L.ctype)return L.ctype;var V=L.name||"",U=V.match(/\.([^\.]+)$/);return U&&vi[U[1]]||Y&&(U=(V=Y).match(/[\.\\]([^\.\\])+$/),U&&vi[U[1]])?vi[U[1]]:"application/octet-stream"}function yc(L){for(var Y=jS(L),V=[],U=0;U<Y.length;U+=76)V.push(Y.slice(U,U+76));return V.join(`\r
`)+`\r
`}function wc(L){var Y=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var ke=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],U=Y.split(`\r
`),G=0;G<U.length;++G){var K=U[G];if(K.length==0){V.push("");continue}for(var me=0;me<K.length;){var Ee=76,ge=K.slice(me,me+Ee);ge.charAt(Ee-1)=="="?Ee--:ge.charAt(Ee-2)=="="?Ee-=2:ge.charAt(Ee-3)=="="&&(Ee-=3),ge=K.slice(me,me+Ee),me+=Ee,me<K.length&&(ge+="="),V.push(ge)}}return V.join(`\r
`)}function bc(L){for(var Y=[],V=0;V<L.length;++V){for(var U=L[V];V<=L.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+L[++V];Y.push(U)}for(var G=0;G<Y.length;++G)Y[G]=Y[G].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Os(Y.join(`\r
`))}function ro(L,Y,V){for(var U="",G="",K="",me,Ee=0;Ee<10;++Ee){var ge=Y[Ee];if(!ge||ge.match(/^\s*$/))break;var ye=ge.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":U=ye[2].trim();break;case"content-type":K=ye[2].trim();break;case"content-transfer-encoding":G=ye[2].trim();break}}switch(++Ee,G.toLowerCase()){case"base64":me=Os(Gi(Y.slice(Ee).join("")));break;case"quoted-printable":me=bc(Y.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ke=vs(L,U.slice(V.length),me,{unsafe:!0});K&&(ke.ctype=K)}function ul(L,Y){if(H(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=Y&&Y.root||"",U=(Wt&&Buffer.isBuffer(L)?L.toString("binary"):H(L)).split(`\r
`),G=0,K="";for(G=0;G<U.length;++G)if(K=U[G],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),V||(V=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),K.slice(0,V.length)!=V););var me=(U[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Ee="--"+(me[1]||""),ge=[],ye=[],ke={FileIndex:ge,FullPaths:ye};E(ke);var Re,Ge=0;for(G=0;G<U.length;++G){var Ye=U[G];Ye!==Ee&&Ye!==Ee+"--"||(Ge++&&ro(ke,U.slice(Re,G),V),Re=G)}return ke}function ka(L,Y){var V=Y||{},U=V.boundary||"SheetJS";U="------="+U;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],K=L.FullPaths[0],me=K,Ee=L.FileIndex[0],ge=1;ge<L.FullPaths.length;++ge)if(me=L.FullPaths[ge].slice(K.length),Ee=L.FileIndex[ge],!(!Ee.size||!Ee.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(St){return"_x"+St.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(St){return"_u"+St.charCodeAt(0).toString(16)+"_"});for(var ye=Ee.content,ke=Wt&&Buffer.isBuffer(ye)?ye.toString("binary"):H(ye),Re=0,Ge=Math.min(1024,ke.length),Ye=0,Be=0;Be<=Ge;++Be)(Ye=ke.charCodeAt(Be))>=32&&Ye<128&&++Re;var Pe=Re>=Ge*4/5;G.push(U),G.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+me),G.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),G.push("Content-Type: "+cl(Ee,me)),G.push(""),G.push(Pe?wc(ke):yc(ke))}return G.push(U+`--\r
`),G.join(`\r
`)}function no(L){var Y={};return E(Y,L),Y}function vs(L,Y,V,U){var G=U&&U.unsafe;G||E(L);var K=!G&&Kt.find(L,Y);if(!K){var me=L.FullPaths[0];Y.slice(0,me.length)==me?me=Y:(me.slice(-1)!="/"&&(me+="/"),me=(me+Y).replace("//","/")),K={name:i(Y),type:2},L.FileIndex.push(K),L.FullPaths.push(me),G||Kt.utils.cfb_gc(L)}return K.content=V,K.size=V?V.length:0,U&&(U.CLSID&&(K.clsid=U.CLSID),U.mt&&(K.mt=U.mt),U.ct&&(K.ct=U.ct)),K}function $s(L,Y){E(L);var V=Kt.find(L,Y);if(V){for(var U=0;U<L.FileIndex.length;++U)if(L.FileIndex[U]==V)return L.FileIndex.splice(U,1),L.FullPaths.splice(U,1),!0}return!1}function ys(L,Y,V){E(L);var U=Kt.find(L,Y);if(U){for(var G=0;G<L.FileIndex.length;++G)if(L.FileIndex[G]==U)return L.FileIndex[G].name=i(V),L.FullPaths[G]=V,!0}return!1}function Ii(L){N(L,!0)}return e.find=B,e.read=O,e.parse=d,e.write=ve,e.writeFile=xe,e.utils={cfb_new:no,cfb_add:vs,cfb_del:$s,cfb_mov:ys,cfb_gc:Ii,ReadShift:id,CheckField:qA,prep_blob:Mn,bconcat:No,use_zlib:F,_deflateRaw:rt,_inflateRaw:Sn,consts:se},e})();function r3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function pa(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Sy(t){for(var e=[],r=pa(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Ap=new Date(1899,11,30,0,0,0);function fi(t,e){var r=t.getTime(),n=Ap.getTime()+(t.getTimezoneOffset()-Ap.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var EA=new Date,n3=Ap.getTime()+(EA.getTimezoneOffset()-Ap.getTimezoneOffset())*6e4,YS=EA.getTimezoneOffset();function bm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+n3),e.getTimezoneOffset()!==YS&&e.setTime(e.getTime()+(e.getTimezoneOffset()-YS)*6e4),e}function i3(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var KS=new Date("2017-02-19T19:06:09.000Z"),TA=isNaN(KS.getFullYear())?new Date("2/19/17"):KS,s3=TA.getFullYear()==2017;function vn(t,e){var r=new Date(t);if(s3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(TA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function rc(t,e){if(Wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return qf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return qf(hA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return qf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return qf(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function In(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=In(t[r]));return e}function Fr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ps(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var a3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&a3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var o3=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}})();function AA(t){return t?t.content&&t.type?rc(t.content,!0):t.data?Hf(t.data):t.asNodeBuffer&&Wt?Hf(t.asNodeBuffer().toString("binary")):t.asBinary?Hf(t.asBinary()):t._data&&t._data.getContent?Hf(rc(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function NA(t){if(!t)return null;if(t.data)return LS(t.data);if(t.asNodeBuffer&&Wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?LS(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function l3(t){return t&&t.name.slice(-4)===".bin"?NA(t):AA(t)}function as(t,e){for(var r=t.FullPaths||pa(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function _y(t,e){var r=as(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Yr(t,e,r){if(!r)return l3(_y(t,e));if(!e)return null;try{return Yr(t,e)}catch{return null}}function Ui(t,e,r){if(!r)return AA(_y(t,e));if(!e)return null;try{return Ui(t,e)}catch{return null}}function c3(t,e,r){return NA(_y(t,e))}function XS(t){for(var e=t.FullPaths||pa(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function u3(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Wt?n=fc(r):n=NP(r),Kt.utils.cfb_add(t,e,n)}Kt.utils.cfb_add(t,e,r)}else t.file(e,r)}function MA(t,e){switch(e.type){case"base64":return Kt.read(t,{type:"base64"});case"binary":return Kt.read(t,{type:"binary"});case"buffer":case"array":return Kt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Gf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var DA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,f3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ZS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,d3=/<[^>]*>/g,ti=DA.match(ZS)?ZS:d3,h3=/<\w*:/,p3=/<(\/?)\w+:/;function Et(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(f3),o=0,l="",u=0,d="",h="",m=1;if(a)for(u=0;u!=a.length;++u){for(h=a[u],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(d=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(m=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+m,h.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=l,n[g.toLowerCase()]=l}}return n}function va(t){return t.replace(p3,"<$1")}var OA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},m3=Sy(OA),Qt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return OA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}})(),g3=/[&<>'"]/g,x3=/[\u0000-\u001f]/g;function Cy(t){var e=t+"";return e.replace(g3,function(r){return m3[r]}).replace(/\n/g,"<br/>").replace(x3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var JS=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function Cr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Lx(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function QS(t){var e=Xo(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function e_(t){return fc(t,"binary").toString("utf8")}var S0="foo bar baz",gr=Wt&&(e_(S0)==Lx(S0)&&e_||QS(S0)==Lx(S0)&&QS)||Lx,qf=Wt?function(t){return fc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Ad=(function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),FA=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})(),v3=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),y3=/<\/?(?:vt:)?variant>/g,w3=/<(?:vt:)([^>]*)>([\s\S]*)</;function t_(t,e){var r=Et(t),n=t.match(v3(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(y3,"").match(w3);a&&i.push({v:gr(a[2]),t:a[1]})}),i}var b3=/(^\s|\s$|\n)/;function k3(t){return pa(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function S3(t,e,r){return"<"+t+(r!=null?k3(r):"")+(e!=null?(e.match(b3)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Ey(t){if(Wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return gr(dc(wy(t)));throw new Error("Bad input format: expected Buffer or string")}var Nd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_3={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},C3=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function E3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function T3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var r_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},n_=Wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:fc(e)})):r_(t)}:r_,i_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode($a(t,i)));return n.join("").replace(ui,"")},Ty=Wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ui,""):i_(t,e,r)}:i_,s_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},IA=Wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):s_(t,e,r)}:s_,a_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(ou(t,i)));return n.join("")},th=Wt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):a_(e,r,n)}:a_,RA=function(t,e){var r=Vi(t,e);return r>0?th(t,e+4,e+4+r-1):""},PA=RA,LA=function(t,e){var r=Vi(t,e);return r>0?th(t,e+4,e+4+r-1):""},BA=LA,jA=function(t,e){var r=2*Vi(t,e);return r>0?th(t,e+4,e+4+r-1):""},zA=jA,VA=function(e,r){var n=Vi(e,r);return n>0?Ty(e,r+4,r+4+n):""},$A=VA,UA=function(t,e){var r=Vi(t,e);return r>0?th(t,e+4,e+4+r):""},HA=UA,WA=function(t,e){return E3(t,e)},Np=WA,GA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Wt&&(PA=function(e,r){if(!Buffer.isBuffer(e))return RA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},BA=function(e,r){if(!Buffer.isBuffer(e))return LA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},zA=function(e,r){if(!Buffer.isBuffer(e))return jA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},$A=function(e,r){if(!Buffer.isBuffer(e))return VA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},HA=function(e,r){if(!Buffer.isBuffer(e))return UA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Np=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):WA(e,r)},GA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ou=function(t,e){return t[e]},$a=function(t,e){return t[e+1]*256+t[e]},A3=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Vi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ol=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},N3=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function id(t,e){var r="",n,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,Wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode($a(this,u)),u+=2;t*=2;break;case"utf8":r=th(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ty(this,this.l,this.l+t);break;case"wstr":return id.call(this,t,"dbcs");case"lpstr-ansi":r=PA(this,this.l),t=4+Vi(this,this.l);break;case"lpstr-cp":r=BA(this,this.l),t=4+Vi(this,this.l);break;case"lpwstr":r=zA(this,this.l),t=4+2*Vi(this,this.l);break;case"lpp4":t=4+Vi(this,this.l),r=$A(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Vi(this,this.l),r=HA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=ou(this,this.l+t++))!==0;)s.push(k0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=$a(this,this.l+t))!==0;)s.push(k0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=ou(this,u),this.l=u+1,o=id.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(k0($a(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=ou(this,u),this.l=u+1,o=id.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(k0(ou(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=ou(this,this.l),this.l++,n;case 2:return n=(e==="i"?A3:$a)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Ol:N3)(this,this.l),this.l+=4,n):(i=Vi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Np(this,this.l):i=Np([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=IA(this,this.l,t);break}}return this.l+=t,r}var M3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},D3=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},O3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function F3(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)O3(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,M3(this,e,this.l);break;case 8:if(n=8,r==="f"){T3(this,e,this.l);break}case 16:break;case-4:n=4,D3(this,e,this.l);break}return this.l+=n,this}function qA(t,e){var r=IA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Mn(t,e){t.l=e,t.read_shift=id,t.chk=qA,t.write_shift=F3}function Qn(t,e){t.l+=e}function an(t){var e=Xo(t);return Mn(e,0),e}function Qa(t,e,r){if(t){var n,i,s;Mn(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Rp[o]||Rp[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var d=u.f&&u.f(t,s,r);if(t.l=l,e(d,u,o))return}}}function Xv(){var t=[],e=Wt?256:2048,r=function(u){var d=an(u);return Mn(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},a=function(){return i(),No(t)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function sd(t,e,r){var n=In(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function o_(t,e,r){var n=In(t);return n.s=sd(n.s,e.s,r),n.e=sd(n.e,e.s,r),n}function ad(t,e){if(t.cRel&&t.c<0)for(t=In(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=In(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Dt(t);return!t.cRel&&t.cRel!=null&&(r=P3(r)),!t.rRel&&t.rRel!=null&&(r=I3(r)),r}function Bx(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+cn(t.s.c)+":"+(t.e.cRel?"":"$")+cn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Rn(t.s.r)+":"+(t.e.rRel?"":"$")+Rn(t.e.r):ad(t.s,e.biff)+":"+ad(t.e,e.biff)}function Ay(t){return parseInt(R3(t),10)-1}function Rn(t){return""+(t+1)}function I3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function R3(t){return t.replace(/\$(\d+)$/,"$1")}function Ny(t){for(var e=L3(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function cn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function P3(t){return t.replace(/^([A-Z])/,"$$$1")}function L3(t){return t.replace(/^\$([A-Z])/,"$1")}function B3(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ci(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Dt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Hu(t){var e=t.indexOf(":");return e==-1?{s:ci(t),e:ci(t)}:{s:ci(t.slice(0,e)),e:ci(t.slice(e+1))}}function Xt(t,e){return typeof e>"u"||typeof e=="number"?Xt(t.s,t.e):(typeof t!="string"&&(t=Dt(t)),typeof e!="string"&&(e=Dt(e)),t==e?t:t+":"+e)}function Rr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function l_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ps(t.z,r?fi(e):e)}catch{}try{return t.w=ps((t.XF||{}).numFmtId||(r?14:0),r?fi(e):e)}catch{return""+e}}function Ka(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mc[t.v]||t.v:e==null?l_(t,t.v):l_(t,e))}function il(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function YA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ci(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Rr(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(u.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[h].length;++m)if(!(typeof e[h][m]>"u")){var g={v:e[h][m]},v=a+h,x=o+m;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),e[h][m]&&typeof e[h][m]=="object"&&!Array.isArray(e[h][m])&&!(e[h][m]instanceof Date))g=e[h][m];else if(Array.isArray(g.v)&&(g.f=e[h][m][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||It[14],n.cellDates?(g.t="d",g.w=ps(g.z,fi(g.v))):(g.t="n",g.v=fi(g.v),g.w=ps(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(g.z=s[v][x].z),s[v][x]=g;else{var w=Dt({c:x,r:v});s[w]&&s[w].z&&(g.z=s[w].z),s[w]=g}}}return u.s.c<1e7&&(s["!ref"]=Xt(u)),s}function Wu(t,e){return YA(null,t,e)}function j3(t){return t.read_shift(4,"i")}function Jn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function z3(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function My(t,e){var r=t.l,n=t.read_shift(1),i=Jn(t),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(z3(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var V3=My;function gs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function hc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var $3=Jn;function Dy(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var U3=Jn,Zv=Dy;function Oy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Np([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ol(e,0)>>2;return r?i/100:i}function KA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var pc=KA;function qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function H3(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=$l[i];u&&(e.rgb=Dd(u));break;case 2:e.rgb=Dd([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function W3(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function XA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function G3(t){return XA(t,1)}function q3(t){return XA(t,2)}var Fy=2,Ai=3,_0=11,c_=12,Mp=19,C0=64,Y3=65,K3=71,X3=4108,Z3=4126,gn=80,ZA=81,J3=[gn,ZA],Q3={1:{n:"CodePage",t:Fy},2:{n:"Category",t:gn},3:{n:"PresentationFormat",t:gn},4:{n:"ByteCount",t:Ai},5:{n:"LineCount",t:Ai},6:{n:"ParagraphCount",t:Ai},7:{n:"SlideCount",t:Ai},8:{n:"NoteCount",t:Ai},9:{n:"HiddenCount",t:Ai},10:{n:"MultimediaClipCount",t:Ai},11:{n:"ScaleCrop",t:_0},12:{n:"HeadingPairs",t:X3},13:{n:"TitlesOfParts",t:Z3},14:{n:"Manager",t:gn},15:{n:"Company",t:gn},16:{n:"LinksUpToDate",t:_0},17:{n:"CharacterCount",t:Ai},19:{n:"SharedDoc",t:_0},22:{n:"HyperlinksChanged",t:_0},23:{n:"AppVersion",t:Ai,p:"version"},24:{n:"DigSig",t:Y3},26:{n:"ContentType",t:gn},27:{n:"ContentStatus",t:gn},28:{n:"Language",t:gn},29:{n:"Version",t:gn},255:{},2147483648:{n:"Locale",t:Mp},2147483651:{n:"Behavior",t:Mp},1919054434:{}},eL={1:{n:"CodePage",t:Fy},2:{n:"Title",t:gn},3:{n:"Subject",t:gn},4:{n:"Author",t:gn},5:{n:"Keywords",t:gn},6:{n:"Comments",t:gn},7:{n:"Template",t:gn},8:{n:"LastAuthor",t:gn},9:{n:"RevNumber",t:gn},10:{n:"EditTime",t:C0},11:{n:"LastPrinted",t:C0},12:{n:"CreatedDate",t:C0},13:{n:"ModifiedDate",t:C0},14:{n:"PageCount",t:Ai},15:{n:"WordCount",t:Ai},16:{n:"CharCount",t:Ai},17:{n:"Thumbnail",t:K3},18:{n:"Application",t:gn},19:{n:"DocSecurity",t:Ai},255:{},2147483648:{n:"Locale",t:Mp},2147483651:{n:"Behavior",t:Mp},1919054434:{}},u_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},tL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var nL=rL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$l=In(nL),mc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},f_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function iL(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sL(t){var e=iL();if(!t||!t.match)return e;var r={};if((t.match(ti)||[]).forEach(function(n){var i=Et(n);switch(i[0].replace(h3,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[f_[i.ContentType]]!==void 0&&e[f_[i.ContentType]].push(i.PartName);break}}),e.xmlns!==_3.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var fu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Jv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function od(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ti)||[]).forEach(function(i){var s=Et(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Gf(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var aL="application/vnd.oasis.opendocument.spreadsheet";function oL(t,e){for(var r=Ey(t),n,i;n=Nd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Et(n[0],!1),i.path=="/"&&i.type!==aL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var ld=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lL=(function(){for(var t=new Array(ld.length),e=0;e<ld.length;++e){var r=ld[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function QA(t){var e={};t=gr(t);for(var r=0;r<ld.length;++r){var n=ld[r],i=t.match(lL[r]);i!=null&&i.length>0&&(e[n[1]]=Qt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=vn(e[n[1]]))}return e}var cL=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function eN(t,e,r,n){var i=[];if(typeof t=="string")i=t_(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(d){return{v:d}}));var a=typeof e=="string"?t_(e,n).map(function(d){return d.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function uL(t,e,r){var n={};return e||(e={}),t=gr(t),cL.forEach(function(i){var s=(t.match(Ad(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Qt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eN(n.HeadingPairs,n.TitlesOfParts,e,r),e}var fL=/<[^>]+>[^<]*/g;function dL(t,e){var r={},n="",i=t.match(fL);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Et(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Qt(d);break;case"bool":r[n]=Cr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=vn(d);break;case"cy":case"error":r[n]=Qt(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var hL={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jx;function pL(t,e,r){jx||(jx=Sy(hL)),e=jx[e]||e,t[e]=r}function Iy(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tN(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function rN(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function nN(t,e,r){return e===31?rN(t):tN(t,e,r)}function Qv(t,e,r){return nN(t,e,r===!1?0:4)}function mL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return nN(t,e,0)}function gL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ui,""),t.l-i&2&&(t.l+=2)}return r}function xL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ui,"");return r}function vL(t){var e=t.l,r=Dp(t,ZA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Dp(t,Ai);return[r,n]}function yL(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(vL(t));return r}function d_(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ui,"").replace(Wf,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function iN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function wL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Dp(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==c_&&n!==e&&J3.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===c_?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return tN(t,n,4).replace(ui,"");case 31:return rN(t);case 64:return Iy(t);case 65:return iN(t);case 71:return wL(t);case 80:return Qv(t,n,!s.raw).replace(ui,"");case 81:return mL(t,n).replace(ui,"");case 4108:return yL(t);case 4126:case 4127:return n==4127?gL(t):xL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function h_(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var d=t.read_shift(4),h=t.read_shift(4);s[a]=[d,h+r]}s.sort(function(T,_){return T[1]-_[1]});var m={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var g=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,g=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],g=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(g=!1,t.l=s[a][1]),g)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(m[v.n]=Dp(t,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Is(o=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(s[a][0]===1){if(o=m.CodePage=Dp(t,Fy),Is(o),l!==-1){var x=t.l;t.l=s[l][1],u=d_(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}u=d_(t,o)}else{var w=u[s[a][0]],S;switch(t[t.l]){case 65:t.l+=4,S=iN(t);break;case 30:t.l+=4,S=Qv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=Qv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=Br(t,4);break;case 64:t.l+=4,S=vn(Iy(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[w]=S}}return t.l=r+n,m}function p_(t,e,r){var n=t.content;if(!n)return{};Mn(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Kt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=h_(n,e),m={SystemIdentifier:u};for(var g in h)m[g]=h[g];if(m.FMTID=s,i===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=h_(n,null)}catch{}for(g in v)m[g]=v[g];return m.FMTID=[s,a],m}function bo(t,e){return t.read_shift(e),null}function bL(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Br(t,e){return t.read_shift(e)===1}function Kr(t){return t.read_shift(2,"u")}function sN(t,e){return bL(t,e,Kr)}function kL(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function rh(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function SL(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=d,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function nc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function nh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):nc(t,n,r)}function gc(t,e,r){if(r.biff>5)return nh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function _L(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function CL(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ui,"");return n&&(t.l+=24),i}function EL(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(ui,"");return r+a}function TL(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return CL(t);case"0303000000000000c000000000000046":return EL(t);default:throw new Error("Unsupported Moniker "+r)}}function E0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ui,""):"";return r}function AL(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,u="",d,h;i&16&&(s=E0(t,r-t.l)),i&128&&(a=E0(t,r-t.l)),(i&257)===257&&(o=E0(t,r-t.l)),(i&257)===1&&(l=TL(t,r-t.l)),i&8&&(u=E0(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(h=Iy(t)),t.l=r;var m=a||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var g={Target:m};return d&&(g.guid=d),h&&(g.time=h),s&&(g.Tooltip=s),g}function aN(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function oN(t,e){var r=aN(t);return r[3]=0,r}function ya(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function NL(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function ML(t,e,r){return e===0?"":gc(t,e,r)}function DL(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function lN(t){var e=t.read_shift(2),r=Oy(t);return[e,r]}function OL(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=rh(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function km(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function cN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var FL=cN;function uN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function IL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function RL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function $n(t){t.l+=2,t.l+=t.read_shift(2)}var PL={0:$n,4:$n,5:$n,6:$n,7:RL,8:$n,9:$n,10:$n,11:$n,12:$n,13:IL,14:$n,15:$n,16:$n,17:$n,18:$n,19:$n,20:$n,21:uN};function LL(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(PL[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function T0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function BL(t,e){return e===0||t.read_shift(2),1200}function jL(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=gc(t,0,r);return t.read_shift(e+n-t.l),i}function zL(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function VL(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=rh(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function $L(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(SL(t));return s.Count=n,s.Unique=i,s}function UL(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function HL(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function WL(t){var e=NL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function GL(t){return t.read_shift(2),t.read_shift(4)}function m_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function qL(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function YL(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function KL(){}function XL(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=rh(t,0,r),n}function ZL(t){var e=ya(t);return e.isst=t.read_shift(4),e}function JL(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ya(t);r.biff==2&&t.l++;var s=nh(t,n-t.l,r);return i.val=s,i}function QL(t,e,r){var n=t.read_shift(2),i=gc(t,0,r);return[n,i]}var e5=gc;function g_(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function t5(t){var e=t.read_shift(2),r=t.read_shift(2),n=lN(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function r5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(lN(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function n5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function i5(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=tL[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function s5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=i5(t,e,n.fStyle,r),n}function a5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function x_(t,e,r){var n=ya(t);(r.biff==2||e==9)&&++t.l;var i=kL(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function o5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ya(t),i=qn(t);return n.val=i,n}var v_=ML;function l5(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=nc(t,s),o=[];n>t.l;)o.push(nh(t));return[s,i,a,o]}function y_(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=OL(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var c5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function w_(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=nc(t,a,r);i&32&&(u=c5[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var h=n==t.l||o===0||!(d>0)?[]:HB(t,d,r,o);return{chKey:s,Name:u,itab:l,rgce:h}}function fN(t,e,r){if(r.biff<8)return u5(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(DL(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function u5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=rh(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function f5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=nc(t,n,r),a=nc(t,i,r);return[s,a]}function d5(t,e,r){var n=cN(t);t.l++;var i=t.read_shift(1);return e-=8,[WB(t,e,r),i,n]}function b_(t,e,r){var n=FL(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,$B(t,e,r)]}function h5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function p5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=gc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function m5(t,e,r){return p5(t,e,r)}function g5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(km(t));return r}function x5(t,e,r){if(r&&r.biff<8)return y5(t,e,r);var n=uN(t),i=LL(t,e-22,n[1]);return{cmo:n,ft:i}}var v5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function y5(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((v5[n]||Qn)(t,e,r)),{cmo:[i,n,s],ft:a}}function w5(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=_L(t,6,r);var o=t.read_shift(2);t.read_shift(2),Kr(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],h=nc(t,t.lens[u+1]-t.lens[u]-1);if(i+=h,i.length>=(d?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function b5(t,e){var r=km(t);t.l+=16;var n=AL(t,e-24);return[r,n]}function k5(t,e){t.read_shift(2);var r=km(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ui,""),[r,n]}function S5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=u_[r]||r,r=t.read_shift(2),e[1]=u_[r]||r,e}function _5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(oN(t));return r}function C5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(oN(t));return r}function E5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function dN(t,e,r){if(!r.cellStyles)return Qn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function T5(t,e){var r={};return e<32||(t.l+=16,r.header=qn(t),r.footer=qn(t),t.l+=2),r}function A5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var N5=ya,M5=sN,D5=nh;function O5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function F5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ya(t);++t.l;var i=gc(t,e-7,r);return n.t="str",n.val=i,n}function I5(t){var e=ya(t);++t.l;var r=qn(t);return e.t="n",e.val=r,e}function R5(t){var e=ya(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function P5(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function L5(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function B5(t,e,r){var n=t.l+e,i=ya(t),s=t.read_shift(2),a=nc(t,s,r);return t.l=n,i.t="str",i.val=a,i}var j5=[2,3,48,49,131,139,140,245],k_=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sy({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=Xo(1);switch(l.type){case"base64":d=Os(Gi(o));break;case"binary":d=Os(o);break;case"buffer":case"array":d=o;break}Mn(d,0);var h=d.read_shift(1),m=!!(h&136),g=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,w=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(w=d.read_shift(2));var S=d.read_shift(2),T=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(T=t[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var _=[],M={},D=Math.min(d.length,h==2?521:w-10-(g?264:0)),O=v?32:11;d.l<D&&d[d.l]!=13;)switch(M={},M.name=Ed.utils.decode(T,d.slice(d.l,d.l+O)).replace(/[\u0000\r\n].*$/g,""),d.l+=O,M.type=String.fromCharCode(d.read_shift(1)),h!=2&&!v&&(M.offset=d.read_shift(4)),M.len=d.read_shift(1),h==2&&(M.offset=d.read_shift(2)),M.dec=d.read_shift(1),M.name.length&&_.push(M),h!=2&&(d.l+=v?13:14),M.type){case"B":(!g||M.len!=8)&&l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var E=0,A=0;for(u[0]=[],A=0;A!=_.length;++A)u[0][A]=_[A].name;for(;x-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,u[++E]=[],A=0,A=0;A!=_.length;++A){var N=d.slice(d.l,d.l+_[A].len);d.l+=_[A].len,Mn(N,0);var P=Ed.utils.decode(T,N);switch(_[A].type){case"C":P.trim().length&&(u[E][A]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[E][A]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[E][A]=P;break;case"F":u[E][A]=parseFloat(P.trim());break;case"+":case"I":u[E][A]=v?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[E][A]=!0;break;case"N":case"F":u[E][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[E][A]="##MEMO##"+(v?parseInt(P.trim(),10):N.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[E][A]=+P||0);break;case"@":u[E][A]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":u[E][A]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":u[E][A]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][A]=-N.read_shift(-8,"f");break;case"B":if(g&&_[A].len==8){u[E][A]=N.read_shift(8,"f");break}case"G":case"P":N.l+=_[A].len;break;case"0":if(_[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[A].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Wu(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function i(o,l){try{return il(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Is(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Xv(),h=a1(o,{header:1,raw:!0,cellDates:!0}),m=h[0],g=h.slice(1),v=o["!cols"]||[],x=0,w=0,S=0,T=1;for(x=0;x<m.length;++x){if(((v[x]||{}).DBF||{}).name){m[x]=v[x].DBF.name,++S;continue}if(m[x]!=null){if(++S,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var _=Rr(o["!ref"]),M=[],D=[],O=[];for(x=0;x<=_.e.c-_.s.c;++x){var E="",A="",N=0,P=[];for(w=0;w<g.length;++w)g[w][x]!=null&&P.push(g[w][x]);if(P.length==0||m[x]==null){M[x]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=P[w]instanceof Date?"D":"C";break;default:A="C"}N=Math.max(N,String(P[w]).length),E=E&&E!=A?"C":A}N>250&&(N=250),A=((v[x]||{}).DBF||{}).type,A=="C"&&v[x].DBF.len>N&&(N=v[x].DBF.len),E=="B"&&A=="N"&&(E="N",O[x]=v[x].DBF.dec,N=v[x].DBF.len),D[x]=E=="C"||A=="N"?N:s[E]||0,T+=D[x],M[x]=E}var B=d.next(32);for(B.write_shift(4,318902576),B.write_shift(4,g.length),B.write_shift(2,296+32*S),B.write_shift(2,T),x=0;x<4;++x)B.write_shift(4,0);for(B.write_shift(4,0|(+e[fA]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var I=d.next(32),ee=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,ee,"sbcs"),I.write_shift(1,M[x]=="?"?"C":M[x],"sbcs"),I.write_shift(4,w),I.write_shift(1,D[x]||s[M[x]]||0),I.write_shift(1,O[x]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=D[x]||s[M[x]]||0}var oe=d.next(264);for(oe.write_shift(4,13),x=0;x<65;++x)oe.write_shift(4,0);for(x=0;x<g.length;++x){var re=d.next(T);for(re.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(M[w]){case"L":re.write_shift(1,g[x][w]==null?63:g[x][w]?84:70);break;case"B":re.write_shift(8,g[x][w]||0,"f");break;case"N":var fe="0";for(typeof g[x][w]=="number"&&(fe=g[x][w].toFixed(O[w]||0)),S=0;S<D[w]-fe.length;++S)re.write_shift(1,32);re.write_shift(1,fe,"sbcs");break;case"D":g[x][w]?(re.write_shift(4,("0000"+g[x][w].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(g[x][w].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+g[x][w].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var se=String(g[x][w]!=null?g[x][w]:"").slice(0,D[w]);for(re.write_shift(1,se,"sbcs"),S=0;S<D[w]-se.length;++S)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}})(),z5=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,g){var v=t[g];return typeof v=="number"?BS(v):v},n=function(m,g,v){var x=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?m:BS(x)};t["|"]=254;function i(m,g){switch(g.type){case"base64":return s(Gi(m),g);case"binary":return s(m,g);case"buffer":return s(Wt&&Buffer.isBuffer(m)?m.toString("binary"):dc(m),g);case"array":return s(rc(m),g)}throw new Error("Unrecognized type "+g.type)}function s(m,g){var v=m.split(/[\n\r]+/),x=-1,w=-1,S=0,T=0,_=[],M=[],D=null,O={},E=[],A=[],N=[],P=0,B;for(+g.codepage>=0&&Is(+g.codepage);S!==v.length;++S){P=0;var I=v[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ee=I.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),oe=ee[0],re;if(I.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&M.push(I.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,se=!1,xe=!1,H=!1,ve=-1,W=-1;for(T=1;T<ee.length;++T)switch(ee[T].charAt(0)){case"A":break;case"X":w=parseInt(ee[T].slice(1))-1,se=!0;break;case"Y":for(x=parseInt(ee[T].slice(1))-1,se||(w=0),B=_.length;B<=x;++B)_[B]=[];break;case"K":re=ee[T].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Ps(re))?isNaN(Cu(re).getDate())||(re=vn(re)):(re=Ps(re),D!==null&&Uu(D)&&(re=bm(re))),fe=!0;break;case"E":H=!0;var F=gu(ee[T].slice(1),{r:x,c:w});_[x][w]=[_[x][w],F];break;case"S":xe=!0,_[x][w]=[_[x][w],"S5S"];break;case"G":break;case"R":ve=parseInt(ee[T].slice(1))-1;break;case"C":W=parseInt(ee[T].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+I)}if(fe&&(_[x][w]&&_[x][w].length==2?_[x][w][0]=re:_[x][w]=re,D=null),xe){if(H)throw new Error("SYLK shared formula cannot have own formula");var X=ve>-1&&_[ve][W];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");_[x][w][1]=kN(X[1],{r:x-ve,c:w-W})}break;case"F":var Z=0;for(T=1;T<ee.length;++T)switch(ee[T].charAt(0)){case"X":w=parseInt(ee[T].slice(1))-1,++Z;break;case"Y":for(x=parseInt(ee[T].slice(1))-1,B=_.length;B<=x;++B)_[B]=[];break;case"M":P=parseInt(ee[T].slice(1))/20;break;case"F":break;case"G":break;case"P":D=M[parseInt(ee[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=ee[T].slice(1).split(" "),B=parseInt(N[0],10);B<=parseInt(N[1],10);++B)P=parseInt(N[2],10),A[B-1]=P===0?{hidden:!0}:{wch:P},Eu(A[B-1]);break;case"C":w=parseInt(ee[T].slice(1))-1,A[w]||(A[w]={});break;case"R":x=parseInt(ee[T].slice(1))-1,E[x]||(E[x]={}),P>0?(E[x].hpt=P,E[x].hpx=Od(P)):P===0&&(E[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+I)}Z<1&&(D=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+I)}}return E.length>0&&(O["!rows"]=E),A.length>0&&(O["!cols"]=A),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,O]}function a(m,g){var v=i(m,g),x=v[0],w=v[1],S=Wu(x,g);return pa(w).forEach(function(T){S[T]=w[T]}),S}function o(m,g){return il(a(m,g),g)}function l(m,g,v,x){var w="C;Y"+(v+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+E8(m.f,{r:v,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(m,g){g.forEach(function(v,x){var w="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Fp(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Ip(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function d(m,g){g.forEach(function(v,x){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*yN(v.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function h(m,g){var v=["ID;PWXL;N;E"],x=[],w=Rr(m["!ref"]),S,T=Array.isArray(m),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&d(v,m["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var M=w.s.r;M<=w.e.r;++M)for(var D=w.s.c;D<=w.e.c;++D){var O=Dt({r:M,c:D});S=T?(m[M]||[])[D]:m[O],!(!S||S.v==null&&(!S.f||S.F))&&x.push(l(S,m,M,D))}return v.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}})(),V5=(function(){function t(s,a){switch(a.type){case"base64":return e(Gi(s),a);case"binary":return e(s,a);case"buffer":return e(Wt&&Buffer.isBuffer(s)?s.toString("binary"):dc(s),a);case"array":return e(rc(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var m=o[d].trim().split(","),g=m[0],v=m[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][u]=!0:x==="FALSE"?h[l][u]=!1:isNaN(Ps(v))?isNaN(Cu(v).getDate())?h[l][u]=v:h[l][u]=vn(v):h[l][u]=Ps(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][u++]=x!==""?x:null;break}if(x==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Wu(t(s,a),a)}function n(s,a){return il(r(s,a),a)}var i=(function(){var s=function(l,u,d,h,m){l.push(u),l.push(d+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},a=function(l,u,d,h){l.push(u+","+d),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],d=Rr(l["!ref"]),h,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){a(u,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var x=Dt({r:g,c:v});if(h=m?(l[g]||[])[v]:l[x],!h){a(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ps(h.z||It[14],fi(vn(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var S=`\r
`,T=u.join(S);return T}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),$5=(function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var g=h.split(`
`),v=-1,x=-1,w=0,S=[];w!==g.length;++w){var T=g[w].trim().split(":");if(T[0]==="cell"){var _=ci(T[1]);if(S.length<=_.r)for(v=S.length;v<=_.r;++v)S[v]||(S[v]=[]);switch(v=_.r,x=_.c,T[2]){case"t":S[v][x]=t(T[3]);break;case"v":S[v][x]=+T[3];break;case"vtf":var M=T[T.length-1];case"vtc":switch(T[3]){case"nl":S[v][x]=!!+T[4];break;default:S[v][x]=+T[4];break}T[2]=="vtf"&&(S[v][x]=[S[v][x],M])}}}return m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),S}function n(h,m){return Wu(r(h,m),m)}function i(h,m){return il(n(h,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var m=[],g=[],v,x="",w=Hu(h["!ref"]),S=Array.isArray(h),T=w.s.r;T<=w.e.r;++T)for(var _=w.s.c;_<=w.e.c;++_)if(x=Dt({r:T,c:_}),v=S?(h[T]||[])[_]:h[x],!(!v||v.v==null||v.t==="z")){switch(g=["cell",x,"t"],v.t){case"s":case"str":g.push(e(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=e(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var M=fi(vn(v.v));g[2]="vtc",g[3]="nd",g[4]=""+M,g[5]=v.w||ps(v.z||It[14],M);break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}})(),Md=(function(){function t(d,h,m,g,v){v.raw?h[m][g]=d:d===""||(d==="TRUE"?h[m][g]=!0:d==="FALSE"?h[m][g]=!1:isNaN(Ps(d))?isNaN(Cu(d).getDate())?h[m][g]=d:h[m][g]=vn(d):h[m][g]=Ps(d))}function e(d,h){var m=h||{},g=[];if(!d||d.length===0)return g;for(var v=d.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var w=10,S=0,T=0;T<=x;++T)S=v[T].indexOf(" "),S==-1?S=v[T].length:S++,w=Math.max(w,S);for(T=0;T<=x;++T){g[T]=[];var _=0;for(t(v[T].slice(0,w).trim(),g,T,_,m),_=1;_<=(v[T].length-w)/10+1;++_)t(v[T].slice(w+(_-1)*10,w+_*10).trim(),g,T,_,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var h={},m=!1,g=0,v=0;g<d.length;++g)(v=d.charCodeAt(g))==34?m=!m:!m&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g]);if(!v.length){h=n;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g])}return v.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[v.pop()[1]]||44}function s(d,h){var m=h||{},g="",v=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):m&&m.FS?g=m.FS:g=i(d.slice(0,1024));var w=0,S=0,T=0,_=0,M=0,D=g.charCodeAt(0),O=!1,E=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var N=m.dateNF!=null?QP(m.dateNF):null;function P(){var B=d.slice(_,M),I={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)I.t="z";else if(m.raw)I.t="s",I.v=B;else if(B.trim().length===0)I.t="s",I.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(I.t="s",I.v=B.slice(2,-1).replace(/""/g,'"')):A8(B)?(I.t="n",I.f=B.slice(1)):(I.t="s",I.v=B);else if(B=="TRUE")I.t="b",I.v=!0;else if(B=="FALSE")I.t="b",I.v=!1;else if(!isNaN(T=Ps(B)))I.t="n",m.cellText!==!1&&(I.w=B),I.v=T;else if(!isNaN(Cu(B).getDate())||N&&B.match(N)){I.z=m.dateNF||It[14];var ee=0;N&&B.match(N)&&(B=e3(B,m.dateNF,B.match(N)||[]),ee=1),m.cellDates?(I.t="d",I.v=vn(B,ee)):(I.t="n",I.v=fi(vn(B,ee))),m.cellText!==!1&&(I.w=ps(I.z,I.v instanceof Date?fi(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=B;if(I.t=="z"||(m.dense?(v[w]||(v[w]=[]),v[w][S]=I):v[Dt({c:S,r:w})]=I),_=M+1,A=d.charCodeAt(_),x.e.c<S&&(x.e.c=S),x.e.r<w&&(x.e.r=w),E==D)++S;else if(S=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;M<d.length;++M)switch(E=d.charCodeAt(M)){case 34:A===34&&(O=!O);break;case D:case 10:case 13:if(!O&&P())break e;break}return M-_>0&&P(),v["!ref"]=Xt(x),v}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,h):Wu(e(d,h),h)}function o(d,h){var m="",g=h.type=="string"?[0,0,0,0]:$y(d,h);switch(h.type){case"base64":m=Gi(d);break;case"binary":m=d;break;case"buffer":h.codepage==65001?m=d.toString("utf8"):h.codepage&&typeof Ed<"u"||(m=Wt&&Buffer.isBuffer(d)?d.toString("binary"):dc(d));break;case"array":m=rc(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=gr(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=gr(m):h.type=="binary"&&typeof Ed<"u",m.slice(0,19)=="socialcalc:version:"?$5.to_sheet(h.type=="string"?m:gr(m),h):a(m,h)}function l(d,h){return il(o(d,h),h)}function u(d){for(var h=[],m=Rr(d["!ref"]),g,v=Array.isArray(d),x=m.s.r;x<=m.e.r;++x){for(var w=[],S=m.s.c;S<=m.e.c;++S){var T=Dt({r:x,c:S});if(g=v?(d[x]||[])[S]:d[T],!g||g.v==null){w.push("          ");continue}for(var _=(g.w||(Ka(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(S===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})();function U5(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=z5.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Md.to_workbook(t,e)}}var cd=(function(){function t(F,X,Z){if(F){Mn(F,F.l||0);for(var q=Z.Enum||ve;F.l<F.length;){var ce=F.read_shift(2),Ce=q[ce]||q[65535],pe=F.read_shift(2),ue=F.l+pe,Se=Ce.f&&Ce.f(F,pe,Z);if(F.l=ue,X(Se,Ce,ce))return}}}function e(F,X){switch(X.type){case"base64":return r(Os(Gi(F)),X);case"binary":return r(Os(F),X);case"buffer":case"array":return r(F,X)}throw"Unsupported type "+X.type}function r(F,X){if(!F)return F;var Z=X||{},q=Z.dense?[]:{},ce="Sheet1",Ce="",pe=0,ue={},Se=[],ze=[],j={s:{r:0,c:0},e:{r:0,c:0}},tt=Z.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)Z.Enum=ve,t(F,function(Te,at,gt){switch(gt){case 0:Z.vers=Te,Te>=4096&&(Z.qpro=!0);break;case 6:j=Te;break;case 204:Te&&(Ce=Te);break;case 222:Ce=Te;break;case 15:case 51:Z.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:gt==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=Z.dateNF||It[14],Z.cellDates&&(Te[1].t="d",Te[1].v=bm(Te[1].v))),Z.qpro&&Te[3]>pe&&(q["!ref"]=Xt(j),ue[ce]=q,Se.push(ce),q=Z.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},pe=Te[3],ce=Ce||"Sheet"+(pe+1),Ce="");var J=Z.dense?(q[Te[0].r]||[])[Te[0].c]:q[Dt(Te[0])];if(J){J.t=Te[1].t,J.v=Te[1].v,Te[1].z!=null&&(J.z=Te[1].z),Te[1].f!=null&&(J.f=Te[1].f);break}Z.dense?(q[Te[0].r]||(q[Te[0].r]=[]),q[Te[0].r][Te[0].c]=Te[1]):q[Dt(Te[0])]=Te[1];break}},Z);else if(F[2]==26||F[2]==14)Z.Enum=W,F[2]==14&&(Z.qpro=!0,F.l=0),t(F,function(Te,at,gt){switch(gt){case 204:ce=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>pe&&(q["!ref"]=Xt(j),ue[ce]=q,Se.push(ce),q=Z.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},pe=Te[3],ce="Sheet"+(pe+1)),tt>0&&Te[0].r>=tt)break;Z.dense?(q[Te[0].r]||(q[Te[0].r]=[]),q[Te[0].r][Te[0].c]=Te[1]):q[Dt(Te[0])]=Te[1],j.e.c<Te[0].c&&(j.e.c=Te[0].c),j.e.r<Te[0].r&&(j.e.r=Te[0].r);break;case 27:Te[14e3]&&(ze[Te[14e3][0]]=Te[14e3][1]);break;case 1537:ze[Te[0]]=Te[1],Te[0]==pe&&(ce=Te[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(q["!ref"]=Xt(j),ue[Ce||ce]=q,Se.push(Ce||ce),!ze.length)return{SheetNames:Se,Sheets:ue};for(var Ne={},qe=[],Le=0;Le<ze.length;++Le)ue[Se[Le]]?(qe.push(ze[Le]||Se[Le]),Ne[ze[Le]]=ue[ze[Le]]||ue[Se[Le]]):(qe.push(ze[Le]),Ne[ze[Le]]={"!ref":"A1"});return{SheetNames:qe,Sheets:Ne}}function n(F,X){var Z=X||{};if(+Z.codepage>=0&&Is(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Xv(),ce=Rr(F["!ref"]),Ce=Array.isArray(F),pe=[];Ns(q,0,s(1030)),Ns(q,6,l(ce));for(var ue=Math.min(ce.e.r,8191),Se=ce.s.r;Se<=ue;++Se)for(var ze=Rn(Se),j=ce.s.c;j<=ce.e.c;++j){Se===ce.s.r&&(pe[j]=cn(j));var tt=pe[j]+ze,Ne=Ce?(F[Se]||[])[j]:F[tt];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?Ns(q,13,g(Se,j,Ne.v)):Ns(q,14,x(Se,j,Ne.v));else{var qe=Ka(Ne);Ns(q,15,h(Se,j,qe.slice(0,239)))}}return Ns(q,1),q.end()}function i(F,X){var Z=X||{};if(+Z.codepage>=0&&Is(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Xv();Ns(q,0,a(F));for(var ce=0,Ce=0;ce<F.SheetNames.length;++ce)(F.Sheets[F.SheetNames[ce]]||{})["!ref"]&&Ns(q,27,H(F.SheetNames[ce],Ce++));var pe=0;for(ce=0;ce<F.SheetNames.length;++ce){var ue=F.Sheets[F.SheetNames[ce]];if(!(!ue||!ue["!ref"])){for(var Se=Rr(ue["!ref"]),ze=Array.isArray(ue),j=[],tt=Math.min(Se.e.r,8191),Ne=Se.s.r;Ne<=tt;++Ne)for(var qe=Rn(Ne),Le=Se.s.c;Le<=Se.e.c;++Le){Ne===Se.s.r&&(j[Le]=cn(Le));var Te=j[Le]+qe,at=ze?(ue[Ne]||[])[Le]:ue[Te];if(!(!at||at.t=="z"))if(at.t=="n")Ns(q,23,P(Ne,Le,pe,at.v));else{var gt=Ka(at);Ns(q,22,E(Ne,Le,pe,gt.slice(0,239)))}}++pe}}return Ns(q,1),q.end()}function s(F){var X=an(2);return X.write_shift(2,F),X}function a(F){var X=an(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var Z=0,q=0,ce=0,Ce=0;Ce<F.SheetNames.length;++Ce){var pe=F.SheetNames[Ce],ue=F.Sheets[pe];if(!(!ue||!ue["!ref"])){++ce;var Se=Hu(ue["!ref"]);Z<Se.e.r&&(Z=Se.e.r),q<Se.e.c&&(q=Se.e.c)}}return Z>8191&&(Z=8191),X.write_shift(2,Z),X.write_shift(1,ce),X.write_shift(1,q),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function o(F,X,Z){var q={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&Z.qpro?(q.s.c=F.read_shift(1),F.l++,q.s.r=F.read_shift(2),q.e.c=F.read_shift(1),F.l++,q.e.r=F.read_shift(2),q):(q.s.c=F.read_shift(2),q.s.r=F.read_shift(2),X==12&&Z.qpro&&(F.l+=2),q.e.c=F.read_shift(2),q.e.r=F.read_shift(2),X==12&&Z.qpro&&(F.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(F){var X=an(8);return X.write_shift(2,F.s.c),X.write_shift(2,F.s.r),X.write_shift(2,F.e.c),X.write_shift(2,F.e.r),X}function u(F,X,Z){var q=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(q[0].c=F.read_shift(1),q[3]=F.read_shift(1),q[0].r=F.read_shift(2),F.l+=2):(q[2]=F.read_shift(1),q[0].c=F.read_shift(2),q[0].r=F.read_shift(2)),q}function d(F,X,Z){var q=F.l+X,ce=u(F,X,Z);if(ce[1].t="s",Z.vers==20768){F.l++;var Ce=F.read_shift(1);return ce[1].v=F.read_shift(Ce,"utf8"),ce}return Z.qpro&&F.l++,ce[1].v=F.read_shift(q-F.l,"cstr"),ce}function h(F,X,Z){var q=an(7+Z.length);q.write_shift(1,255),q.write_shift(2,X),q.write_shift(2,F),q.write_shift(1,39);for(var ce=0;ce<q.length;++ce){var Ce=Z.charCodeAt(ce);q.write_shift(1,Ce>=128?95:Ce)}return q.write_shift(1,0),q}function m(F,X,Z){var q=u(F,X,Z);return q[1].v=F.read_shift(2,"i"),q}function g(F,X,Z){var q=an(7);return q.write_shift(1,255),q.write_shift(2,X),q.write_shift(2,F),q.write_shift(2,Z,"i"),q}function v(F,X,Z){var q=u(F,X,Z);return q[1].v=F.read_shift(8,"f"),q}function x(F,X,Z){var q=an(13);return q.write_shift(1,255),q.write_shift(2,X),q.write_shift(2,F),q.write_shift(8,Z,"f"),q}function w(F,X,Z){var q=F.l+X,ce=u(F,X,Z);if(ce[1].v=F.read_shift(8,"f"),Z.qpro)F.l=q;else{var Ce=F.read_shift(2);M(F.slice(F.l,F.l+Ce),ce),F.l+=Ce}return ce}function S(F,X,Z){var q=X&32768;return X&=-32769,X=(q?F:0)+(X>=8192?X-16384:X),(q?"":"$")+(Z?cn(X):Rn(X))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(F,X){Mn(F,0);for(var Z=[],q=0,ce="",Ce="",pe="",ue="";F.l<F.length;){var Se=F[F.l++];switch(Se){case 0:Z.push(F.read_shift(8,"f"));break;case 1:Ce=S(X[0].c,F.read_shift(2),!0),ce=S(X[0].r,F.read_shift(2),!1),Z.push(Ce+ce);break;case 2:{var ze=S(X[0].c,F.read_shift(2),!0),j=S(X[0].r,F.read_shift(2),!1);Ce=S(X[0].c,F.read_shift(2),!0),ce=S(X[0].r,F.read_shift(2),!1),Z.push(ze+j+":"+Ce+ce)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(F.read_shift(2));break;case 6:{for(var tt="";Se=F[F.l++];)tt+=String.fromCharCode(Se);Z.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:ue=Z.pop(),pe=Z.pop(),Z.push(["AND","OR"][Se-20]+"("+pe+","+ue+")");break;default:if(Se<32&&_[Se])ue=Z.pop(),pe=Z.pop(),Z.push(pe+_[Se]+ue);else if(T[Se]){if(q=T[Se][1],q==69&&(q=F[F.l++]),q>Z.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+Z.join("|")+"|");return}var Ne=Z.slice(-q);Z.length-=q,Z.push(T[Se][0]+"("+Ne.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}Z.length==1?X[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function D(F){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=F.read_shift(2),X[3]=F[F.l++],X[0].c=F[F.l++],X}function O(F,X){var Z=D(F);return Z[1].t="s",Z[1].v=F.read_shift(X-4,"cstr"),Z}function E(F,X,Z,q){var ce=an(6+q.length);ce.write_shift(2,F),ce.write_shift(1,Z),ce.write_shift(1,X),ce.write_shift(1,39);for(var Ce=0;Ce<q.length;++Ce){var pe=q.charCodeAt(Ce);ce.write_shift(1,pe>=128?95:pe)}return ce.write_shift(1,0),ce}function A(F,X){var Z=D(F);Z[1].v=F.read_shift(2);var q=Z[1].v>>1;if(Z[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return Z[1].v=q,Z}function N(F,X){var Z=D(F),q=F.read_shift(4),ce=F.read_shift(4),Ce=F.read_shift(2);if(Ce==65535)return q===0&&ce===3221225472?(Z[1].t="e",Z[1].v=15):q===0&&ce===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var pe=Ce&32768;return Ce=(Ce&32767)-16446,Z[1].v=(1-pe*2)*(ce*Math.pow(2,Ce+32)+q*Math.pow(2,Ce)),Z}function P(F,X,Z,q){var ce=an(14);if(ce.write_shift(2,F),ce.write_shift(1,Z),ce.write_shift(1,X),q==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Ce=0,pe=0,ue=0,Se=0;return q<0&&(Ce=1,q=-q),pe=Math.log2(q)|0,q/=Math.pow(2,pe-31),Se=q>>>0,(Se&2147483648)==0&&(q/=2,++pe,Se=q>>>0),q-=Se,Se|=2147483648,Se>>>=0,q*=Math.pow(2,32),ue=q>>>0,ce.write_shift(4,ue),ce.write_shift(4,Se),pe+=16383+(Ce?32768:0),ce.write_shift(2,pe),ce}function B(F,X){var Z=N(F);return F.l+=X-14,Z}function I(F,X){var Z=D(F),q=F.read_shift(4);return Z[1].v=q>>6,Z}function ee(F,X){var Z=D(F),q=F.read_shift(8,"f");return Z[1].v=q,Z}function oe(F,X){var Z=ee(F);return F.l+=X-10,Z}function re(F,X){return F[F.l+X-1]==0?F.read_shift(X,"cstr"):""}function fe(F,X){var Z=F[F.l++];Z>X-1&&(Z=X-1);for(var q="";q.length<Z;)q+=String.fromCharCode(F[F.l++]);return q}function se(F,X,Z){if(!(!Z.qpro||X<21)){var q=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var ce=F.read_shift(X-21,"cstr");return[q,ce]}}function xe(F,X){for(var Z={},q=F.l+X;F.l<q;){var ce=F.read_shift(2);if(ce==14e3){for(Z[ce]=[0,""],Z[ce][0]=F.read_shift(2);F[F.l];)Z[ce][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return Z}function H(F,X){var Z=an(5+F.length);Z.write_shift(2,14e3),Z.write_shift(2,X);for(var q=0;q<F.length;++q){var ce=F.charCodeAt(q);Z[Z.l++]=ce>127?95:ce}return Z[Z.l++]=0,Z}var ve={0:{n:"BOF",f:Kr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})();function H5(t){var e={},r=t.match(ti),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Et(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=vy[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var W5=(function(){var t=Ad("t"),e=Ad("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Qt(a[1])},l=s.match(e);return l&&(o.s=H5(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}})(),G5=(function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),q5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Y5=/<(?:\w+:)?r>/,K5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ry(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qt(gr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=gr(t),r&&(n.h=Cy(n.t))):t.match(Y5)&&(n.r=gr(t),n.t=Qt(gr((t.replace(K5,"").match(q5)||[]).join("").replace(ti,""))),r&&(n.h=G5(W5(n.r)))),n):{t:""}}var X5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Z5=/<(?:\w+:)?(?:si|sstItem)>/g,J5=/<\/(?:\w+:)?(?:si|sstItem)>/;function Q5(t,e){var r=[],n="";if(!t)return r;var i=t.match(X5);if(i){n=i[2].replace(Z5,"").split(J5);for(var s=0;s!=n.length;++s){var a=Ry(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Et(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function e6(t){return[t.read_shift(4),t.read_shift(4)]}function t6(t,e){var r=[],n=!1;return Qa(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function hN(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ga(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function r6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ga(t,4),e.U=Ga(t,4),e.W=Ga(t,4),e}function n6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function i6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(n6(t));return e}function s6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function a6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ga(t,4),e.U=Ga(t,4),e.W=Ga(t,4),e}function o6(t){var e=a6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function pN(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function mN(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function l6(t){var e=Ga(t);switch(e.Minor){case 2:return[e.Minor,c6(t)];case 3:return[e.Minor,u6()];case 4:return[e.Minor,f6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function c6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=pN(t,r),i=mN(t,t.length-t.l);return{t:"Std",h:n,v:i}}function u6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function f6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ti,function(s){var a=Et(s);switch(va(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function d6(t,e){var r={},n=r.EncryptionVersionInfo=Ga(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=pN(t,i),e-=i,r.EncryptionVerifier=mN(t,e),r}function h6(t){var e={},r=e.EncryptionVersionInfo=Ga(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function p6(t){var e=0,r,n=hN(t),i=n.length+1,s,a,o,l,u;for(r=Xo(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(e&16384)===0?0:1,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var gN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var d=a[u],h=0;h!=7;++h)d&64&&(o^=r[l]),d*=2,--l;return o};return function(a){for(var o=hN(a),l=s(o),u=o.length,d=Xo(16),h=0;h!=16;++h)d[h]=0;var m,g,v;for((u&1)===1&&(m=l>>8,d[u]=i(t[0],m),--u,m=l&255,g=o[o.length-1],d[u]=i(g,m));u>0;)--u,m=l>>8,d[u]=i(o[u],m),--u,m=l&255,d[u]=i(o[u],m);for(u=15,v=15-o.length;v>0;)m=l>>8,d[u]=i(t[v],m),--u,--v,m=l&255,d[u]=i(o[u],m),--u,--v;return d}})(),m6=function(t,e,r,n,i){i||(i=e),n||(n=gN(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},g6=function(t){var e=0,r=gN(t);return function(n){var i=m6("",n,e,r);return e=i[1],i[0]}};function x6(t,e,r,n){var i={key:Kr(t),verificationBytes:Kr(t)};return r.password&&(i.verifier=p6(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=g6(r.password)),i}function v6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=h6(t):n.Data=d6(t,e),n}function y6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?v6(t,e-2,n):x6(t,r.biff>=8?e:e-2,r,n),n}var w6=(function(){function t(i,s){switch(s.type){case"base64":return e(Gi(i),s);case"binary":return e(i,s);case"buffer":return e(Wt&&Buffer.isBuffer(i)?i.toString("binary"):dc(i),s);case"array":return e(rc(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,g=0,v,x=-1;v=m.exec(d);){switch(v[0]){case"\\cell":var w=d.slice(g,m.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[h][x]=S:o[Dt({r:h,c:x})]=S}break}g=m.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Xt(u),o}function r(i,s){return il(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Rr(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=Dt({r:u,c:d});o=l?(i[u]||[])[d]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ka(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function b6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Dd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function k6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,u/2]}function S6(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function Op(t,e){if(e===0)return t;var r=k6(b6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Dd(S6(r))}var xN=6,_6=15,C6=1,li=xN;function Fp(t){return Math.floor((t+Math.round(128/li)/256)*li)}function Ip(t){return Math.floor((t-5)/li*100+.5)/100}function e1(t){return Math.round((t*li+5)/li*256)/256}function zx(t){return e1(Ip(Fp(t)))}function Py(t){var e=Math.abs(t-zx(t)),r=li;if(e>.005)for(li=C6;li<_6;++li)Math.abs(t-zx(t))<=e&&(e=Math.abs(t-zx(t)),r=li);li=r}function Eu(t){t.width?(t.wpx=Fp(t.width),t.wch=Ip(t.wpx),t.MDW=li):t.wpx?(t.wch=Ip(t.wpx),t.width=e1(t.wch),t.MDW=li):typeof t.wch=="number"&&(t.width=e1(t.wch),t.wpx=Fp(t.width),t.MDW=li),t.customWidth&&delete t.customWidth}var E6=96,vN=E6;function yN(t){return t*96/vN}function Od(t){return t*vN/96}var T6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function A6(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=Et(a);switch(va(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Cr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Cr(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function N6(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=Et(a);switch(va(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function M6(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ti)||[]).forEach(function(a){var o=Et(a);switch(va(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=gr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Cr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Cr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Cr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Cr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Cr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Cr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Cr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=vy[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Cr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=$l[i.color.index];i.color.index==81&&(l=$l[1]),l||(l=$l[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Op(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function D6(t,e,r){e.NumberFmt=[];for(var n=pa(It),i=0;i<n.length;++i)e.NumberFmt[n[i]]=It[n[i]];var s=t[0].match(ti);if(s)for(i=0;i<s.length;++i){var a=Et(s[i]);switch(va(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Qt(gr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Vl(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var A0=["numFmtId","fillId","fontId","borderId","xfId"],N0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function O6(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ti)||[]).forEach(function(s){var a=Et(s),o=0;switch(va(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<A0.length;++o)n[A0[o]]&&(n[A0[o]]=parseInt(n[A0[o]],10));for(o=0;o<N0.length;++o)n[N0[o]]&&(n[N0[o]]=Cr(n[N0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Cr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var F6=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&D6(h,d,u),(h=o.match(i))&&M6(h,d,l,u),(h=o.match(n))&&N6(h,d,l,u),(h=o.match(s))&&A6(h,d,l,u),(h=o.match(r))&&O6(h,d,u),d}})();function I6(t,e){var r=t.read_shift(2),n=Jn(t);return[r,n]}function R6(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=W3(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=H3(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jn(t),n}var P6=Qn;function L6(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var B6=Qn;function j6(t,e,r){var n={};n.NumberFmt=[];for(var i in It)n.NumberFmt[i]=It[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Qa(t,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],Vl(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Op(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var z6=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function V6(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ti)||[]).forEach(function(i){var s=Et(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[z6.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $6(){}function U6(){}var H6=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,W6=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,G6=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function q6(t,e,r){e.themeElements={};var n;[["clrScheme",H6,V6],["fontScheme",W6,$6],["fmtScheme",G6,U6]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var Y6=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function wN(t,e){(!t||t.length===0)&&(t=K6());var r,n={};if(!(r=t.match(Y6)))throw new Error("themeElements not found in theme");return q6(r[0],n,e),n.raw=t,n}function K6(t,e){var r=[DA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function X6(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=MA(s,{type:"array"})}catch{return}var o=Ui(a,"theme/theme/theme1.xml",!0);if(o)return wN(o,r)}}function Z6(t){return t.read_shift(4)}function J6(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Q6(t,4);break;case 2:e.xclrValue=aN(t);break;case 3:e.xclrValue=Z6(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Q6(t,e){return Qn(t,e)}function e8(t,e){return Qn(t,e)}function t8(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=J6(t);break;case 6:n[1]=e8(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function r8(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(t8(t,r-t.l));return{ixfe:n,ext:s}}function n8(t,e){e.forEach(function(r){r[0]})}function i8(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Jn(t)}}function s8(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function a8(t){return t.l+=4,t.read_shift(4)!=0}function o8(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Qa(t,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(d),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function l8(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ti,function(o){var l=Et(o);switch(va(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(a=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function c8(t){var e=[];if(!t)return e;var r=1;return(t.match(ti)||[]).forEach(function(n){var i=Et(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function u8(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Dt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function f8(t,e,r){var n=[];return Qa(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function d8(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Qa(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function h8(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function S_(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=ci(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=Rr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=Xt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var d={a:a.author,t:a.t,r:a.r,T:r};a.h&&(d.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(d.a==n[h].id){d.a=n[h].name||d.a;break}}s.c.push(d)})}function p8(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Et(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=ci(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&Ry(h[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function m8(t,e){var r=[],n=!1,i={},s=0;return t.replace(ti,function(o,l){var u=Et(o);switch(va(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function g8(t,e){var r=[],n=!1;return t.replace(ti,function(s){var a=Et(s);switch(va(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function x8(t){var e={};e.iauthor=t.read_shift(4);var r=pc(t);return e.rfx=r.s,e.ref=Dt(r.s),t.l+=16,e}var v8=Jn;function y8(t,e){var r=[],n=[],i={},s=!1;return Qa(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var w8="application/vnd.ms-office.vbaProject";function b8(t){var e=Kt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Kt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Kt.write(e)}function k8(){return{"!type":"dialog"}}function S8(){return{"!type":"dialog"}}function _8(){return{"!type":"macro"}}function C8(){return{"!type":"macro"}}var gu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?u+=e.r:--u,i+(o?"":"$")+cn(d)+(l?"":"$")+Rn(u)}return function(i,s){return e=s,i.replace(t,r)}})(),bN=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,E8=(function(){return function(e,r){return e.replace(bN,function(n,i,s,a,o,l){var u=Ny(a)-(s?0:r.c),d=Ay(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",m=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+m})}})();function kN(t,e){return t.replace(bN,function(r,n,i,s,a,o){return n+(i=="$"?i+s:cn(Ny(s)+e.c))+(a=="$"?a+o:Rn(Ay(o)+e.r))})}function T8(t,e,r){var n=Hu(e),i=n.s,s=ci(r),a={r:s.r-i.r,c:s.c-i.c};return kN(t,a)}function A8(t){return t.length!=1}function __(t){return t.replace(/_xlfn\./g,"")}function Gr(t){t.l+=1}function Zo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function SN(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _N(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Zo(t),o=Zo(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function _N(t){var e=Zo(t),r=Zo(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function N8(t,e,r){if(r.biff<8)return _N(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Zo(t),a=Zo(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function CN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return M8(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Zo(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function M8(t){var e=Zo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function D8(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function O8(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return F8(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function F8(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function I8(t,e,r){var n=(t[t.l++]&96)>>5,i=SN(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function R8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=SN(t,s,r);return[n,i,a]}function P8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function L8(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function B8(t,e,r){var n=(t[t.l++]&96)>>5,i=N8(t,e-1,r);return[n,i]}function j8(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function C_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function z8(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function V8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function $8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function U8(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function H8(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function EN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function W8(t){return t.read_shift(2),EN(t)}function G8(t){return t.read_shift(2),EN(t)}function q8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=CN(t,0,r);return[n,i]}function Y8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=O8(t,0,r);return[n,i]}function K8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=CN(t,0,r);return[n,i,s]}function X8(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[ZB[i],NN[i],n]}function Z8(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:J8(t);return[i,(s[0]===0?NN:XB)[s[1]]]}function J8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Q8(t,e,r){t.l+=r&&r.biff==2?3:4}function eB(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function tB(t){return t.l++,mc[t.read_shift(1)]}function rB(t){return t.l++,t.read_shift(2)}function nB(t){return t.l++,t.read_shift(1)!==0}function iB(t){return t.l++,qn(t)}function sB(t,e,r){return t.l++,rh(t,e-1,r)}function aB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Br(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=qn(t);break;case 2:r[1]=gc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function oB(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?pc:km)(t));return i}function lB(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=aB(t,r.biff);return a}function cB(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function uB(t,e,r){if(r.biff==5)return fB(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function fB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function dB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function hB(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function pB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function mB(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var gB=Qn,xB=Qn,vB=Qn;function ih(t,e,r){return t.l+=2,[D8(t)]}function Ly(t){return t.l+=6,[]}var yB=ih,wB=Ly,bB=Ly,kB=ih;function TN(t){return t.l+=2,[Kr(t),t.read_shift(2)&1]}var SB=ih,_B=TN,CB=Ly,EB=ih,TB=ih,AB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=AB[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function MB(t){return t.l+=2,[t.read_shift(4)]}function DB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function OB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function FB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function IB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function RB(t){return t.l+=4,[0,0]}var E_={1:{n:"PtgExp",f:eB},2:{n:"PtgTbl",f:vB},3:{n:"PtgAdd",f:Gr},4:{n:"PtgSub",f:Gr},5:{n:"PtgMul",f:Gr},6:{n:"PtgDiv",f:Gr},7:{n:"PtgPower",f:Gr},8:{n:"PtgConcat",f:Gr},9:{n:"PtgLt",f:Gr},10:{n:"PtgLe",f:Gr},11:{n:"PtgEq",f:Gr},12:{n:"PtgGe",f:Gr},13:{n:"PtgGt",f:Gr},14:{n:"PtgNe",f:Gr},15:{n:"PtgIsect",f:Gr},16:{n:"PtgUnion",f:Gr},17:{n:"PtgRange",f:Gr},18:{n:"PtgUplus",f:Gr},19:{n:"PtgUminus",f:Gr},20:{n:"PtgPercent",f:Gr},21:{n:"PtgParen",f:Gr},22:{n:"PtgMissArg",f:Gr},23:{n:"PtgStr",f:sB},26:{n:"PtgSheet",f:DB},27:{n:"PtgEndSheet",f:OB},28:{n:"PtgErr",f:tB},29:{n:"PtgBool",f:nB},30:{n:"PtgInt",f:rB},31:{n:"PtgNum",f:iB},32:{n:"PtgArray",f:j8},33:{n:"PtgFunc",f:X8},34:{n:"PtgFuncVar",f:Z8},35:{n:"PtgName",f:cB},36:{n:"PtgRef",f:q8},37:{n:"PtgArea",f:I8},38:{n:"PtgMemArea",f:dB},39:{n:"PtgMemErr",f:gB},40:{n:"PtgMemNoMem",f:xB},41:{n:"PtgMemFunc",f:hB},42:{n:"PtgRefErr",f:pB},43:{n:"PtgAreaErr",f:P8},44:{n:"PtgRefN",f:Y8},45:{n:"PtgAreaN",f:B8},46:{n:"PtgMemAreaN",f:FB},47:{n:"PtgMemNoMemN",f:IB},57:{n:"PtgNameX",f:uB},58:{n:"PtgRef3d",f:K8},59:{n:"PtgArea3d",f:R8},60:{n:"PtgRefErr3d",f:mB},61:{n:"PtgAreaErr3d",f:L8},255:{}},PB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},LB={1:{n:"PtgElfLel",f:TN},2:{n:"PtgElfRw",f:EB},3:{n:"PtgElfCol",f:yB},6:{n:"PtgElfRwV",f:TB},7:{n:"PtgElfColV",f:kB},10:{n:"PtgElfRadical",f:SB},11:{n:"PtgElfRadicalS",f:CB},13:{n:"PtgElfColS",f:wB},15:{n:"PtgElfColSV",f:bB},16:{n:"PtgElfRadicalLel",f:_B},25:{n:"PtgList",f:NB},29:{n:"PtgSxName",f:MB},255:{}},BB={0:{n:"PtgAttrNoop",f:RB},1:{n:"PtgAttrSemi",f:H8},2:{n:"PtgAttrIf",f:$8},4:{n:"PtgAttrChoose",f:z8},8:{n:"PtgAttrGoto",f:V8},16:{n:"PtgAttrSum",f:Q8},32:{n:"PtgAttrBaxcel",f:C_},33:{n:"PtgAttrBaxcel",f:C_},64:{n:"PtgAttrSpace",f:W8},65:{n:"PtgAttrSpaceSemi",f:G8},128:{n:"PtgAttrIfError",f:U8},255:{}};function sh(t,e,r,n){if(n.biff<8)return Qn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=lB(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=oB(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Qn(t,e)),s}function ah(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=E_[s]||E_[PB[s]],(s===24||s===25)&&(i=(s===24?LB:BB)[t[t.l+1]]),!i||!i.f?Qn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function jB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var zB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function VB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function AN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function T_(t,e,r){var n=AN(t,e,r);return n=="#REF"?n:VB(n,r)}function Gn(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,d,h=0,m=0,g,v="";if(!t[0]||!t[0][0])return"";for(var x=-1,w="",S=0,T=t[0].length;S<T;++S){var _=t[0][S];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:w=Fr(" ",t[0][x][1][1]);break;case 1:w=Fr("\r",t[0][x][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}u=u+w,x=-1}o.push(u+zB[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=sd(_[1][1],a,i),o.push(ad(d,s));break;case"PtgRefN":d=r?sd(_[1][1],r,i):_[1][1],o.push(ad(d,s));break;case"PtgRef3d":h=_[1][1],d=sd(_[1][2],a,i),v=T_(n,h,i),o.push(v+"!"+ad(d,s));break;case"PtgFunc":case"PtgFuncVar":var M=_[1][0],D=_[1][1];M||(M=0),M&=127;var O=M==0?[]:o.slice(-M);o.length-=M,D==="User"&&(D=O.shift()),o.push(D+"("+O.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=o_(_[1][1],r?{s:r}:a,i),o.push(Bx(g,i));break;case"PtgArea":g=o_(_[1][1],a,i),o.push(Bx(g,i));break;case"PtgArea3d":h=_[1][1],g=_[1][2],v=T_(n,h,i),o.push(v+"!"+Bx(g,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=_[1][2];var E=(n.names||[])[m-1]||(n[0]||[])[m],A=E?E.Name:"SH33TJSNAME"+String(m);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var N=_[1][1];m=_[1][2];var P;if(i.biff<=5)N<0&&(N=-N),n[N]&&(P=n[N][m]);else{var B="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][m]&&n[N][m].itab>0&&(B=n.SheetNames[n[N][m].itab-1]+"!"):B=n.SheetNames[m-1]+"!"),n[N]&&n[N][m])B+=n[N][m].Name;else if(n[0]&&n[0][m])B+=n[0][m].Name;else{var I=(AN(n,N,i)||"").split(";;");I[m-1]?B=I[m-1]:B+="SH33TJSERRX"}o.push(B);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var ee="(",oe=")";if(x>=0){switch(w="",t[0][x][1][0]){case 2:ee=Fr(" ",t[0][x][1][1])+ee;break;case 3:ee=Fr("\r",t[0][x][1][1])+ee;break;case 4:oe=Fr(" ",t[0][x][1][1])+oe;break;case 5:oe=Fr("\r",t[0][x][1][1])+oe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(ee+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Dt(d)]){var fe=n.sharedf[Dt(d)];o.push(Gn(fe,a,re,n,i))}else{var se=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Gn(u[1],a,re,n,i)),se=!0;break}se||o.push(_[1])}break;case"PtgArray":o.push("{"+jB(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&xe.indexOf(t[0][S][0])==-1){_=t[0][x];var H=!0;switch(_[1][0]){case 4:H=!1;case 0:w=Fr(" ",_[1][1]);break;case 5:H=!1;case 1:w=Fr("\r",_[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function $B(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Qn(t,e-2)];var o=ah(t,a,r);return e!==a+i&&(s=sh(t,e-a-i,o,r)),t.l=n,[o,s]}function UB(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Qn(t,e-2)];var o=ah(t,a,r);return e!==a+i&&(s=sh(t,e-a-i,o,r)),t.l=n,[o,s]}function HB(t,e,r,n){var i=t.l+e,s=ah(t,n,r),a;return i!==t.l&&(a=sh(t,i-t.l,s,r)),[s,a]}function WB(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=ah(t,s,r);return s==65535?[[],Qn(t,e-2)]:(e!==s+2&&(i=sh(t,n-s-2,a,r)),[a,i])}function GB(t){var e;if($a(t,t.l+6)!==65535)return[qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Vx(t,e,r){var n=t.l+e,i=ya(t);r.biff==2&&++t.l;var s=GB(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=UB(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Sm(t,e,r){var n=t.read_shift(4),i=ah(t,n,r),s=t.read_shift(4),a=s>0?sh(t,s,i,r):null;return[i,a]}var qB=Sm,_m=Sm,YB=Sm,KB=Sm,XB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ZB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function A_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function $x(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var ud={},xu={};function fd(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function MN(t,e,r,n,i,s){try{n.cellNF&&(t.z=It[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=vn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(It[e]==null&&Vl(JP[e]||"General",e),t.t==="e")t.w=t.w||mc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Td(t.v);else if(t.t==="d"){var a=fi(t.v);(a|0)===a?t.w=a.toString(10):t.w=Td(a)}else{if(t.v===void 0)return"";t.w=tc(t.v,xu)}else t.t==="d"?t.w=ps(e,fi(t.v),xu):t.w=ps(e,t.v,xu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Op(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Op(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function JB(t,e){var r=Rr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Xt(r))}var QB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ej=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,tj=/<(?:\w:)?hyperlink [^>]*>/mg,rj=/"(\w*:\w*)"/,nj=/<(?:\w:)?col\b[^>]*[\/]?>/g,ij=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sj=/<(?:\w:)?pageMargins[^>]*\/>/g,DN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,aj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,oj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function lj(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=t.match(ej);h?(u=t.slice(0,h.index),d=t.slice(h.index+h[0].length)):u=d=t;var m=u.match(DN);m?By(m[0],o,i,r):(m=u.match(aj))&&cj(m[0],m[1]||"",o,i,r);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var v=u.slice(g,g+50).match(rj);v&&JB(o,v[1])}var x=u.match(oj);x&&x[1]&&mj(x[1],i);var w=[];if(e.cellStyles){var S=u.match(nj);S&&dj(w,S)}h&&gj(h[1],o,e,l,s,a);var T=d.match(ij);T&&(o["!autofilter"]=hj(T[0]));var _=[],M=d.match(QB);if(M)for(g=0;g!=M.length;++g)_[g]=Rr(M[g].slice(M[g].indexOf('"')+1));var D=d.match(tj);D&&uj(o,D,n);var O=d.match(sj);if(O&&(o["!margins"]=fj(Et(O[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Xt(l)),e.sheetRows>0&&o["!ref"]){var E=Rr(o["!ref"]);e.sheetRows<=+E.e.r&&(E.e.r=e.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xt(E))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function By(t,e,r,n){var i=Et(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Qt(gr(i.codeName)))}function cj(t,e,r,n,i){By(t.slice(0,t.indexOf(">")),r,n,i)}function uj(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Et(gr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Qt(s.location))):(s.Target="#"+Qt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Rr(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Dt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=s)}}}function fj(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function dj(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Et(e[n],!0);i.hidden&&(i.hidden=Cr(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Py(i.width)),Eu(i);s<=a;)t[s++]=In(i)}}function hj(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var pj=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mj(t,e){e.Views||(e.Views=[{}]),(t.match(pj)||[]).forEach(function(r,n){var i=Et(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Cr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var gj=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Ad("v"),a=Ad("f");return function(l,u,d,h,m,g){for(var v=0,x="",w=[],S=[],T=0,_=0,M=0,D="",O,E,A=0,N=0,P,B,I=0,ee=0,oe=Array.isArray(g.CellXf),re,fe=[],se=[],xe=Array.isArray(u),H=[],ve={},W=!1,F=!!d.sheetStubs,X=l.split(e),Z=0,q=X.length;Z!=q;++Z){x=X[Z].trim();var ce=x.length;if(ce!==0){var Ce=0;e:for(v=0;v<ce;++v)switch(x[v]){case">":if(x[v-1]!="/"){++v;break e}if(d&&d.cellStyles){if(E=Et(x.slice(Ce,v),!0),A=E.r!=null?parseInt(E.r,10):A+1,N=-1,d.sheetRows&&d.sheetRows<A)continue;ve={},W=!1,E.ht&&(W=!0,ve.hpt=parseFloat(E.ht),ve.hpx=Od(ve.hpt)),E.hidden=="1"&&(W=!0,ve.hidden=!0),E.outlineLevel!=null&&(W=!0,ve.level=+E.outlineLevel),W&&(H[A-1]=ve)}break;case"<":Ce=v;break}if(Ce>=v)break;if(E=Et(x.slice(Ce,v),!0),A=E.r!=null?parseInt(E.r,10):A+1,N=-1,!(d.sheetRows&&d.sheetRows<A)){h.s.r>A-1&&(h.s.r=A-1),h.e.r<A-1&&(h.e.r=A-1),d&&d.cellStyles&&(ve={},W=!1,E.ht&&(W=!0,ve.hpt=parseFloat(E.ht),ve.hpx=Od(ve.hpt)),E.hidden=="1"&&(W=!0,ve.hidden=!0),E.outlineLevel!=null&&(W=!0,ve.level=+E.outlineLevel),W&&(H[A-1]=ve)),w=x.slice(v).split(t);for(var pe=0;pe!=w.length&&w[pe].trim().charAt(0)=="<";++pe);for(w=w.slice(pe),v=0;v!=w.length;++v)if(x=w[v].trim(),x.length!==0){if(S=x.match(r),T=v,_=0,M=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,S!=null&&S.length===2){for(T=0,D=S[1],_=0;_!=D.length&&!((M=D.charCodeAt(_)-64)<1||M>26);++_)T=26*T+M;--T,N=T}else++N;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,E=Et(x.slice(0,_),!0),E.r||(E.r=Dt({r:A-1,c:N})),D=x.slice(_),O={t:""},(S=D.match(s))!=null&&S[1]!==""&&(O.v=Qt(S[1])),d.cellFormula){if((S=D.match(a))!=null&&S[1]!==""){if(O.f=Qt(gr(S[1])).replace(/\r\n/g,`
`),d.xlfn||(O.f=__(O.f)),S[0].indexOf('t="array"')>-1)O.F=(D.match(i)||[])[1],O.F.indexOf(":")>-1&&fe.push([Rr(O.F),O.F]);else if(S[0].indexOf('t="shared"')>-1){B=Et(S[0]);var ue=Qt(gr(S[1]));d.xlfn||(ue=__(ue)),se[parseInt(B.si,10)]=[B,ue,E.r]}}else(S=D.match(/<f[^>]*\/>/))&&(B=Et(S[0]),se[B.si]&&(O.f=T8(se[B.si][1],se[B.si][2],E.r)));var Se=ci(E.r);for(_=0;_<fe.length;++_)Se.r>=fe[_][0].s.r&&Se.r<=fe[_][0].e.r&&Se.c>=fe[_][0].s.c&&Se.c<=fe[_][0].e.c&&(O.F=fe[_][1])}if(E.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(F)O.t="z";else continue;else O.t=E.t||"n";switch(h.s.c>N&&(h.s.c=N),h.e.c<N&&(h.e.c=N),O.t){case"n":if(O.v==""||O.v==null){if(!F)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!F)continue;O.t="z"}else P=ud[parseInt(O.v,10)],O.v=P.t,O.r=P.r,d.cellHTML&&(O.h=P.h);break;case"str":O.t="s",O.v=O.v!=null?gr(O.v):"",d.cellHTML&&(O.h=Cy(O.v));break;case"inlineStr":S=D.match(n),O.t="s",S!=null&&(P=Ry(S[1]))?(O.v=P.t,d.cellHTML&&(O.h=P.h)):O.v="";break;case"b":O.v=Cr(O.v);break;case"d":d.cellDates?O.v=vn(O.v,1):(O.v=fi(vn(O.v,1)),O.t="n");break;case"e":(!d||d.cellText!==!1)&&(O.w=O.v),O.v=JA[O.v];break}if(I=ee=0,re=null,oe&&E.s!==void 0&&(re=g.CellXf[E.s],re!=null&&(re.numFmtId!=null&&(I=re.numFmtId),d.cellStyles&&re.fillId!=null&&(ee=re.fillId))),MN(O,I,ee,d,m,g),d.cellDates&&oe&&O.t=="n"&&Uu(It[I])&&(O.t="d",O.v=bm(O.v)),E.cm&&d.xlmeta){var ze=(d.xlmeta.Cell||[])[+E.cm-1];ze&&ze.type=="XLDAPR"&&(O.D=!0)}if(xe){var j=ci(E.r);u[j.r]||(u[j.r]=[]),u[j.r][j.c]=O}else u[E.r]=O}}}}H.length>0&&(u["!rows"]=H)}})();function xj(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var vj=pc;function yj(){}function wj(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=$3(t),r}function bj(t){var e=gs(t);return[e]}function kj(t){var e=hc(t);return[e]}function Sj(t){var e=gs(t),r=t.read_shift(1);return[e,r,"b"]}function _j(t){var e=hc(t),r=t.read_shift(1);return[e,r,"b"]}function Cj(t){var e=gs(t),r=t.read_shift(1);return[e,r,"e"]}function Ej(t){var e=hc(t),r=t.read_shift(1);return[e,r,"e"]}function Tj(t){var e=gs(t),r=t.read_shift(4);return[e,r,"s"]}function Aj(t){var e=hc(t),r=t.read_shift(4);return[e,r,"s"]}function Nj(t){var e=gs(t),r=qn(t);return[e,r,"n"]}function ON(t){var e=hc(t),r=qn(t);return[e,r,"n"]}function Mj(t){var e=gs(t),r=Oy(t);return[e,r,"n"]}function Dj(t){var e=hc(t),r=Oy(t);return[e,r,"n"]}function Oj(t){var e=gs(t),r=My(t);return[e,r,"is"]}function Fj(t){var e=gs(t),r=Jn(t);return[e,r,"str"]}function Ij(t){var e=hc(t),r=Jn(t);return[e,r,"str"]}function Rj(t,e,r){var n=t.l+e,i=gs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=_m(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function Pj(t,e,r){var n=t.l+e,i=gs(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=_m(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function Lj(t,e,r){var n=t.l+e,i=gs(t);i.r=r["!row"];var s=qn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=_m(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}function Bj(t,e,r){var n=t.l+e,i=gs(t);i.r=r["!row"];var s=Jn(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=_m(t,n-t.l,r);a[3]=Gn(o,null,i,r.supbooks,r)}else t.l=n;return a}var jj=pc;function zj(t,e){var r=t.l+e,n=pc(t),i=Dy(t),s=Jn(t),a=Jn(t),o=Jn(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Vj(){}function $j(t,e,r){var n=t.l+e,i=KA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=qB(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Uj(t,e,r){var n=t.l+e,i=pc(t),s=[i];if(r.cellFormula){var a=KB(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}var Hj=["left","right","top","bottom","header","footer"];function Wj(t){var e={};return Hj.forEach(function(r){e[r]=qn(t)}),e}function Gj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function qj(){}function Yj(){}function Kj(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,g,v,x,w,S,T,_,M,D,O=[];o.biff=12,o["!row"]=0;var E=0,A=!1,N=[],P={},B=o.supbooks||i.supbooks||[[]];if(B.sharedf=P,B.arrayf=N,B.SheetNames=i.SheetNames||i.Sheets.map(function(xe){return xe.name}),!o.supbooks&&(o.supbooks=B,i.Names))for(var I=0;I<i.Names.length;++I)B[0][I+1]=i.Names[I];var ee=[],oe=[],re=!1;Rp[16]={n:"BrtShortReal",f:ON};var fe;if(Qa(t,function(H,ve,W){if(!m)switch(W){case 148:u=H;break;case 0:g=H,o.sheetRows&&o.sheetRows<=g.r&&(m=!0),M=Rn(w=g.r),o["!row"]=g.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Od(H.hpt)),oe[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:H[2]},H[2]){case"n":v.v=H[1];break;case"s":_=ud[H[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!H[1];break;case"e":v.v=H[1],o.cellText!==!1&&(v.w=mc[v.v]);break;case"str":v.t="s",v.v=H[1];break;case"is":v.t="s",v.v=H[1].t;break}if((x=a.CellXf[H[0].iStyleRef])&&MN(v,x.numFmtId,null,o,s,a),S=H[0].c==-1?S+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=v):l[cn(S)+M]=v,o.cellFormula){for(A=!1,E=0;E<N.length;++E){var F=N[E];g.r>=F[0].s.r&&g.r<=F[0].e.r&&S>=F[0].s.c&&S<=F[0].e.c&&(v.F=Xt(F[0]),A=!0)}!A&&H.length>3&&(v.f=H[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>S&&(d.s.c=S),d.e.r<g.r&&(d.e.r=g.r),d.e.c<S&&(d.e.c=S),o.cellDates&&x&&v.t=="n"&&Uu(It[x.numFmtId])){var X=Pl(v.v);X&&(v.t="d",v.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},S=H[0].c==-1?S+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=v):l[cn(S)+M]=v,d.s.r>g.r&&(d.s.r=g.r),d.s.c>S&&(d.s.c=S),d.e.r<g.r&&(d.e.r=g.r),d.e.c<S&&(d.e.c=S),fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 176:O.push(H);break;case 49:fe=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var Z=n["!id"][H.relId];for(Z?(H.Target=Z.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=Z):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(S=H.rfx.s.c;S<=H.rfx.e.c;++S)o.dense?(l[w]||(l[w]=[]),l[w][S]||(l[w][S]={t:"z",v:void 0}),l[w][S].l=H):(T=Dt({c:S,r:w}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=H);break;case 426:if(!o.cellFormula)break;N.push(H),D=o.dense?l[w][S]:l[cn(S)+M],D.f=Gn(H[1],d,{r:g.r,c:S},B,o),D.F=Xt(H[0]);break;case 427:if(!o.cellFormula)break;P[Dt(H[0].s)]=H[1],D=o.dense?l[w][S]:l[cn(S)+M],D.f=Gn(H[1],d,{r:g.r,c:S},B,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)ee[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},re||(re=!0,Py(H.w/256)),Eu(ee[H.e+1]);break;case 161:l["!autofilter"]={ref:Xt(H)};break;case 476:l["!margins"]=H;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),H.name&&(i.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),H.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ve.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=Xt(u||d)),o.sheetRows&&l["!ref"]){var se=Rr(l["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>d.e.r&&(se.e.r=d.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>d.e.c&&(se.e.c=d.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xt(se))}return O.length>0&&(l["!merges"]=O),ee.length>0&&(l["!cols"]=ee),oe.length>0&&(l["!rows"]=oe),l}function Xj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Qt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function Zj(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=Xj(h);d.s.r=d.s.c=0,d.e.c=o,u=cn(o),m[0].forEach(function(g,v){a[u+Rn(v)]={t:"n",v:g,z:m[1]},l=v}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(a["!ref"]=Xt(d)),a}function Jj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(DN);return o&&By(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Qj(t,e){t.l+=10;var r=Jn(t);return{name:r}}function e9(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Qa(t,function(l,u,d){switch(d){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var FN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],t9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],r9=[],n9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function N_(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Cr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function M_(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Cr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function IN(t){M_(t.WBProps,FN),M_(t.CalcPr,n9),N_(t.WBView,t9),N_(t.Sheets,r9),xu.date1904=Cr(t.WBProps.date1904)}var i9="][*?/\\".split("");function s9(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return i9.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var a9=/<\w+:workbook/;function o9(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ti,function(l,u){var d=Et(l);switch(va(d[0])){case"<?xml":break;case"<workbook":l.match(a9)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":FN.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Cr(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=gr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Qt(gr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=gr(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Cr(d.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=Qt(gr(t.slice(a,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),C3.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return IN(r),r}function l9(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Zv(t),r.name=Jn(t),r}function c9(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Jn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function u9(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function f9(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=U3(t),a=YB(t,0,r),o=Dy(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function d9(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Rp[16]={n:"BrtFRTArchID$",f:u9},Qa(t,function(l,u,d){switch(d){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Gn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([d,l]):a[0]=[d,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),IN(r),r.Names=s,r.supbooks=a,r}function h9(t,e,r){return e.slice(-4)===".bin"?d9(t,r):o9(t,r)}function p9(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?Kj(t,n,r,i,s,a,o):lj(t,n,r,i,s,a,o)}function m9(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?e9(t,n,r,i,s):Jj(t,n,r,i,s)}function g9(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?_8():C8()}function x9(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?k8():S8()}function v9(t,e,r,n){return e.slice(-4)===".bin"?j6(t,r,n):F6(t,r,n)}function y9(t,e,r){return wN(t,r)}function w9(t,e,r){return e.slice(-4)===".bin"?t6(t,r):Q5(t,r)}function b9(t,e,r){return e.slice(-4)===".bin"?y8(t,r):p8(t,r)}function k9(t,e,r){return e.slice(-4)===".bin"?f8(t):c8(t)}function S9(t,e,r,n){return r.slice(-4)===".bin"?d8(t,e,r,n):void 0}function _9(t,e,r){return e.slice(-4)===".bin"?o8(t,e,r):l8(t,e,r)}var RN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,PN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function As(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(RN),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(PN),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function C9(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(RN),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(PN),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var dd;function E9(t,e){var r=dd[t]||Qt(t);return r==="General"?tc(e):ps(r,e)}function T9(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Cr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=vn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Qt(e)]=i}function A9(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||mc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Td(t.v):t.w=tc(t.v):t.w=E9(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=dd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Uu(n)){var i=Pl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function N9(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=T6[n.Pattern]||n.Pattern)}t[e.ID]=e}function M9(t,e,r,n,i,s,a,o,l,u){var d="General",h=n.StyleID,m={};u=u||{};var g=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&g.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Cr(t);break;case"String":n.t="s",n.r=JS(Qt(t)),n.v=t.indexOf("<")>-1?Qt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(vn(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Qt(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=JA[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=JS(e||t));break}if(A9(n,d,u),u.cellFormula!==!1)if(n.Formula){var x=Qt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=gu(x,i),delete n.Formula,n.ArrayRange=="RC"?n.F=gu("RC:RC",i):n.ArrayRange&&(n.F=gu(n.ArrayRange,i),l.push([Rr(n.F),n.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(g.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function D9(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Ux(t,e){var r=e||{};_A();var n=Hf(Ey(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=gr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=In(r);return a.type="string",Md.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(at){i.indexOf("<"+at)>=0&&(s=!0)}),s)return z9(n,r);dd={"General Number":"General","General Date":It[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":It[15],"Short Date":It[14],"Long Time":It[19],"Medium Time":It[18],"Short Time":It[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:It[2],Standard:It[4],Percent:It[10],Scientific:It[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},h=[],m=r.dense?[]:{},g="",v={},x={},w=As('<Data ss:Type="String">'),S=0,T=0,_=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},O={},E="",A=0,N=[],P={},B={},I=0,ee=[],oe=[],re={},fe=[],se,xe=!1,H=[],ve=[],W={},F=0,X=0,Z={Sheets:[],WBProps:{date1904:!1}},q={};Nd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";o=Nd.exec(n);)switch(o[3]=(ce=o[3]).toLowerCase()){case"data":if(ce=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?M9(n.slice(S,o.index),E,w,l[l.length-1][0]=="comment"?re:v,{c:T,r:_},D,fe[T],x,H,r):(E="",w=As(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(v.c=oe),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(m[_]||(m[_]=[]),m[_][T]=v):m[cn(T)+Rn(_)]=v),v.HRef&&(v.l={Target:Qt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(F=T+(parseInt(v.MergeAcross,10)|0),X=_+(parseInt(v.MergeDown,10)|0),N.push({s:{c:T,r:_},e:{c:F,r:X}})),!r.sheetStubs)v.MergeAcross?T=F+1:++T;else if(v.MergeAcross||v.MergeDown){for(var Ce=T;Ce<=F;++Ce)for(var pe=_;pe<=X;++pe)(Ce>T||pe>_)&&(r.dense?(m[pe]||(m[pe]=[]),m[pe][Ce]={t:"z"}):m[cn(Ce)+Rn(pe)]={t:"z"});T=F+1}else++T;else v=C9(o[0]),v.Index&&(T=+v.Index-1),T<M.s.c&&(M.s.c=T),T>M.e.c&&(M.e.c=T),o[0].slice(-2)==="/>"&&++T,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<M.s.r&&(M.s.r=_),_>M.e.r&&(M.e.r=_),o[0].slice(-2)==="/>"&&(x=As(o[0]),x.Index&&(_=+x.Index-1)),T=0,++_):(x=As(o[0]),x.Index&&(_=+x.Index-1),W={},(x.AutoFitHeight=="0"||x.Height)&&(W.hpx=parseInt(x.Height,10),W.hpt=yN(W.hpx),ve[_]=W),x.Hidden=="1"&&(W.hidden=!0,ve[_]=W));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(g),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(m["!ref"]=Xt(M),r.sheetRows&&r.sheetRows<=M.e.r&&(m["!fullref"]=m["!ref"],M.e.r=r.sheetRows-1,m["!ref"]=Xt(M))),N.length&&(m["!merges"]=N),fe.length>0&&(m["!cols"]=fe),ve.length>0&&(m["!rows"]=ve),d[g]=m}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=T=0,l.push([o[3],!1]),u=As(o[0]),g=Qt(u.Name),m=r.dense?[]:{},N=[],H=[],ve=[],q={name:g,Hidden:0},Z.Sheets.push(q);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],xe=!1}break;case"style":o[1]==="/"?N9(D,O,r):O=As(o[0]);break;case"numberformat":O.nf=Qt(As(o[0]).Format||"General"),dd[O.nf]&&(O.nf=dd[O.nf]);for(var ue=0;ue!=392&&It[ue]!=O.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(It[ue]==null){Vl(O.nf,ue);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(se=As(o[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!xe&&se.wpx>10){xe=!0,li=xN;for(var Se=0;Se<fe.length;++Se)fe[Se]&&Eu(fe[Se])}xe&&Eu(se),fe[se.Index-1||fe.length]=se;for(var ze=0;ze<+se.Span;++ze)fe[fe.length]=In(se);break;case"namedrange":if(o[1]==="/")break;Z.Names||(Z.Names=[]);var j=Et(o[0]),tt={Name:j.Name,Ref:gu(j.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(tt.Sheet=Z.Sheets.length-1),Z.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=As(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?pL(P,ce,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));D9(re),oe.push(re)}else l.push([o[3],!1]),u=As(o[0]),re={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ne=As(o[0]);m["!autofilter"]={ref:gu(Ne.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return P_(n,r);var qe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:qe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:qe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:qe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:qe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else I=o.index+o[0].length;break;case"header":m["!margins"]||fd(m["!margins"]={},"xlml"),isNaN(+Et(o[0]).Margin)||(m["!margins"].header=+Et(o[0]).Margin);break;case"footer":m["!margins"]||fd(m["!margins"]={},"xlml"),isNaN(+Et(o[0]).Margin)||(m["!margins"].footer=+Et(o[0]).Margin);break;case"pagemargins":var Le=Et(o[0]);m["!margins"]||fd(m["!margins"]={},"xlml"),isNaN(+Le.Top)||(m["!margins"].top=+Le.Top),isNaN(+Le.Left)||(m["!margins"].left=+Le.Left),isNaN(+Le.Right)||(m["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(m["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:qe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:qe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:qe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:qe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:qe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:qe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:qe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:qe=!1}break;case"smarttags":break;default:qe=!1;break}if(qe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?T9(B,ce,ee,n.slice(I,o.index)):(ee=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Te={};return!r.bookSheets&&!r.bookProps&&(Te.Sheets=d),Te.SheetNames=h,Te.Workbook=Z,Te.SSF=In(It),Te.Props=P,Te.Custprops=B,Te}function t1(t,e){switch(Vy(e=e||{}),e.type||"base64"){case"base64":return Ux(Gi(t),e);case"binary":case"buffer":case"file":return Ux(t,e);case"array":return Ux(dc(t),e)}}function O9(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=G3(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=q3(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var F9=[60,1084,2066,2165,2175];function I9(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=$a(r,r.l),u=r1[l],d=0;u!=null&&F9.indexOf(l)>-1;)s=$a(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+s),a.push(o),r.l+=4+s,u=r1[l=$a(r,r.l)];var h=No(a);Mn(h,0);var m=0;h.lens=[];for(var g=0;g<a.length;++g)h.lens.push(m),m+=a[g].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Qs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=It[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||mc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Td(t.v):t.w=tc(t.v):t.w=ps(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Uu(It[n]||String(n))){var i=Pl(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function M0(t,e,r){return{v:t,ixfe:e,t:r}}function R9(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],u="",d={},h,m="",g,v,x,w,S={},T=[],_,M,D=[],O=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},N=function(rt){return rt<8?$l[rt]:rt<64&&O[rt-8]||$l[rt]},P=function(rt,Tt,ar){var $t=Tt.XF.data;if(!(!$t||!$t.patternType||!ar||!ar.cellStyles)){Tt.s={},Tt.s.patternType=$t.patternType;var Mr;(Mr=Dd(N($t.icvFore)))&&(Tt.s.fgColor={rgb:Mr}),(Mr=Dd(N($t.icvBack)))&&(Tt.s.bgColor={rgb:Mr})}},B=function(rt,Tt,ar){if(!(W>1)&&!(ar.sheetRows&&rt.r>=ar.sheetRows)){if(ar.cellStyles&&Tt.XF&&Tt.XF.data&&P(rt,Tt,ar),delete Tt.ixfe,delete Tt.XF,h=rt,m=Dt(rt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<a.s.r&&(a.s.r=rt.r),rt.c<a.s.c&&(a.s.c=rt.c),rt.r+1>a.e.r&&(a.e.r=rt.r+1),rt.c+1>a.e.c&&(a.e.c=rt.c+1),ar.cellFormula&&Tt.f){for(var $t=0;$t<T.length;++$t)if(!(T[$t][0].s.c>rt.c||T[$t][0].s.r>rt.r)&&!(T[$t][0].e.c<rt.c||T[$t][0].e.r<rt.r)){Tt.F=Xt(T[$t][0]),(T[$t][0].s.c!=rt.c||T[$t][0].s.r!=rt.r)&&delete Tt.f,Tt.f&&(Tt.f=""+Gn(T[$t][1],a,rt,H,I));break}}ar.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=Tt):i[m]=Tt}},I={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(I.password=e.password);var ee,oe=[],re=[],fe=[],se=[],xe=!1,H=[];H.SheetNames=I.snames,H.sharedf=I.sharedf,H.arrayf=I.arrayf,H.names=[],H.XTI=[];var ve=0,W=0,F=0,X=[],Z=[],q;I.codepage=1200,Is(1200);for(var ce=!1;t.l<t.length-1;){var Ce=t.l,pe=t.read_shift(2);if(pe===0&&ve===10)break;var ue=t.l===t.length?0:t.read_shift(2),Se=r1[pe];if(Se&&Se.f){if(e.bookSheets&&ve===133&&pe!==133)break;if(ve=pe,Se.r===2||Se.r==12){var ze=t.read_shift(2);if(ue-=2,!I.enc&&ze!==pe&&((ze&255)<<8|ze>>8)!==pe)throw new Error("rt mismatch: "+ze+"!="+pe);Se.r==12&&(t.l+=10,ue-=10)}var j={};if(pe===10?j=Se.f(t,ue,I):j=I9(pe,Se,t,ue,I),W==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(pe){case 34:r.opts.Date1904=E.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=j,!e.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=j;break;case 66:var tt=Number(j);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}Is(I.codepage=tt),ce=!0;break;case 317:I.rrtabid=j;break;case 25:I.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:I.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(i["!type"]="dialog"),j.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),j.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:D.push(j);break;case 430:H.push([j]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(j);break;case 24:case 536:q={Name:j.Name,Ref:Gn(j.rgce,a,null,H,I)},j.itab>0&&(q.Sheet=j.itab-1),H.names.push(q),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(Z[j.itab-1]={ref:Xt(j.rgce[0][0][1][2])});break;case 22:I.ExternCount=j;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(j),H.XTI=H.XTI.concat(j);break;case 2196:if(I.biff<8)break;q!=null&&(q.Comment=j[1]);break;case 18:i["!protect"]=j;break;case 19:j!==0&&I.WTF&&console.error("Password verifier: "+j);break;case 133:s[j.pos]=j,I.snames.push(j.name);break;case 10:{if(--W)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Xt(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ne=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Xt(a),a.e.r=Ne}a.e.r++,a.e.c++}oe.length>0&&(i["!merges"]=oe),re.length>0&&(i["!objects"]=re),fe.length>0&&(i["!cols"]=fe),se.length>0&&(i["!rows"]=se),E.Sheets.push(A)}u===""?d=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),I.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(I.biff=5,ce=!0,Is(I.codepage=28591)),I.biff==8&&j.BIFFVer==0&&j.dt==16&&(I.biff=2),W++)break;if(i=e.dense?[]:{},I.biff<8&&!ce&&(ce=!0,Is(I.codepage=e.codepage||1252)),I.biff<5||j.BIFFVer==0&&j.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var qe={pos:t.l-ue,name:u};s[qe.pos]=qe,I.snames.push(u)}else u=(s[Ce]||{name:""}).name;j.dt==32&&(i["!type"]="chart"),j.dt==64&&(i["!type"]="macro"),oe=[],re=[],I.arrayf=T=[],fe=[],se=[],xe=!1,A={Hidden:(s[Ce]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[j.r]||[])[j.c]:i[Dt({c:j.c,r:j.r})])&&++j.c,_={ixfe:j.ixfe,XF:D[j.ixfe]||{},v:j.val,t:"n"},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e);break;case 5:case 517:_={ixfe:j.ixfe,XF:D[j.ixfe],v:j.val,t:j.t},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e);break;case 638:_={ixfe:j.ixfe,XF:D[j.ixfe],v:j.rknum,t:"n"},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e);break;case 189:for(var Le=j.c;Le<=j.C;++Le){var Te=j.rkrec[Le-j.c][0];_={ixfe:Te,XF:D[Te],v:j.rkrec[Le-j.c][1],t:"n"},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:Le,r:j.r},_,e)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(_=M0(j.val,j.cell.ixfe,j.tt),_.XF=D[_.ixfe],e.cellFormula){var at=j.formula;if(at&&at[0]&&at[0][0]&&at[0][0][0]=="PtgExp"){var gt=at[0][0][1][0],J=at[0][0][1][1],le=Dt({r:gt,c:J});S[le]?_.f=""+Gn(j.formula,a,j.cell,H,I):_.F=((e.dense?(i[gt]||[])[J]:i[le])||{}).F}else _.f=""+Gn(j.formula,a,j.cell,H,I)}F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B(j.cell,_,e),o=j}break;case 7:case 519:if(o)o.val=j,_=M0(j,o.cell.ixfe,"s"),_.XF=D[_.ixfe],e.cellFormula&&(_.f=""+Gn(o.formula,a,o.cell,H,I)),F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(j);var be=Dt(j[0].s);if(g=e.dense?(i[j[0].s.r]||[])[j[0].s.c]:i[be],e.cellFormula&&g){if(!o||!be||!g)break;g.f=""+Gn(j[1],a,j[0],H,I),g.F=Xt(j[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;S[Dt(o.cell)]=j[0],g=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Dt(o.cell)],(g||{}).f=""+Gn(j[0],a,h,H,I)}}break;case 253:_=M0(l[j.isst].t,j.ixfe,"s"),l[j.isst].h&&(_.h=l[j.isst].h),_.XF=D[_.ixfe],F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:j.ixfe,XF:D[j.ixfe],t:"z"},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e));break;case 190:if(e.sheetStubs)for(var Ve=j.c;Ve<=j.C;++Ve){var Me=j.ixfe[Ve-j.c];_={ixfe:Me,XF:D[Me],t:"z"},F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:Ve,r:j.r},_,e)}break;case 214:case 516:case 4:_=M0(j.val,j.ixfe,"s"),_.XF=D[_.ixfe],F>0&&(_.z=X[_.ixfe>>8&63]),Qs(_,e,r.opts.Date1904),B({c:j.c,r:j.r},_,e);break;case 0:case 512:W===1&&(a=j);break;case 252:l=j;break;case 1054:if(I.biff==4){X[F++]=j[1];for(var Ae=0;Ae<F+163&&It[Ae]!=j[1];++Ae);Ae>=163&&Vl(j[1],F+163)}else Vl(j[1],j[0]);break;case 30:{X[F++]=j;for(var $e=0;$e<F+163&&It[$e]!=j;++$e);$e>=163&&Vl(j,F+163)}break;case 229:oe=oe.concat(j);break;case 93:re[j.cmo[0]]=I.lastobj=j;break;case 438:I.lastobj.TxO=j;break;case 127:I.lastobj.ImData=j;break;case 440:for(w=j[0].s.r;w<=j[0].e.r;++w)for(x=j[0].s.c;x<=j[0].e.c;++x)g=e.dense?(i[w]||[])[x]:i[Dt({c:x,r:w})],g&&(g.l=j[1]);break;case 2048:for(w=j[0].s.r;w<=j[0].e.r;++w)for(x=j[0].s.c;x<=j[0].e.c;++x)g=e.dense?(i[w]||[])[x]:i[Dt({c:x,r:w})],g&&g.l&&(g.l.Tooltip=j[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;g=e.dense?(i[j[0].r]||[])[j[0].c]:i[Dt(j[0])];var et=re[j[2]];g||(e.dense?(i[j[0].r]||(i[j[0].r]=[]),g=i[j[0].r][j[0].c]={t:"z"}):g=i[Dt(j[0])]={t:"z"},a.e.r=Math.max(a.e.r,j[0].r),a.s.r=Math.min(a.s.r,j[0].r),a.e.c=Math.max(a.e.c,j[0].c),a.s.c=Math.min(a.s.c,j[0].c)),g.c||(g.c=[]),v={a:j[1],t:et.TxO.t},g.c.push(v)}break;case 2173:n8(D[j.ixfe],j.ext);break;case 125:{if(!I.cellStyles)break;for(;j.e>=j.s;)fe[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},xe||(xe=!0,Py(j.w/256)),Eu(fe[j.e+1])}break;case 520:{var st={};j.level!=null&&(se[j.r]=st,st.level=j.level),j.hidden&&(se[j.r]=st,st.hidden=!0),j.hpt&&(se[j.r]=st,st.hpt=j.hpt,st.hpx=Od(j.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||fd(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=j;break;case 161:i["!margins"]||fd(i["!margins"]={}),i["!margins"].header=j.header,i["!margins"].footer=j.footer;break;case 574:j.RTL&&(E.Views[0].RTL=!0);break;case 146:O=j;break;case 2198:ee=j;break;case 140:M=j;break;case 442:u?A.CodeName=j||A.name:E.WBProps.CodeName=j||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),t.l+=ue}return r.SheetNames=pa(s).sort(function(Nt,rt){return Number(Nt)-Number(rt)}).map(function(Nt){return s[Nt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&Z.forEach(function(Nt,rt){r.Sheets[r.SheetNames[rt]]["!autofilter"]=Nt}),r.Strings=l,r.SSF=In(It),I.enc&&(r.Encryption=I.enc),ee&&(r.Themes=ee),r.Metadata={},M!==void 0&&(r.Metadata.Country=M),H.names.length>0&&(E.Names=H.names),r.Workbook=E,r}var D_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function P9(t,e,r){var n=Kt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=p_(n,Q3,D_.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var a=Kt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=p_(a,eL,D_.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(eN(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function LN(t,e){e||(e={}),Vy(e),dA(),e.codepage&&yy(e.codepage);var r,n;if(t.FullPaths){if(Kt.find(t,"/encryption"))throw new Error("File is password-protected");r=Kt.find(t,"!CompObj"),n=Kt.find(t,"/Workbook")||Kt.find(t,"/Book")}else{switch(e.type){case"base64":t=Os(Gi(t));break;case"binary":t=Os(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Mn(t,0),n={content:t}}var i,s;if(r&&O9(r),e.bookProps&&!e.bookSheets)i={};else{var a=Wt?"buffer":"array";if(n&&n.content)i=R9(n.content,e);else if((s=Kt.find(t,"PerfectOffice_MAIN"))&&s.content)i=cd.to_workbook(s.content,(e.type=a,e));else if((s=Kt.find(t,"NativeContent_MAIN"))&&s.content)i=cd.to_workbook(s.content,(e.type=a,e));else throw(s=Kt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Kt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=b8(t))}var o={};return t.FullPaths&&P9(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}var Rp={0:{f:xj},1:{f:bj},2:{f:Mj},3:{f:Cj},4:{f:Sj},5:{f:Nj},6:{f:Fj},7:{f:Tj},8:{f:Bj},9:{f:Lj},10:{f:Rj},11:{f:Pj},12:{f:kj},13:{f:Dj},14:{f:Ej},15:{f:_j},16:{f:ON},17:{f:Ij},18:{f:Aj},19:{f:My},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:f9},40:{},42:{},43:{f:R6},44:{f:I6},45:{f:P6},46:{f:B6},47:{f:L6},48:{},49:{f:j3},50:{},51:{f:s8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dN},62:{f:Oj},63:{f:u8},64:{f:qj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Gj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:wj},148:{f:vj,p:16},151:{f:Vj},152:{},153:{f:c9},154:{},155:{},156:{f:l9},157:{},158:{},159:{T:1,f:e6},160:{T:-1},161:{T:1,f:pc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:jj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:i8},336:{T:-1},337:{f:a8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$j},427:{f:Uj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Wj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:yj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:zj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v8},633:{T:1},634:{T:-1},635:{T:1,f:x8},636:{T:-1},637:{f:V3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Qj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Yj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},r1={6:{f:Vx},10:{f:bo},12:{f:Kr},13:{f:Kr},14:{f:Br},15:{f:Br},16:{f:qn},17:{f:Br},18:{f:Br},19:{f:Kr},20:{f:v_},21:{f:v_},23:{f:fN},24:{f:w_},25:{f:Br},26:{},27:{},28:{f:m5},29:{},34:{f:Br},35:{f:y_},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:Br},43:{f:Br},47:{f:y6},49:{f:XL},51:{f:Kr},60:{},61:{f:qL},64:{f:Br},65:{f:KL},66:{f:Kr},77:{},80:{},81:{},82:{},85:{f:Kr},89:{},90:{},91:{},92:{f:jL},93:{f:x5},94:{},95:{f:Br},96:{},97:{},99:{f:Br},125:{f:dN},128:{f:a5},129:{f:zL},130:{f:Kr},131:{f:Br},132:{f:Br},133:{f:VL},134:{},140:{f:S5},141:{f:Kr},144:{},146:{f:C5},151:{},152:{},153:{},154:{},155:{},156:{f:Kr},157:{},158:{},160:{f:M5},161:{f:T5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:r5},190:{f:n5},193:{f:bo},197:{},198:{},199:{},200:{},201:{},202:{f:Br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Kr},220:{},221:{f:Br},222:{},224:{f:s5},225:{f:BL},226:{f:bo},227:{},229:{f:g5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$L},253:{f:ZL},255:{f:UL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Br},353:{f:bo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:l5},431:{f:Br},432:{},433:{},434:{},437:{},438:{f:w5},439:{f:Br},440:{f:b5},441:{},442:{f:nh},443:{},444:{f:Kr},445:{},446:{},448:{f:bo},449:{f:GL,r:2},450:{f:bo},512:{f:g_},513:{f:N5},515:{f:o5},516:{f:JL},517:{f:x_},519:{f:D5},520:{f:HL},523:{},545:{f:b_},549:{f:m_},566:{},574:{f:YL},638:{f:t5},659:{},1048:{},1054:{f:QL},1084:{},1212:{f:d5},2048:{f:k5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:T0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:E5,r:12},2173:{f:r8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:f5,r:12},2197:{},2198:{f:X6,r:12},2199:{},2200:{},2201:{},2202:{f:h5,r:12},2203:{f:bo},2204:{},2205:{},2206:{},2207:{},2211:{f:WL},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Kr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:A5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:g_},1:{},2:{f:R5},3:{f:I5},4:{f:F5},5:{f:x_},7:{f:P5},8:{},9:{f:T0},11:{},22:{f:Kr},30:{f:e5},31:{},32:{},33:{f:b_},36:{},37:{f:m_},50:{f:L5},62:{},52:{},67:{},68:{f:Kr},69:{},86:{},126:{},127:{f:O5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:B5},223:{},234:{},354:{},421:{},518:{f:Vx},521:{f:T0},536:{f:w_},547:{f:y_},561:{},579:{},1030:{f:Vx},1033:{f:T0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ns(t,e,r,n){var i=e;if(!isNaN(i)){var s=(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&GA(r)&&t.push(r)}}function O_(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=o3(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,m=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var x=l[a].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var S=x.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var T=S[o].trim();if(T.match(/<t[dh]/i)){for(var _=T,M=0;_.charAt(0)=="<"&&(M=_.indexOf(">"))>-1;)_=_.slice(M+1);for(var D=0;D<v.length;++D){var O=v[D];O.s.c==d&&O.s.r<u&&u<=O.e.r&&(d=O.e.c+1,D=-1)}var E=Et(T.slice(0,T.indexOf(">")));m=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||m>1)&&v.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+m-1}});var A=E.t||E["data-t"]||"";if(!_.length){d+=m;continue}if(_=FA(_),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!_.length){d+=m;continue}var N={t:"s",v:_};r.raw||!_.trim().length||A=="s"||(_==="TRUE"?N={t:"b",v:!0}:_==="FALSE"?N={t:"b",v:!1}:isNaN(Ps(_))?isNaN(Cu(_).getDate())||(N={t:"d",v:vn(_)},r.cellDates||(N={t:"n",v:fi(N.v)}),N.z=r.dateNF||It[14]):N={t:"n",v:Ps(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=N):n[Dt({r:u,c:d})]=N,d+=m}}}}return n["!ref"]=Xt(g),v.length&&(n["!merges"]=v),n}function L9(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>a)&&!(i[u].e.r<r||i[u].e.c<a)){if(i[u].s.r<r||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var d=Dt({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],m=h&&h.v!=null&&(h.h||Cy(h.w||(Ka(h),h.w)||""))||"",g={};o>1&&(g.rowspan=o),l>1&&(g.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),g.id=(n.id||"sjs")+"-"+d,s.push(S3("td",m,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var B9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',j9="</body></html>";function z9(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return il(O_(r[0],e),e);var n=Uy();return r.forEach(function(i,s){Hy(n,O_(i,e),"Sheet"+(s+1))}),n}function V9(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $9(t,e){var r=e||{},n=r.header!=null?r.header:B9,i=r.footer!=null?r.footer:j9,s=[n],a=Hu(t["!ref"]);r.dense=Array.isArray(t),s.push(V9(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(L9(t,a,o,r));return s.push("</table>"+i),s.join("")}function BN(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?ci(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var d=Hu(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var h=[],m=0,g=t["!rows"]||(t["!rows"]=[]),v=0,x=0,w=0,S=0,T=0,_=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&x<l;++v){var M=o[v];if(F_(M)){if(n.display)continue;g[x]={hidden:!0}}var D=M.children;for(w=S=0;w<D.length;++w){var O=D[w];if(!(n.display&&F_(O))){var E=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):FA(O.innerHTML),A=O.getAttribute("data-z")||O.getAttribute("z");for(m=0;m<h.length;++m){var N=h[m];N.s.c==S+s&&N.s.r<x+i&&x+i<=N.e.r&&(S=N.e.c+1-s,m=-1)}_=+O.getAttribute("colspan")||1,((T=+O.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+i,c:S+s},e:{r:x+i+(T||1)-1,c:S+s+(_||1)-1}});var P={t:"s",v:E},B=O.getAttribute("data-t")||O.getAttribute("t")||"";E!=null&&(E.length==0?P.t=B||"z":n.raw||E.trim().length==0||B=="s"||(E==="TRUE"?P={t:"b",v:!0}:E==="FALSE"?P={t:"b",v:!1}:isNaN(Ps(E))?isNaN(Cu(E).getDate())||(P={t:"d",v:vn(E)},n.cellDates||(P={t:"n",v:fi(P.v)}),P.z=n.dateNF||It[14]):P={t:"n",v:Ps(E)})),P.z===void 0&&A!=null&&(P.z=A);var I="",ee=O.getElementsByTagName("A");if(ee&&ee.length)for(var oe=0;oe<ee.length&&!(ee[oe].hasAttribute("href")&&(I=ee[oe].getAttribute("href"),I.charAt(0)!="#"));++oe);I&&I.charAt(0)!="#"&&(P.l={Target:I}),n.dense?(t[x+i]||(t[x+i]=[]),t[x+i][S+s]=P):t[Dt({c:S+s,r:x+i})]=P,u.e.c<S+s&&(u.e.c=S+s),S+=_}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,x-1+i),t["!ref"]=Xt(u),x>=l&&(t["!fullref"]=Xt((u.e.r=o.length-v+x-1+i,u))),t}function jN(t,e){var r=e||{},n=r.dense?[]:{};return BN(n,t,e)}function U9(t,e){return il(jN(t,e),e)}function F_(t){var e="",r=H9(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function H9(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function W9(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qt(e.replace(/<[^>]*>/g,""));return[r]}var I_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zN(t,e){var r=e||{},n=Ey(t),i=[],s,a,o={name:""},l="",u=0,d,h,m={},g=[],v=r.dense?[]:{},x,w,S={value:""},T="",_=0,M=[],D=-1,O=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,N={},P=[],B={},I=0,ee=0,oe=[],re=1,fe=1,se=[],xe={Names:[]},H={},ve=["",""],W=[],F={},X="",Z=0,q=!1,ce=!1,Ce=0;for(Nd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Nd.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?v["!ref"]=Xt(E):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(v["!fullref"]=v["!ref"],E.e.r=r.sheetRows-1,v["!ref"]=Xt(E)),P.length&&(v["!merges"]=P),oe.length&&(v["!rows"]=oe),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),m[d.name]=v,ce=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=Et(x[0],!1),D=O=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,v=r.dense?[]:{},P=[],oe=[],ce=!0);break;case"table-row-group":x[1]==="/"?--A:++A;break;case"table-row":case"":if(x[1]==="/"){D+=re,re=1;break}if(h=Et(x[0],!1),h.?D=h.-1:D==-1&&(D=0),re=+h["number-rows-repeated"]||1,re<10)for(Ce=0;Ce<re;++Ce)A>0&&(oe[D+Ce]={level:A});O=-1;break;case"covered-table-cell":x[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(v[D]||(v[D]=[]),v[D][O]={t:"z"}):v[Dt({r:D,c:O})]={t:"z"}),T="",M=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++O,S=Et(x[0],!1),fe=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(w.f=A_(Qt(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=Qt(S["string-value"]||""),r.dense?(v[D]||(v[D]=[]),v[D][O]=w):v[Dt({r:D,c:O})]=w),O+=fe-1;else if(x[1]!=="/"){++O,T="",_=0,M=[],fe=1;var pe=re?D+re-1:D;if(O>E.e.c&&(E.e.c=O),O<E.s.c&&(E.s.c=O),D<E.s.r&&(E.s.r=D),pe>E.e.r&&(E.e.r=pe),S=Et(x[0],!1),W=[],F={},w={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Qt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(I=parseInt(S["number-matrix-rows-spanned"],10)||0,ee=parseInt(S["number-matrix-columns-spanned"],10)||0,B={s:{r:D,c:O},e:{r:D+I-1,c:O+ee-1}},w.F=Xt(B),se.push([B,w.F])),S.formula)w.f=A_(S.formula);else for(Ce=0;Ce<se.length;++Ce)D>=se[Ce][0].s.r&&D<=se[Ce][0].e.r&&O>=se[Ce][0].s.c&&O<=se[Ce][0].e.c&&(w.F=se[Ce][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(I=parseInt(S["number-rows-spanned"],10)||0,ee=parseInt(S["number-columns-spanned"],10)||0,B={s:{r:D,c:O},e:{r:D+I-1,c:O+ee-1}},P.push(B)),S["number-columns-repeated"]&&(fe=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Cr(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=vn(S["date-value"]),r.cellDates||(w.t="n",w.v=fi(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=i3(S["time-value"])/86400,r.cellDates&&(w.t="d",w.v=bm(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(T=Qt(S["string-value"]),M=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(q=!1,w.t==="s"&&(w.v=T||"",M.length&&(w.R=M),q=_==0),H.Target&&(w.l=H),W.length>0&&(w.c=W,W=[]),T&&r.cellText!==!1&&(w.w=T),q&&(w.t="z",delete w.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var ue=0;ue<re;++ue){if(fe=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(v[D+ue]||(v[D+ue]=[]),v[D+ue][O]=ue==0?w:In(w);--fe>0;)v[D+ue][O+fe]=In(w);else for(v[Dt({r:D+ue,c:O})]=w;--fe>0;)v[Dt({r:D+ue,c:O+fe})]=In(w);E.e.c<=O&&(E.e.c=O)}fe=parseInt(S["number-columns-repeated"]||"1",10),O+=fe-1,fe=0,w={},T="",M=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s;F.t=T,M.length&&(F.R=M),F.a=X,W.push(F)}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);X="",Z=0,T="",_=0,M=[];break;case"creator":x[1]==="/"?X=n.slice(Z,x.index):Z=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&i.push([x[3],!1]);T="",_=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(N[o.name]=l,(s=i.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=Et(x[0],!1),i.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Et(x[0],!1),l+=I_[x[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Et(x[0],!1),l+=I_[x[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":a=Et(x[0],!1),ve=$x(a["cell-range-address"]);var Se={Name:a.name,Ref:ve[0]+"!"+ve[1]};ce&&(Se.Sheet=g.length),xe.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(x[1]==="/"&&(!S||!S["string-value"])){var ze=W9(n.slice(_,x.index));T=(T.length>0?T+`
`:"")+ze[0]}else Et(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ve=$x(Et(x[0])["target-range-address"]),m[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(H=Et(x[0],!1),!H.href)break;H.Target=Qt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ve=$x(H.Target.slice(1)),H.Target="#"+ve[0]+"!"+ve[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:m,SheetNames:g,Workbook:xe};return r.bookSheets&&delete j.Sheets,j}function R_(t,e){e=e||{},as(t,"META-INF/manifest.xml")&&oL(Yr(t,"META-INF/manifest.xml"),e);var r=Ui(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=zN(gr(r),e);return as(t,"meta.xml")&&(n.Props=QA(Yr(t,"meta.xml"))),n}function P_(t,e){return zN(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function jy(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function n1(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):gr(dc(t))}function i1(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function L_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function G9(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Fd(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function un(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Kn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Fd(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Fd(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function zy(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function q9(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Fd(t,n),s=Kn(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:un(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Kn(o.data),u=un(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=un(s[3][0].data)>>>0>0),r.push(a)}return r}function Y9(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Fd(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[i1(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var d=i1(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function K9(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Y9(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return i1(e)}function X9(t,e,r,n){var i=jy(t),s=i.getUint32(4,!0),a=(n>1?12:8)+L_(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=L_(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function Z9(t,e,r){var n=jy(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);i&1&&(l=G9(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function J9(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return X9(t,e,r,t[0]);case 5:return Z9(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function $o(t){var e=Kn(t);return Fd(e[1][0].data)}function B_(t,e){var r=Kn(e.data),n=un(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Kn(a.data),l=un(o[1][0].data)>>>0;switch(n){case 1:s[l]=n1(o[3][0].data);break;case 8:{var u=t[$o(o[9][0].data)][0],d=Kn(u.data),h=t[$o(d[1][0].data)][0],m=un(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var g=Kn(h.data);s[l]=g[3].map(function(v){return n1(v.data)}).join("")}break}}),s}function Q9(t,e){var r,n,i,s,a,o,l,u,d,h,m,g,v,x,w=Kn(t),S=un(w[1][0].data)>>>0,T=un(w[2][0].data)>>>0,_=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&un(w[8][0].data)>0||!1,M,D;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&e!=0)M=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,D=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(d=w[4])==null?void 0:d[0])!=null&&h.data&&e!=1)M=(g=(m=w[4])==null?void 0:m[0])==null?void 0:g.data,D=(x=(v=w[3])==null?void 0:v[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=_?4:1,E=jy(M),A=[],N=0;N<M.length/2;++N){var P=E.getUint16(N*2,!0);P<65535&&A.push([N,P])}if(A.length!=T)throw"Expected ".concat(T," cells, found ").concat(A.length);var B=[];for(N=0;N<A.length-1;++N)B[A[N][0]]=D.subarray(A[N][1]*O,A[N+1][1]*O);return A.length>=1&&(B[A[A.length-1][0]]=D.subarray(A[A.length-1][1]*O)),{R:S,cells:B}}function ez(t,e){var r,n=Kn(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?un(n[7][0].data)>>>0>0?1:0:-1,s=zy(n[5],function(a){return Q9(a,i)});return{nrows:un(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function tz(t,e,r){var n,i=Kn(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(un(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(un(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Xt(s);var a=Kn(i[4][0].data),o=B_(t,t[$o(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?B_(t,t[$o(a[17][0].data)][0]):[],u=Kn(a[3][0].data),d=0;u[1].forEach(function(h){var m=Kn(h.data),g=t[$o(m[2][0].data)][0],v=un(g.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var x=ez(t,g);x.data.forEach(function(w,S){w.forEach(function(T,_){var M=Dt({r:d+S,c:_}),D=J9(T,o,l);D&&(r[M]=D)})}),d+=x.nrows})}function rz(t,e){var r=Kn(e.data),n={"!ref":"A1"},i=t[$o(r[2][0].data)],s=un(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return tz(t,i[0],n),n}function nz(t,e){var r,n=Kn(e.data),i={name:(r=n[1])!=null&&r[0]?n1(n[1][0].data):"",sheets:[]},s=zy(n[2],$o);return s.forEach(function(a){t[a].forEach(function(o){var l=un(o.meta[1][0].data);l==6e3&&i.sheets.push(rz(t,o))})}),i}function iz(t,e){var r=Uy(),n=Kn(e.data),i=zy(n[1],$o);if(i.forEach(function(s){t[s].forEach(function(a){var o=un(a.meta[1][0].data);if(o==2){var l=nz(t,a);l.sheets.forEach(function(u,d){Hy(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hx(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=K9(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var d;try{d=q9(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&un(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var d=un(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return iz(s,o)}function sz(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Vy(t){sz([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function az(t){return fu.WS.indexOf(t)>-1?"sheet":t==fu.CS?"chart":t==fu.DS?"dialog":t==fu.MS?"macro":t&&t.length?t:"sheet"}function oz(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,az(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function lz(t,e,r,n,i,s,a,o,l,u,d,h){try{s[n]=od(Ui(t,r,!0),e);var m=Yr(t,e),g;switch(o){case"sheet":g=p9(m,e,i,l,s[n],u,d,h);break;case"chart":if(g=m9(m,e,i,l,s[n],u,d,h),!g||!g["!drawel"])break;var v=Gf(g["!drawel"].Target,e),x=Jv(v),w=h8(Ui(t,v,!0),od(Ui(t,x,!0),v)),S=Gf(w,v),T=Jv(S);g=Zj(Ui(t,S,!0),S,l,od(Ui(t,T,!0),S),u,g);break;case"macro":g=g9(m,e,i,l,s[n],u,d,h);break;case"dialog":g=x9(m,e,i,l,s[n],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=g;var _=[];s&&s[n]&&pa(s[n]).forEach(function(M){var D="";if(s[n][M].Type==fu.CMNT){D=Gf(s[n][M].Target,e);var O=b9(Yr(t,D,!0),D,l);if(!O||!O.length)return;S_(g,O,!1)}s[n][M].Type==fu.TCMNT&&(D=Gf(s[n][M].Target,e),_=_.concat(m8(Yr(t,D,!0),l)))}),_&&_.length&&S_(g,_,!0,l.people||[])}catch(M){if(l.WTF)throw M}}function rs(t){return t.charAt(0)=="/"?t.slice(1):t}function cz(t,e){if(_A(),e=e||{},Vy(e),as(t,"META-INF/manifest.xml")||as(t,"objectdata.xml"))return R_(t,e);if(as(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hx<"u"){if(t.FileIndex)return Hx(t);var r=Kt.utils.cfb_new();return XS(t).forEach(function(oe){u3(r,oe,c3(t,oe))}),Hx(r)}throw new Error("Unsupported NUMBERS file")}if(!as(t,"[Content_Types].xml"))throw as(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):as(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=XS(t),i=sL(Ui(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Yr(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Yr(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(ud=[],i.sst)try{ud=w9(Yr(t,rs(i.sst)),i.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&i.themes.length&&(l=y9(Ui(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=v9(Yr(t,rs(i.style)),i.style,l,e))}i.links.map(function(oe){try{var re=od(Ui(t,Jv(rs(oe))),oe);return S9(Yr(t,rs(oe)),re,oe,e)}catch{}});var d=h9(Yr(t,rs(i.workbooks[0])),i.workbooks[0],e),h={},m="";i.coreprops.length&&(m=Yr(t,rs(i.coreprops[0]),!0),m&&(h=QA(m)),i.extprops.length!==0&&(m=Yr(t,rs(i.extprops[0]),!0),m&&uL(m,h,e)));var g={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(m=Ui(t,rs(i.custprops[0]),!0),m&&(g=dL(m,e)));var v={};if((e.bookSheets||e.bookProps)&&(d.Sheets?a=d.Sheets.map(function(re){return re.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=g),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var x={};e.bookDeps&&i.calcchain&&(x=k9(Yr(t,rs(i.calcchain)),i.calcchain));var w=0,S={},T,_;{var M=d.Sheets;h.Worksheets=M.length,h.SheetNames=[];for(var D=0;D!=M.length;++D)h.SheetNames[D]=M[D].name}var O=s?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");as(t,A)||(A="xl/_rels/workbook."+O+".rels");var N=od(Ui(t,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=_9(Yr(t,rs(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=g8(Yr(t,rs(i.people[0])),e)),N&&(N=oz(N,d.Sheets));var P=Yr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var B="sheet";if(N&&N[w]?(T="xl/"+N[w][1].replace(/[\/]?xl\//,""),as(t,T)||(T=N[w][1]),as(t,T)||(T=A.replace(/_rels\/.*$/,"")+N[w][1]),B=N[w][2]):(T="xl/worksheets/sheet"+(w+1-P)+"."+O,T=T.replace(/sheet0\./,"sheet.")),_=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var I=!1,ee=0;ee!=e.sheets.length;++ee)typeof e.sheets[ee]=="number"&&e.sheets[ee]==w&&(I=1),typeof e.sheets[ee]=="string"&&e.sheets[ee].toLowerCase()==h.SheetNames[w].toLowerCase()&&(I=1);if(!I)continue e}}lz(t,T,_,h.SheetNames[w],w,S,a,B,e,d,l,u)}return v={Directory:i,Workbook:d,Props:h,Custprops:g,Deps:x,Sheets:a,SheetNames:h.SheetNames,Strings:ud,Styles:u,Themes:l,SSF:In(It)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(oe,re){oe=oe.replace(/^Root Entry[\/]/,""),v.keys.push(oe),v.files[oe]=t.FileIndex[re]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=Yr(t,rs(i.vba[0]),!0):i.defaults&&i.defaults.bin===w8&&(v.vbaraw=Yr(t,"xl/vbaProject.bin",!0))),v}function uz(t,e){var r=e||{},n="Workbook",i=Kt.find(t,n);try{if(n="/!DataSpaces/Version",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(r6(i.content),n="/!DataSpaces/DataSpaceMap",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=i6(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=s6(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);o6(i.content)}catch{}if(n="/EncryptionInfo",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=l6(i.content);if(n="/EncryptedPackage",i=Kt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function $y(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Gi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function fz(t,e){return Kt.find(t,"EncryptedPackage")?uz(t,e):LN(t,e)}function dz(t,e){var r,n=t,i=e||{};return i.type||(i.type=Wt&&Buffer.isBuffer(t)?"buffer":"base64"),r=MA(n,i),cz(r,i)}function VN(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return t1(t.slice(r),e);default:break e}return Md.to_workbook(t,e)}function hz(t,e){var r="",n=$y(t,e);switch(e.type){case"base64":r=Gi(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=rc(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=gr(r)),e.type="binary",VN(r,e)}function pz(t,e){var r=t;return e.type=="base64"&&(r=Gi(r)),r=Ed.utils.decode(1200,r.slice(2),"str"),e.type="binary",VN(r,e)}function mz(t){return t.match(/[^\x00-\x7F]/)?qf(t):t}function Wx(t,e,r,n){return n?(r.type="string",Md.to_workbook(t,r)):Md.to_workbook(e,r)}function s1(t,e){dA();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return s1(new Uint8Array(t),(r=In(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xu={},r.dateNF&&(xu.dateNF=r.dateNF),r.type||(r.type=Wt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Wt?"buffer":"binary",n=r3(t),typeof Uint8Array<"u"&&!Wt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=mz(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=In(r),r.type="array",s1(wy(n),r)}switch((i=$y(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return fz(Kt.read(n,r),r);break;case 9:if(i[1]<=8)return LN(n,r);break;case 60:return t1(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return U5(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return V5.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?dz(n,r):Wx(t,n,r,s);case 239:return i[3]===60?t1(n,r):Wx(t,n,r,s);case 255:if(i[1]===254)return pz(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return cd.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return cd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return k_.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return w6.to_workbook(n,r);break;case 10:case 13:case 32:return hz(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return j5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?k_.to_workbook(n,r):Wx(t,n,r,s)}function gz(t,e,r,n,i,s,a,o){var l=Rn(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||t[r])for(var g=e.s.c;g<=e.e.c;++g){var v=a?t[r][g]:t[n[g]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[g]!=null&&(m[s[g]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(x==null)if(v.t=="e"&&x===null)m[s[g]]=null;else if(u!==void 0)m[s[g]]=u;else if(d&&x===null)m[s[g]]=null;else continue;else m[s[g]]=d&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:Ka(v,x,o);x!=null&&(h=!1)}}return{row:m,isempty:h}}function a1(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=Rr(d);break;case"number":l=Rr(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var h=Rn(l.s.r),m=[],g=[],v=0,x=0,w=Array.isArray(t),S=l.s.r,T=0,_={};w&&!t[S]&&(t[S]=[]);var M=u.skipHidden&&t["!cols"]||[],D=u.skipHidden&&t["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(M[T]||{}).hidden)switch(m[T]=cn(T),r=w?t[S][T]:t[m[T]+h],n){case 1:s[T]=T-l.s.c;break;case 2:s[T]=m[T];break;case 3:s[T]=u.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ka(r,null,u),x=_[a]||0,!x)_[a]=1;else{do o=a+"_"+x++;while(_[o]);_[a]=x,_[o]=1}s[T]=o}for(S=l.s.r+i;S<=l.e.r;++S)if(!(D[S]||{}).hidden){var O=gz(t,l,S,m,n,s,w,u);(O.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[v++]=O.row)}return g.length=v,g}var j_=/"/g;function xz(t,e,r,n,i,s,a,o){for(var l=!0,u=[],d="",h=Rn(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var g=o.dense?(t[r]||[])[m]:t[n[m]+h];if(g==null)d="";else if(g.v!=null){l=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:Ka(g,null,o));for(var v=0,x=0;v!==d.length;++v)if((x=d.charCodeAt(v))===i||x===s||x===34||o.forceQuotes){d='"'+d.replace(j_,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(l=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(j_,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(a)}function $N(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Rr(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],g=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(m[v]||{}).hidden||(h[v]=cn(v));for(var x=0,w=i.s.r;w<=i.e.r;++w)(g[w]||{}).hidden||(d=xz(t,i,w,h,a,l,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function vz(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=$N(t,e);return r}function yz(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Rr(t["!ref"]),s="",a=[],o,l=[],u=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=cn(o);for(var d=i.s.r;d<=i.e.r;++d)for(s=Rn(d),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function UN(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ci(n.origin):n.origin;a=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=Rr(s["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+i)}else a==-1&&(a=0,d.e.r=e.length-1+i);var m=n.header||[],g=0;e.forEach(function(x,w){pa(x).forEach(function(S){(g=m.indexOf(S))==-1&&(m[g=m.length]=S);var T=x[S],_="z",M="",D=Dt({c:o+g,r:a+w+i});u=Id(s,D),T&&typeof T=="object"&&!(T instanceof Date)?s[D]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",n.cellDates||(_="n",T=fi(T)),M=n.dateNF||It[14]):T===null&&n.nullError&&(_="e",T=0),u?(u.t=_,u.v=T,delete u.w,delete u.R,M&&(u.z=M)):s[D]=u={t:_,v:T},M&&(u.z=M))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var v=Rn(a);if(i)for(g=0;g<m.length;++g)s[cn(g+o)+v]={t:"s",v:m[g]};return s["!ref"]=Xt(d),s}function wz(t,e){return UN(null,t,e)}function Id(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ci(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Id(t,Dt(e)):Id(t,Dt({r:e,c:r||0}))}function bz(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Uy(){return{SheetNames:[],Sheets:{}}}function Hy(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(s9(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function kz(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=bz(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Sz(t,e){return t.z=e,t}function HN(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _z(t,e,r){return HN(t,"#"+e,r)}function Cz(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Ez(t,e,r,n){for(var i=typeof e!="string"?e:Rr(e),s=typeof e=="string"?e:Xt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Id(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Tz={encode_col:cn,encode_row:Rn,encode_cell:Dt,encode_range:Xt,decode_col:Ny,decode_row:Ay,split_cell:B3,decode_cell:ci,decode_range:Hu,format_cell:Ka,sheet_add_aoa:YA,sheet_add_json:UN,sheet_add_dom:BN,aoa_to_sheet:Wu,json_to_sheet:wz,table_to_sheet:jN,table_to_book:U9,sheet_to_csv:$N,sheet_to_txt:vz,sheet_to_json:a1,sheet_to_html:$9,sheet_to_formulae:yz,sheet_to_row_object_array:a1,sheet_get_cell:Id,book_new:Uy,book_append_sheet:Hy,book_set_sheet_visibility:kz,cell_set_number_format:Sz,cell_set_hyperlink:HN,cell_set_internal_link:_z,cell_add_comment:Cz,sheet_set_array_formula:Ez,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Az=t=>t.replace(/"/g,"").trim().toLowerCase(),Nz=t=>{switch(t){case"active":return"";case"probation":return"";case"vacation":return" ";case"inactive":return"";case"terminated":return"";default:return t}},Mz=(t,e)=>{const r=e.map(i=>i.label),n=t.map(i=>e.map(s=>{var a;switch(s.key){case"fio":return`${i.personalInfo.lastName} ${i.personalInfo.firstName}`.trim();case"position":return i.workInfo.position;case"orgUnit":return i.orgPlacement.orgUnit;case"team":return i.workInfo.team.name;case"scheme":return((a=i.orgPlacement.workScheme)==null?void 0:a.name)??"";case"hourNorm":return String(i.orgPlacement.hourNorm);case"status":return Nz(i.status);case"hireDate":return i.workInfo.hireDate.toLocaleDateString("ru-RU");default:return""}}));return xy.unparse({fields:r,data:n})},Dz=(t,e)=>{const r=t.filter(i=>i.status==="vacation").map(i=>[i.credentials.wfmLogin,`${i.personalInfo.lastName} ${i.personalInfo.firstName}`.trim(),e(i.status),i.workInfo.team.name,"  "]);if(r.length===0)return null;const n=["login","","","",""];return xy.unparse({fields:n,data:r})},Oz=t=>{const e=t.flatMap(n=>{const i=`${n.personalInfo.lastName} ${n.personalInfo.firstName}`.trim();return n.tags.length===0?[[n.credentials.wfmLogin,i,""]]:n.tags.map(s=>[n.credentials.wfmLogin,i,s])});if(e.length===0)return null;const r=["login","",""];return xy.unparse({fields:r,data:e})},Fz=(t,e)=>{const[r]=t.split(/\r?\n/).filter(Boolean);if(!r)return{valid:!1,missingHeaders:e,message:"   ."};const n=r.split(",").map(Az).filter(s=>s.length>0),i=e.filter(s=>!n.includes(s.toLowerCase()));return{valid:i.length===0,missingHeaders:i}},Iz=async t=>{const e=await t.arrayBuffer(),r=s1(e,{type:"array"}),[n]=r.SheetNames;if(!n)return[];const i=r.Sheets[n],s=Tz.sheet_to_json({...i,"!range":void 0},{header:1}),[a]=s;return(a??[]).map(o=>String(o??"").trim())},Rz=t=>t?t.replace(/<br\s*\/?>/gi,`
`).replace(/<\/?p>/gi,`
`).replace(/<\/?li>/gi,`
`).replace(/<\/?div>/gi,`
`).replace(/<\/?h\d>/gi,`
`).replace(/<[^>]+>/g,"").replace(/\u00a0/g," ").split(`
`).map(e=>e.trim()).filter(Boolean).join(`
`):"",WN=t=>{if(!t)return"<p></p>";const e=t.split(/\r?\n/).filter(r=>r.trim().length>0);return e.length===0?"<p></p>":e.map(r=>`<p>${r}</p>`).join("")},Ul=(t,e,{createdAt:r,createdBy:n}={})=>({id:typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`task-${Date.now()}-${Math.floor(Math.random()*1e4)}`,message:t,createdAt:r??new Date,createdBy:n??"agent",source:e});var ir;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(ir||(ir={}));var z_;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(z_||(z_={}));const ft=ir.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Co=t=>{switch(typeof t){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(t)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(t)?ft.array:t===null?ft.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ft.promise:typeof Map<"u"&&t instanceof Map?ft.map:typeof Set<"u"&&t instanceof Set?ft.set:typeof Date<"u"&&t instanceof Date?ft.date:ft.object;default:return ft.unknown}},He=ir.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Xa extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let o=n,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(r(a))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return i(this),n}static assert(e){if(!(e instanceof Xa))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ir.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];r[s]=r[s]||[],r[s].push(e(i))}else n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Xa.create=t=>new Xa(t);const o1=(t,e)=>{let r;switch(t.code){case He.invalid_type:t.received===ft.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case He.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,ir.jsonStringifyReplacer)}`;break;case He.unrecognized_keys:r=`Unrecognized key(s) in object: ${ir.joinValues(t.keys,", ")}`;break;case He.invalid_union:r="Invalid input";break;case He.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ir.joinValues(t.options)}`;break;case He.invalid_enum_value:r=`Invalid enum value. Expected ${ir.joinValues(t.options)}, received '${t.received}'`;break;case He.invalid_arguments:r="Invalid function arguments";break;case He.invalid_return_type:r="Invalid function return type";break;case He.invalid_date:r="Invalid date";break;case He.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:ir.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case He.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case He.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case He.custom:r="Invalid input";break;case He.invalid_intersection_types:r="Intersection results could not be merged";break;case He.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case He.not_finite:r="Number must be finite";break;default:r=e.defaultError,ir.assertNever(t)}return{message:r}};let Pz=o1;function Lz(){return Pz}const Bz=t=>{const{data:e,path:r,errorMaps:n,issueData:i}=t,s=[...r,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=n.filter(u=>!!u).slice().reverse();for(const u of l)o=u(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}};function Je(t,e){const r=Lz(),n=Bz({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===o1?void 0:o1].filter(i=>!!i)});t.common.issues.push(n)}class qi{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const i of r){if(i.status==="aborted")return Ot;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const i of r){const s=await i.key,a=await i.value;n.push({key:s,value:a})}return qi.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const i of r){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Ot;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(n[s.value]=a.value)}return{status:e.value,value:n}}}const Ot=Object.freeze({status:"aborted"}),Yf=t=>({status:"dirty",value:t}),xs=t=>({status:"valid",value:t}),V_=t=>t.status==="aborted",$_=t=>t.status==="dirty",Tu=t=>t.status==="valid",Pp=t=>typeof Promise<"u"&&t instanceof Promise;var ht;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ht||(ht={}));class Jo{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const U_=(t,e)=>{if(Tu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Xa(t.common.issues);return this._error=r,this._error}}};function Vt(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{const{message:l}=t;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??n??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:i}}class er{get description(){return this._def.description}_getType(e){return Co(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Co(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new qi,ctx:{common:e.parent.common,data:e.data,parsedType:Co(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Pp(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){const n={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Co(e)},i=this._parseSync({data:e,path:n.path,parent:n});return U_(n,i)}"~validate"(e){var n,i;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Co(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:r});return Tu(s)?{value:s.value}:{issues:r.common.issues}}catch(s){(i=(n=s==null?void 0:s.message)==null?void 0:n.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(s=>Tu(s)?{value:s.value}:{issues:r.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Co(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(Pp(i)?i:Promise.resolve(i));return U_(n,s)}refine(e,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:He.custom,...n(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new Nu({schema:this,typeName:Ft.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Uo.create(this,this._def)}nullable(){return Mu.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ha.create(this)}promise(){return zp.create(this,this._def)}or(e){return Bp.create([this,e],this._def)}and(e){return jp.create(this,e,this._def)}transform(e){return new Nu({...Vt(this._def),schema:this,typeName:Ft.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new c1({...Vt(this._def),innerType:this,defaultValue:r,typeName:Ft.ZodDefault})}brand(){return new o7({typeName:Ft.ZodBranded,type:this,...Vt(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new u1({...Vt(this._def),innerType:this,catchValue:r,typeName:Ft.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Wy.create(this,e)}readonly(){return f1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const jz=/^c[^\s-]{8,}$/i,zz=/^[0-9a-z]+$/,Vz=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$z=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Uz=/^[a-z0-9_-]{21}$/i,Hz=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Wz=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Gz=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,qz="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Gx;const Yz=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Kz=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Xz=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zz=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Jz=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Qz=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,GN="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",e7=new RegExp(`^${GN}$`);function qN(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function t7(t){return new RegExp(`^${qN(t)}$`)}function r7(t){let e=`${GN}T${qN(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function n7(t,e){return!!((e==="v4"||!e)&&Yz.test(t)||(e==="v6"||!e)&&Xz.test(t))}function i7(t,e){if(!Hz.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function s7(t,e){return!!((e==="v4"||!e)&&Kz.test(t)||(e==="v6"||!e)&&Zz.test(t))}class Fo extends er{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const s=this._getOrReturnCtx(e);return Je(s,{code:He.invalid_type,expected:ft.string,received:s.parsedType}),Ot}const n=new qi;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),Je(i,{code:He.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),Je(i,{code:He.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?Je(i,{code:He.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&Je(i,{code:He.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")Gz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"email",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Gx||(Gx=new RegExp(qz,"u")),Gx.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"emoji",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")$z.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"uuid",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")Uz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"nanoid",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")jz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"cuid",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")zz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"cuid2",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")Vz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"ulid",code:He.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),Je(i,{validation:"url",code:He.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"regex",code:He.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?r7(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?e7.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?t7(s).test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{code:He.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?Wz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"duration",code:He.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?n7(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"ip",code:He.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?i7(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"jwt",code:He.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?s7(e.data,s.version)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"cidr",code:He.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?Jz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"base64",code:He.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?Qz.test(e.data)||(i=this._getOrReturnCtx(e,i),Je(i,{validation:"base64url",code:He.invalid_string,message:s.message}),n.dirty()):ir.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:He.invalid_string,...ht.errToObj(n)})}_addCheck(e){return new Fo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ht.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ht.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ht.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ht.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ht.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ht.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ht.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ht.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ht.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ht.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ht.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ht.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ht.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...ht.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ht.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ht.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...ht.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...ht.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...ht.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...ht.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...ht.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...ht.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...ht.errToObj(r)})}nonempty(e){return this.min(1,ht.errToObj(e))}trim(){return new Fo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Fo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Fo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Fo.create=t=>new Fo({checks:[],typeName:Ft.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Vt(t)});function a7(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,s=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return s%a/10**i}class Rd extends er{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const s=this._getOrReturnCtx(e);return Je(s,{code:He.invalid_type,expected:ft.number,received:s.parsedType}),Ot}let n;const i=new qi;for(const s of this._def.checks)s.kind==="int"?ir.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),Je(n,{code:He.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?a7(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),Je(n,{code:He.not_finite,message:s.message}),i.dirty()):ir.assertNever(s);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,ht.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ht.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ht.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ht.toString(r))}setLimit(e,r,n,i){return new Rd({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:ht.toString(i)}]})}_addCheck(e){return new Rd({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ht.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ht.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ht.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ht.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ht.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ht.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:ht.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ht.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ht.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ir.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Rd.create=t=>new Rd({checks:[],typeName:Ft.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Vt(t)});class Pd extends er{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let n;const i=new qi;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),Je(n,{code:He.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):ir.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return Je(r,{code:He.invalid_type,expected:ft.bigint,received:r.parsedType}),Ot}gte(e,r){return this.setLimit("min",e,!0,ht.toString(r))}gt(e,r){return this.setLimit("min",e,!1,ht.toString(r))}lte(e,r){return this.setLimit("max",e,!0,ht.toString(r))}lt(e,r){return this.setLimit("max",e,!1,ht.toString(r))}setLimit(e,r,n,i){return new Pd({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:ht.toString(i)}]})}_addCheck(e){return new Pd({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ht.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ht.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ht.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ht.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:ht.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Pd.create=t=>new Pd({checks:[],typeName:Ft.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Vt(t)});class H_ extends er{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.boolean,received:n.parsedType}),Ot}return xs(e.data)}}H_.create=t=>new H_({typeName:Ft.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Vt(t)});class Lp extends er{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const s=this._getOrReturnCtx(e);return Je(s,{code:He.invalid_type,expected:ft.date,received:s.parsedType}),Ot}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return Je(s,{code:He.invalid_date}),Ot}const n=new qi;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),Je(i,{code:He.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),Je(i,{code:He.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):ir.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Lp({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:ht.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:ht.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Lp.create=t=>new Lp({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ft.ZodDate,...Vt(t)});class W_ extends er{_parse(e){if(this._getType(e)!==ft.symbol){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.symbol,received:n.parsedType}),Ot}return xs(e.data)}}W_.create=t=>new W_({typeName:Ft.ZodSymbol,...Vt(t)});class G_ extends er{_parse(e){if(this._getType(e)!==ft.undefined){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.undefined,received:n.parsedType}),Ot}return xs(e.data)}}G_.create=t=>new G_({typeName:Ft.ZodUndefined,...Vt(t)});class q_ extends er{_parse(e){if(this._getType(e)!==ft.null){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.null,received:n.parsedType}),Ot}return xs(e.data)}}q_.create=t=>new q_({typeName:Ft.ZodNull,...Vt(t)});class Y_ extends er{constructor(){super(...arguments),this._any=!0}_parse(e){return xs(e.data)}}Y_.create=t=>new Y_({typeName:Ft.ZodAny,...Vt(t)});class K_ extends er{constructor(){super(...arguments),this._unknown=!0}_parse(e){return xs(e.data)}}K_.create=t=>new K_({typeName:Ft.ZodUnknown,...Vt(t)});class Qo extends er{_parse(e){const r=this._getOrReturnCtx(e);return Je(r,{code:He.invalid_type,expected:ft.never,received:r.parsedType}),Ot}}Qo.create=t=>new Qo({typeName:Ft.ZodNever,...Vt(t)});class X_ extends er{_parse(e){if(this._getType(e)!==ft.undefined){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.void,received:n.parsedType}),Ot}return xs(e.data)}}X_.create=t=>new X_({typeName:Ft.ZodVoid,...Vt(t)});class ha extends er{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==ft.array)return Je(r,{code:He.invalid_type,expected:ft.array,received:r.parsedType}),Ot;if(i.exactLength!==null){const a=r.data.length>i.exactLength.value,o=r.data.length<i.exactLength.value;(a||o)&&(Je(r,{code:a?He.too_big:He.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(Je(r,{code:He.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(Je(r,{code:He.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,o)=>i.type._parseAsync(new Jo(r,a,r.path,o)))).then(a=>qi.mergeArray(n,a));const s=[...r.data].map((a,o)=>i.type._parseSync(new Jo(r,a,r.path,o)));return qi.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new ha({...this._def,minLength:{value:e,message:ht.toString(r)}})}max(e,r){return new ha({...this._def,maxLength:{value:e,message:ht.toString(r)}})}length(e,r){return new ha({...this._def,exactLength:{value:e,message:ht.toString(r)}})}nonempty(e){return this.min(1,e)}}ha.create=(t,e)=>new ha({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ft.ZodArray,...Vt(e)});function lu(t){if(t instanceof Xr){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Uo.create(lu(n))}return new Xr({...t._def,shape:()=>e})}else return t instanceof ha?new ha({...t._def,type:lu(t.element)}):t instanceof Uo?Uo.create(lu(t.unwrap())):t instanceof Mu?Mu.create(lu(t.unwrap())):t instanceof ic?ic.create(t.items.map(e=>lu(e))):t}class Xr extends er{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=ir.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==ft.object){const u=this._getOrReturnCtx(e);return Je(u,{code:He.invalid_type,expected:ft.object,received:u.parsedType}),Ot}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Qo&&this._def.unknownKeys==="strip"))for(const u in i.data)a.includes(u)||o.push(u);const l=[];for(const u of a){const d=s[u],h=i.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Jo(i,h,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Qo){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(u==="strict")o.length>0&&(Je(i,{code:He.unrecognized_keys,keys:o}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const h=i.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Jo(i,h,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const h=await d.key,m=await d.value;u.push({key:h,value:m,alwaysSet:d.alwaysSet})}return u}).then(u=>qi.mergeObjectSync(n,u)):qi.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return ht.errToObj,new Xr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,a;const i=((a=(s=this._def).errorMap)==null?void 0:a.call(s,r,n).message)??n.defaultError;return r.code==="unrecognized_keys"?{message:ht.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Xr({...this._def,unknownKeys:"strip"})}passthrough(){return new Xr({...this._def,unknownKeys:"passthrough"})}extend(e){return new Xr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Xr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ft.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Xr({...this._def,catchall:e})}pick(e){const r={};for(const n of ir.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new Xr({...this._def,shape:()=>r})}omit(e){const r={};for(const n of ir.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new Xr({...this._def,shape:()=>r})}deepPartial(){return lu(this)}partial(e){const r={};for(const n of ir.objectKeys(this.shape)){const i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}return new Xr({...this._def,shape:()=>r})}required(e){const r={};for(const n of ir.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Uo;)s=s._def.innerType;r[n]=s}return new Xr({...this._def,shape:()=>r})}keyof(){return YN(ir.objectKeys(this.shape))}}Xr.create=(t,e)=>new Xr({shape:()=>t,unknownKeys:"strip",catchall:Qo.create(),typeName:Ft.ZodObject,...Vt(e)});Xr.strictCreate=(t,e)=>new Xr({shape:()=>t,unknownKeys:"strict",catchall:Qo.create(),typeName:Ft.ZodObject,...Vt(e)});Xr.lazycreate=(t,e)=>new Xr({shape:t,unknownKeys:"strip",catchall:Qo.create(),typeName:Ft.ZodObject,...Vt(e)});class Bp extends er{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Xa(o.ctx.common.issues));return Je(r,{code:He.invalid_union,unionErrors:a}),Ot}if(r.common.async)return Promise.all(n.map(async s=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of n){const u={...r,common:{...r.common,issues:[]},parent:null},d=l._parseSync({data:r.data,path:r.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Xa(l));return Je(r,{code:He.invalid_union,unionErrors:o}),Ot}}get options(){return this._def.options}}Bp.create=(t,e)=>new Bp({options:t,typeName:Ft.ZodUnion,...Vt(e)});function l1(t,e){const r=Co(t),n=Co(e);if(t===e)return{valid:!0,data:t};if(r===ft.object&&n===ft.object){const i=ir.objectKeys(e),s=ir.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const l=l1(t[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(r===ft.array&&n===ft.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],o=e[s],l=l1(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return r===ft.date&&n===ft.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class jp extends er{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=(s,a)=>{if(V_(s)||V_(a))return Ot;const o=l1(s.value,a.value);return o.valid?(($_(s)||$_(a))&&r.dirty(),{status:r.value,value:o.data}):(Je(n,{code:He.invalid_intersection_types}),Ot)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}jp.create=(t,e,r)=>new jp({left:t,right:e,typeName:Ft.ZodIntersection,...Vt(r)});class ic extends er{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ft.array)return Je(n,{code:He.invalid_type,expected:ft.array,received:n.parsedType}),Ot;if(n.data.length<this._def.items.length)return Je(n,{code:He.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ot;!this._def.rest&&n.data.length>this._def.items.length&&(Je(n,{code:He.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const s=[...n.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Jo(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>qi.mergeArray(r,a)):qi.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new ic({...this._def,rest:e})}}ic.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ic({items:t,typeName:Ft.ZodTuple,rest:null,...Vt(e)})};class Z_ extends er{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ft.map)return Je(n,{code:He.invalid_type,expected:ft.map,received:n.parsedType}),Ot;const i=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([o,l],u)=>({key:i._parse(new Jo(n,o,n.path,[u,"key"])),value:s._parse(new Jo(n,l,n.path,[u,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return Ot;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(u.value,d.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of a){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return Ot;(u.status==="dirty"||d.status==="dirty")&&r.dirty(),o.set(u.value,d.value)}return{status:r.value,value:o}}}}Z_.create=(t,e,r)=>new Z_({valueType:e,keyType:t,typeName:Ft.ZodMap,...Vt(r)});class Ld extends er{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ft.set)return Je(n,{code:He.invalid_type,expected:ft.set,received:n.parsedType}),Ot;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(Je(n,{code:He.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(Je(n,{code:He.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const s=this._def.valueType;function a(l){const u=new Set;for(const d of l){if(d.status==="aborted")return Ot;d.status==="dirty"&&r.dirty(),u.add(d.value)}return{status:r.value,value:u}}const o=[...n.data.values()].map((l,u)=>s._parse(new Jo(n,l,n.path,u)));return n.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,r){return new Ld({...this._def,minSize:{value:e,message:ht.toString(r)}})}max(e,r){return new Ld({...this._def,maxSize:{value:e,message:ht.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Ld.create=(t,e)=>new Ld({valueType:t,minSize:null,maxSize:null,typeName:Ft.ZodSet,...Vt(e)});class J_ extends er{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}J_.create=(t,e)=>new J_({getter:t,typeName:Ft.ZodLazy,...Vt(e)});class Q_ extends er{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return Je(r,{received:r.data,code:He.invalid_literal,expected:this._def.value}),Ot}return{status:"valid",value:e.data}}get value(){return this._def.value}}Q_.create=(t,e)=>new Q_({value:t,typeName:Ft.ZodLiteral,...Vt(e)});function YN(t,e){return new Au({values:t,typeName:Ft.ZodEnum,...Vt(e)})}class Au extends er{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return Je(r,{expected:ir.joinValues(n),received:r.parsedType,code:He.invalid_type}),Ot}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return Je(r,{received:r.data,code:He.invalid_enum_value,options:n}),Ot}return xs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return Au.create(e,{...this._def,...r})}exclude(e,r=this._def){return Au.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}Au.create=YN;class e2 extends er{_parse(e){const r=ir.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ft.string&&n.parsedType!==ft.number){const i=ir.objectValues(r);return Je(n,{expected:ir.joinValues(i),received:n.parsedType,code:He.invalid_type}),Ot}if(this._cache||(this._cache=new Set(ir.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=ir.objectValues(r);return Je(n,{received:n.data,code:He.invalid_enum_value,options:i}),Ot}return xs(e.data)}get enum(){return this._def.values}}e2.create=(t,e)=>new e2({values:t,typeName:Ft.ZodNativeEnum,...Vt(e)});class zp extends er{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.promise&&r.common.async===!1)return Je(r,{code:He.invalid_type,expected:ft.promise,received:r.parsedType}),Ot;const n=r.parsedType===ft.promise?r.data:Promise.resolve(r.data);return xs(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}zp.create=(t,e)=>new zp({type:t,typeName:Ft.ZodPromise,...Vt(e)});class Nu extends er{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ft.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{Je(n,a),a.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(n.data,s);if(n.common.async)return Promise.resolve(a).then(async o=>{if(r.value==="aborted")return Ot;const l=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return l.status==="aborted"?Ot:l.status==="dirty"||r.value==="dirty"?Yf(l.value):l});{if(r.value==="aborted")return Ot;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?Ot:o.status==="dirty"||r.value==="dirty"?Yf(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Ot:(o.status==="dirty"&&r.dirty(),a(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Ot:(o.status==="dirty"&&r.dirty(),a(o.value).then(()=>({status:r.value,value:o.value}))))}if(i.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Tu(a))return Ot;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Tu(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:r.value,value:o})):Ot);ir.assertNever(i)}}Nu.create=(t,e,r)=>new Nu({schema:t,typeName:Ft.ZodEffects,effect:e,...Vt(r)});Nu.createWithPreprocess=(t,e,r)=>new Nu({schema:e,effect:{type:"preprocess",transform:t},typeName:Ft.ZodEffects,...Vt(r)});class Uo extends er{_parse(e){return this._getType(e)===ft.undefined?xs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Uo.create=(t,e)=>new Uo({innerType:t,typeName:Ft.ZodOptional,...Vt(e)});class Mu extends er{_parse(e){return this._getType(e)===ft.null?xs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mu.create=(t,e)=>new Mu({innerType:t,typeName:Ft.ZodNullable,...Vt(e)});class c1 extends er{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===ft.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}c1.create=(t,e)=>new c1({innerType:t,typeName:Ft.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Vt(e)});class u1 extends er{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Pp(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Xa(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Xa(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}u1.create=(t,e)=>new u1({innerType:t,typeName:Ft.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Vt(e)});class t2 extends er{_parse(e){if(this._getType(e)!==ft.nan){const n=this._getOrReturnCtx(e);return Je(n,{code:He.invalid_type,expected:ft.nan,received:n.parsedType}),Ot}return{status:"valid",value:e.data}}}t2.create=t=>new t2({typeName:Ft.ZodNaN,...Vt(t)});class o7 extends er{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Wy extends er{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ot:s.status==="dirty"?(r.dirty(),Yf(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ot:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new Wy({in:e,out:r,typeName:Ft.ZodPipeline})}}class f1 extends er{_parse(e){const r=this._def.innerType._parse(e),n=i=>(Tu(i)&&(i.value=Object.freeze(i.value)),i);return Pp(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}}f1.create=(t,e)=>new f1({innerType:t,typeName:Ft.ZodReadonly,...Vt(e)});var Ft;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ft||(Ft={}));const An=Fo.create;Qo.create;ha.create;const La=Xr.create;Bp.create;jp.create;ic.create;const KN=Au.create;zp.create;Uo.create;Mu.create;const l7=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,c7=/^(\+?[0-9()\s-]{7,})$/,u7=["active","probation","vacation","inactive","terminated"],ns=()=>An().trim().optional().default(""),f7=La({personalInfo:La({lastName:An().trim().min(1," "),firstName:An().trim().min(1," "),middleName:ns(),email:An().trim().min(1," email").regex(l7,"  email"),phone:An().trim().min(1," ").regex(c7,"  "),address:ns(),dateOfBirth:ns()}),credentials:La({wfmLogin:An().trim().min(1,"  WFM"),externalLogins:An().trim().min(1,"  "),password:ns()}),orgPlacement:La({orgUnit:An().trim().min(1,"  "),office:An().trim().min(1," "),timeZone:An().trim().min(1,"  "),hourNorm:An().trim().min(1,"  ").refine(t=>{const e=Number(t);return Number.isFinite(e)&&e>0},"  "),workScheme:ns()}),workInfo:La({position:An().trim().min(1," "),hireDate:ns()}),preferences:La({preferredShifts:ns(),schemePreferences:ns()}),additional:La({personnelNumber:ns(),actualAddress:ns(),tasks:ns()}),tags:ns(),status:KN(u7)}),r2=(t,e,r)=>{if(t&&"reportValidity"in t){const n=Ke(r,e);t.setCustomValidity(n&&n.message||""),t.reportValidity()}},XN=(t,e)=>{for(const r in e.fields){const n=e.fields[r];n&&n.ref&&"reportValidity"in n.ref?r2(n.ref,r,t):n.refs&&n.refs.forEach(i=>r2(i,r,t))}},d7=(t,e)=>{e.shouldUseNativeValidation&&XN(t,e);const r={};for(const n in t){const i=Ke(e.fields,n),s=Object.assign(t[n]||{},{ref:i&&i.ref});if(h7(e.names||Object.keys(t),n)){const a=Object.assign({},Ke(r,n));lr(a,"root",s),lr(r,n,a)}else lr(r,n,s)}return r},h7=(t,e)=>t.some(r=>r.startsWith(e+"."));var p7=function(t,e){for(var r={};t.length;){var n=t[0],i=n.code,s=n.message,a=n.path.join(".");if(!r[a])if("unionErrors"in n){var o=n.unionErrors[0].errors[0];r[a]={message:o.message,type:o.code}}else r[a]={message:s,type:i};if("unionErrors"in n&&n.unionErrors.forEach(function(d){return d.errors.forEach(function(h){return t.push(h)})}),e){var l=r[a].types,u=l&&l[n.code];r[a]=yT(a,e,r,i,u?[].concat(u,n.message):n.message)}t.shift()}return r},ZN=function(t,e,r){return r===void 0&&(r={}),function(n,i,s){try{return Promise.resolve((function(a,o){try{var l=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](n,e)).then(function(u){return s.shouldUseNativeValidation&&XN({},s),{errors:{},values:r.raw?n:u}})}catch(u){return o(u)}return l&&l.then?l.then(void 0,o):l})(0,function(a){if((function(o){return Array.isArray(o==null?void 0:o.errors)})(a))return{values:{},errors:d7(p7(a.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}}};const m7=t=>{var e,r;return{personalInfo:{lastName:t.personalInfo.lastName,firstName:t.personalInfo.firstName,middleName:t.personalInfo.middleName??"",email:t.personalInfo.email,phone:t.personalInfo.phone,address:t.personalInfo.address??"",dateOfBirth:t.personalInfo.dateOfBirth?t.personalInfo.dateOfBirth.toISOString().slice(0,10):""},credentials:{wfmLogin:t.credentials.wfmLogin,externalLogins:t.credentials.externalLogins.join(", "),password:""},orgPlacement:{orgUnit:t.orgPlacement.orgUnit,office:t.orgPlacement.office,timeZone:t.orgPlacement.timeZone,hourNorm:t.orgPlacement.hourNorm.toString(),workScheme:((e=t.orgPlacement.workScheme)==null?void 0:e.name)??""},workInfo:{position:t.workInfo.position,hireDate:t.workInfo.hireDate.toISOString().slice(0,10)},preferences:{preferredShifts:t.preferences.preferredShifts.join(", "),schemePreferences:(t.preferences.schemePreferences??[]).join(", ")},additional:{personnelNumber:t.personnelNumber??"",actualAddress:t.actualAddress??t.personalInfo.address??"",tasks:WN(((r=t.tasks)==null?void 0:r.map(n=>n.message).join(`
`))??"")},tags:t.tags.join(", "),status:t.status}},g7=()=>({personalInfo:{lastName:"",firstName:"",middleName:"",email:"",phone:"",address:"",dateOfBirth:""},credentials:{wfmLogin:"",externalLogins:"",password:""},orgPlacement:{orgUnit:"",office:"",timeZone:"",hourNorm:"40",workScheme:""},workInfo:{position:"",hireDate:""},preferences:{preferredShifts:"",schemePreferences:""},additional:{personnelNumber:"",actualAddress:"",tasks:WN("")},tags:"",status:"active"}),x7=(t,e)=>{var o;const r=t.credentials.externalLogins.split(",").map(l=>l.trim()).filter(Boolean),n=t.preferences.preferredShifts.split(",").map(l=>l.trim()).filter(Boolean),i=t.preferences.schemePreferences.split(",").map(l=>l.trim()).filter(Boolean),s=Rz(t.additional.tasks).split(/\r?\n/).map(l=>l.trim()).filter(Boolean),a=s.length>0?[...e.tasks??[],...s.map(l=>Ul(l,"manual"))]:e.tasks??[];return{...e,status:t.status,personalInfo:{...e.personalInfo,lastName:t.personalInfo.lastName.trim(),firstName:t.personalInfo.firstName.trim(),middleName:t.personalInfo.middleName.trim(),email:t.personalInfo.email.trim(),phone:t.personalInfo.phone.trim(),address:t.personalInfo.address.trim(),dateOfBirth:t.personalInfo.dateOfBirth?new Date(t.personalInfo.dateOfBirth):void 0},credentials:{...e.credentials,wfmLogin:t.credentials.wfmLogin.trim(),externalLogins:r,passwordSet:e.credentials.passwordSet||t.credentials.password.trim().length>0,passwordLastUpdated:t.credentials.password.trim().length>0?new Date:e.credentials.passwordLastUpdated},orgPlacement:{...e.orgPlacement,orgUnit:t.orgPlacement.orgUnit.trim(),office:t.orgPlacement.office.trim(),timeZone:t.orgPlacement.timeZone.trim(),hourNorm:Number(t.orgPlacement.hourNorm),workScheme:t.orgPlacement.workScheme.trim()?{...e.orgPlacement.workScheme??{id:"manual",type:"custom"},name:t.orgPlacement.workScheme.trim(),effectiveFrom:((o=e.orgPlacement.workScheme)==null?void 0:o.effectiveFrom)??new Date}:void 0},workInfo:{...e.workInfo,position:t.workInfo.position.trim(),hireDate:t.workInfo.hireDate?new Date(t.workInfo.hireDate):e.workInfo.hireDate},preferences:{...e.preferences,preferredShifts:n.length>0?n:e.preferences.preferredShifts,schemePreferences:i.length>0?i:e.preferences.schemePreferences},personnelNumber:t.additional.personnelNumber.trim()||void 0,actualAddress:t.additional.actualAddress.trim()||void 0,tasks:a,tags:t.tags.split(",").map(l=>l.trim()).filter(Boolean),metadata:{...e.metadata,updatedAt:new Date,lastModifiedBy:"agent"}}},v7=ZN(f7);function JN(t){return`${t}-label`}const y7={display:"flex",flexDirection:"column",gap:en("xs")},w7={fontFamily:Vu("fontFamily"),fontSize:$u("sizeSm"),fontWeight:gy("fontWeightSemibold"),color:Qr("emphasisForeground"),display:"inline-flex",alignItems:"center",gap:en("2xs")},QN={fontFamily:Vu("fontFamily"),fontSize:$u("sizeXs"),lineHeight:uA("lineHeightRelaxed"),color:Qr("mutedForeground")},b7={...QN,color:Qr("danger")};function vu({fieldId:t,label:e,children:r,error:n,hint:i,required:s,testId:a}){const o=z.useId(),l=t??o,u=JN(l),d=i?`${l}-hint`:void 0,h=typeof n=="string"?n:n==null?void 0:n.message,m=h?`${l}-error`:void 0;return b.jsxs("div",{style:y7,"data-testid":a,children:[b.jsxs("label",{id:u,htmlFor:l,style:w7,children:[b.jsx("span",{children:e}),s?b.jsx("span",{"aria-hidden":!0,children:"*"}):null]}),r,h?b.jsx("span",{id:m,role:"alert",style:b7,children:h}):i?b.jsx("span",{id:d,style:QN,children:i}):null]})}const yu=({controlId:t,hasError:e,labelId:r,hintId:n,errorId:i})=>{const s=r??JN(t);return{id:t,labelId:s,"aria-invalid":e||void 0,"aria-describedby":[i,n].filter(Boolean).join(" ")||void 0}};La({login:An().min(4," 4 "),email:An().email(" email"),status:KN(["active","trial","dismissed"])});en("sm"),Zl("md"),`${Qr("borderMuted")}`,Qr("surface"),Qr("emphasisForeground");en("md");function Tn(t){this.content=t}Tn.prototype={constructor:Tn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),s=n.content.slice();return i==-1?s.push(r||t,e):(s[i+1]=e,r&&(s[i]=r)),new Tn(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new Tn(r)},addToStart:function(t,e){return new Tn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new Tn(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),s=n.find(t);return i.splice(s==-1?i.length:s,0,e,r),new Tn(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Tn.from(t),t.size?new Tn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Tn.from(t),t.size?new Tn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Tn.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};Tn.from=function(t){if(t instanceof Tn)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new Tn(e)};function eM(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),s=e.child(n);if(i==s){r+=i.nodeSize;continue}if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(let a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){let a=eM(i.content,s.content,r+1);if(a!=null)return a}r+=i.nodeSize}}function tM(t,e,r,n){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:r,b:n};let a=t.child(--i),o=e.child(--s),l=a.nodeSize;if(a==o){r-=l,n-=l;continue}if(!a.sameMarkup(o))return{a:r,b:n};if(a.isText&&a.text!=o.text){let u=0,d=Math.min(a.text.length,o.text.length);for(;u<d&&a.text[a.text.length-u-1]==o.text[o.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(a.content.size||o.content.size){let u=tM(a.content,o.content,r-1,n-1);if(u)return u}r-=l,n-=l}}class Ie{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,s){for(let a=0,o=0;o<r;a++){let l=this.content[a],u=o+l.nodeSize;if(u>e&&n(l,i+o,s||null,a)!==!1&&l.content.size){let d=o+1;l.nodesBetween(Math.max(0,e-d),Math.min(l.content.size,r-d),n,i+d)}o=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let s="",a=!0;return this.nodesBetween(e,r,(o,l)=>{let u=o.isText?o.text.slice(Math.max(e,l)-l,r-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&n&&(a?a=!1:s+=n),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),s=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new Ie(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let s=0,a=0;a<r;s++){let o=this.content[s],l=a+o.nodeSize;l>e&&((a<e||l>r)&&(o.isText?o=o.cut(Math.max(0,e-a),Math.min(o.text.length,r-a)):o=o.cut(Math.max(0,e-a-1),Math.min(o.content.size,r-a-1))),n.push(o),i+=o.nodeSize),a=l}return new Ie(n,i)}cutByIndex(e,r){return e==r?Ie.empty:e==0&&r==this.content.length?this:new Ie(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),s=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new Ie(i,s)}addToStart(e){return new Ie([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ie(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return eM(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return tM(this,e,r,n)}findIndex(e){if(e==0)return D0(0,e);if(e==this.size)return D0(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),s=n+i.nodeSize;if(s>=e)return s==e?D0(r+1,s):D0(r,n);n=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return Ie.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ie(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ie.empty;let r,n=0;for(let i=0;i<e.length;i++){let s=e[i];n+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(r||(r=e.slice(0,i)),r[r.length-1]=s.withText(r[r.length-1].text+s.text)):r&&r.push(s)}return new Ie(r||e,n)}static from(e){if(!e)return Ie.empty;if(e instanceof Ie)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ie([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ie.empty=new Ie([],0);const qx={index:0,offset:0};function D0(t,e){return qx.index=t,qx.offset=e,qx}function Vp(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!Vp(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!Vp(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let hr=class d1{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))r||(r=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(s)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Vp(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return d1.none;if(e instanceof d1)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};hr.none=[];class $p extends Error{}class Qe{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=nM(this.content,e+this.openStart,r);return n&&new Qe(n,this.openStart,this.openEnd)}removeBetween(e,r){return new Qe(rM(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return Qe.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Qe(Ie.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.lastChild)i++;return new Qe(e,n,i)}}Qe.empty=new Qe(Ie.empty,0,0);function rM(t,e,r){let{index:n,offset:i}=t.findIndex(e),s=t.maybeChild(n),{index:a,offset:o}=t.findIndex(r);if(i==e||s.isText){if(o!=r&&!t.child(a).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=a)throw new RangeError("Removing non-flat range");return t.replaceChild(n,s.copy(rM(s.content,e-i-1,r-i-1)))}function nM(t,e,r,n){let{index:i,offset:s}=t.findIndex(e),a=t.maybeChild(i);if(s==e||a.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let o=nM(a.content,e-s-1,r,a);return o&&t.replaceChild(i,a.copy(o))}function k7(t,e,r){if(r.openStart>t.depth)throw new $p("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new $p("Inconsistent open depths");return iM(t,e,r,0)}function iM(t,e,r,n){let i=t.index(n),s=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let a=iM(t,e,r,n+1);return s.copy(s.content.replaceChild(i,a))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let a=t.parent,o=a.content;return Wl(a,o.cut(0,t.parentOffset).append(r.content).append(o.cut(e.parentOffset)))}else{let{start:a,end:o}=S7(r,t);return Wl(s,aM(t,a,o,e,n))}else return Wl(s,Up(t,e,n))}function sM(t,e){if(!e.type.compatibleContent(t.type))throw new $p("Cannot join "+e.type.name+" onto "+t.type.name)}function h1(t,e,r){let n=t.node(r);return sM(n,e.node(r)),n}function Hl(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function hd(t,e,r,n){let i=(e||t).node(r),s=0,a=e?e.index(r):i.childCount;t&&(s=t.index(r),t.depth>r?s++:t.textOffset&&(Hl(t.nodeAfter,n),s++));for(let o=s;o<a;o++)Hl(i.child(o),n);e&&e.depth==r&&e.textOffset&&Hl(e.nodeBefore,n)}function Wl(t,e){return t.type.checkContent(e),t.copy(e)}function aM(t,e,r,n,i){let s=t.depth>i&&h1(t,e,i+1),a=n.depth>i&&h1(r,n,i+1),o=[];return hd(null,t,i,o),s&&a&&e.index(i)==r.index(i)?(sM(s,a),Hl(Wl(s,aM(t,e,r,n,i+1)),o)):(s&&Hl(Wl(s,Up(t,e,i+1)),o),hd(e,r,i,o),a&&Hl(Wl(a,Up(r,n,i+1)),o)),hd(n,null,i,o),new Ie(o)}function Up(t,e,r){let n=[];if(hd(null,t,r,n),t.depth>r){let i=h1(t,e,r+1);Hl(Wl(i,Up(t,e,r+1)),n)}return hd(e,null,r,n),new Ie(n)}function S7(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let s=r-1;s>=0;s--)i=e.node(s).copy(Ie.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class Bd{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let s=0;s<e;s++)i+=n.child(s).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return hr.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let o=n;n=i,i=o}let s=n.marks;for(var a=0;a<s.length;a++)s[a].type.spec.inclusive===!1&&(!i||!s[a].isInSet(i.marks))&&(s=s[a--].removeFromSet(s));return s}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!i||!n[s].isInSet(i.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new Hp(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,s=r;for(let a=e;;){let{index:o,offset:l}=a.content.findIndex(s),u=s-l;if(n.push(a,o,i+l),!u||(a=a.child(o),a.isText))break;s=u-1,i+=l+1}return new Bd(r,n,s)}static resolveCached(e,r){let n=n2.get(e);if(n)for(let s=0;s<n.elts.length;s++){let a=n.elts[s];if(a.pos==r)return a}else n2.set(e,n=new _7);let i=n.elts[n.i]=Bd.resolve(e,r);return n.i=(n.i+1)%C7,i}}class _7{constructor(){this.elts=[],this.i=0}}const C7=12,n2=new WeakMap;class Hp{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const E7=Object.create(null);let Ho=class p1{constructor(e,r,n,i=hr.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||Ie.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&Vp(this.attrs,r||e.defaultAttrs||E7)&&hr.sameSet(this.marks,n||hr.none)}copy(e=null){return e==this.content?this:new p1(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new p1(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return Qe.empty;let i=this.resolve(e),s=this.resolve(r),a=n?0:i.sharedDepth(r),o=i.start(a),u=i.node(a).content.cut(i.pos-o,s.pos-o);return new Qe(u,i.depth-a,s.depth-a)}replace(e,r,n){return k7(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return Bd.resolveCached(this,e)}resolveNoCache(e){return Bd.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,s=>(n.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),oM(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=Ie.empty,i=0,s=n.childCount){let a=this.contentMatchAt(e).matchFragment(n,i,s),o=a&&a.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(n),a=s&&s.matchFragment(this.content,r);return a?a.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=hr.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!hr.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=Ie.fromJSON(e,r.content),s=e.nodeType(r.type).create(r.attrs,i,n);return s.type.checkAttrs(s.attrs),s}};Ho.prototype.text=void 0;class Wp extends Ho{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):oM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Wp(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Wp(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function oM(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class sc{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new T7(e,r);if(n.next==null)return sc.empty;let i=lM(n);n.next&&n.err("Unexpected trailing text");let s=I7(F7(i));return R7(s,n),s}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let s=r;i&&s<n;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function s(a,o){let l=a.matchFragment(e,n);if(l&&(!r||l.validEnd))return Ie.from(o.map(u=>u.createAndFill()));for(let u=0;u<a.next.length;u++){let{type:d,next:h}=a.next[u];if(!(d.isText||d.hasRequiredAttrs())&&i.indexOf(h)==-1){i.push(h);let m=s(h,o.concat(d));if(m)return m}}return null}return s(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),s=i.match;if(s.matchType(e)){let a=[];for(let o=i;o.type;o=o.via)a.push(o.type);return a.reverse()}for(let a=0;a<s.next.length;a++){let{type:o,next:l}=s.next[a];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!i.type||l.validEnd)&&(n.push({match:o.contentMatch,type:o,via:i}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let s=i+(n.validEnd?"*":" ")+" ";for(let a=0;a<n.next.length;a++)s+=(a?", ":"")+n.next[a].type.name+"->"+e.indexOf(n.next[a].next);return s}).join(`
`)}}sc.empty=new sc(!0);class T7{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function lM(t){let e=[];do e.push(A7(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function A7(t){let e=[];do e.push(N7(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function N7(t){let e=O7(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=M7(t,e);else break;return e}function i2(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function M7(t,e){let r=i2(t),n=r;return t.eat(",")&&(t.next!="}"?n=i2(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function D7(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let s in r){let a=r[s];a.isInGroup(e)&&i.push(a)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function O7(t){if(t.eat("(")){let e=lM(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=D7(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function F7(t){let e=[[]];return i(s(t,0),r()),e;function r(){return e.push([])-1}function n(a,o,l){let u={term:l,to:o};return e[a].push(u),u}function i(a,o){a.forEach(l=>l.to=o)}function s(a,o){if(a.type=="choice")return a.exprs.reduce((l,u)=>l.concat(s(u,o)),[]);if(a.type=="seq")for(let l=0;;l++){let u=s(a.exprs[l],o);if(l==a.exprs.length-1)return u;i(u,o=r())}else if(a.type=="star"){let l=r();return n(o,l),i(s(a.expr,l),l),[n(l)]}else if(a.type=="plus"){let l=r();return i(s(a.expr,o),l),i(s(a.expr,l),l),[n(l)]}else{if(a.type=="opt")return[n(o)].concat(s(a.expr,o));if(a.type=="range"){let l=o;for(let u=0;u<a.min;u++){let d=r();i(s(a.expr,l),d),l=d}if(a.max==-1)i(s(a.expr,l),l);else for(let u=a.min;u<a.max;u++){let d=r();n(l,d),i(s(a.expr,l),d),l=d}return[n(l)]}else{if(a.type=="name")return[n(o,void 0,a.value)];throw new Error("Unknown expr type")}}}}function cM(t,e){return e-t}function s2(t,e){let r=[];return n(e),r.sort(cM);function n(i){let s=t[i];if(s.length==1&&!s[0].term)return n(s[0].to);r.push(i);for(let a=0;a<s.length;a++){let{term:o,to:l}=s[a];!o&&r.indexOf(l)==-1&&n(l)}}}function I7(t){let e=Object.create(null);return r(s2(t,0));function r(n){let i=[];n.forEach(a=>{t[a].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let d=0;d<i.length;d++)i[d][0]==o&&(u=i[d][1]);s2(t,l).forEach(d=>{u||i.push([o,u=[]]),u.indexOf(d)==-1&&u.push(d)})})});let s=e[n.join(",")]=new sc(n.indexOf(t.length-1)>-1);for(let a=0;a<i.length;a++){let o=i[a][1].sort(cM);s.next.push({type:i[a][0],next:e[o.join(",")]||r(o)})}return s}}function R7(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],s=!i.validEnd,a=[];for(let o=0;o<i.next.length;o++){let{type:l,next:u}=i.next[o];a.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),n.indexOf(u)==-1&&n.push(u)}s&&e.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function uM(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function fM(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let s=t[n];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function dM(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function hM(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new L7(t,n,e[n]);return r}let a2=class pM{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=hM(e,n.attrs),this.defaultAttrs=uM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==sc.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:fM(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ho(this,this.computeAttrs(e),Ie.from(r),hr.setFrom(n))}createChecked(e=null,r,n){return r=Ie.from(r),this.checkContent(r),new Ho(this,this.computeAttrs(e),r,hr.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=Ie.from(r),r.size){let a=this.contentMatch.fillBefore(r);if(!a)return null;r=a.append(r)}let i=this.contentMatch.matchFragment(r),s=i&&i.fillBefore(Ie.empty,!0);return s?new Ho(this,e,r.append(s),hr.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){dM(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:hr.none:e}static compile(e,r){let n=Object.create(null);e.forEach((s,a)=>n[s]=new pM(s,r,a));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function P7(t,e,r){let n=r.split("|");return i=>{let s=i===null?"null":typeof i;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${s}`)}}class L7{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?P7(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Cm{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=hM(e,i.attrs),this.excluded=null;let s=uM(this.attrs);this.instance=s?new hr(this,s):null}create(e=null){return!e&&this.instance?this.instance:new hr(this,fM(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((s,a)=>n[s]=new Cm(s,i++,r,a)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){dM(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class mM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=Tn.from(e.nodes),r.marks=Tn.from(e.marks||{}),this.nodes=a2.compile(this.spec.nodes,this),this.marks=Cm.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],a=s.spec.content||"",o=s.spec.marks;if(s.contentMatch=n[a]||(n[a]=sc.parse(a,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=o=="_"?null:o?o2(this,o.split(" ")):o==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],a=s.spec.excludes;s.excluded=a==null?[s]:a==""?[]:o2(this,a.split(" "))}this.nodeFromJSON=i=>Ho.fromJSON(this,i),this.markFromJSON=i=>hr.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof a2){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new Wp(n,n.defaultAttrs,e,hr.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function o2(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],s=t.marks[i],a=s;if(s)r.push(s);else for(let o in t.marks){let l=t.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&r.push(a=l)}if(!a)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function B7(t){return t.tag!=null}function j7(t){return t.style!=null}class Wo{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(B7(i))this.tags.push(i);else if(j7(i)){let s=/[^=]*/.exec(i.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,r={}){let n=new c2(this,r,!1);return n.addAll(e,hr.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new c2(this,r,!0);return n.addAll(e,hr.none,r.from,r.to),Qe.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if($7(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||r.matchesContext(s.context))){if(s.getAttrs){let a=s.getAttrs(e);if(a===!1)continue;s.attrs=a||void 0}return s}}}matchStyle(e,r,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let a=this.styles[s],o=a.style;if(!(o.indexOf(e)!=0||a.context&&!n.matchesContext(a.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=r))){if(a.getAttrs){let l=a.getAttrs(r);if(l===!1)continue;a.attrs=l||void 0}return a}}}static schemaRules(e){let r=[];function n(i){let s=i.priority==null?50:i.priority,a=0;for(;a<r.length;a++){let o=r[a];if((o.priority==null?50:o.priority)<s)break}r.splice(a,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(a=>{n(a=u2(a)),a.mark||a.ignore||a.clearMark||(a.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(a=>{n(a=u2(a)),a.node||a.ignore||a.mark||(a.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Wo(e,Wo.schemaRules(e)))}}const gM={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},z7={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},xM={ol:!0,ul:!0},jd=1,m1=2,pd=4;function l2(t,e,r){return e!=null?(e?jd:0)|(e==="full"?m1:0):t&&t.whitespace=="pre"?jd|m1:r&~pd}class O0{constructor(e,r,n,i,s,a){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=a,this.content=[],this.activeMarks=hr.none,this.match=s||(a&pd?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ie.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&jd)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let r=Ie.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(Ie.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!gM.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class c2{constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,s,a=l2(null,r.preserveWhitespace,0)|(n?pd:0);i?s=new O0(i.type,i.attrs,hr.none,!0,r.topMatch||i.type.contentMatch,a):n?s=new O0(null,null,hr.none,!0,null,a):s=new O0(e.schema.topNodeType,null,hr.none,!0,null,a),this.nodes=[s],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,s=i.options&m1?"full":this.localPreserveWS||(i.options&jd)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(s)s!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let a=i.content[i.content.length-1],o=e.previousSibling;(!a||o&&o.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let a=e.nodeName.toLowerCase(),o;xM.hasOwnProperty(a)&&this.parser.normalizeLists&&V7(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(l?l.ignore:z7.hasOwnProperty(a))this.findInside(e),this.ignoreFallback(e,r);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,d=this.needsBlock;if(gM.hasOwnProperty(a))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let h=l&&l.skip?r:this.readStyles(e,r);h&&this.addAll(e,h),u&&this.sync(s),this.needsBlock=d}else{let u=this.readStyles(e,r);u&&this.addElementByRule(e,l,u,l.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],a=n.getPropertyValue(s);if(a)for(let o=void 0;;){let l=this.parser.matchStyle(s,a,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?r=r.filter(u=>!l.clearMark(u)):r=r.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return r}addElementByRule(e,r,n,i){let s,a;if(r.node)if(a=this.parser.schema.nodes[r.node],a.isLeaf)this.insertNode(a.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(a,r.attrs||null,n,r.preserveWhitespace);l&&(s=!0,n=l)}else{let l=this.parser.schema.marks[r.mark];n=n.concat(l.create(r.attrs))}let o=this.top;if(a&&a.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof r.contentElement=="string"?l=e.querySelector(r.contentElement):typeof r.contentElement=="function"?l=r.contentElement(e):r.contentElement&&(l=r.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}s&&this.sync(o)&&this.open--}addAll(e,r,n,i){let s=n||0;for(let a=n?e.childNodes[n]:e.firstChild,o=i==null?null:e.childNodes[i];a!=o;a=a.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(a,r);this.findAtPoint(e,s)}findPlace(e,r,n){let i,s;for(let a=this.open,o=0;a>=0;a--){let l=this.nodes[a],u=l.findWrapping(e);if(u&&(!i||i.length>u.length+o)&&(i=u,s=l,!u.length))break;if(l.solid){if(n)break;o+=2}}if(!i)return null;this.sync(s);for(let a=0;a<i.length;a++)r=this.enterInner(i[a],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(r=this.enterInner(s,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let a=hr.none;for(let o of i.concat(e.marks))(s.type?s.type.allowsMarkType(o.type):f2(o.type,e.type))&&(a=o.addToSet(a));return s.content.push(e.mark(a)),!0}return!1}enter(e,r,n,i){let s=this.findPlace(e.create(r),n,!1);return s&&(s=this.enterInner(e,r,n,!0,i)),s}enterInner(e,r,n,i=!1,s){this.closeExtra();let a=this.top;a.match=a.match&&a.match.matchType(e);let o=l2(e,s,a.options);a.options&pd&&a.content.length==0&&(o|=pd);let l=hr.none;return n=n.filter(u=>(a.type?a.type.allowsMarkType(u.type):f2(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new O0(e,r,l,i,null,o)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=jd)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(i?0:1),a=(o,l)=>{for(;o>=0;o--){let u=r[o];if(u==""){if(o==r.length-1||o==0)continue;for(;l>=s;l--)if(a(o-1,l))return!0;return!1}else{let d=l>0||l==0&&i?this.nodes[l].type:n&&l>=s?n.node(l-s).type:null;if(!d||d.name!=u&&!d.isInGroup(u))return!1;l--}}return!0};return a(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function V7(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&xM.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function $7(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function u2(t){let e={};for(let r in t)e[r]=t[r];return e}function f2(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let s=[],a=o=>{s.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:d}=o.edge(l);if(u==e||s.indexOf(d)<0&&a(d))return!0}};if(a(i.contentMatch))return!0}}class xc{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=Yx(r).createDocumentFragment());let i=n,s=[];return e.forEach(a=>{if(s.length||a.marks.length){let o=0,l=0;for(;o<s.length&&l<a.marks.length;){let u=a.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(s[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<s.length;)i=s.pop()[1];for(;l<a.marks.length;){let u=a.marks[l++],d=this.serializeMark(u,a.isInline,r);d&&(s.push([u,i]),i.appendChild(d.dom),i=d.contentDOM||d.dom)}}i.appendChild(this.serializeNodeInner(a,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=fp(Yx(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,r);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&fp(Yx(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return fp(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new xc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=d2(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return d2(e.marks)}}function d2(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function Yx(t){return t.document||window.document}const h2=new WeakMap;function U7(t){let e=h2.get(t);return e===void 0&&h2.set(t,e=H7(t)),e}function H7(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function fp(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(s=U7(n))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let a=i.indexOf(" ");a>0&&(r=i.slice(0,a),i=i.slice(a+1));let o,l=r?t.createElementNS(r,i):t.createElement(i),u=e[1],d=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){d=2;for(let h in u)if(u[h]!=null){let m=h.indexOf(" ");m>0?l.setAttributeNS(h.slice(0,m),h.slice(m+1),u[h]):h=="style"&&l.style?l.style.cssText=u[h]:l.setAttribute(h,u[h])}}for(let h=d;h<e.length;h++){let m=e[h];if(m===0){if(h<e.length-1||h>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:g,contentDOM:v}=fp(t,m,r,n);if(l.appendChild(g),v){if(o)throw new RangeError("Multiple content holes");o=v}}}return{dom:l,contentDOM:o}}const vM=65535,yM=Math.pow(2,16);function W7(t,e){return t+e*yM}function p2(t){return t&vM}function G7(t){return(t-(t&vM))/yM}const wM=1,bM=2,dp=4,kM=8;class g1{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&kM)>0}get deletedBefore(){return(this.delInfo&(wM|dp))>0}get deletedAfter(){return(this.delInfo&(bM|dp))>0}get deletedAcross(){return(this.delInfo&dp)>0}}class Hi{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Hi.empty)return Hi.empty}recover(e){let r=0,n=p2(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+G7(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[o+s],d=this.ranges[o+a],h=l+u;if(e<=h){let m=u?e==l?-1:e==h?1:r:r,g=l+i+(m<0?0:d);if(n)return g;let v=e==(r<0?l:h)?null:W7(o/3,e-l),x=e==l?bM:e==h?wM:dp;return(r<0?e!=l:e!=h)&&(x|=kM),new g1(g,x,v)}i+=d-u}return n?e+i:new g1(e+i,0,null)}touches(e,r){let n=0,i=p2(r),s=this.inverted?2:1,a=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?n:0);if(l>e)break;let u=this.ranges[o+s],d=l+u;if(e<=d&&o==i*3)return!0;n+=this.ranges[o+a]-u}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let a=this.ranges[i],o=a-(this.inverted?s:0),l=a+(this.inverted?0:s),u=this.ranges[i+r],d=this.ranges[i+n];e(o,o+u,l,l+d),s+=d-u}}invert(){return new Hi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Hi.empty:new Hi(e<0?[0,-e,0]:[0,0,e])}}Hi.empty=new Hi([]);class zd{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new zd(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new zd;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let s=this.from;s<this.to;s++){let a=this._maps[s],o=a.mapResult(e,r);if(o.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this._maps[l].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return n?e:new g1(e,i,null)}}const Kx=Object.create(null);class ri{getMap(){return Hi.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Kx[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Kx)throw new RangeError("Duplicate use of step JSON ID "+e);return Kx[e]=r,r.prototype.jsonID=e,r}}class Zr{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new Zr(e,null)}static fail(e){return new Zr(null,e)}static fromReplace(e,r,n,i){try{return Zr.ok(e.replace(r,n,i))}catch(s){if(s instanceof $p)return Zr.fail(s.message);throw s}}}function Gy(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(Gy(s.content,e,s))),s.isInline&&(s=e(s,r,i)),n.push(s)}return Ie.fromArray(n)}class Io extends ri{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),s=new Qe(Gy(r.content,(a,o)=>!a.isAtom||!o.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),i),r.openStart,r.openEnd);return Zr.fromReplace(e,this.from,this.to,s)}invert(){return new da(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Io(r.pos,n.pos,this.mark)}merge(e){return e instanceof Io&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Io(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Io(r.from,r.to,e.markFromJSON(r.mark))}}ri.jsonID("addMark",Io);class da extends ri{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new Qe(Gy(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return Zr.fromReplace(e,this.from,this.to,n)}invert(){return new Io(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new da(r.pos,n.pos,this.mark)}merge(e){return e instanceof da&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new da(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new da(r.from,r.to,e.markFromJSON(r.mark))}}ri.jsonID("removeMark",da);class Ro extends ri{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return Zr.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return Zr.fromReplace(e,this.pos,this.pos+1,new Qe(Ie.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new Ro(this.pos,r.marks[i]);return new Ro(this.pos,this.mark)}}return new ac(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Ro(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ro(r.pos,e.markFromJSON(r.mark))}}ri.jsonID("addNodeMark",Ro);class ac extends ri{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return Zr.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return Zr.fromReplace(e,this.pos,this.pos+1,new Qe(Ie.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Ro(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new ac(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ac(r.pos,e.markFromJSON(r.mark))}}ri.jsonID("removeNodeMark",ac);class xn extends ri{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&x1(e,this.from,this.to)?Zr.fail("Structure replace would overwrite content"):Zr.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Hi([this.from,this.to-this.from,this.slice.size])}invert(e){return new xn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new xn(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof xn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?Qe.empty:new Qe(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new xn(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?Qe.empty:new Qe(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new xn(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new xn(r.from,r.to,Qe.fromJSON(e,r.slice),!!r.structure)}}ri.jsonID("replace",xn);class yn extends ri{constructor(e,r,n,i,s,a,o=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=s,this.insert=a,this.structure=o}apply(e){if(this.structure&&(x1(e,this.from,this.gapFrom)||x1(e,this.gapTo,this.to)))return Zr.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return Zr.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?Zr.fromReplace(e,this.from,this.to,n):Zr.fail("Content does not fit in gap")}getMap(){return new Hi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new yn(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||s>n.pos?null:new yn(r.pos,n.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new yn(r.from,r.to,r.gapFrom,r.gapTo,Qe.fromJSON(e,r.slice),r.insert,!!r.structure)}}ri.jsonID("replaceAround",yn);function x1(t,e,r){let n=t.resolve(e),i=r-e,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let a=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,i--}}return!1}function q7(t,e,r,n){let i=[],s=[],a,o;t.doc.nodesBetween(e,r,(l,u,d)=>{if(!l.isInline)return;let h=l.marks;if(!n.isInSet(h)&&d.type.allowsMarkType(n.type)){let m=Math.max(u,e),g=Math.min(u+l.nodeSize,r),v=n.addToSet(h);for(let x=0;x<h.length;x++)h[x].isInSet(v)||(a&&a.to==m&&a.mark.eq(h[x])?a.to=g:i.push(a=new da(m,g,h[x])));o&&o.to==m?o.to=g:s.push(o=new Io(m,g,n))}}),i.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}function Y7(t,e,r,n){let i=[],s=0;t.doc.nodesBetween(e,r,(a,o)=>{if(!a.isInline)return;s++;let l=null;if(n instanceof Cm){let u=a.marks,d;for(;d=n.isInSet(u);)(l||(l=[])).push(d),u=d.removeFromSet(u)}else n?n.isInSet(a.marks)&&(l=[n]):l=a.marks;if(l&&l.length){let u=Math.min(o+a.nodeSize,r);for(let d=0;d<l.length;d++){let h=l[d],m;for(let g=0;g<i.length;g++){let v=i[g];v.step==s-1&&h.eq(i[g].style)&&(m=v)}m?(m.to=u,m.step=s):i.push({style:h,from:Math.max(o,e),to:u,step:s})}}}),i.forEach(a=>t.step(new da(a.from,a.to,a.style)))}function qy(t,e,r,n=r.contentMatch,i=!0){let s=t.doc.nodeAt(e),a=[],o=e+1;for(let l=0;l<s.childCount;l++){let u=s.child(l),d=o+u.nodeSize,h=n.matchType(u.type);if(!h)a.push(new xn(o,d,Qe.empty));else{n=h;for(let m=0;m<u.marks.length;m++)r.allowsMarkType(u.marks[m].type)||t.step(new da(o,d,u.marks[m]));if(i&&u.isText&&r.whitespace!="pre"){let m,g=/\r?\n|\r/g,v;for(;m=g.exec(u.text);)v||(v=new Qe(Ie.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),a.push(new xn(o+m.index,o+m.index+m[0].length,v))}}o=d}if(!n.validEnd){let l=n.fillBefore(Ie.empty,!0);t.replace(o,o,new Qe(l,0,0))}for(let l=a.length-1;l>=0;l--)t.step(a[l])}function K7(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function Gu(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let i=t.$from.node(n),s=t.$from.index(n),a=t.$to.indexAfter(n);if(n<t.depth&&i.canReplace(s,a,r))return n;if(n==0||i.type.spec.isolating||!K7(i,s,a))break}return null}function X7(t,e,r){let{$from:n,$to:i,depth:s}=e,a=n.before(s+1),o=i.after(s+1),l=a,u=o,d=Ie.empty,h=0;for(let v=s,x=!1;v>r;v--)x||n.index(v)>0?(x=!0,d=Ie.from(n.node(v).copy(d)),h++):l--;let m=Ie.empty,g=0;for(let v=s,x=!1;v>r;v--)x||i.after(v+1)<i.end(v)?(x=!0,m=Ie.from(i.node(v).copy(m)),g++):u++;t.step(new yn(l,u,a,o,new Qe(d.append(m),h,g),d.size-h,!0))}function Yy(t,e,r=null,n=t){let i=Z7(t,e),s=i&&J7(n,e);return s?i.map(m2).concat({type:e,attrs:r}).concat(s.map(m2)):null}function m2(t){return{type:t,attrs:null}}function Z7(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.contentMatchAt(n).findWrapping(e);if(!s)return null;let a=s.length?s[0]:e;return r.canReplaceWith(n,i,a)?s:null}function J7(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.child(n),a=e.contentMatch.findWrapping(s.type);if(!a)return null;let l=(a.length?a[a.length-1]:e).contentMatch;for(let u=n;l&&u<i;u++)l=l.matchType(r.child(u).type);return!l||!l.validEnd?null:a}function Q7(t,e,r){let n=Ie.empty;for(let a=r.length-1;a>=0;a--){if(n.size){let o=r[a].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ie.from(r[a].type.create(r[a].attrs,n))}let i=e.start,s=e.end;t.step(new yn(i,s,i,s,new Qe(n,0,0),r.length,!0))}function eV(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,r,(a,o)=>{let l=typeof i=="function"?i(a):i;if(a.isTextblock&&!a.hasMarkup(n,l)&&tV(t.doc,t.mapping.slice(s).map(o),n)){let u=null;if(n.schema.linebreakReplacement){let g=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);g&&!v?u=!1:!g&&v&&(u=!0)}u===!1&&_M(t,a,o,s),qy(t,t.mapping.slice(s).map(o,1),n,void 0,u===null);let d=t.mapping.slice(s),h=d.map(o,1),m=d.map(o+a.nodeSize,1);return t.step(new yn(h,m,h+1,m-1,new Qe(Ie.from(n.create(l,null,a.marks)),0,0),1,!0)),u===!0&&SM(t,a,o,s),!1}})}function SM(t,e,r,n){e.forEach((i,s)=>{if(i.isText){let a,o=/\r?\n|\r/g;for(;a=o.exec(i.text);){let l=t.mapping.slice(n).map(r+1+s+a.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function _M(t,e,r,n){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let a=t.mapping.slice(n).map(r+1+s);t.replaceWith(a,a+1,e.type.schema.text(`
`))}})}function tV(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function rV(t,e,r,n,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");r||(r=s.type);let a=r.create(n,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,a);if(!r.validContent(s.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new yn(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new Qe(Ie.from(a),0,0),1,!0))}function qa(t,e,r=1,n){let i=t.resolve(e),s=i.depth-r,a=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!a.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,d=r-2;u>s;u--,d--){let h=i.node(u),m=i.index(u);if(h.type.spec.isolating)return!1;let g=h.content.cutByIndex(m,h.childCount),v=n&&n[d+1];v&&(g=g.replaceChild(0,v.type.create(v.attrs)));let x=n&&n[d]||h;if(!h.canReplace(m+1,h.childCount)||!x.type.validContent(g))return!1}let o=i.indexAfter(s),l=n&&n[0];return i.node(s).canReplaceWith(o,o,l?l.type:i.node(s+1).type)}function nV(t,e,r=1,n){let i=t.doc.resolve(e),s=Ie.empty,a=Ie.empty;for(let o=i.depth,l=i.depth-r,u=r-1;o>l;o--,u--){s=Ie.from(i.node(o).copy(s));let d=n&&n[u];a=Ie.from(d?d.type.create(d.attrs,a):i.node(o).copy(a))}t.step(new xn(e,e,new Qe(s.append(a),r,r),!0))}function sl(t,e){let r=t.resolve(e),n=r.index();return CM(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function iV(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),a=s.type==n?t.type.schema.nodes.text:s.type;if(r=r.matchType(a),!r||!t.type.allowsMarks(s.marks))return!1}return r.validEnd}function CM(t,e){return!!(t&&e&&!t.isLeaf&&iV(t,e))}function Em(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let s,a,o=n.index(i);if(i==n.depth?(s=n.nodeBefore,a=n.nodeAfter):r>0?(s=n.node(i+1),o++,a=n.node(i).maybeChild(o)):(s=n.node(i).maybeChild(o-1),a=n.node(i+1)),s&&!s.isTextblock&&CM(s,a)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function sV(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-r),a=s.node().type;if(i&&a.inlineContent){let d=a.whitespace=="pre",h=!!a.contentMatch.matchType(i);d&&!h?n=!1:!d&&h&&(n=!0)}let o=t.steps.length;if(n===!1){let d=t.doc.resolve(e+r);_M(t,d.node(),d.before(),o)}a.inlineContent&&qy(t,e+r-1,a,s.node().contentMatchAt(s.index()),n==null);let l=t.mapping.slice(o),u=l.map(e-r);if(t.step(new xn(u,l.map(e+r,-1),Qe.empty,!0)),n===!0){let d=t.doc.resolve(u);SM(t,d.node(),d.before(),t.steps.length)}return t}function aV(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let s=n.index(i);if(n.node(i).canReplaceWith(s,s,r))return n.before(i+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let s=n.indexAfter(i);if(n.node(i).canReplaceWith(s,s,r))return n.after(i+1);if(s<n.node(i).childCount)return null}return null}function EM(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let s=0;s<r.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(r.openStart==0&&r.size?2:1);s++)for(let a=n.depth;a>=0;a--){let o=a==n.depth?0:n.pos<=(n.start(a+1)+n.end(a+1))/2?-1:1,l=n.index(a)+(o>0?1:0),u=n.node(a),d=!1;if(s==1)d=u.canReplace(l,l,i);else{let h=u.contentMatchAt(l).findWrapping(i.firstChild.type);d=h&&u.canReplaceWith(l,l,h[0])}if(d)return o==0?n.pos:o<0?n.before(a+1):n.after(a+1)}return null}function Tm(t,e,r=e,n=Qe.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),s=t.resolve(r);return TM(i,s,n)?new xn(e,r,n):new oV(i,s,n).fit()}function TM(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class oV{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ie.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Ie.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let s=this.placed,a=n.depth,o=i.depth;for(;a&&o&&s.childCount==1;)s=s.firstChild.content,a--,o--;let l=new Qe(s,a,o);return e>-1?new yn(n.pos,e,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new xn(n.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let s=r.firstChild;if(r.childCount>1&&(i=0),s.type.spec.isolating&&i<=n){e=n;break}r=s.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,s=null;n?(s=Xx(this.unplaced.content,n-1).firstChild,i=s.content):i=this.unplaced.content;let a=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],d,h=null;if(r==1&&(a?u.matchType(a.type)||(h=u.fillBefore(Ie.from(a),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:o,parent:s,inject:h};if(r==2&&a&&(d=u.findWrapping(a.type)))return{sliceDepth:n,frontierDepth:o,parent:s,wrap:d};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=Xx(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Qe(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=Xx(e,r);if(i.childCount<=1&&r>0){let s=e.size-r<=r+i.size;this.unplaced=new Qe(Kf(e,r-1,1),r-1,s?r-1:n)}else this.unplaced=new Qe(Kf(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:s}){for(;this.depth>r;)this.closeFrontierNode();if(s)for(let x=0;x<s.length;x++)this.openFrontierNode(s[x]);let a=this.unplaced,o=n?n.content:a.content,l=a.openStart-e,u=0,d=[],{match:h,type:m}=this.frontier[r];if(i){for(let x=0;x<i.childCount;x++)d.push(i.child(x));h=h.matchFragment(i)}let g=o.size+e-(a.content.size-a.openEnd);for(;u<o.childCount;){let x=o.child(u),w=h.matchType(x.type);if(!w)break;u++,(u>1||l==0||x.content.size)&&(h=w,d.push(AM(x.mark(m.allowedMarks(x.marks)),u==1?l:0,u==o.childCount?g:-1)))}let v=u==o.childCount;v||(g=-1),this.placed=Xf(this.placed,r,Ie.from(d)),this.frontier[r].match=h,v&&g<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let x=0,w=o;x<g;x++){let S=w.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),w=S.content}this.unplaced=v?e==0?Qe.empty:new Qe(Kf(a.content,e-1,1),e-1,g<0?a.openEnd:e-1):new Qe(Kf(a.content,e,u),a.openStart,a.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!Zx(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],s=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),a=Zx(e,r,i,n,s);if(a){for(let o=r-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],d=Zx(e,o,u,l,!0);if(!d||d.childCount)continue e}return{depth:r,fit:a,move:s?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Xf(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Xf(this.placed,this.depth,Ie.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ie.empty,!0);r.childCount&&(this.placed=Xf(this.placed,this.frontier.length,r))}}function Kf(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(Kf(t.firstChild.content,e-1,r)))}function Xf(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(Xf(t.lastChild.content,e-1,r)))}function Xx(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function AM(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,AM(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(Ie.empty,!0)))),t.copy(n)}function Zx(t,e,r,n,i){let s=t.node(e),a=i?t.indexAfter(e):t.index(e);if(a==s.childCount&&!r.compatibleContent(s.type))return null;let o=n.fillBefore(s.content,!0,a);return o&&!lV(r,s.content,a)?o:null}function lV(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function cV(t){return t.spec.defining||t.spec.definingForContent}function uV(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),s=t.doc.resolve(r);if(TM(i,s,n))return t.step(new xn(e,r,n));let a=MM(i,t.doc.resolve(r));a[a.length-1]==0&&a.pop();let o=-(i.depth+1);a.unshift(o);for(let m=i.depth,g=i.pos-1;m>0;m--,g--){let v=i.node(m).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;a.indexOf(m)>-1?o=m:i.before(m)==g&&a.splice(1,0,-m)}let l=a.indexOf(o),u=[],d=n.openStart;for(let m=n.content,g=0;;g++){let v=m.firstChild;if(u.push(v),g==n.openStart)break;m=v.content}for(let m=d-1;m>=0;m--){let g=u[m],v=cV(g.type);if(v&&!g.sameMarkup(i.node(Math.abs(o)-1)))d=m;else if(v||!g.type.isTextblock)break}for(let m=n.openStart;m>=0;m--){let g=(m+d+1)%(n.openStart+1),v=u[g];if(v)for(let x=0;x<a.length;x++){let w=a[(x+l)%a.length],S=!0;w<0&&(S=!1,w=-w);let T=i.node(w-1),_=i.index(w-1);if(T.canReplaceWith(_,_,v.type,v.marks))return t.replace(i.before(w),S?s.after(w):r,new Qe(NM(n.content,0,n.openStart,g),g,n.openEnd))}}let h=t.steps.length;for(let m=a.length-1;m>=0&&(t.replace(e,r,n),!(t.steps.length>h));m--){let g=a[m];g<0||(e=i.before(g),r=s.after(g))}}function NM(t,e,r,n,i){if(e<r){let s=t.firstChild;t=t.replaceChild(0,s.copy(NM(s.content,e+1,r,n,s)))}if(e>n){let s=i.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(Ie.empty,!0))}return t}function fV(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=aV(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new Qe(Ie.from(n),0,0))}function dV(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),s=MM(n,i);for(let a=0;a<s.length;a++){let o=s[a],l=a==s.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return t.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return t.delete(n.before(o),i.after(o))}for(let a=1;a<=n.depth&&a<=i.depth;a++)if(e-n.start(a)==n.depth-a&&r>n.end(a)&&i.end(a)-r!=i.depth-a&&n.start(a-1)==i.start(a-1)&&n.node(a-1).canReplace(n.index(a-1),i.index(a-1)))return t.delete(n.before(a),r);t.delete(e,r)}function MM(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&r.push(i)}return r}class wu extends ri{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return Zr.fail("No node at attribute step's position");let n=Object.create(null);for(let s in r.attrs)n[s]=r.attrs[s];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return Zr.fromReplace(e,this.pos,this.pos+1,new Qe(Ie.from(i),0,r.isLeaf?0:1))}getMap(){return Hi.empty}invert(e){return new wu(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new wu(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new wu(r.pos,r.attr,r.value)}}ri.jsonID("attr",wu);class Vd extends ri{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return Zr.ok(n)}getMap(){return Hi.empty}invert(e){return new Vd(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Vd(r.attr,r.value)}}ri.jsonID("docAttr",Vd);let Du=class extends Error{};Du=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};Du.prototype=Object.create(Error.prototype);Du.prototype.constructor=Du;Du.prototype.name="TransformError";class hV{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new zd}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new Du(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=Qe.empty){let i=Tm(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new Qe(Ie.from(n),0,0))}delete(e,r){return this.replace(e,r,Qe.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return uV(this,e,r,n),this}replaceRangeWith(e,r,n){return fV(this,e,r,n),this}deleteRange(e,r){return dV(this,e,r),this}lift(e,r){return X7(this,e,r),this}join(e,r=1){return sV(this,e,r),this}wrap(e,r){return Q7(this,e,r),this}setBlockType(e,r=e,n,i=null){return eV(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return rV(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new wu(e,r,n)),this}setDocAttribute(e,r){return this.step(new Vd(e,r)),this}addNodeMark(e,r){return this.step(new Ro(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof hr)r.isInSet(n.marks)&&this.step(new ac(e,r));else{let i=n.marks,s,a=[];for(;s=r.isInSet(i);)a.push(new ac(e,s)),i=s.removeFromSet(i);for(let o=a.length-1;o>=0;o--)this.step(a[o])}return this}split(e,r=1,n){return nV(this,e,r,n),this}addMark(e,r,n){return q7(this,e,r,n),this}removeMark(e,r,n){return Y7(this,e,r,n),this}clearIncompatible(e,r,n){return qy(this,e,r,n),this}}const Jx=Object.create(null);class Pt{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new pV(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=Qe.empty){let n=r.content.lastChild,i=null;for(let o=0;o<r.openEnd;o++)i=n,n=n.lastChild;let s=e.steps.length,a=this.ranges;for(let o=0;o<a.length;o++){let{$from:l,$to:u}=a[o],d=e.mapping.slice(s);e.replaceRange(d.map(l.pos),d.map(u.pos),o?Qe.empty:r),o==0&&v2(e,s,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:a,$to:o}=i[s],l=e.mapping.slice(n),u=l.map(a.pos),d=l.map(o.pos);s?e.deleteRange(u,d):(e.replaceRangeWith(u,d,r),v2(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new Mt(e):cu(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let s=e.depth-1;s>=0;s--){let a=r<0?cu(e.node(0),e.node(s),e.before(s+1),e.index(s),r,n):cu(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,r,n);if(a)return a}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new Wi(e.node(0))}static atStart(e){return cu(e,e,0,0,1)||new Wi(e)}static atEnd(e){return cu(e,e,e.content.size,e.childCount,-1)||new Wi(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Jx[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Jx)throw new RangeError("Duplicate use of selection JSON ID "+e);return Jx[e]=r,r.prototype.jsonID=e,r}getBookmark(){return Mt.between(this.$anchor,this.$head).getBookmark()}}Pt.prototype.visible=!0;class pV{constructor(e,r){this.$from=e,this.$to=r}}let g2=!1;function x2(t){!g2&&!t.parent.inlineContent&&(g2=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Mt extends Pt{constructor(e,r=e){x2(e),x2(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return Pt.near(n);let i=e.resolve(r.map(this.anchor));return new Mt(i.parent.inlineContent?i:n,n)}replace(e,r=Qe.empty){if(super.replace(e,r),r==Qe.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof Mt&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Am(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Mt(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let s=Pt.findFrom(r,n,!0)||Pt.findFrom(r,-n,!0);if(s)r=s.$head;else return Pt.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(Pt.findFrom(e,-n,!0)||Pt.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new Mt(e,r)}}Pt.jsonID("text",Mt);class Am{constructor(e,r){this.anchor=e,this.head=r}map(e){return new Am(e.map(this.anchor),e.map(this.head))}resolve(e){return Mt.between(e.resolve(this.anchor),e.resolve(this.head))}}class mt extends Pt{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),s=e.resolve(i);return n?Pt.near(s):new mt(s)}content(){return new Qe(Ie.from(this.node),0,0)}eq(e){return e instanceof mt&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ky(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new mt(e.resolve(r.anchor))}static create(e,r){return new mt(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}mt.prototype.visible=!1;Pt.jsonID("node",mt);class Ky{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new Am(n,n):new Ky(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&mt.isSelectable(n)?new mt(r):Pt.near(r)}}class Wi extends Pt{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=Qe.empty){if(r==Qe.empty){e.delete(0,e.doc.content.size);let n=Pt.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new Wi(e)}map(e){return new Wi(e)}eq(e){return e instanceof Wi}getBookmark(){return mV}}Pt.jsonID("all",Wi);const mV={map(){return this},resolve(t){return new Wi(t)}};function cu(t,e,r,n,i,s=!1){if(e.inlineContent)return Mt.create(t,r);for(let a=n-(i>0?0:1);i>0?a<e.childCount:a>=0;a+=i){let o=e.child(a);if(o.isAtom){if(!s&&mt.isSelectable(o))return mt.create(t,r-(i<0?o.nodeSize:0))}else{let l=cu(t,o,r+i,i<0?o.childCount:0,i,s);if(l)return l}r+=o.nodeSize*i}return null}function v2(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof xn||i instanceof yn))return;let s=t.mapping.maps[n],a;s.forEach((o,l,u,d)=>{a==null&&(a=d)}),t.setSelection(Pt.near(t.doc.resolve(a),r))}const y2=1,F0=2,w2=4;class gV extends hV{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|y2)&~F0,this.storedMarks=null,this}get selectionSet(){return(this.updated&y2)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=F0,this}ensureMarks(e){return hr.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&F0)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&~F0,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||hr.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),n=n??r,!e)return this.deleteRange(r,n);let s=this.storedMarks;if(!s){let a=this.doc.resolve(r);s=n==r?a.marks():a.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,s)),this.selection.empty||this.setSelection(Pt.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=w2,this}get scrolledIntoView(){return(this.updated&w2)>0}}function b2(t,e){return!e||!t?t:t.bind(e)}class Zf{constructor(e,r,n){this.name=e,this.init=b2(r.init,n),this.apply=b2(r.apply,n)}}const xV=[new Zf("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Zf("selection",{init(t,e){return t.selection||Pt.atStart(e.doc)},apply(t){return t.selection}}),new Zf("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new Zf("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Qx{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=xV.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Zf(n.key,n.spec.state,n))})}}class du{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let s=!1;for(let a=0;a<this.config.plugins.length;a++){let o=this.config.plugins[a];if(o.spec.appendTransaction){let l=i?i[a].n:0,u=i?i[a].state:this,d=l<r.length&&o.spec.appendTransaction.call(o,l?r.slice(l):r,u,n);if(d&&n.filterTransaction(d,a)){if(d.setMeta("appendedTransaction",e),!i){i=[];for(let h=0;h<this.config.plugins.length;h++)i.push(h<a?{state:n,n:r.length}:{state:this,n:0})}r.push(d),n=n.applyInner(d),s=!0}i&&(i[a]={state:n,n:r.length})}}if(!s)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new du(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let s=n[i];r[s.name]=s.apply(e,this[s.name],this,r)}return r}get tr(){return new gV(this)}static create(e){let r=new Qx(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new du(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new Qx(this.schema,e.plugins),n=r.fields,i=new du(r);for(let s=0;s<n.length;s++){let a=n[s].name;i[a]=this.hasOwnProperty(a)?this[a]:n[s].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],s=i.spec.state;s&&s.toJSON&&(r[n]=s.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Qx(e.schema,e.plugins),s=new du(i);return i.fields.forEach(a=>{if(a.name=="doc")s.doc=Ho.fromJSON(e.schema,r.doc);else if(a.name=="selection")s.selection=Pt.fromJSON(s.doc,r.selection);else if(a.name=="storedMarks")r.storedMarks&&(s.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let l=n[o],u=l.spec.state;if(l.key==a.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){s[a.name]=u.fromJSON.call(l,e,r[o],s);return}}s[a.name]=a.init(e,s)}}),s}}function DM(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=DM(i,e,{})),r[n]=i}return r}class Oi{constructor(e){this.spec=e,this.props={},e.props&&DM(e.props,this,this.props),this.key=e.key?e.key.key:OM("plugin")}getState(e){return e[this.key]}}const ev=Object.create(null);function OM(t){return t in ev?t+"$"+ ++ev[t]:(ev[t]=0,t+"$")}class wa{constructor(e="key"){this.key=OM(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Dn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Ou=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let v1=null;const Ba=function(t,e,r){let n=v1||(v1=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},vV=function(){v1=null},oc=function(t,e,r,n){return r&&(k2(t,e,r,n,-1)||k2(t,e,r,n,1))},yV=/^(img|br|input|textarea|hr)$/i;function k2(t,e,r,n,i){for(var s;;){if(t==r&&e==n)return!0;if(e==(i<0?0:cs(t))){let a=t.parentNode;if(!a||a.nodeType!=1||oh(t)||yV.test(t.nodeName)||t.contentEditable=="false")return!1;e=Dn(t)+(i<0?0:1),t=a}else if(t.nodeType==1){let a=t.childNodes[e+(i<0?-1:0)];if(a.nodeType==1&&a.contentEditable=="false")if(!((s=a.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else t=a,e=i<0?cs(t):0}else return!1}}function cs(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function wV(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=cs(t)}else if(t.parentNode&&!oh(t))e=Dn(t),t=t.parentNode;else return null}}function bV(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!oh(t))e=Dn(t)+1,t=t.parentNode;else return null}}function kV(t,e,r){for(let n=e==0,i=e==cs(t);n||i;){if(t==r)return!0;let s=Dn(t);if(t=t.parentNode,!t)return!1;n=n&&s==0,i=i&&s==cs(t)}}function oh(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Nm=function(t){return t.focusNode&&oc(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Fl(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function SV(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function _V(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(cs(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(cs(n.startContainer),n.startOffset)}}}const ma=typeof navigator<"u"?navigator:null,S2=typeof document<"u"?document:null,al=ma&&ma.userAgent||"",y1=/Edge\/(\d+)/.exec(al),FM=/MSIE \d/.exec(al),w1=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(al),Di=!!(FM||w1||y1),Go=FM?document.documentMode:w1?+w1[1]:y1?+y1[1]:0,ds=!Di&&/gecko\/(\d+)/i.test(al);ds&&+(/Firefox\/(\d+)/.exec(al)||[0,0])[1];const b1=!Di&&/Chrome\/(\d+)/.exec(al),Xn=!!b1,IM=b1?+b1[1]:0,di=!Di&&!!ma&&/Apple Computer/.test(ma.vendor),Fu=di&&(/Mobile\/\w+/.test(al)||!!ma&&ma.maxTouchPoints>2),ls=Fu||(ma?/Mac/.test(ma.platform):!1),CV=ma?/Win/.test(ma.platform):!1,Ua=/Android \d/.test(al),lh=!!S2&&"webkitFontSmoothing"in S2.documentElement.style,EV=lh?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function TV(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Fa(t,e){return typeof t=="number"?t:t[e]}function AV(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function _2(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let a=r||t.dom;a;){if(a.nodeType!=1){a=Ou(a);continue}let o=a,l=o==s.body,u=l?TV(s):AV(o),d=0,h=0;if(e.top<u.top+Fa(n,"top")?h=-(u.top-e.top+Fa(i,"top")):e.bottom>u.bottom-Fa(n,"bottom")&&(h=e.bottom-e.top>u.bottom-u.top?e.top+Fa(i,"top")-u.top:e.bottom-u.bottom+Fa(i,"bottom")),e.left<u.left+Fa(n,"left")?d=-(u.left-e.left+Fa(i,"left")):e.right>u.right-Fa(n,"right")&&(d=e.right-u.right+Fa(i,"right")),d||h)if(l)s.defaultView.scrollBy(d,h);else{let g=o.scrollLeft,v=o.scrollTop;h&&(o.scrollTop+=h),d&&(o.scrollLeft+=d);let x=o.scrollLeft-g,w=o.scrollTop-v;e={left:e.left-x,top:e.top-w,right:e.right-x,bottom:e.bottom-w}}let m=l?"fixed":getComputedStyle(a).position;if(/^(fixed|sticky)$/.test(m))break;a=m=="absolute"?a.offsetParent:Ou(a)}}function NV(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let s=(e.left+e.right)/2,a=r+1;a<Math.min(innerHeight,e.bottom);a+=5){let o=t.root.elementFromPoint(s,a);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=r-20){n=o,i=l.top;break}}return{refDOM:n,refTop:i,stack:RM(t.dom)}}function RM(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=Ou(n));return e}function MV({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;PM(r,n==0?0:n-e)}function PM(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:s}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=s&&(n.scrollLeft=s)}}let Qc=null;function DV(t){if(t.setActive)return t.setActive();if(Qc)return t.focus(Qc);let e=RM(t);t.focus(Qc==null?{get preventScroll(){return Qc={preventScroll:!0},!0}}:void 0),Qc||(Qc=!1,PM(e,0))}function LM(t,e){let r,n=2e8,i,s=0,a=e.top,o=e.top,l,u;for(let d=t.firstChild,h=0;d;d=d.nextSibling,h++){let m;if(d.nodeType==1)m=d.getClientRects();else if(d.nodeType==3)m=Ba(d).getClientRects();else continue;for(let g=0;g<m.length;g++){let v=m[g];if(v.top<=a&&v.bottom>=o){a=Math.max(v.bottom,a),o=Math.min(v.top,o);let x=v.left>e.left?v.left-e.left:v.right<e.left?e.left-v.right:0;if(x<n){r=d,n=x,i=x&&r.nodeType==3?{left:v.right<e.left?v.right:v.left,top:e.top}:e,d.nodeType==1&&x&&(s=h+(e.left>=(v.left+v.right)/2?1:0));continue}}else v.top>e.top&&!l&&v.left<=e.left&&v.right>=e.left&&(l=d,u={left:Math.max(v.left,Math.min(v.right,e.left)),top:v.top});!r&&(e.left>=v.right&&e.top>=v.top||e.left>=v.left&&e.top>=v.bottom)&&(s=h+1)}}return!r&&l&&(r=l,i=u,n=0),r&&r.nodeType==3?OV(r,i):!r||n&&r.nodeType==1?{node:t,offset:s}:LM(r,i)}function OV(t,e){let r=t.nodeValue.length,n=document.createRange();for(let i=0;i<r;i++){n.setEnd(t,i+1),n.setStart(t,i);let s=_o(n,1);if(s.top!=s.bottom&&Xy(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function Xy(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function FV(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function IV(t,e,r){let{node:n,offset:i}=LM(e,r),s=-1;if(n.nodeType==1&&!n.firstChild){let a=n.getBoundingClientRect();s=a.left!=a.right&&r.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(n,i,s)}function RV(t,e,r,n){let i=-1;for(let s=e,a=!1;s!=t.dom;){let o=t.docView.nearestDesc(s,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!a&&l.left>n.left||l.top>n.top?i=o.posBefore:(!a&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),a=!0),!o.contentDOM&&i<0&&!o.node.isText))return(o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;s=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function BM(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),s=i;;){let a=t.childNodes[s];if(a.nodeType==1){let o=a.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(Xy(e,u))return BM(a,e,u)}}if((s=(s+1)%n)==i)break}return t}function PV(t,e){let r=t.dom.ownerDocument,n,i=0,s=_V(r,e.left,e.top);s&&({node:n,offset:i}=s);let a=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),o;if(!a||!t.dom.contains(a.nodeType!=1?a.parentNode:a)){let u=t.dom.getBoundingClientRect();if(!Xy(e,u)||(a=BM(t.dom,e,u),!a))return null}if(di)for(let u=a;n&&u;u=Ou(u))u.draggable&&(n=void 0);if(a=FV(a,e),n){if(ds&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let d=n.childNodes[i],h;d.nodeName=="IMG"&&(h=d.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&i++}let u;lh&&i&&n.nodeType==1&&(u=n.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=RV(t,n,i,e))}o==null&&(o=IV(t,a,e));let l=t.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function C2(t){return t.top<t.bottom||t.left<t.right}function _o(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(C2(n))return n}return Array.prototype.find.call(r,C2)||t.getBoundingClientRect()}const LV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function jM(t,e,r){let{node:n,offset:i,atom:s}=t.docView.domFromPos(e,r<0?-1:1),a=lh||ds;if(n.nodeType==3)if(a&&(LV.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let l=_o(Ba(n,i,i),r);if(ds&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let u=_o(Ba(n,i-1,i-1),-1);if(u.top==l.top){let d=_o(Ba(n,i,i+1),-1);if(d.top!=l.top)return Df(d,d.left<u.left)}}return l}else{let l=i,u=i,d=r<0?1:-1;return r<0&&!i?(u++,d=-1):r>=0&&i==n.nodeValue.length?(l--,d=1):r<0?l--:u++,Df(_o(Ba(n,l,u),d),d<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(r<0||i==cs(n))){let l=n.childNodes[i-1];if(l.nodeType==1)return tv(l.getBoundingClientRect(),!1)}if(s==null&&i<cs(n)){let l=n.childNodes[i];if(l.nodeType==1)return tv(l.getBoundingClientRect(),!0)}return tv(n.getBoundingClientRect(),r>=0)}if(s==null&&i&&(r<0||i==cs(n))){let l=n.childNodes[i-1],u=l.nodeType==3?Ba(l,cs(l)-(a?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return Df(_o(u,1),!1)}if(s==null&&i<cs(n)){let l=n.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?Ba(l,0,a?0:1):l.nodeType==1?l:null:null;if(u)return Df(_o(u,-1),!0)}return Df(_o(n.nodeType==3?Ba(n):n,-r),r>=0)}function Df(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function tv(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function zM(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function BV(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return zM(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(s,!0);if(!o)break;if(o.node.isBlock){s=o.contentDOM||o.dom;break}s=o.dom.parentNode}let a=jM(t,i.pos,1);for(let o=s.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=Ba(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let d=l[u];if(d.bottom>d.top+1&&(r=="up"?a.top-d.top>(d.bottom-a.top)*2:d.bottom-a.bottom>(a.bottom-d.top)*2))return!1}}return!0})}const jV=/[\u0590-\u08ac]/;function zV(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,s=!i,a=i==n.parent.content.size,o=t.domSelection();return o?!jV.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?s:a:zM(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:d,anchorOffset:h}=t.domSelectionRange(),m=o.caretBidiLevel;o.modify("move",r,"character");let g=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:v,focusOffset:x}=t.domSelectionRange(),w=v&&!g.contains(v.nodeType==1?v:v.parentNode)||l==v&&u==x;try{o.collapse(d,h),l&&(l!=d||u!=h)&&o.extend&&o.extend(l,u)}catch{}return m!=null&&(o.caretBidiLevel=m),w}):n.pos==n.start()||n.pos==n.end()}let E2=null,T2=null,A2=!1;function VV(t,e,r){return E2==e&&T2==r?A2:(E2=e,T2=r,A2=r=="up"||r=="down"?BV(t,e,r):zV(t,e,r))}const hs=0,N2=1,Ll=2,ga=3;class ch{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=hs,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let s,a;if(e==this.contentDOM)s=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(a)+a.size:this.posAtStart}else{let s,a;if(e==this.contentDOM)s=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((a=s.pmViewDesc)&&a.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(a):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>Dn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),a;if(s&&(!r||s.node))if(n&&(a=s.nodeDOM)&&!(a.nodeType==1?a.contains(e.nodeType==1?e:e.parentNode):a==e))n=!1;else return s}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],s=n+i.size;if(n==e&&s!=n){for(;!i.border&&i.children.length;)for(let a=0;a<i.children.length;a++){let o=i.children[a];if(o.size){i=o;break}}return i}if(e<s)return i.descAt(e-n-i.border);n=s}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let s=0;n<this.children.length;n++){let a=this.children[n],o=s+a.size;if(o>e||a instanceof $M){i=e-s;break}s=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let s;n&&!(s=this.children[n-1]).size&&s instanceof VM&&s.side>=0;n--);if(r<=0){let s,a=!0;for(;s=n?this.children[n-1]:null,!(!s||s.dom.parentNode==this.contentDOM);n--,a=!1);return s&&r&&a&&!s.border&&!s.domAtom?s.domFromPos(s.size,r):{node:this.contentDOM,offset:s?Dn(s.dom)+1:0}}else{let s,a=!0;for(;s=n<this.children.length?this.children[n]:null,!(!s||s.dom.parentNode==this.contentDOM);n++,a=!1);return s&&a&&!s.border&&!s.domAtom?s.domFromPos(0,r):{node:this.contentDOM,offset:s?Dn(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let a=n,o=0;;o++){let l=this.children[o],u=a+l.size;if(i==-1&&e<=u){let d=a+l.border;if(e>=d&&r<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,r,d);e=a;for(let h=o;h>0;h--){let m=this.children[h-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){i=Dn(m.dom)+1;break}e-=m.size}i==-1&&(i=0)}if(i>-1&&(u>r||o==this.children.length-1)){r=u;for(let d=o+1;d<this.children.length;d++){let h=this.children[d];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){s=Dn(h.dom);break}r+=h.size}s==-1&&(s=this.contentDOM.childNodes.length);break}a=u}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let s=Math.min(e,r),a=Math.max(e,r);for(let g=0,v=0;g<this.children.length;g++){let x=this.children[g],w=v+x.size;if(s>v&&a<w)return x.setSelection(e-v-x.border,r-v-x.border,n,i);v=w}let o=this.domFromPos(e,e?-1:1),l=r==e?o:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),d=n.domSelectionRange(),h=!1;if((ds||di)&&e==r){let{node:g,offset:v}=o;if(g.nodeType==3){if(h=!!(v&&g.nodeValue[v-1]==`
`),h&&v==g.nodeValue.length)for(let x=g,w;x;x=x.parentNode){if(w=x.nextSibling){w.nodeName=="BR"&&(o=l={node:w.parentNode,offset:Dn(w)+1});break}let S=x.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let x=g.childNodes[v-1];h=x&&(x.nodeName=="BR"||x.contentEditable=="false")}}if(ds&&d.focusNode&&d.focusNode!=l.node&&d.focusNode.nodeType==1){let g=d.focusNode.childNodes[d.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||h&&di)&&oc(o.node,o.offset,d.anchorNode,d.anchorOffset)&&oc(l.node,l.offset,d.focusNode,d.focusOffset))return;let m=!1;if((u.extend||e==r)&&!(h&&ds)){u.collapse(o.node,o.offset);try{e!=r&&u.extend(l.node,l.offset),m=!0}catch{}}if(!m){if(e>r){let v=o;o=l,l=v}let g=document.createRange();g.setEnd(l.node,l.offset),g.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let s=this.children[i],a=n+s.size;if(n==a?e<=a&&r>=n:e<a&&r>n){let o=n+s.border,l=a-s.border;if(e>=o&&r<=l){this.dirty=e==n||r==a?Ll:N2,e==o&&r==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=ga:s.markDirty(e-o,r-o);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Ll:ga}n=a}this.dirty=Ll}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?Ll:N2;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class VM extends ch{constructor(e,r,n,i){let s,a=r.type.toDOM;if(typeof a=="function"&&(a=a(n,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!r.type.spec.raw){if(a.nodeType!=1){let o=document.createElement("span");o.appendChild(a),a=o}a.contentEditable="false",a.classList.add("ProseMirror-widget")}super(e,[],a,null),this.widget=r,this.widget=r,s=this}matchesWidget(e){return this.dirty==hs&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class $V extends ch{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class lc extends ch{constructor(e,r,n,i,s){super(e,[],n,i),this.mark=r,this.spec=s}static create(e,r,n,i){let s=i.nodeViews[r.type.name],a=s&&s(r,i,n);return(!a||!a.dom)&&(a=xc.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new lc(e,r,a.dom,a.contentDOM||a.dom,a)}parseRule(){return this.dirty&ga||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ga&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=hs){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=hs}}slice(e,r,n){let i=lc.create(this.parent,this.mark,!0,n),s=this.children,a=this.size;r<a&&(s=S1(s,r,a,n)),e>0&&(s=S1(s,0,e,n));for(let o=0;o<s.length;o++)s[o].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class qo extends ch{constructor(e,r,n,i,s,a,o,l,u){super(e,[],s,a),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,r,n,i,s,a){let o=s.nodeViews[r.type.name],l,u=o&&o(r,s,()=>{if(!l)return a;if(l.parent)return l.parent.posBeforeChild(l)},n,i),d=u&&u.dom,h=u&&u.contentDOM;if(r.isText){if(!d)d=document.createTextNode(r.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:h}=xc.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!h&&!r.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),r.type.spec.draggable&&(d.draggable=!0));let m=d;return d=WM(d,n,r),u?l=new UV(e,r,n,i,d,h||null,m,u,s,a+1):r.isText?new Mm(e,r,n,i,d,m,s):new qo(e,r,n,i,d,h||null,m,s,a+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ie.empty)}return e}matchesNode(e,r,n){return this.dirty==hs&&e.eq(this.node)&&Gp(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,s=e.composing?this.localCompositionInfo(e,r):null,a=s&&s.pos>-1?s:null,o=s&&s.pos<0,l=new WV(this,a&&a.node,e);YV(this.node,this.innerDeco,(u,d,h)=>{u.spec.marks?l.syncToMarks(u.spec.marks,n,e):u.type.side>=0&&!h&&l.syncToMarks(d==this.node.childCount?hr.none:this.node.child(d).marks,n,e),l.placeWidget(u,e,i)},(u,d,h,m)=>{l.syncToMarks(u.marks,n,e);let g;l.findNodeMatch(u,d,h,m)||o&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(g=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(u,d,h,g,e)||l.updateNextNode(u,d,h,e,m,i)||l.addNode(u,d,h,e,i),i+=u.nodeSize}),l.syncToMarks([],n,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Ll)&&(a&&this.protectLocalComposition(e,a),UM(this.contentDOM,this.children,e),Fu&&KV(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof Mt)||n<r||i>r+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let a=s.nodeValue,o=XV(this.node.content,a,n-r,i-r);return o<0?null:{node:s,pos:o,text:a}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let s=r;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let a=new $V(this,s,r,i);e.input.compositionNodes.push(a),this.children=S1(this.children,n,n+i.length,e,a)}update(e,r,n,i){return this.dirty==ga||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=hs}updateOuterDeco(e){if(Gp(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=HM(this.dom,this.nodeDOM,k1(this.outerDeco,this.node,r),k1(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function M2(t,e,r,n,i){WM(n,e,t);let s=new qo(void 0,t,e,r,n,n,n,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Mm extends qo{constructor(e,r,n,i,s,a,o){super(e,r,n,i,s,null,a,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==ga||this.dirty!=hs&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=hs||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=hs,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),s=document.createTextNode(i.text);return new Mm(this.parent,i,this.outerDeco,this.innerDeco,s,s,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=ga)}get domAtom(){return!1}isText(e){return this.node.text==e}}class $M extends ch{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==hs&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class UV extends qo{constructor(e,r,n,i,s,a,o,l,u,d){super(e,r,n,i,s,a,o,u,d),this.spec=l}update(e,r,n,i){if(this.dirty==ga)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,r,n);return s&&this.updateInner(e,r,n,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function UM(t,e,r){let n=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let a=e[s],o=a.dom;if(o.parentNode==t){for(;o!=n;)n=D2(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(o,n);if(a instanceof lc){let l=n?n.previousSibling:t.lastChild;UM(a.contentDOM,a.children,r),n=l?l.nextSibling:t.firstChild}}for(;n;)n=D2(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const md=function(t){t&&(this.nodeName=t)};md.prototype=Object.create(null);const Bl=[new md];function k1(t,e,r){if(t.length==0)return Bl;let n=r?Bl[0]:new md,i=[n];for(let s=0;s<t.length;s++){let a=t[s].type.attrs;if(a){a.nodeName&&i.push(n=new md(a.nodeName));for(let o in a){let l=a[o];l!=null&&(r&&i.length==1&&i.push(n=new md(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function HM(t,e,r,n){if(r==Bl&&n==Bl)return e;let i=e;for(let s=0;s<n.length;s++){let a=n[s],o=r[s];if(s){let l;o&&o.nodeName==a.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==a.nodeName||(l=document.createElement(a.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=Bl[0]),i=l}HV(i,o||Bl[0],a)}return i}function HV(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)i.indexOf(n[s])==-1&&t.classList.remove(n[s]);for(let s=0;s<i.length;s++)n.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function WM(t,e,r){return HM(t,t,Bl,k1(e,r,t.nodeType!=1))}function Gp(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function D2(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class WV{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=GV(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n){let i=0,s=this.stack.length>>1,a=Math.min(s,e.length);for(;i<a&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=hs,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let u=this.top.children[l];if(u.matchesMark(e[s])&&!this.isLocked(u.dom)){o=l;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let l=lc.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let s=-1,a;if(i>=this.preMatch.index&&(a=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&a.matchesNode(e,r,n))s=this.top.children.indexOf(a,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(e,r,n)&&!this.preMatch.matched.has(u)){s=o;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,r,n,i,s){let a=this.top.children[i];return a.dirty==ga&&a.dom==a.contentDOM&&(a.dirty=Ll),a.update(e,r,n,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,s,a){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof qo){let u=this.preMatch.matched.get(l);if(u!=null&&u!=s)return!1;let d=l.dom,h,m=this.isLocked(d)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ga&&Gp(r,l.outerDeco));if(!m&&l.update(e,r,n,i))return this.destroyBetween(this.index,o),l.dom!=d&&(this.changed=!0),this.index++,!0;if(!m&&(h=this.recreateWrapper(l,e,r,n,i,a)))return this.destroyBetween(this.index,o),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=Ll,h.updateChildren(i,a+1),h.dirty=hs),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,s,a){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!Gp(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=qo.create(this.top,r,n,i,s,a);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,r,n,i,s){let a=qo.create(this.top,e,r,n,i,s);a.contentDOM&&a.updateChildren(i,s+1),this.top.children.splice(this.index++,0,a),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new VM(this.top,e,r,n);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof lc;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof Mm)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((di||Xn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new $M(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function GV(t,e){let r=e,n=r.children.length,i=t.childCount,s=new Map,a=[];e:for(;i>0;){let o;for(;;)if(n){let u=r.children[n-1];if(u instanceof lc)r=u,n=u.children.length;else{o=u,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=o.node;if(l){if(l!=t.child(i-1))break;--i,s.set(o,i),a.push(o)}}return{index:i,matched:s,matches:a.reverse()}}function qV(t,e){return t.type.side-e.type.side}function YV(t,e,r,n){let i=e.locals(t),s=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let d=t.child(u);n(d,i,e.forChild(s,d),u),s+=d.nodeSize}return}let a=0,o=[],l=null;for(let u=0;;){let d,h;for(;a<i.length&&i[a].to==s;){let w=i[a++];w.widget&&(d?(h||(h=[d])).push(w):d=w)}if(d)if(h){h.sort(qV);for(let w=0;w<h.length;w++)r(h[w],u,!!l)}else r(d,u,!!l);let m,g;if(l)g=-1,m=l,l=null;else if(u<t.childCount)g=u,m=t.child(u++);else break;for(let w=0;w<o.length;w++)o[w].to<=s&&o.splice(w--,1);for(;a<i.length&&i[a].from<=s&&i[a].to>s;)o.push(i[a++]);let v=s+m.nodeSize;if(m.isText){let w=v;a<i.length&&i[a].from<w&&(w=i[a].from);for(let S=0;S<o.length;S++)o[S].to<w&&(w=o[S].to);w<v&&(l=m.cut(w-s),m=m.cut(0,w-s),v=w,g=-1)}else for(;a<i.length&&i[a].to<v;)a++;let x=m.isInline&&!m.isLeaf?o.filter(w=>!w.inline):o.slice();n(m,x,e.forChild(s,m),g),s=v}}function KV(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function XV(t,e,r,n){for(let i=0,s=0;i<t.childCount&&s<=n;){let a=t.child(i++),o=s;if(s+=a.nodeSize,!a.isText)continue;let l=a.text;for(;i<t.childCount;){let u=t.child(i++);if(s+=u.nodeSize,!u.isText)break;l+=u.text}if(s>=r){if(s>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;let u=o<n?l.lastIndexOf(e,n-o-1):-1;if(u>=0&&u+e.length+o>=r)return o+u;if(r==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}return-1}function S1(t,e,r,n,i){let s=[];for(let a=0,o=0;a<t.length;a++){let l=t[a],u=o,d=o+=l.size;u>=r||d<=e?s.push(l):(u<e&&s.push(l.slice(0,e-u,n)),i&&(s.push(i),i=void 0),d>r&&s.push(l.slice(r-u,l.size,n)))}return s}function Zy(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),s=i&&i.size==0,a=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(a<0)return null;let o=n.resolve(a),l,u;if(Nm(r)){for(l=a;i&&!i.node;)i=i.parent;let h=i.node;if(i&&h.isAtom&&mt.isSelectable(h)&&i.parent&&!(h.isInline&&kV(r.focusNode,r.focusOffset,i.dom))){let m=i.posBefore;u=new mt(a==m?o:n.resolve(m))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let h=a,m=a;for(let g=0;g<r.rangeCount;g++){let v=r.getRangeAt(g);h=Math.min(h,t.docView.posFromDOM(v.startContainer,v.startOffset,1)),m=Math.max(m,t.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(h<0)return null;[l,a]=m==t.state.selection.anchor?[m,h]:[h,m],o=n.resolve(a)}else l=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(l<0)return null}let d=n.resolve(l);if(!u){let h=e=="pointer"||t.state.selection.head<o.pos&&!s?1:-1;u=Jy(t,d,o,h)}return u}function GM(t){return t.editable?t.hasFocus():YM(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ya(t,e=!1){let r=t.state.selection;if(qM(t,r),!!GM(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Xn){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&oc(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)JV(t);else{let{anchor:n,head:i}=r,s,a;O2&&!(r instanceof Mt)&&(r.$from.parent.inlineContent||(s=F2(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(a=F2(t,r.to))),t.docView.setSelection(n,i,t,e),O2&&(s&&I2(s),a&&I2(a)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&ZV(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const O2=di||Xn&&IM<63;function F2(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,s=n?r.childNodes[n-1]:null;if(di&&i&&i.contentEditable=="false")return rv(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return rv(i);if(s)return rv(s)}}function rv(t){return t.contentEditable="true",di&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function I2(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function ZV(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!GM(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function JV(t){let e=t.domSelection();if(!e)return;let r=t.cursorWrapper.dom,n=r.nodeName=="IMG";n?e.collapse(r.parentNode,Dn(r)+1):e.collapse(r,0),!n&&!t.state.selection.visible&&Di&&Go<=11&&(r.disabled=!0,r.disabled=!1)}function qM(t,e){if(e instanceof mt){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(R2(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else R2(t)}function R2(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Jy(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||Mt.between(e,r,n)}function P2(t){return t.editable&&!t.hasFocus()?!1:YM(t)}function YM(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function QV(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return oc(e.node,e.offset,r.anchorNode,r.anchorOffset)}function _1(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&Pt.findFrom(s,e)}function Eo(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function L2(t,e,r){let n=t.state.selection;if(n instanceof Mt)if(r.indexOf("s")>-1){let{$head:i}=n,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let a=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return Eo(t,new Mt(n.$anchor,a))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=_1(t.state,e);return i&&i instanceof mt?Eo(t,i):!1}else if(!(ls&&r.indexOf("m")>-1)){let i=n.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,a;if(!s||s.isText)return!1;let o=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(a=t.docView.descAt(o))&&!a.contentDOM?mt.isSelectable(s)?Eo(t,new mt(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):lh?Eo(t,new Mt(t.state.doc.resolve(e<0?o:o+s.nodeSize))):!1:!1}}else return!1;else{if(n instanceof mt&&n.node.isInline)return Eo(t,new Mt(e>0?n.$to:n.$from));{let i=_1(t.state,e);return i?Eo(t,i):!1}}}function qp(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function gd(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function eu(t,e){return e<0?e$(t):t$(t)}function e$(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,s,a=!1;for(ds&&r.nodeType==1&&n<qp(r)&&gd(r.childNodes[n],-1)&&(a=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(gd(o,-1))i=r,s=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(KM(r))break;{let o=r.previousSibling;for(;o&&gd(o,-1);)i=r.parentNode,s=Dn(o),o=o.previousSibling;if(o)r=o,n=qp(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}a?C1(t,r,n):i&&C1(t,i,s)}function t$(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=qp(r),s,a;for(;;)if(n<i){if(r.nodeType!=1)break;let o=r.childNodes[n];if(gd(o,1))s=r,a=++n;else break}else{if(KM(r))break;{let o=r.nextSibling;for(;o&&gd(o,1);)s=o.parentNode,a=Dn(o)+1,o=o.nextSibling;if(o)r=o,n=0,i=qp(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}s&&C1(t,s,a)}function KM(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function r$(t,e){for(;t&&e==t.childNodes.length&&!oh(t);)e=Dn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function n$(t,e){for(;t&&!e&&!oh(t);)e=Dn(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function C1(t,e,r){if(e.nodeType!=3){let s,a;(a=r$(e,r))?(e=a,r=0):(s=n$(e,r))&&(e=s,r=s.nodeValue.length)}let n=t.domSelection();if(!n)return;if(Nm(n)){let s=document.createRange();s.setEnd(e,r),s.setStart(e,r),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Ya(t)},50)}function B2(t,e){let r=t.state.doc.resolve(e);if(!(Xn||CV)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let s=t.coordsAtPos(e-1),a=(s.top+s.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<r.end()){let s=t.coordsAtPos(e+1),a=(s.top+s.bottom)/2;if(a>i.top&&a<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function j2(t,e,r){let n=t.state.selection;if(n instanceof Mt&&!n.empty||r.indexOf("s")>-1||ls&&r.indexOf("m")>-1)return!1;let{$from:i,$to:s}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let a=_1(t.state,e);if(a&&a instanceof mt)return Eo(t,a)}if(!i.parent.inlineContent){let a=e<0?i:s,o=n instanceof Wi?Pt.near(a,e):Pt.findFrom(a,e);return o?Eo(t,o):!1}return!1}function z2(t,e){if(!(t.state.selection instanceof Mt))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){let a=t.state.tr;return e<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),t.dispatch(a),!0}return!1}function V2(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function i$(t){if(!di||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;V2(t,n,"true"),setTimeout(()=>V2(t,n,"false"),20)}return!1}function s$(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function a$(t,e){let r=e.keyCode,n=s$(e);if(r==8||ls&&r==72&&n=="c")return z2(t,-1)||eu(t,-1);if(r==46&&!e.shiftKey||ls&&r==68&&n=="c")return z2(t,1)||eu(t,1);if(r==13||r==27)return!0;if(r==37||ls&&r==66&&n=="c"){let i=r==37?B2(t,t.state.selection.from)=="ltr"?-1:1:-1;return L2(t,i,n)||eu(t,i)}else if(r==39||ls&&r==70&&n=="c"){let i=r==39?B2(t,t.state.selection.from)=="ltr"?1:-1:1;return L2(t,i,n)||eu(t,i)}else{if(r==38||ls&&r==80&&n=="c")return j2(t,-1,n)||eu(t,-1);if(r==40||ls&&r==78&&n=="c")return i$(t)||j2(t,1,n)||eu(t,1);if(n==(ls?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function Qy(t,e){t.someProp("transformCopied",g=>{e=g(e,t)});let r=[],{content:n,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,s--;let g=n.firstChild;r.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),n=g.content}let a=t.someProp("clipboardSerializer")||xc.fromSchema(t.state.schema),o=tD(),l=o.createElement("div");l.appendChild(a.serializeFragment(n,{document:o}));let u=l.firstChild,d,h=0;for(;u&&u.nodeType==1&&(d=eD[u.nodeName.toLowerCase()]);){for(let g=d.length-1;g>=0;g--){let v=o.createElement(d[g]);for(;l.firstChild;)v.appendChild(l.firstChild);l.appendChild(v),h++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${s}${h?` -${h}`:""} ${JSON.stringify(r)}`);let m=t.someProp("clipboardTextSerializer",g=>g(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:m,slice:e}}function XM(t,e,r,n,i){let s=i.parent.type.spec.code,a,o;if(!r&&!e)return null;let l=!!e&&(n||s||!r);if(l){if(t.someProp("transformPastedText",m=>{e=m(e,s||n,t)}),s)return o=new Qe(Ie.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",m=>{o=m(o,t,!0)}),o;let h=t.someProp("clipboardTextParser",m=>m(e,i,n,t));if(h)o=h;else{let m=i.marks(),{schema:g}=t.state,v=xc.fromSchema(g);a=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(x=>{let w=a.appendChild(document.createElement("p"));x&&w.appendChild(v.serializeNode(g.text(x,m)))})}}else t.someProp("transformPastedHTML",h=>{r=h(r,t)}),a=u$(r),lh&&f$(a);let u=a&&a.querySelector("[data-pm-slice]"),d=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let h=+d[3];h>0;h--){let m=a.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;a=m}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||Wo.fromSchema(t.state.schema)).parseSlice(a,{preserveWhitespace:!!(l||d),context:i,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!o$.test(m.parentNode.nodeName)?{ignore:!0}:null}})),d)o=d$($2(o,+d[1],+d[2]),d[4]);else if(o=Qe.maxOpen(l$(o.content,i),!0),o.openStart||o.openEnd){let h=0,m=0;for(let g=o.content.firstChild;h<o.openStart&&!g.type.spec.isolating;h++,g=g.firstChild);for(let g=o.content.lastChild;m<o.openEnd&&!g.type.spec.isolating;m++,g=g.lastChild);o=$2(o,h,m)}return t.someProp("transformPasted",h=>{o=h(o,t,l)}),o}const o$=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function l$(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),s,a=[];if(t.forEach(o=>{if(!a)return;let l=i.findWrapping(o.type),u;if(!l)return a=null;if(u=a.length&&s.length&&JM(l,s,o,a[a.length-1],0))a[a.length-1]=u;else{a.length&&(a[a.length-1]=QM(a[a.length-1],s.length));let d=ZM(o,l);a.push(d),i=i.matchType(d.type),s=l}}),a)return Ie.from(a)}return t}function ZM(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,Ie.from(t));return t}function JM(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=JM(t,e,r,n.lastChild,i+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(Ie.from(ZM(r,t,i+1))))}}function QM(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,QM(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(Ie.empty,!0);return t.copy(r.append(n))}function E1(t,e,r,n,i,s){let a=e<0?t.firstChild:t.lastChild,o=a.content;return t.childCount>1&&(s=0),i<n-1&&(o=E1(o,e,r,n,i+1,s)),i>=r&&(o=e<0?a.contentMatchAt(0).fillBefore(o,s<=i).append(o):o.append(a.contentMatchAt(a.childCount).fillBefore(Ie.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(o))}function $2(t,e,r){return e<t.openStart&&(t=new Qe(E1(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new Qe(E1(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const eD={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let U2=null;function tD(){return U2||(U2=document.implementation.createHTMLDocument("title"))}let nv=null;function c$(t){let e=window.trustedTypes;return e?(nv||(nv=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),nv.createHTML(t)):t}function u$(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=tD().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&eD[n[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),r.innerHTML=c$(t),i)for(let s=0;s<i.length;s++)r=r.querySelector(i[s])||r;return r}function f$(t){let e=t.querySelectorAll(Xn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function d$(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:a}=t;for(let o=n.length-2;o>=0;o-=2){let l=r.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=Ie.from(l.create(n[o+1],i)),s++,a++}return new Qe(i,s,a)}const hi={},pi={},h$={touchstart:!0,touchmove:!0};class p${constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function m$(t){for(let e in hi){let r=hi[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{x$(t,n)&&!ew(t,n)&&(t.editable||!(n.type in pi))&&r(t,n)},h$[e]?{passive:!0}:void 0)}di&&t.dom.addEventListener("input",()=>null),T1(t)}function Po(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function g$(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function T1(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>ew(t,n))})}function ew(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function x$(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function v$(t,e){!ew(t,e)&&hi[e.type]&&(t.editable||!(e.type in pi))&&hi[e.type](t,e)}pi.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!nD(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Ua&&Xn&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),Fu&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,Fl(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||a$(t,r)?r.preventDefault():Po(t,"key")};pi.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};pi.keypress=(t,e)=>{let r=e;if(nD(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||ls&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof Mt)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",a=>a(t,n.$from.pos,n.$to.pos,i,s))&&t.dispatch(s()),r.preventDefault()}};function Dm(t){return{left:t.clientX,top:t.clientY}}function y$(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function tw(t,e,r,n,i){if(n==-1)return!1;let s=t.state.doc.resolve(n);for(let a=s.depth+1;a>0;a--)if(t.someProp(e,o=>a>s.depth?o(t,r,s.nodeAfter,s.before(a),i,!0):o(t,r,s.node(a),s.before(a),i,!1)))return!0;return!1}function bu(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);n.setMeta("pointer",!0),t.dispatch(n)}function w$(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&mt.isSelectable(n)?(bu(t,new mt(r)),!0):!1}function b$(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof mt&&(n=r.node);let s=t.state.doc.resolve(e);for(let a=s.depth+1;a>0;a--){let o=a>s.depth?s.nodeAfter:s.node(a);if(mt.isSelectable(o)){n&&r.$from.depth>0&&a>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?i=s.before(r.$from.depth):i=s.before(a);break}}return i!=null?(bu(t,mt.create(t.state.doc,i)),!0):!1}function k$(t,e,r,n,i){return tw(t,"handleClickOn",e,r,n)||t.someProp("handleClick",s=>s(t,e,n))||(i?b$(t,r):w$(t,r))}function S$(t,e,r,n){return tw(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function _$(t,e,r,n){return tw(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||C$(t,r,n)}function C$(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(bu(t,Mt.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let s=i.depth+1;s>0;s--){let a=s>i.depth?i.nodeAfter:i.node(s),o=i.before(s);if(a.inlineContent)bu(t,Mt.create(n,o+1,o+1+a.content.size));else if(mt.isSelectable(a))bu(t,mt.create(n,o));else continue;return!0}}function rw(t){return Yp(t)}const rD=ls?"metaKey":"ctrlKey";hi.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=rw(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&y$(r,t.input.lastClick)&&!r[rD]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:s,button:r.button};let a=t.posAtCoords(Dm(r));a&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new E$(t,a,r,!!n)):(s=="doubleClick"?S$:_$)(t,a.pos,a.inside,r)?r.preventDefault():Po(t,"pointer"))};class E${constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[rD],this.allowDefault=n.shiftKey;let s,a;if(r.inside>-1)s=e.state.doc.nodeAt(r.inside),a=r.inside;else{let d=e.state.doc.resolve(r.pos);s=d.parent,a=d.depth?d.before():0}const o=i?null:n.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof mt&&u.from<=a&&u.to>a)&&(this.mightDrag={node:s,pos:a,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ds&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Po(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ya(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(Dm(e))),this.updateAllowDefault(e),this.allowDefault||!r?Po(this.view,"pointer"):k$(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||di&&this.mightDrag&&!this.mightDrag.node.isAtom||Xn&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(bu(this.view,Pt.near(this.view.state.doc.resolve(r.pos))),e.preventDefault()):Po(this.view,"pointer")}move(e){this.updateAllowDefault(e),Po(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}hi.touchstart=t=>{t.input.lastTouch=Date.now(),rw(t),Po(t,"pointer")};hi.touchmove=t=>{t.input.lastTouch=Date.now(),Po(t,"pointer")};hi.contextmenu=t=>rw(t);function nD(t,e){return t.composing?!0:di&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const T$=Ua?5e3:-1;pi.compositionstart=pi.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof Mt&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||r.marks(),Yp(t,!0),t.markCursor=null;else if(Yp(t,!e.selection.empty),ds&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,s=n.focusOffset;i&&i.nodeType==1&&s!=0;){let a=s<0?i.lastChild:i.childNodes[s-1];if(!a)break;if(a.nodeType==3){let o=t.domSelection();o&&o.collapse(a,a.nodeValue.length);break}else i=a,s=-1}}t.input.composing=!0}iD(t,T$)};pi.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,iD(t,20))};function iD(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Yp(t),e))}function sD(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=N$());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function A$(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=wV(e.focusNode,e.focusOffset),n=bV(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(r==s||n==s)return s;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let a=r.pmViewDesc;if(!(!a||!a.isText(r.nodeValue)))return n}}return r||n}function N$(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Yp(t,e=!1){if(!(Ua&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),sD(t),e||t.docView&&t.docView.dirty){let r=Zy(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function M$(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const $d=Di&&Go<15||Fu&&EV<604;hi.copy=pi.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let s=$d?null:r.clipboardData,a=n.content(),{dom:o,text:l}=Qy(t,a);s?(r.preventDefault(),s.clearData(),s.setData("text/html",o.innerHTML),s.setData("text/plain",l)):M$(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function D$(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function O$(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Ud(t,n.value,null,i,e):Ud(t,n.textContent,n.innerHTML,i,e)},50)}function Ud(t,e,r,n,i){let s=XM(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,s||Qe.empty)))return!0;if(!s)return!1;let a=D$(s),o=a?t.state.tr.replaceSelectionWith(a,n):t.state.tr.replaceSelection(s);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function aD(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}pi.paste=(t,e)=>{let r=e;if(t.composing&&!Ua)return;let n=$d?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&Ud(t,aD(n),n.getData("text/html"),i,r)?r.preventDefault():O$(t,r)};class oD{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const F$=ls?"altKey":"ctrlKey";function lD(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[F$]}hi.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Dm(r)),a;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof mt?i.to-1:i.to))){if(n&&n.mightDrag)a=mt.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let h=t.docView.nearestDesc(r.target,!0);h&&h.node.type.spec.draggable&&h!=t.docView&&(a=mt.create(t.state.doc,h.posBefore))}}let o=(a||t.state.selection).content(),{dom:l,text:u,slice:d}=Qy(t,o);(!r.dataTransfer.files.length||!Xn||IM>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData($d?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",$d||r.dataTransfer.setData("text/plain",u),t.dragging=new oD(d,lD(t,r),a)};hi.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};pi.dragover=pi.dragenter=(t,e)=>e.preventDefault();pi.drop=(t,e)=>{let r=e,n=t.dragging;if(t.dragging=null,!r.dataTransfer)return;let i=t.posAtCoords(Dm(r));if(!i)return;let s=t.state.doc.resolve(i.pos),a=n&&n.slice;a?t.someProp("transformPasted",v=>{a=v(a,t,!1)}):a=XM(t,aD(r.dataTransfer),$d?null:r.dataTransfer.getData("text/html"),!1,s);let o=!!(n&&lD(t,r));if(t.someProp("handleDrop",v=>v(t,r,a||Qe.empty,o))){r.preventDefault();return}if(!a)return;r.preventDefault();let l=a?EM(t.state.doc,s.pos,a):s.pos;l==null&&(l=s.pos);let u=t.state.tr;if(o){let{node:v}=n;v?v.replace(u):u.deleteSelection()}let d=u.mapping.map(l),h=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,m=u.doc;if(h?u.replaceRangeWith(d,d,a.content.firstChild):u.replaceRange(d,d,a),u.doc.eq(m))return;let g=u.doc.resolve(d);if(h&&mt.isSelectable(a.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(a.content.firstChild))u.setSelection(new mt(g));else{let v=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((x,w,S,T)=>v=T),u.setSelection(Jy(t,g,u.doc.resolve(v)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};hi.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ya(t)},20))};hi.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};hi.beforeinput=(t,e)=>{if(Xn&&Ua&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Fl(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in pi)hi[t]=pi[t];function Hd(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class Kp{constructor(e,r){this.toDOM=e,this.spec=r||Gl,this.side=this.spec.side||0}map(e,r,n,i){let{pos:s,deleted:a}=e.mapResult(r.from+i,this.side<0?-1:1);return a?null:new us(s-n,s-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Kp&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hd(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Yo{constructor(e,r){this.attrs=e,this.spec=r||Gl}map(e,r,n,i){let s=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,a=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return s>=a?null:new us(s,a,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof Yo&&Hd(this.attrs,e.attrs)&&Hd(this.spec,e.spec)}static is(e){return e.type instanceof Yo}destroy(){}}class nw{constructor(e,r){this.attrs=e,this.spec=r||Gl}map(e,r,n,i){let s=e.mapResult(r.from+i,1);if(s.deleted)return null;let a=e.mapResult(r.to+i,-1);return a.deleted||a.pos<=s.pos?null:new us(s.pos-n,a.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),s;return i==r.from&&!(s=e.child(n)).isText&&i+s.nodeSize==r.to}eq(e){return this==e||e instanceof nw&&Hd(this.attrs,e.attrs)&&Hd(this.spec,e.spec)}destroy(){}}class us{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new us(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new us(e,e,new Kp(r,n))}static inline(e,r,n,i){return new us(e,r,new Yo(n,i))}static node(e,r,n,i){return new us(e,r,new nw(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Yo}get widget(){return this.type instanceof Kp}}const uu=[],Gl={};class on{constructor(e,r){this.local=e.length?e:uu,this.children=r.length?r:uu}static create(e,r){return r.length?Xp(r,e,0,Gl):Wn}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,s){for(let a=0;a<this.local.length;a++){let o=this.local[a];o.from<=r&&o.to>=e&&(!s||s(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let a=0;a<this.children.length;a+=3)if(this.children[a]<r&&this.children[a+1]>e){let o=this.children[a]+1;this.children[a+2].findInner(e-o,r-o,n,i+o,s)}}map(e,r,n){return this==Wn||e.maps.length==0?this:this.mapInner(e,r,0,0,n||Gl)}mapInner(e,r,n,i,s){let a;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,n,i);l&&l.type.valid(r,l)?(a||(a=[])).push(l):s.onRemove&&s.onRemove(this.local[o].spec)}return this.children.length?I$(this.children,a||[],e,r,n,i,s):a?new on(a.sort(ql),uu):Wn}add(e,r){return r.length?this==Wn?on.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,s=0;e.forEach((o,l)=>{let u=l+n,d;if(d=uD(r,o,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(o,d,u+1):i.splice(s,0,l,l+o.nodeSize,Xp(d,o,u+1,Gl)),s+=3}});let a=cD(s?fD(r):r,-n);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||a.splice(o--,1);return new on(a.length?this.local.concat(a).sort(ql):this.local,i||this.children)}remove(e){return e.length==0||this==Wn?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let s=0;s<n.length;s+=3){let a,o=n[s]+r,l=n[s+1]+r;for(let d=0,h;d<e.length;d++)(h=e[d])&&h.from>o&&h.to<l&&(e[d]=null,(a||(a=[])).push(h));if(!a)continue;n==this.children&&(n=this.children.slice());let u=n[s+2].removeInner(a,o+1);u!=Wn?n[s+2]=u:(n.splice(s,3),s-=3)}if(i.length){for(let s=0,a;s<e.length;s++)if(a=e[s])for(let o=0;o<i.length;o++)i[o].eq(a,r)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new on(i,n):Wn}forChild(e,r){if(this==Wn)return this;if(r.isLeaf)return on.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let s=e+1,a=s+r.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<a&&l.to>s&&l.type instanceof Yo){let u=Math.max(s,l.from)-s,d=Math.min(a,l.to)-s;u<d&&(i||(i=[])).push(l.copy(u,d))}}if(i){let o=new on(i.sort(ql),uu);return n?new Mo([o,n]):o}return n||Wn}eq(e){if(this==e)return!0;if(!(e instanceof on)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return iw(this.localsInner(e))}localsInner(e){if(this==Wn)return uu;if(e.inlineContent||!this.local.some(Yo.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Yo||r.push(this.local[n]);return r}forEachSet(e){e(this)}}on.empty=new on([],[]);on.removeOverlap=iw;const Wn=on.empty;class Mo{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,Gl));return Mo.from(n)}forChild(e,r){if(r.isLeaf)return on.empty;let n=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,r);s!=Wn&&(s instanceof Mo?n=n.concat(s.members):n.push(s))}return Mo.from(n)}eq(e){if(!(e instanceof Mo)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!r)r=s;else{n&&(r=r.slice(),n=!1);for(let a=0;a<s.length;a++)r.push(s[a])}}return r?iw(n?r:r.sort(ql)):uu}static from(e){switch(e.length){case 0:return Wn;case 1:return e[0];default:return new Mo(e.every(r=>r instanceof on)?e:e.reduce((r,n)=>r.concat(n instanceof on?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function I$(t,e,r,n,i,s,a){let o=t.slice();for(let u=0,d=s;u<r.maps.length;u++){let h=0;r.maps[u].forEach((m,g,v,x)=>{let w=x-v-(g-m);for(let S=0;S<o.length;S+=3){let T=o[S+1];if(T<0||m>T+d-h)continue;let _=o[S]+d-h;g>=_?o[S+1]=m<=_?-2:-1:m>=d&&w&&(o[S]+=w,o[S+1]+=w)}h+=w}),d=r.maps[u].map(d,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let d=r.map(t[u]+s),h=d-i;if(h<0||h>=n.content.size){l=!0;continue}let m=r.map(t[u+1]+s,-1),g=m-i,{index:v,offset:x}=n.content.findIndex(h),w=n.maybeChild(v);if(w&&x==h&&x+w.nodeSize==g){let S=o[u+2].mapInner(r,w,d+1,t[u]+s+1,a);S!=Wn?(o[u]=h,o[u+1]=g,o[u+2]=S):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=R$(o,t,e,r,i,s,a),d=Xp(u,n,0,a);e=d.local;for(let h=0;h<o.length;h+=3)o[h+1]<0&&(o.splice(h,3),h-=3);for(let h=0,m=0;h<d.children.length;h+=3){let g=d.children[h];for(;m<o.length&&o[m]<g;)m+=3;o.splice(m,0,d.children[h],d.children[h+1],d.children[h+2])}}return new on(e.sort(ql),o)}function cD(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new us(i.from+e,i.to+e,i.type))}return r}function R$(t,e,r,n,i,s,a){function o(l,u){for(let d=0;d<l.local.length;d++){let h=l.local[d].map(n,i,u);h?r.push(h):a.onRemove&&a.onRemove(l.local[d].spec)}for(let d=0;d<l.children.length;d+=3)o(l.children[d+2],l.children[d]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+s+1);return r}function uD(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let s=0,a;s<t.length;s++)(a=t[s])&&a.from>r&&a.to<n&&((i||(i=[])).push(a),t[s]=null);return i}function fD(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function Xp(t,e,r,n){let i=[],s=!1;e.forEach((o,l)=>{let u=uD(t,o,l+r);if(u){s=!0;let d=Xp(u,o,r+l+1,n);d!=Wn&&i.push(l,l+o.nodeSize,d)}});let a=cD(s?fD(t):t,-r).sort(ql);for(let o=0;o<a.length;o++)a[o].type.valid(e,a[o])||(n.onRemove&&n.onRemove(a[o].spec),a.splice(o--,1));return a.length||i.length?new on(a,i):Wn}function ql(t,e){return t.from-e.from||t.to-e.to}function iw(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let s=e[i];if(s.from==n.from){s.to!=n.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,n.to),H2(e,i+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,s.from),H2(e,i,n.copy(s.from,n.to)));break}}}return e}function H2(t,e,r){for(;e<t.length&&ql(r,t[e])>0;)e++;t.splice(e,0,r)}function iv(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=Wn&&e.push(n)}),t.cursorWrapper&&e.push(on.create(t.state.doc,[t.cursorWrapper.deco])),Mo.from(e)}const P$={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},L$=Di&&Go<=11;class B${constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class j${constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new B$,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);Di&&Go<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),L$&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,P$)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(P2(this.view)){if(this.suppressingSelectionUpdates)return Ya(this.view);if(Di&&Go<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&oc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let s=e.focusNode;s;s=Ou(s))r.add(s);for(let s=e.anchorNode;s;s=Ou(s))if(r.has(s)){n=s;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&P2(e)&&!this.ignoreSelectionChange(n),s=-1,a=-1,o=!1,l=[];if(e.editable)for(let d=0;d<r.length;d++){let h=this.registerMutation(r[d],l);h&&(s=s<0?h.from:Math.min(h.from,s),a=a<0?h.to:Math.max(h.to,a),h.typeOver&&(o=!0))}if(ds&&l.length){let d=l.filter(h=>h.nodeName=="BR");if(d.length==2){let[h,m]=d;h.parentNode&&h.parentNode.parentNode==m.parentNode?m.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let m of d){let g=m.parentNode;g&&g.nodeName=="LI"&&(!h||$$(e,h)!=g)&&m.remove()}}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Nm(n)&&(u=Zy(e))&&u.eq(Pt.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ya(e),this.currentSelection.set(n),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,a),z$(e)),this.handleDOMChange(s,a,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Ya(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let d=0;d<e.addedNodes.length;d++){let h=e.addedNodes[d];r.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Di&&Go<=11&&e.addedNodes.length)for(let d=0;d<e.addedNodes.length;d++){let{previousSibling:h,nextSibling:m}=e.addedNodes[d];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(s=m)}let a=i&&i.parentNode==e.target?Dn(i)+1:0,o=n.localPosFromDOM(e.target,a,-1),l=s&&s.parentNode==e.target?Dn(s):e.target.childNodes.length,u=n.localPosFromDOM(e.target,l,1);return{from:o,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let W2=new WeakMap,G2=!1;function z$(t){if(!W2.has(t)&&(W2.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=ds,G2)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),G2=!0}}function q2(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return oc(a.node,a.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}function V$(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return q2(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?q2(t,r):null}function $$(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function U$(t,e,r){let{node:n,fromOffset:i,toOffset:s,from:a,to:o}=t.docView.parseRange(e,r),l=t.domSelectionRange(),u,d=l.anchorNode;if(d&&t.dom.contains(d.nodeType==1?d:d.parentNode)&&(u=[{node:d,offset:l.anchorOffset}],Nm(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Xn&&t.input.lastKeyCode===8)for(let w=s;w>i;w--){let S=n.childNodes[w-1],T=S.pmViewDesc;if(S.nodeName=="BR"&&!T){s=w;break}if(!T||T.size)break}let h=t.state.doc,m=t.someProp("domParser")||Wo.fromSchema(t.state.schema),g=h.resolve(a),v=null,x=m.parse(n,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:H$,context:g});if(u&&u[0].pos!=null){let w=u[0].pos,S=u[1]&&u[1].pos;S==null&&(S=w),v={anchor:w+a,head:S+a}}return{doc:x,sel:v,from:a,to:o}}function H$(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(di&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||di&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const W$=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function G$(t,e,r,n,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let E=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,A=Zy(t,E);if(A&&!t.state.selection.eq(A)){if(Xn&&Ua&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",P=>P(t,Fl(13,"Enter"))))return;let N=t.state.tr.setSelection(A);E=="pointer"?N.setMeta("pointer",!0):E=="key"&&N.scrollIntoView(),s&&N.setMeta("composition",s),t.dispatch(N)}return}let a=t.state.doc.resolve(e),o=a.sharedDepth(r);e=a.before(o+1),r=t.state.doc.resolve(r).after(o+1);let l=t.state.selection,u=U$(t,e,r),d=t.state.doc,h=d.slice(u.from,u.to),m,g;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(m=t.state.selection.to,g="end"):(m=t.state.selection.from,g="start"),t.input.lastKeyCode=null;let v=K$(h.content,u.doc.content,u.from,m,g);if(v&&t.input.domChangeCount++,(Fu&&t.input.lastIOSEnter>Date.now()-225||Ua)&&i.some(E=>E.nodeType==1&&!W$.test(E.nodeName))&&(!v||v.endA>=v.endB)&&t.someProp("handleKeyDown",E=>E(t,Fl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!v)if(n&&l instanceof Mt&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))v={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let E=Y2(t,t.state.doc,u.sel);if(E&&!E.eq(t.state.selection)){let A=t.state.tr.setSelection(E);s&&A.setMeta("composition",s),t.dispatch(A)}}return}t.state.selection.from<t.state.selection.to&&v.start==v.endB&&t.state.selection instanceof Mt&&(v.start>t.state.selection.from&&v.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?v.start=t.state.selection.from:v.endA<t.state.selection.to&&v.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(v.endB+=t.state.selection.to-v.endA,v.endA=t.state.selection.to)),Di&&Go<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>u.from&&u.doc.textBetween(v.start-u.from-1,v.start-u.from+1)==" "&&(v.start--,v.endA--,v.endB--);let x=u.doc.resolveNoCache(v.start-u.from),w=u.doc.resolveNoCache(v.endB-u.from),S=d.resolve(v.start),T=x.sameParent(w)&&x.parent.inlineContent&&S.end()>=v.endA;if((Fu&&t.input.lastIOSEnter>Date.now()-225&&(!T||i.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!T&&x.pos<u.doc.content.size&&(!x.sameParent(w)||!x.parent.inlineContent)&&x.pos<w.pos&&!/\S/.test(u.doc.textBetween(x.pos,w.pos,"","")))&&t.someProp("handleKeyDown",E=>E(t,Fl(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>v.start&&Y$(d,v.start,v.endA,x,w)&&t.someProp("handleKeyDown",E=>E(t,Fl(8,"Backspace")))){Ua&&Xn&&t.domObserver.suppressSelectionUpdates();return}Xn&&v.endB==v.start&&(t.input.lastChromeDelete=Date.now()),Ua&&!T&&x.start()!=w.start()&&w.parentOffset==0&&x.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==v.endA&&(v.endB-=2,w=u.doc.resolveNoCache(v.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(E){return E(t,Fl(13,"Enter"))})},20));let _=v.start,M=v.endA,D=E=>{let A=E||t.state.tr.replace(_,M,u.doc.slice(v.start-u.from,v.endB-u.from));if(u.sel){let N=Y2(t,A.doc,u.sel);N&&!(Xn&&t.composing&&N.empty&&(v.start!=v.endB||t.input.lastChromeDelete<Date.now()-100)&&(N.head==_||N.head==A.mapping.map(M)-1)||Di&&N.empty&&N.head==_)&&A.setSelection(N)}return s&&A.setMeta("composition",s),A.scrollIntoView()},O;if(T)if(x.pos==w.pos){Di&&Go<=11&&x.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ya(t),20));let E=D(t.state.tr.delete(_,M)),A=d.resolve(v.start).marksAcross(d.resolve(v.endA));A&&E.ensureMarks(A),t.dispatch(E)}else if(v.endA==v.endB&&(O=q$(x.parent.content.cut(x.parentOffset,w.parentOffset),S.parent.content.cut(S.parentOffset,v.endA-S.start())))){let E=D(t.state.tr);O.type=="add"?E.addMark(_,M,O.mark):E.removeMark(_,M,O.mark),t.dispatch(E)}else if(x.parent.child(x.index()).isText&&x.index()==w.index()-(w.textOffset?0:1)){let E=x.parent.textBetween(x.parentOffset,w.parentOffset),A=()=>D(t.state.tr.insertText(E,_,M));t.someProp("handleTextInput",N=>N(t,_,M,E,A))||t.dispatch(A())}else t.dispatch(D());else t.dispatch(D())}function Y2(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:Jy(t,e.resolve(r.anchor),e.resolve(r.head))}function q$(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,s=n,a,o,l;for(let d=0;d<n.length;d++)i=n[d].removeFromSet(i);for(let d=0;d<r.length;d++)s=r[d].removeFromSet(s);if(i.length==1&&s.length==0)o=i[0],a="add",l=d=>d.mark(o.addToSet(d.marks));else if(i.length==0&&s.length==1)o=s[0],a="remove",l=d=>d.mark(o.removeFromSet(d.marks));else return null;let u=[];for(let d=0;d<e.childCount;d++)u.push(l(e.child(d)));if(Ie.from(u).eq(t))return{mark:o,type:a}}function Y$(t,e,r,n,i){if(r-e<=i.pos-n.pos||sv(n,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!n.parent.isTextblock){let o=s.nodeAfter;return o!=null&&r==e+o.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let a=t.resolve(sv(s,!0,!0));return!a.parent.isTextblock||a.pos>r||sv(a,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(a.parent.content)}function sv(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let s=t.node(n).maybeChild(t.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function K$(t,e,r,n,i){let s=t.findDiffStart(e,r);if(s==null)return null;let{a,b:o}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let l=Math.max(0,s-Math.min(a,o));n-=a+l-s}if(a<s&&t.size<e.size){let l=n<=s&&n>=a?s-n:0;s-=l,s&&s<e.size&&K2(e.textBetween(s-1,s+1))&&(s+=l?1:-1),o=s+(o-a),a=s}else if(o<s){let l=n<=s&&n>=o?s-n:0;s-=l,s&&s<t.size&&K2(t.textBetween(s-1,s+1))&&(s+=l?1:-1),a=s+(a-o),o=s}return{start:s,endA:a,endB:o}}function K2(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class dD{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new p$,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(eC),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=J2(this),Z2(this),this.nodeViews=Q2(this),this.docView=M2(this.state.doc,X2(this),iv(this),this.dom,this),this.domObserver=new j$(this,(n,i,s,a)=>G$(this,n,i,s,a)),this.domObserver.start(),m$(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&T1(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(eC),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,s=!1,a=!1;e.storedMarks&&this.composing&&(sD(this),a=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let g=Q2(this);Z$(g,this.nodeViews)&&(this.nodeViews=g,s=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&T1(this),this.editable=J2(this),Z2(this);let l=iv(this),u=X2(this),d=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",h=s||!this.docView.matchesNode(e.doc,u,l);(h||!e.selection.eq(i.selection))&&(a=!0);let m=d=="preserve"&&a&&this.dom.style.overflowAnchor==null&&NV(this);if(a){this.domObserver.stop();let g=h&&(Di||Xn)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&X$(i.selection,e.selection);if(h){let v=Xn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=A$(this)),(s||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=M2(e.doc,u,l,this.dom,this)),v&&!this.trackWrites&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&QV(this))?Ya(this,g):(qM(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():m&&MV(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof mt){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&_2(this,r.getBoundingClientRect(),e)}else _2(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let s=n.from+(this.state.doc.content.size-r.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(i=s)}this.dragging=new oD(e.slice,e.move,i<0?void 0:mt.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let a=0;a<this.directPlugins.length;a++){let o=this.directPlugins[a].props[e];if(o!=null&&(i=r?r(o):o))return i}let s=this.state.plugins;if(s)for(let a=0;a<s.length;a++){let o=s[a].props[e];if(o!=null&&(i=r?r(o):o))return i}}hasFocus(){if(Di){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&DV(this.dom),Ya(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return PV(this,e)}coordsAtPos(e,r=1){return jM(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return VV(this,r||this.state,e)}pasteHTML(e,r){return Ud(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return Ud(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return Qy(this,e)}destroy(){this.docView&&(g$(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],iv(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,vV())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return v$(this,e)}domSelectionRange(){let e=this.domSelection();return e?di&&this.root.nodeType===11&&SV(this.dom.ownerDocument)==this.dom&&V$(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}dD.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function X2(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[us.node(0,t.state.doc.content.size,e)]}function Z2(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:us.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function J2(t){return!t.someProp("editable",e=>e(t.state)===!1)}function X$(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function Q2(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function Z$(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function eC(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var el={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Zp={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},J$=typeof navigator<"u"&&/Mac/.test(navigator.platform),Q$=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var On=0;On<10;On++)el[48+On]=el[96+On]=String(On);for(var On=1;On<=24;On++)el[On+111]="F"+On;for(var On=65;On<=90;On++)el[On]=String.fromCharCode(On+32),Zp[On]=String.fromCharCode(On);for(var av in el)Zp.hasOwnProperty(av)||(Zp[av]=el[av]);function eU(t){var e=J$&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Q$&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Zp:el)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const tU=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),rU=typeof navigator<"u"&&/Win/.test(navigator.platform);function nU(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,s,a;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))tU?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),a&&(r="Meta-"+r),s&&(r="Shift-"+r),r}function iU(t){let e=Object.create(null);for(let r in t)e[nU(r)]=t[r];return e}function ov(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function sU(t){return new Oi({props:{handleKeyDown:hD(t)}})}function hD(t){let e=iU(t);return function(r,n){let i=eU(n),s,a=e[ov(i,n)];if(a&&a(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let o=e[ov(i,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(rU&&n.ctrlKey&&n.altKey)&&(s=el[n.keyCode])&&s!=i){let o=e[ov(s,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}const sw=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function pD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const mD=(t,e,r)=>{let n=pD(t,r);if(!n)return!1;let i=aw(n);if(!i){let a=n.blockRange(),o=a&&Gu(a);return o==null?!1:(e&&e(t.tr.lift(a,o).scrollIntoView()),!0)}let s=i.nodeBefore;if(_D(t,i,e,-1))return!0;if(n.parent.content.size==0&&(Iu(s,"end")||mt.isSelectable(s)))for(let a=n.depth;;a--){let o=Tm(t.doc,n.before(a),n.after(a),Qe.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Iu(s,"end")?Pt.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):mt.create(l.doc,i.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}if(a==1||n.node(a-1).childCount>1)break}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},aU=(t,e,r)=>{let n=pD(t,r);if(!n)return!1;let i=aw(n);return i?gD(t,i,e):!1},oU=(t,e,r)=>{let n=vD(t,r);if(!n)return!1;let i=ow(n);return i?gD(t,i,e):!1};function gD(t,e,r){let n=e.nodeBefore,i=n,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let d=i.lastChild;if(!d)return!1;i=d}let a=e.nodeAfter,o=a,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let d=o.firstChild;if(!d)return!1;o=d}let u=Tm(t.doc,s,l,Qe.empty);if(!u||u.from!=s||u instanceof xn&&u.slice.size>=l-s)return!1;if(r){let d=t.tr.step(u);d.setSelection(Mt.create(d.doc,s)),r(d.scrollIntoView())}return!0}function Iu(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const xD=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;s=aw(n)}let a=s&&s.nodeBefore;return!a||!mt.isSelectable(a)?!1:(e&&e(t.tr.setSelection(mt.create(t.doc,s.pos-a.nodeSize)).scrollIntoView()),!0)};function aw(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function vD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const yD=(t,e,r)=>{let n=vD(t,r);if(!n)return!1;let i=ow(n);if(!i)return!1;let s=i.nodeAfter;if(_D(t,i,e,1))return!0;if(n.parent.content.size==0&&(Iu(s,"start")||mt.isSelectable(s))){let a=Tm(t.doc,n.before(),n.after(),Qe.empty);if(a&&a.slice.size<a.to-a.from){if(e){let o=t.tr.step(a);o.setSelection(Iu(s,"start")?Pt.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):mt.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},wD=(t,e,r)=>{let{$head:n,empty:i}=t.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;s=ow(n)}let a=s&&s.nodeAfter;return!a||!mt.isSelectable(a)?!1:(e&&e(t.tr.setSelection(mt.create(t.doc,s.pos)).scrollIntoView()),!0)};function ow(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const lU=(t,e)=>{let r=t.selection,n=r instanceof mt,i;if(n){if(r.node.isTextblock||!sl(t.doc,r.from))return!1;i=r.from}else if(i=Em(t.doc,r.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);n&&s.setSelection(mt.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},cU=(t,e)=>{let r=t.selection,n;if(r instanceof mt){if(r.node.isTextblock||!sl(t.doc,r.to))return!1;n=r.to}else if(n=Em(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},uU=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),s=i&&Gu(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},bD=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function lw(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const fU=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),s=r.indexAfter(-1),a=lw(i.contentMatchAt(s));if(!a||!i.canReplaceWith(s,s,a))return!1;if(e){let o=r.after(),l=t.tr.replaceWith(o,o,a.createAndFill());l.setSelection(Pt.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},kD=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof Wi||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=lw(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let a=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=t.tr.insert(a,s.createAndFill());o.setSelection(Mt.create(o.doc,a+1)),e(o.scrollIntoView())}return!0},SD=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let s=r.before();if(qa(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let n=r.blockRange(),i=n&&Gu(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)};function dU(t){return(e,r)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof mt&&e.selection.node.isBlock)return!n.parentOffset||!qa(e.doc,n.pos)?!1:(r&&r(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let s=[],a,o,l=!1,u=!1;for(let g=n.depth;;g--)if(n.node(g).isBlock){l=n.end(g)==n.pos+(n.depth-g),u=n.start(g)==n.pos-(n.depth-g),o=lw(n.node(g-1).contentMatchAt(n.indexAfter(g-1))),s.unshift(l&&o?{type:o}:null),a=g;break}else{if(g==1)return!1;s.unshift(null)}let d=e.tr;(e.selection instanceof Mt||e.selection instanceof Wi)&&d.deleteSelection();let h=d.mapping.map(n.pos),m=qa(d.doc,h,s.length,s);if(m||(s[0]=o?{type:o}:null,m=qa(d.doc,h,s.length,s)),!m)return!1;if(d.split(h,s.length,s),!l&&u&&n.node(a).type!=o){let g=d.mapping.map(n.before(a)),v=d.doc.resolve(g);o&&n.node(a-1).canReplaceWith(v.index(),v.index()+1,o)&&d.setNodeMarkup(d.mapping.map(n.before(a)),o)}return r&&r(d.scrollIntoView()),!0}}const hU=dU(),pU=(t,e)=>{let{$from:r,to:n}=t.selection,i,s=r.sharedDepth(n);return s==0?!1:(i=r.before(s),e&&e(t.tr.setSelection(mt.create(t.doc,i))),!0)};function mU(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,s=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||sl(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function _D(t,e,r,n){let i=e.nodeBefore,s=e.nodeAfter,a,o,l=i.type.spec.isolating||s.type.spec.isolating;if(!l&&mU(t,e,r))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(a=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(a[0]||s.type).validEnd){if(r){let g=e.pos+s.nodeSize,v=Ie.empty;for(let S=a.length-1;S>=0;S--)v=Ie.from(a[S].create(null,v));v=Ie.from(i.copy(v));let x=t.tr.step(new yn(e.pos-1,g,e.pos,g,new Qe(v,1,0),a.length,!0)),w=x.doc.resolve(g+2*a.length);w.nodeAfter&&w.nodeAfter.type==i.type&&sl(x.doc,w.pos)&&x.join(w.pos),r(x.scrollIntoView())}return!0}let d=s.type.spec.isolating||n>0&&l?null:Pt.findFrom(e,1),h=d&&d.$from.blockRange(d.$to),m=h&&Gu(h);if(m!=null&&m>=e.depth)return r&&r(t.tr.lift(h,m).scrollIntoView()),!0;if(u&&Iu(s,"start",!0)&&Iu(i,"end")){let g=i,v=[];for(;v.push(g),!g.isTextblock;)g=g.lastChild;let x=s,w=1;for(;!x.isTextblock;x=x.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,x.content)){if(r){let S=Ie.empty;for(let _=v.length-1;_>=0;_--)S=Ie.from(v[_].copy(S));let T=t.tr.step(new yn(e.pos-v.length,e.pos+s.nodeSize,e.pos+w,e.pos+s.nodeSize-w,new Qe(S,v.length,0),0,!0));r(T.scrollIntoView())}return!0}}return!1}function CD(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(r&&r(e.tr.setSelection(Mt.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const gU=CD(-1),xU=CD(1);function vU(t,e=null){return function(r,n){let{$from:i,$to:s}=r.selection,a=i.blockRange(s),o=a&&Yy(a,t,e);return o?(n&&n(r.tr.wrap(a,o).scrollIntoView()),!0):!1}}function tC(t,e=null){return function(r,n){let i=!1;for(let s=0;s<r.selection.ranges.length&&!i;s++){let{$from:{pos:a},$to:{pos:o}}=r.selection.ranges[s];r.doc.nodesBetween(a,o,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let d=r.doc.resolve(u),h=d.index();i=d.parent.canReplaceWith(h,h+1,t)}})}if(!i)return!1;if(n){let s=r.tr;for(let a=0;a<r.selection.ranges.length;a++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[a];s.setBlockType(o,l,t,e)}n(s.scrollIntoView())}return!0}}function cw(...t){return function(e,r,n){for(let i=0;i<t.length;i++)if(t[i](e,r,n))return!0;return!1}}cw(sw,mD,xD);cw(sw,yD,wD);cw(bD,kD,SD,hU);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function yU(t,e=null){return function(r,n){let{$from:i,$to:s}=r.selection,a=i.blockRange(s);if(!a)return!1;let o=n?r.tr:null;return wU(o,a,t,e)?(n&&n(o.scrollIntoView()),!0):!1}}function wU(t,e,r,n=null){let i=!1,s=e,a=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=a.resolve(e.start-2);s=new Hp(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Hp(e.$from,a.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=Yy(s,r,n,e);return o?(t&&bU(t,e,o,i,r),!0):!1}function bU(t,e,r,n,i){let s=Ie.empty;for(let d=r.length-1;d>=0;d--)s=Ie.from(r[d].type.create(r[d].attrs,s));t.step(new yn(e.start-(n?2:0),e.end,e.start,e.end,new Qe(s,0,0),r.length,!0));let a=0;for(let d=0;d<r.length;d++)r[d].type==i&&(a=d+1);let o=r.length-a,l=e.start+r.length-(n?2:0),u=e.parent;for(let d=e.startIndex,h=e.endIndex,m=!0;d<h;d++,m=!1)!m&&qa(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=u.child(d).nodeSize;return t}function kU(t){return function(e,r){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,a=>a.childCount>0&&a.firstChild.type==t);return s?r?n.node(s.depth-1).type==t?SU(e,r,t,s):_U(e,r,s):!0:!1}}function SU(t,e,r,n){let i=t.tr,s=n.end,a=n.$to.end(n.depth);s<a&&(i.step(new yn(s-1,a,s,a,new Qe(Ie.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new Hp(i.doc.resolve(n.$from.pos),i.doc.resolve(a),n.depth));const o=Gu(n);if(o==null)return!1;i.lift(n,o);let l=i.doc.resolve(i.mapping.map(s,-1)-1);return sl(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function _U(t,e,r){let n=t.tr,i=r.parent;for(let g=r.end,v=r.endIndex-1,x=r.startIndex;v>x;v--)g-=i.child(v).nodeSize,n.delete(g-1,g+1);let s=n.doc.resolve(r.start),a=s.nodeAfter;if(n.mapping.map(r.end)!=r.start+s.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,l=r.endIndex==i.childCount,u=s.node(-1),d=s.index(-1);if(!u.canReplace(d+(o?0:1),d+1,a.content.append(l?Ie.empty:Ie.from(i))))return!1;let h=s.pos,m=h+a.nodeSize;return n.step(new yn(h-(o?1:0),m+(l?1:0),h+1,m-1,new Qe((o?Ie.empty:Ie.from(i.copy(Ie.empty))).append(l?Ie.empty:Ie.from(i.copy(Ie.empty))),o?0:1,l?0:1),o?0:1)),e(n.scrollIntoView()),!0}function CU(t){return function(e,r){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let a=s.startIndex;if(a==0)return!1;let o=s.parent,l=o.child(a-1);if(l.type!=t)return!1;if(r){let u=l.lastChild&&l.lastChild.type==o.type,d=Ie.from(u?t.create():null),h=new Qe(Ie.from(t.create(null,Ie.from(o.type.create(null,d)))),u?3:1,0),m=s.start,g=s.end;r(e.tr.step(new yn(m-(u?3:1),g,m,g,h,1,!0)).scrollIntoView())}return!0}}function Om(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:s}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,s=r.storedMarks,r}}}class Fm{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:r,state:n}=this,{view:i}=r,{tr:s}=n,a=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...d)=>{const h=l(...d)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,r=!0){const{rawCommands:n,editor:i,state:s}=this,{view:a}=i,o=[],l=!!e,u=e||s.tr,d=()=>(!l&&r&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(u),o.every(m=>m===!0)),h={...Object.fromEntries(Object.entries(n).map(([m,g])=>[m,(...x)=>{const w=this.buildProps(u,r),S=g(...x)(w);return o.push(S),h}])),run:d};return h}createCan(e){const{rawCommands:r,state:n}=this,i=!1,s=e||n.tr,a=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(r).map(([l,u])=>[l,(...d)=>u(...d)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,r=!0){const{rawCommands:n,editor:i,state:s}=this,{view:a}=i,o={tr:e,editor:i,view:a,state:Om({state:s,transaction:e}),dispatch:r?()=>{}:void 0,chain:()=>this.createChain(e,r),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...d)=>u(...d)(o)]))}};return o}}class EU{constructor(){this.callbacks={}}on(e,r){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(r),this}emit(e,...r){const n=this.callbacks[e];return n&&n.forEach(i=>i.apply(this,r)),this}off(e,r){const n=this.callbacks[e];return n&&(r?this.callbacks[e]=n.filter(i=>i!==r):delete this.callbacks[e]),this}once(e,r){const n=(...i)=>{this.off(e,n),r.apply(this,i)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}}function ct(t,e,r){return t.config[e]===void 0&&t.parent?ct(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?ct(t.parent,e,r):null}):t.config[e]}function Im(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function ED(t){const e=[],{nodeExtensions:r,markExtensions:n}=Im(t),i=[...r,...n],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(a=>{const o={name:a.name,options:a.options,storage:a.storage,extensions:i},l=ct(a,"addGlobalAttributes",o);if(!l)return;l().forEach(d=>{d.types.forEach(h=>{Object.entries(d.attributes).forEach(([m,g])=>{e.push({type:h,name:m,attribute:{...s,...g}})})})})}),i.forEach(a=>{const o={name:a.name,options:a.options,storage:a.storage},l=ct(a,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([d,h])=>{const m={...s,...h};typeof(m==null?void 0:m.default)=="function"&&(m.default=m.default()),m!=null&&m.isRequired&&(m==null?void 0:m.default)===void 0&&delete m.default,e.push({type:a.name,name:d,attribute:m})})}),e}function kn(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function mi(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,s])=>{if(!n[i]){n[i]=s;return}if(i==="class"){const o=s?String(s).split(" "):[],l=n[i]?n[i].split(" "):[],u=o.filter(d=>!l.includes(d));n[i]=[...l,...u].join(" ")}else if(i==="style"){const o=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(d=>d.trim()).filter(Boolean):[],u=new Map;l.forEach(d=>{const[h,m]=d.split(":").map(g=>g.trim());u.set(h,m)}),o.forEach(d=>{const[h,m]=d.split(":").map(g=>g.trim());u.set(h,m)}),n[i]=Array.from(u.entries()).map(([d,h])=>`${d}: ${h}`).join("; ")}else n[i]=s}),n},{})}function A1(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>mi(r,n),{})}function TD(t){return typeof t=="function"}function jt(t,e=void 0,...r){return TD(t)?e?t.bind(e)(...r):t(...r):t}function TU(t={}){return Object.keys(t).length===0&&t.constructor===Object}function AU(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function rC(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((s,a)=>{const o=a.attribute.parseHTML?a.attribute.parseHTML(r):AU(r.getAttribute(a.name));return o==null?s:{...s,[a.name]:o}},{});return{...n,...i}}}}function nC(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&TU(r)?!1:r!=null))}function NU(t,e){var r;const n=ED(t),{nodeExtensions:i,markExtensions:s}=Im(t),a=(r=i.find(u=>ct(u,"topNode")))===null||r===void 0?void 0:r.name,o=Object.fromEntries(i.map(u=>{const d=n.filter(S=>S.type===u.name),h={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((S,T)=>{const _=ct(T,"extendNodeSchema",h);return{...S,..._?_(u):{}}},{}),g=nC({...m,content:jt(ct(u,"content",h)),marks:jt(ct(u,"marks",h)),group:jt(ct(u,"group",h)),inline:jt(ct(u,"inline",h)),atom:jt(ct(u,"atom",h)),selectable:jt(ct(u,"selectable",h)),draggable:jt(ct(u,"draggable",h)),code:jt(ct(u,"code",h)),whitespace:jt(ct(u,"whitespace",h)),linebreakReplacement:jt(ct(u,"linebreakReplacement",h)),defining:jt(ct(u,"defining",h)),isolating:jt(ct(u,"isolating",h)),attrs:Object.fromEntries(d.map(S=>{var T;return[S.name,{default:(T=S==null?void 0:S.attribute)===null||T===void 0?void 0:T.default}]}))}),v=jt(ct(u,"parseHTML",h));v&&(g.parseDOM=v.map(S=>rC(S,d)));const x=ct(u,"renderHTML",h);x&&(g.toDOM=S=>x({node:S,HTMLAttributes:A1(S,d)}));const w=ct(u,"renderText",h);return w&&(g.toText=w),[u.name,g]})),l=Object.fromEntries(s.map(u=>{const d=n.filter(w=>w.type===u.name),h={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((w,S)=>{const T=ct(S,"extendMarkSchema",h);return{...w,...T?T(u):{}}},{}),g=nC({...m,inclusive:jt(ct(u,"inclusive",h)),excludes:jt(ct(u,"excludes",h)),group:jt(ct(u,"group",h)),spanning:jt(ct(u,"spanning",h)),code:jt(ct(u,"code",h)),attrs:Object.fromEntries(d.map(w=>{var S;return[w.name,{default:(S=w==null?void 0:w.attribute)===null||S===void 0?void 0:S.default}]}))}),v=jt(ct(u,"parseHTML",h));v&&(g.parseDOM=v.map(w=>rC(w,d)));const x=ct(u,"renderHTML",h);return x&&(g.toDOM=w=>x({mark:w,HTMLAttributes:A1(w,d)})),[u.name,g]}));return new mM({topNode:a,nodes:o,marks:l})}function lv(t,e){return e.nodes[t]||e.marks[t]||null}function iC(t,e){return Array.isArray(e)?e.some(r=>(typeof r=="string"?r:r.name)===t.name):e}function uw(t,e){const r=xc.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}const MU=(t,e=500)=>{let r="";const n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(i,s,a,o)=>{var l,u;const d=((u=(l=i.type.spec).toText)===null||u===void 0?void 0:u.call(l,{node:i,pos:s,parent:a,index:o}))||i.textContent||"%leaf%";r+=i.isAtom&&!i.isText?d:d.slice(0,Math.max(0,n-s))}),r};function fw(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Rm{constructor(e){this.find=e.find,this.handler=e.handler}}const DU=(t,e)=>{if(fw(e))return e.exec(t);const r=e(t);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=t,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function I0(t){var e;const{editor:r,from:n,to:i,text:s,rules:a,plugin:o}=t,{view:l}=r;if(l.composing)return!1;const u=l.state.doc.resolve(n);if(u.parent.type.spec.code||!((e=u.nodeBefore||u.nodeAfter)===null||e===void 0)&&e.marks.find(m=>m.type.spec.code))return!1;let d=!1;const h=MU(u)+s;return a.forEach(m=>{if(d)return;const g=DU(h,m.find);if(!g)return;const v=l.state.tr,x=Om({state:l.state,transaction:v}),w={from:n-(g[0].length-s.length),to:i},{commands:S,chain:T,can:_}=new Fm({editor:r,state:x});m.handler({state:x,range:w,match:g,commands:S,chain:T,can:_})===null||!v.steps.length||(v.setMeta(o,{transform:v,from:n,to:i,text:s}),l.dispatch(v),d=!0)}),d}function OU(t){const{editor:e,rules:r}=t,n=new Oi({state:{init(){return null},apply(i,s,a){const o=i.getMeta(n);if(o)return o;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:d}=l;typeof d=="string"?d=d:d=uw(Ie.from(d),a.schema);const{from:h}=l,m=h+d.length;I0({editor:e,from:h,to:m,text:d,rules:r,plugin:n})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,a,o){return I0({editor:e,from:s,to:a,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&I0({editor:e,from:s.pos,to:s.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:a}=i.state.selection;return a?I0({editor:e,from:a.pos,to:a.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function FU(t){return Object.prototype.toString.call(t).slice(8,-1)}function R0(t){return FU(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Pm(t,e){const r={...t};return R0(t)&&R0(e)&&Object.keys(e).forEach(n=>{R0(e[n])&&R0(t[n])?r[n]=Pm(t[n],e[n]):r[n]=e[n]}),r}class tl{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=jt(ct(this,"addOptions",{name:this.name}))),this.storage=jt(ct(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new tl(e)}configure(e={}){const r=this.extend({...this.config,addOptions:()=>Pm(this.options,e)});return r.name=this.name,r.parent=this.parent,r}extend(e={}){const r=new tl(e);return r.parent=this,this.child=r,r.name=e.name?e.name:r.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=jt(ct(r,"addOptions",{name:r.name})),r.storage=jt(ct(r,"addStorage",{name:r.name,options:r.options})),r}static handleExit({editor:e,mark:r}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const a=i.marks();if(!!!a.find(u=>(u==null?void 0:u.type.name)===r.name))return!1;const l=a.find(u=>(u==null?void 0:u.type.name)===r.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}}function IU(t){return typeof t=="number"}class RU{constructor(e){this.find=e.find,this.handler=e.handler}}const PU=(t,e,r)=>{if(fw(e))return[...t.matchAll(e)];const n=e(t,r);return n?n.map(i=>{const s=[i.text];return s.index=i.index,s.input=t,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function LU(t){const{editor:e,state:r,from:n,to:i,rule:s,pasteEvent:a,dropEvent:o}=t,{commands:l,chain:u,can:d}=new Fm({editor:e,state:r}),h=[];return r.doc.nodesBetween(n,i,(g,v)=>{if(!g.isTextblock||g.type.spec.code)return;const x=Math.max(n,v),w=Math.min(i,v+g.content.size),S=g.textBetween(x-v,w-v,void 0,"");PU(S,s.find,a).forEach(_=>{if(_.index===void 0)return;const M=x+_.index+1,D=M+_[0].length,O={from:r.tr.mapping.map(M),to:r.tr.mapping.map(D)},E=s.handler({state:r,range:O,match:_,commands:l,chain:u,can:d,pasteEvent:a,dropEvent:o});h.push(E)})}),h.every(g=>g!==null)}let P0=null;const BU=t=>{var e;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=r.clipboardData)===null||e===void 0||e.setData("text/html",t),r};function jU(t){const{editor:e,rules:r}=t;let n=null,i=!1,s=!1,a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:d,from:h,to:m,rule:g,pasteEvt:v})=>{const x=d.tr,w=Om({state:d,transaction:x});if(!(!LU({editor:e,state:w,from:Math.max(h-1,0),to:m.b-1,rule:g,pasteEvent:v,dropEvent:o})||!x.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return a=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,x}};return r.map(d=>new Oi({view(h){const m=v=>{var x;n=!((x=h.dom.parentElement)===null||x===void 0)&&x.contains(v.target)?h.dom.parentElement:null,n&&(P0=e)},g=()=>{P0&&(P0=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(h,m)=>{if(s=n===h.dom.parentElement,o=m,!s){const g=P0;g!=null&&g.isEditable&&setTimeout(()=>{const v=g.state.selection;v&&g.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(h,m)=>{var g;const v=(g=m.clipboardData)===null||g===void 0?void 0:g.getData("text/html");return a=m,i=!!(v!=null&&v.includes("data-pm-slice")),!1}}},appendTransaction:(h,m,g)=>{const v=h[0],x=v.getMeta("uiEvent")==="paste"&&!i,w=v.getMeta("uiEvent")==="drop"&&!s,S=v.getMeta("applyPasteRules"),T=!!S;if(!x&&!w&&!T)return;if(T){let{text:D}=S;typeof D=="string"?D=D:D=uw(Ie.from(D),g.schema);const{from:O}=S,E=O+D.length,A=BU(D);return l({rule:d,state:g,from:O,to:{b:E},pasteEvt:A})}const _=m.doc.content.findDiffStart(g.doc.content),M=m.doc.content.findDiffEnd(g.doc.content);if(!(!IU(_)||!M||_===M.b))return l({rule:d,state:g,from:_,to:M,pasteEvt:a})}}))}function zU(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}class hu{constructor(e,r){this.splittableMarks=[],this.editor=r,this.extensions=hu.resolve(e),this.schema=NU(this.extensions,r),this.setupExtensions()}static resolve(e){const r=hu.sort(hu.flatten(e)),n=zU(r.map(i=>i.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),r}static flatten(e){return e.map(r=>{const n={name:r.name,options:r.options,storage:r.storage},i=ct(r,"addExtensions",n);return i?[r,...this.flatten(i())]:r}).flat(10)}static sort(e){return e.sort((n,i)=>{const s=ct(n,"priority")||100,a=ct(i,"priority")||100;return s>a?-1:s<a?1:0})}get commands(){return this.extensions.reduce((e,r)=>{const n={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:lv(r.name,this.schema)},i=ct(r,"addCommands",n);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,r=hu.sort([...this.extensions].reverse()),n=[],i=[],s=r.map(a=>{const o={name:a.name,options:a.options,storage:a.storage,editor:e,type:lv(a.name,this.schema)},l=[],u=ct(a,"addKeyboardShortcuts",o);let d={};if(a.type==="mark"&&ct(a,"exitable",o)&&(d.ArrowRight=()=>tl.handleExit({editor:e,mark:a})),u){const x=Object.fromEntries(Object.entries(u()).map(([w,S])=>[w,()=>S({editor:e})]));d={...d,...x}}const h=sU(d);l.push(h);const m=ct(a,"addInputRules",o);iC(a,e.options.enableInputRules)&&m&&n.push(...m());const g=ct(a,"addPasteRules",o);iC(a,e.options.enablePasteRules)&&g&&i.push(...g());const v=ct(a,"addProseMirrorPlugins",o);if(v){const x=v();l.push(...x)}return l}).flat();return[OU({editor:e,rules:n}),...jU({editor:e,rules:i}),...s]}get attributes(){return ED(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:r}=Im(this.extensions);return Object.fromEntries(r.filter(n=>!!ct(n,"addNodeView")).map(n=>{const i=this.attributes.filter(l=>l.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:e,type:kn(n.name,this.schema)},a=ct(n,"addNodeView",s);if(!a)return[];const o=(l,u,d,h,m)=>{const g=A1(l,i);return a()({node:l,view:u,getPos:d,decorations:h,innerDecorations:m,editor:e,extension:n,HTMLAttributes:g})};return[n.name,o]}))}setupExtensions(){this.extensions.forEach(e=>{var r;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:lv(e.name,this.schema)};e.type==="mark"&&(!((r=jt(ct(e,"keepOnSplit",n)))!==null&&r!==void 0)||r)&&this.splittableMarks.push(e.name);const i=ct(e,"onBeforeCreate",n),s=ct(e,"onCreate",n),a=ct(e,"onUpdate",n),o=ct(e,"onSelectionUpdate",n),l=ct(e,"onTransaction",n),u=ct(e,"onFocus",n),d=ct(e,"onBlur",n),h=ct(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),a&&this.editor.on("update",a),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),d&&this.editor.on("blur",d),h&&this.editor.on("destroy",h)})}}class gi{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=jt(ct(this,"addOptions",{name:this.name}))),this.storage=jt(ct(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new gi(e)}configure(e={}){const r=this.extend({...this.config,addOptions:()=>Pm(this.options,e)});return r.name=this.name,r.parent=this.parent,r}extend(e={}){const r=new gi({...this.config,...e});return r.parent=this,this.child=r,r.name=e.name?e.name:r.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=jt(ct(r,"addOptions",{name:r.name})),r.storage=jt(ct(r,"addStorage",{name:r.name,options:r.options})),r}}function AD(t,e,r){const{from:n,to:i}=e,{blockSeparator:s=`

`,textSerializers:a={}}=r||{};let o="";return t.nodesBetween(n,i,(l,u,d,h)=>{var m;l.isBlock&&u>n&&(o+=s);const g=a==null?void 0:a[l.type.name];if(g)return d&&(o+=g({node:l,pos:u,parent:d,index:h,range:e})),!1;l.isText&&(o+=(m=l==null?void 0:l.text)===null||m===void 0?void 0:m.slice(Math.max(n,u)-u,i-u))}),o}function ND(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,r])=>[e,r.spec.toText]))}const VU=gi.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Oi({key:new wa("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:r}=t,{doc:n,selection:i}=e,{ranges:s}=i,a=Math.min(...s.map(d=>d.$from.pos)),o=Math.max(...s.map(d=>d.$to.pos)),l=ND(r);return AD(n,{from:a,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),$U=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(e.dom.blur(),(r=window==null?void 0:window.getSelection())===null||r===void 0||r.removeAllRanges())}),!0),UU=(t=!1)=>({commands:e})=>e.setContent("",t),HU=()=>({state:t,tr:e,dispatch:r})=>{const{selection:n}=e,{ranges:i}=n;return r&&i.forEach(({$from:s,$to:a})=>{t.doc.nodesBetween(s.pos,a.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:d}=e,h=u.resolve(d.map(l)),m=u.resolve(d.map(l+o.nodeSize)),g=h.blockRange(m);if(!g)return;const v=Gu(g);if(o.type.isTextblock){const{defaultType:x}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(g.start,x)}(v||v===0)&&e.lift(g,v)})}),!0},WU=t=>e=>t(e),GU=()=>({state:t,dispatch:e})=>kD(t,e),qU=(t,e)=>({editor:r,tr:n})=>{const{state:i}=r,s=i.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);const a=n.mapping.map(e);return n.insert(a,s.content),n.setSelection(new Mt(n.doc.resolve(Math.max(a-1,0)))),!0},YU=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,n=r.$anchor.node();if(n.content.size>0)return!1;const i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===n.type){if(e){const o=i.before(s),l=i.after(s);t.delete(o,l).scrollIntoView()}return!0}return!1},KU=t=>({tr:e,state:r,dispatch:n})=>{const i=kn(t,r.schema),s=e.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===i){if(n){const l=s.before(a),u=s.after(a);e.delete(l,u).scrollIntoView()}return!0}return!1},XU=t=>({tr:e,dispatch:r})=>{const{from:n,to:i}=t;return r&&e.delete(n,i),!0},ZU=()=>({state:t,dispatch:e})=>sw(t,e),JU=()=>({commands:t})=>t.keyboardShortcut("Enter"),QU=()=>({state:t,dispatch:e})=>fU(t,e);function Jp(t,e,r={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>r.strict?e[i]===t[i]:fw(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function MD(t,e,r={}){return t.find(n=>n.type===e&&Jp(Object.fromEntries(Object.keys(r).map(i=>[i,n.attrs[i]])),r))}function sC(t,e,r={}){return!!MD(t,e,r)}function dw(t,e,r){var n;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(d=>d.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(d=>d.type===e)||(r=r||((n=i.node.marks[0])===null||n===void 0?void 0:n.attrs),!MD([...i.node.marks],e,r)))return;let a=i.index,o=t.start()+i.offset,l=a+1,u=o+i.node.nodeSize;for(;a>0&&sC([...t.parent.child(a-1).marks],e,r);)a-=1,o-=t.parent.child(a).nodeSize;for(;l<t.parent.childCount&&sC([...t.parent.child(l).marks],e,r);)u+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function ol(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const eH=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const s=ol(t,n.schema),{doc:a,selection:o}=r,{$from:l,from:u,to:d}=o;if(i){const h=dw(l,s,e);if(h&&h.from<=u&&h.to>=d){const m=Mt.create(a,h.from,h.to);r.setSelection(m)}}return!0},tH=t=>e=>{const r=typeof t=="function"?t(e):t;for(let n=0;n<r.length;n+=1)if(r[n](e))return!0;return!1};function DD(t){return t instanceof Mt}function jl(t=0,e=0,r=0){return Math.min(Math.max(t,e),r)}function OD(t,e=null){if(!e)return null;const r=Pt.atStart(t),n=Pt.atEnd(t);if(e==="start"||e===!0)return r;if(e==="end")return n;const i=r.from,s=n.to;return e==="all"?Mt.create(t,jl(0,i,s),jl(t.content.size,i,s)):Mt.create(t,jl(e,i,s),jl(e,i,s))}function rH(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function hw(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const nH=(t=null,e={})=>({editor:r,view:n,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const a=()=>{(hw()||rH())&&n.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!DD(r.state.selection))return a(),!0;const o=OD(i.doc,t)||r.state.selection,l=r.state.selection.eq(o);return s&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),a()),!0},iH=(t,e)=>r=>t.every((n,i)=>e(n,{...r,index:i})),sH=(t,e)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},t,e),FD=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&FD(n)}return t};function L0(t){const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return FD(r)}function Wd(t,e,r){if(t instanceof Ho||t instanceof Ie)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return Ie.fromArray(t.map(o=>e.nodeFromJSON(o)));const a=e.nodeFromJSON(t);return r.errorOnInvalidContent&&a.check(),a}catch(s){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Wd("",e,r)}if(i){if(r.errorOnInvalidContent){let a=!1,o="";const l=new mM({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(a=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?Wo.fromSchema(l).parseSlice(L0(t),r.parseOptions):Wo.fromSchema(l).parse(L0(t),r.parseOptions),r.errorOnInvalidContent&&a)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const s=Wo.fromSchema(e);return r.slice?s.parseSlice(L0(t),r.parseOptions).content:s.parse(L0(t),r.parseOptions)}return Wd("",e,r)}function aH(t,e,r){const n=t.steps.length-1;if(n<e)return;const i=t.steps[n];if(!(i instanceof xn||i instanceof yn))return;const s=t.mapping.maps[n];let a=0;s.forEach((o,l,u,d)=>{a===0&&(a=d)}),t.setSelection(Pt.near(t.doc.resolve(a),r))}const oH=t=>!("type"in t),lH=(t,e,r)=>({tr:n,dispatch:i,editor:s})=>{var a;if(i){r={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const l=w=>{s.emit("contentError",{editor:s,error:w,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Wd(e,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(w){l(w)}try{o=Wd(e,s.schema,{parseOptions:u,errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:s.options.enableContentCheck})}catch(w){return l(w),!1}let{from:d,to:h}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},m=!0,g=!0;if((oH(o)?o:[o]).forEach(w=>{w.check(),m=m?w.isText&&w.marks.length===0:!1,g=g?w.isBlock:!1}),d===h&&g){const{parent:w}=n.doc.resolve(d);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(d-=1,h+=1)}let x;if(m){if(Array.isArray(e))x=e.map(w=>w.text||"").join("");else if(e instanceof Ie){let w="";e.forEach(S=>{S.text&&(w+=S.text)}),x=w}else typeof e=="object"&&e&&e.text?x=e.text:x=e;n.insertText(x,d,h)}else x=o,n.replaceWith(d,h,x);r.updateSelection&&aH(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:x}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:x})}return!0},cH=()=>({state:t,dispatch:e})=>lU(t,e),uH=()=>({state:t,dispatch:e})=>cU(t,e),fH=()=>({state:t,dispatch:e})=>mD(t,e),dH=()=>({state:t,dispatch:e})=>yD(t,e),hH=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Em(t.doc,t.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},pH=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Em(t.doc,t.selection.$from.pos,1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},mH=()=>({state:t,dispatch:e})=>aU(t,e),gH=()=>({state:t,dispatch:e})=>oU(t,e);function ID(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function xH(t){const e=t.split(/-(?!$)/);let r=e[e.length-1];r==="Space"&&(r=" ");let n,i,s,a;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))hw()||ID()?a=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),a&&(r=`Meta-${r}`),s&&(r=`Shift-${r}`),r}const vH=t=>({editor:e,view:r,tr:n,dispatch:i})=>{const s=xH(t).split(/-(?!$)/),a=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:a==="Space"?" ":a,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,o))});return l==null||l.steps.forEach(u=>{const d=u.map(n.mapping);d&&i&&n.maybeStep(d)}),!0};function Gd(t,e,r={}){const{from:n,to:i,empty:s}=t.selection,a=e?kn(e,t.schema):null,o=[];t.doc.nodesBetween(n,i,(h,m)=>{if(h.isText)return;const g=Math.max(n,m),v=Math.min(i,m+h.nodeSize);o.push({node:h,from:g,to:v})});const l=i-n,u=o.filter(h=>a?a.name===h.node.type.name:!0).filter(h=>Jp(h.node.attrs,r,{strict:!1}));return s?!!u.length:u.reduce((h,m)=>h+m.to-m.from,0)>=l}const yH=(t,e={})=>({state:r,dispatch:n})=>{const i=kn(t,r.schema);return Gd(r,i,e)?uU(r,n):!1},wH=()=>({state:t,dispatch:e})=>SD(t,e),bH=t=>({state:e,dispatch:r})=>{const n=kn(t,e.schema);return kU(n)(e,r)},kH=()=>({state:t,dispatch:e})=>bD(t,e);function Lm(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function aC(t,e){const r=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,i)=>(r.includes(i)||(n[i]=t[i]),n),{})}const SH=(t,e)=>({tr:r,state:n,dispatch:i})=>{let s=null,a=null;const o=Lm(typeof t=="string"?t:t.name,n.schema);return o?(o==="node"&&(s=kn(t,n.schema)),o==="mark"&&(a=ol(t,n.schema)),i&&r.selection.ranges.forEach(l=>{n.doc.nodesBetween(l.$from.pos,l.$to.pos,(u,d)=>{s&&s===u.type&&r.setNodeMarkup(d,void 0,aC(u.attrs,e)),a&&u.marks.length&&u.marks.forEach(h=>{a===h.type&&r.addMark(d,d+u.nodeSize,a.create(aC(h.attrs,e)))})})}),!0):!1},_H=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),CH=()=>({tr:t,dispatch:e})=>{if(e){const r=new Wi(t.doc);t.setSelection(r)}return!0},EH=()=>({state:t,dispatch:e})=>xD(t,e),TH=()=>({state:t,dispatch:e})=>wD(t,e),AH=()=>({state:t,dispatch:e})=>pU(t,e),NH=()=>({state:t,dispatch:e})=>xU(t,e),MH=()=>({state:t,dispatch:e})=>gU(t,e);function N1(t,e,r={},n={}){return Wd(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}const DH=(t,e=!1,r={},n={})=>({editor:i,tr:s,dispatch:a,commands:o})=>{var l,u;const{doc:d}=s;if(r.preserveWhitespace!=="full"){const h=N1(t,i.schema,r,{errorOnInvalidContent:(l=n.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return a&&s.replaceWith(0,d.content.size,h).setMeta("preventUpdate",!e),!0}return a&&s.setMeta("preventUpdate",!e),o.insertContentAt({from:0,to:d.content.size},t,{parseOptions:r,errorOnInvalidContent:(u=n.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function RD(t,e){const r=ol(e,t.schema),{from:n,to:i,empty:s}=t.selection,a=[];s?(t.storedMarks&&a.push(...t.storedMarks),a.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,i,l=>{a.push(...l.marks)});const o=a.find(l=>l.type.name===r.name);return o?{...o.attrs}:{}}function OH(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function FH(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function pw(t){return e=>FH(e.$from,t)}function IH(t,e){const r={from:0,to:t.content.size};return AD(t,r,e)}function RH(t,e){const r=kn(e,t.schema),{from:n,to:i}=t.selection,s=[];t.doc.nodesBetween(n,i,o=>{s.push(o)});const a=s.reverse().find(o=>o.type.name===r.name);return a?{...a.attrs}:{}}function PH(t,e){const r=Lm(typeof e=="string"?e:e.name,t.schema);return r==="node"?RH(t,e):r==="mark"?RD(t,e):{}}function PD(t,e,r){const n=[];return t===e?r.resolve(t).marks().forEach(i=>{const s=r.resolve(t),a=dw(s,i.type);a&&n.push({mark:i,...a})}):r.nodesBetween(t,e,(i,s)=>{!i||(i==null?void 0:i.nodeSize)===void 0||n.push(...i.marks.map(a=>({from:s,to:s+i.nodeSize,mark:a})))}),n}function hp(t,e,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const i=t.find(s=>s.type===e&&s.name===n);return i?i.attribute.keepOnSplit:!1}))}function M1(t,e,r={}){const{empty:n,ranges:i}=t.selection,s=e?ol(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(h=>s?s.name===h.type.name:!0).find(h=>Jp(h.attrs,r,{strict:!1}));let a=0;const o=[];if(i.forEach(({$from:h,$to:m})=>{const g=h.pos,v=m.pos;t.doc.nodesBetween(g,v,(x,w)=>{if(!x.isText&&!x.marks.length)return;const S=Math.max(g,w),T=Math.min(v,w+x.nodeSize),_=T-S;a+=_,o.push(...x.marks.map(M=>({mark:M,from:S,to:T})))})}),a===0)return!1;const l=o.filter(h=>s?s.name===h.mark.type.name:!0).filter(h=>Jp(h.mark.attrs,r,{strict:!1})).reduce((h,m)=>h+m.to-m.from,0),u=o.filter(h=>s?h.mark.type!==s&&h.mark.type.excludes(s):!0).reduce((h,m)=>h+m.to-m.from,0);return(l>0?l+u:l)>=a}function LH(t,e,r={}){if(!e)return Gd(t,null,r)||M1(t,null,r);const n=Lm(e,t.schema);return n==="node"?Gd(t,e,r):n==="mark"?M1(t,e,r):!1}function oC(t,e){const{nodeExtensions:r}=Im(e),n=r.find(a=>a.name===t);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},s=jt(ct(n,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function mw(t,{checkChildren:e=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!==null&&n!==void 0?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(s=>{i!==!1&&(mw(s,{ignoreWhitespace:r,checkChildren:e})||(i=!1))}),i}return!1}function BH(t){return t instanceof mt}function jH(t,e,r){var n;const{selection:i}=e;let s=null;if(DD(i)&&(s=i.$cursor),s){const o=(n=t.storedMarks)!==null&&n!==void 0?n:s.marks();return!!r.isInSet(o)||!o.some(l=>l.type.excludes(r))}const{ranges:a}=i;return a.some(({$from:o,$to:l})=>{let u=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(o.pos,l.pos,(d,h,m)=>{if(u)return!1;if(d.isInline){const g=!m||m.type.allowsMarkType(r),v=!!r.isInSet(d.marks)||!d.marks.some(x=>x.type.excludes(r));u=g&&v}return!u}),u})}const zH=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const{selection:s}=r,{empty:a,ranges:o}=s,l=ol(t,n.schema);if(i)if(a){const u=RD(n,l);r.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{const d=u.$from.pos,h=u.$to.pos;n.doc.nodesBetween(d,h,(m,g)=>{const v=Math.max(g,d),x=Math.min(g+m.nodeSize,h);m.marks.find(S=>S.type===l)?m.marks.forEach(S=>{l===S.type&&r.addMark(v,x,l.create({...S.attrs,...e}))}):r.addMark(v,x,l.create(e))})});return jH(n,r,l)},VH=(t,e)=>({tr:r})=>(r.setMeta(t,e),!0),$H=(t,e={})=>({state:r,dispatch:n,chain:i})=>{const s=kn(t,r.schema);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:o})=>tC(s,{...a,...e})(r)?!0:o.clearNodes()).command(({state:o})=>tC(s,{...a,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},UH=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,i=jl(t,0,n.content.size),s=mt.create(n,i);e.setSelection(s)}return!0},HH=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,{from:i,to:s}=typeof t=="number"?{from:t,to:t}:t,a=Mt.atStart(n).from,o=Mt.atEnd(n).to,l=jl(i,a,o),u=jl(s,a,o),d=Mt.create(n,l,u);e.setSelection(d)}return!0},WH=t=>({state:e,dispatch:r})=>{const n=kn(t,e.schema);return CU(n)(e,r)};function lC(t,e){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const n=r.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(n)}}const GH=({keepMarks:t=!0}={})=>({tr:e,state:r,dispatch:n,editor:i})=>{const{selection:s,doc:a}=e,{$from:o,$to:l}=s,u=i.extensionManager.attributes,d=hp(u,o.node().type.name,o.node().attrs);if(s instanceof mt&&s.node.isBlock)return!o.parentOffset||!qa(a,o.pos)?!1:(n&&(t&&lC(r,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,m=o.depth===0?void 0:OH(o.node(-1).contentMatchAt(o.indexAfter(-1)));let g=h&&m?[{type:m,attrs:d}]:void 0,v=qa(e.doc,e.mapping.map(o.pos),1,g);if(!g&&!v&&qa(e.doc,e.mapping.map(o.pos),1,m?[{type:m}]:void 0)&&(v=!0,g=m?[{type:m,attrs:d}]:void 0),n){if(v&&(s instanceof Mt&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,g),m&&!h&&!o.parentOffset&&o.parent.type!==m)){const x=e.mapping.map(o.before()),w=e.doc.resolve(x);o.node(-1).canReplaceWith(w.index(),w.index()+1,m)&&e.setNodeMarkup(e.mapping.map(o.before()),m)}t&&lC(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return v},qH=(t,e={})=>({tr:r,state:n,dispatch:i,editor:s})=>{var a;const o=kn(t,n.schema),{$from:l,$to:u}=n.selection,d=n.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(u))return!1;const h=l.node(-1);if(h.type!==o)return!1;const m=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let S=Ie.empty;const T=l.index(-1)?1:l.index(-2)?2:3;for(let A=l.depth-T;A>=l.depth-3;A-=1)S=Ie.from(l.node(A).copy(S));const _=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,M={...hp(m,l.node().type.name,l.node().attrs),...e},D=((a=o.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(M))||void 0;S=S.append(Ie.from(o.createAndFill(null,D)||void 0));const O=l.before(l.depth-(T-1));r.replace(O,l.after(-_),new Qe(S,4-T,0));let E=-1;r.doc.nodesBetween(O,r.doc.content.size,(A,N)=>{if(E>-1)return!1;A.isTextblock&&A.content.size===0&&(E=N+1)}),E>-1&&r.setSelection(Mt.near(r.doc.resolve(E))),r.scrollIntoView()}return!0}const g=u.pos===l.end()?h.contentMatchAt(0).defaultType:null,v={...hp(m,h.type.name,h.attrs),...e},x={...hp(m,l.node().type.name,l.node().attrs),...e};r.delete(l.pos,u.pos);const w=g?[{type:o,attrs:v},{type:g,attrs:x}]:[{type:o,attrs:v}];if(!qa(r.doc,l.pos,2))return!1;if(i){const{selection:S,storedMarks:T}=n,{splittableMarks:_}=s.extensionManager,M=T||S.$to.parentOffset&&S.$from.marks();if(r.split(l.pos,2,w).scrollIntoView(),!M||!i)return!0;const D=M.filter(O=>_.includes(O.type.name));r.ensureMarks(D)}return!0},cv=(t,e)=>{const r=pw(a=>a.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&sl(t.doc,r.pos)&&t.join(r.pos),!0},uv=(t,e)=>{const r=pw(a=>a.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&sl(t.doc,n)&&t.join(n),!0},YH=(t,e,r,n={})=>({editor:i,tr:s,state:a,dispatch:o,chain:l,commands:u,can:d})=>{const{extensions:h,splittableMarks:m}=i.extensionManager,g=kn(t,a.schema),v=kn(e,a.schema),{selection:x,storedMarks:w}=a,{$from:S,$to:T}=x,_=S.blockRange(T),M=w||x.$to.parentOffset&&x.$from.marks();if(!_)return!1;const D=pw(O=>oC(O.type.name,h))(x);if(_.depth>=1&&D&&_.depth-D.depth<=1){if(D.node.type===g)return u.liftListItem(v);if(oC(D.node.type.name,h)&&g.validContent(D.node.content)&&o)return l().command(()=>(s.setNodeMarkup(D.pos,g),!0)).command(()=>cv(s,g)).command(()=>uv(s,g)).run()}return!r||!M||!o?l().command(()=>d().wrapInList(g,n)?!0:u.clearNodes()).wrapInList(g,n).command(()=>cv(s,g)).command(()=>uv(s,g)).run():l().command(()=>{const O=d().wrapInList(g,n),E=M.filter(A=>m.includes(A.type.name));return s.ensureMarks(E),O?!0:u.clearNodes()}).wrapInList(g,n).command(()=>cv(s,g)).command(()=>uv(s,g)).run()},KH=(t,e={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:s=!1}=r,a=ol(t,n.schema);return M1(n,a,e)?i.unsetMark(a,{extendEmptyMarkRange:s}):i.setMark(a,e)},XH=(t,e,r={})=>({state:n,commands:i})=>{const s=kn(t,n.schema),a=kn(e,n.schema),o=Gd(n,s,r);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(a,l):i.setNode(s,{...l,...r})},ZH=(t,e={})=>({state:r,commands:n})=>{const i=kn(t,r.schema);return Gd(r,i,e)?n.lift(i):n.wrapIn(i,e)},JH=()=>({state:t,dispatch:e})=>{const r=t.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const a=t.tr,o=s.transform;for(let l=o.steps.length-1;l>=0;l-=1)a.step(o.steps[l].invert(o.docs[l]));if(s.text){const l=a.doc.resolve(s.from).marks();a.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else a.delete(s.from,s.to)}return!0}}return!1},QH=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,{empty:n,ranges:i}=r;return n||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},eW=(t,e={})=>({tr:r,state:n,dispatch:i})=>{var s;const{extendEmptyMarkRange:a=!1}=e,{selection:o}=r,l=ol(t,n.schema),{$from:u,empty:d,ranges:h}=o;if(!i)return!0;if(d&&a){let{from:m,to:g}=o;const v=(s=u.marks().find(w=>w.type===l))===null||s===void 0?void 0:s.attrs,x=dw(u,l,v);x&&(m=x.from,g=x.to),r.removeMark(m,g,l)}else h.forEach(m=>{r.removeMark(m.$from.pos,m.$to.pos,l)});return r.removeStoredMark(l),!0},tW=(t,e={})=>({tr:r,state:n,dispatch:i})=>{let s=null,a=null;const o=Lm(typeof t=="string"?t:t.name,n.schema);return o?(o==="node"&&(s=kn(t,n.schema)),o==="mark"&&(a=ol(t,n.schema)),i&&r.selection.ranges.forEach(l=>{const u=l.$from.pos,d=l.$to.pos;let h,m,g,v;r.selection.empty?n.doc.nodesBetween(u,d,(x,w)=>{s&&s===x.type&&(g=Math.max(w,u),v=Math.min(w+x.nodeSize,d),h=w,m=x)}):n.doc.nodesBetween(u,d,(x,w)=>{w<u&&s&&s===x.type&&(g=Math.max(w,u),v=Math.min(w+x.nodeSize,d),h=w,m=x),w>=u&&w<=d&&(s&&s===x.type&&r.setNodeMarkup(w,void 0,{...x.attrs,...e}),a&&x.marks.length&&x.marks.forEach(S=>{if(a===S.type){const T=Math.max(w,u),_=Math.min(w+x.nodeSize,d);r.addMark(T,_,a.create({...S.attrs,...e}))}}))}),m&&(h!==void 0&&r.setNodeMarkup(h,void 0,{...m.attrs,...e}),a&&m.marks.length&&m.marks.forEach(x=>{a===x.type&&r.addMark(g,v,a.create({...x.attrs,...e}))}))}),!0):!1},rW=(t,e={})=>({state:r,dispatch:n})=>{const i=kn(t,r.schema);return vU(i,e)(r,n)},nW=(t,e={})=>({state:r,dispatch:n})=>{const i=kn(t,r.schema);return yU(i,e)(r,n)};var iW=Object.freeze({__proto__:null,blur:$U,clearContent:UU,clearNodes:HU,command:WU,createParagraphNear:GU,cut:qU,deleteCurrentNode:YU,deleteNode:KU,deleteRange:XU,deleteSelection:ZU,enter:JU,exitCode:QU,extendMarkRange:eH,first:tH,focus:nH,forEach:iH,insertContent:sH,insertContentAt:lH,joinBackward:fH,joinDown:uH,joinForward:dH,joinItemBackward:hH,joinItemForward:pH,joinTextblockBackward:mH,joinTextblockForward:gH,joinUp:cH,keyboardShortcut:vH,lift:yH,liftEmptyBlock:wH,liftListItem:bH,newlineInCode:kH,resetAttributes:SH,scrollIntoView:_H,selectAll:CH,selectNodeBackward:EH,selectNodeForward:TH,selectParentNode:AH,selectTextblockEnd:NH,selectTextblockStart:MH,setContent:DH,setMark:zH,setMeta:VH,setNode:$H,setNodeSelection:UH,setTextSelection:HH,sinkListItem:WH,splitBlock:GH,splitListItem:qH,toggleList:YH,toggleMark:KH,toggleNode:XH,toggleWrap:ZH,undoInputRule:JH,unsetAllMarks:QH,unsetMark:eW,updateAttributes:tW,wrapIn:rW,wrapInList:nW});const sW=gi.create({name:"commands",addCommands(){return{...iW}}}),aW=gi.create({name:"drop",addProseMirrorPlugins(){return[new Oi({key:new wa("tiptapDrop"),props:{handleDrop:(t,e,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:r,moved:n})}}})]}}),oW=gi.create({name:"editable",addProseMirrorPlugins(){return[new Oi({key:new wa("editable"),props:{editable:()=>this.editor.options.editable}})]}}),lW=new wa("focusEvents"),cW=gi.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Oi({key:lW,props:{handleDOMEvents:{focus:(e,r)=>{t.isFocused=!0;const n=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,r)=>{t.isFocused=!1;const n=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),uW=gi.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:a})=>[()=>a.undoInputRule(),()=>a.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:d,$anchor:h}=l,{pos:m,parent:g}=h,v=h.parent.isTextblock&&m>0?o.doc.resolve(m-1):h,x=v.parent.type.spec.isolating,w=h.pos-h.parentOffset,S=x&&v.parent.childCount===1?w===h.pos:Pt.atStart(u).from===m;return!d||!g.type.isTextblock||g.textContent.length||!S||S&&h.parent.type.name==="paragraph"?!1:a.clearNodes()}),()=>a.deleteSelection(),()=>a.joinBackward(),()=>a.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:a})=>[()=>a.deleteSelection(),()=>a.deleteCurrentNode(),()=>a.joinForward(),()=>a.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:a})=>[()=>a.newlineInCode(),()=>a.createParagraphNear(),()=>a.liftEmptyBlock(),()=>a.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},s={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return hw()||ID()?s:i},addProseMirrorPlugins(){return[new Oi({key:new wa("clearDocument"),appendTransaction:(t,e,r)=>{if(t.some(x=>x.getMeta("composition")))return;const n=t.some(x=>x.docChanged)&&!e.doc.eq(r.doc),i=t.some(x=>x.getMeta("preventClearDocument"));if(!n||i)return;const{empty:s,from:a,to:o}=e.selection,l=Pt.atStart(e.doc).from,u=Pt.atEnd(e.doc).to;if(s||!(a===l&&o===u)||!mw(r.doc))return;const m=r.tr,g=Om({state:r,transaction:m}),{commands:v}=new Fm({editor:this.editor,state:g});if(v.clearNodes(),!!m.steps.length)return m}})]}}),fW=gi.create({name:"paste",addProseMirrorPlugins(){return[new Oi({key:new wa("tiptapPaste"),props:{handlePaste:(t,e,r)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:r})}}})]}}),dW=gi.create({name:"tabindex",addProseMirrorPlugins(){return[new Oi({key:new wa("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Il{get name(){return this.node.type.name}constructor(e,r,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=r,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(e);return new Il(r,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Il(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Il(e,this.editor)}get children(){const e=[];return this.node.content.forEach((r,n)=>{const i=r.isBlock&&!r.isTextblock,s=r.isAtom&&!r.isText,a=this.pos+n+(s?0:1);if(a<0||a>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(a);if(!i&&o.depth<=this.depth)return;const l=new Il(o,this.editor,i,i?r:null);i&&(l.actualDepth=this.depth+1),e.push(new Il(o,this.editor,i,i?r:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,r={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(r).length>0){const s=i.node.attrs,a=Object.keys(r);for(let o=0;o<a.length;o+=1){const l=a[o];if(s[l]!==r[l])break}}else n=i;i=i.parent}return n}querySelector(e,r={}){return this.querySelectorAll(e,r,!0)[0]||null}querySelectorAll(e,r={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(r);return this.children.forEach(a=>{n&&i.length>0||(a.node.type.name===e&&s.every(l=>r[l]===a.node.attrs[l])&&i.push(a),!(n&&i.length>0)&&(i=i.concat(a.querySelectorAll(e,r,n))))}),i}setAttribute(e){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(r)}}const hW=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function pW(t,e,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class mW extends EU{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:n,moved:i})=>this.options.onDrop(r,n,i)),this.on("paste",({event:r,slice:n})=>this.options.onPaste(r,n)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=pW(hW,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,r=!0){this.setOptions({editable:e}),r&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,r){const n=TD(r)?r(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const r=this.state.plugins;let n=r;if([].concat(e).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;n=n.filter(o=>!o.key.startsWith(a))}),r.length===n.length)return;const i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}createExtensionManager(){var e,r;const i=[...this.options.enableCoreExtensions?[oW,VU.configure({blockSeparator:(r=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||r===void 0?void 0:r.blockSeparator}),sW,cW,uW,dW,aW,fW].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new hu(i,this)}createCommandManager(){this.commandManager=new Fm({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let r;try{r=N1(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(a){if(!(a instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(a.message))throw a;this.emit("contentError",{editor:this,error:a,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(o=>o.name!=="collaboration"),this.createExtensionManager()}}),r=N1(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=OD(r,this.options.autofocus);this.view=new dD(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:du.create({doc:r,selection:n||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const r=this.capturedTransaction;return this.capturedTransaction=null,r}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(a=>{var o;return(o=this.capturedTransaction)===null||o===void 0?void 0:o.step(a)});return}const r=this.state.apply(e),n=!this.state.selection.eq(r.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:r}),this.view.updateState(r),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return PH(this.state,e)}isActive(e,r){const n=typeof e=="string"?e:null,i=typeof e=="string"?r:e;return LH(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return uw(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:r=`

`,textSerializers:n={}}=e||{};return IH(this.state.doc,{blockSeparator:r,textSerializers:{...ND(this.schema),...n}})}get isEmpty(){return mw(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,r){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelector(e,r))||null}$nodes(e,r){var n;return((n=this.$doc)===null||n===void 0?void 0:n.querySelectorAll(e,r))||null}$pos(e){const r=this.state.doc.resolve(e);return new Il(r,this)}get $doc(){return this.$pos(0)}}function Ru(t){return new Rm({find:t.find,handler:({state:e,range:r,match:n})=>{const i=jt(t.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:s}=e,a=n[n.length-1],o=n[0];if(a){const l=o.search(/\S/),u=r.from+o.indexOf(a),d=u+a.length;if(PD(r.from,r.to,e.doc).filter(g=>g.mark.type.excluded.find(x=>x===t.type&&x!==g.mark.type)).filter(g=>g.to>u).length)return null;d<r.to&&s.delete(d,r.to),u>r.from&&s.delete(r.from+l,u);const m=r.from+l+a.length;s.addMark(r.from+l,m,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function gW(t){return new Rm({find:t.find,handler:({state:e,range:r,match:n})=>{const i=jt(t.getAttributes,void 0,n)||{},{tr:s}=e,a=r.from;let o=r.to;const l=t.type.create(i);if(n[1]){const u=n[0].lastIndexOf(n[1]);let d=a+u;d>o?d=o:o=d+n[1].length;const h=n[0][n[0].length-1];s.insertText(h,a+n[0].length-1),s.replaceWith(d,o,l)}else if(n[0]){const u=t.type.isInline?a:a-1;s.insert(u,t.type.create(i)).delete(s.mapping.map(a),s.mapping.map(o))}s.scrollIntoView()}})}function D1(t){return new Rm({find:t.find,handler:({state:e,range:r,match:n})=>{const i=e.doc.resolve(r.from),s=jt(t.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,s)}})}function qd(t){return new Rm({find:t.find,handler:({state:e,range:r,match:n,chain:i})=>{const s=jt(t.getAttributes,void 0,n)||{},a=e.tr.delete(r.from,r.to),l=a.doc.resolve(r.from).blockRange(),u=l&&Yy(l,t.type,s);if(!u)return null;if(a.wrap(l,u),t.keepMarks&&t.editor){const{selection:h,storedMarks:m}=e,{splittableMarks:g}=t.editor.extensionManager,v=m||h.$to.parentOffset&&h.$from.marks();if(v){const x=v.filter(w=>g.includes(w.type.name));a.ensureMarks(x)}}if(t.keepAttributes){const h=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(h,s).run()}const d=a.doc.resolve(r.from-1).nodeBefore;d&&d.type===t.type&&sl(a.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(n,d))&&a.join(r.from-1)}})}let zs=class O1{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=jt(ct(this,"addOptions",{name:this.name}))),this.storage=jt(ct(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new O1(e)}configure(e={}){const r=this.extend({...this.config,addOptions:()=>Pm(this.options,e)});return r.name=this.name,r.parent=this.parent,r}extend(e={}){const r=new O1(e);return r.parent=this,this.child=r,r.name=e.name?e.name:r.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${r.name}".`),r.options=jt(ct(r,"addOptions",{name:r.name})),r.storage=jt(ct(r,"addStorage",{name:r.name,options:r.options})),r}};function Pu(t){return new RU({find:t.find,handler:({state:e,range:r,match:n,pasteEvent:i})=>{const s=jt(t.getAttributes,void 0,n,i);if(s===!1||s===null)return null;const{tr:a}=e,o=n[n.length-1],l=n[0];let u=r.to;if(o){const d=l.search(/\S/),h=r.from+l.indexOf(o),m=h+o.length;if(PD(r.from,r.to,e.doc).filter(v=>v.mark.type.excluded.find(w=>w===t.type&&w!==v.mark.type)).filter(v=>v.to>h).length)return null;m<r.to&&a.delete(m,r.to),h>r.from&&a.delete(r.from+d,h),u=r.from+d+o.length,a.addMark(r.from+d,u,t.type.create(s||{})),a.removeStoredMark(t.type)}}})}function xW(t,e){const{selection:r}=t,{$from:n}=r;if(r instanceof mt){const s=n.index();return n.parent.canReplaceWith(s,s+1,e)}let i=n.depth;for(;i>=0;){const s=n.index(i);if(n.node(i).contentMatchAt(s).matchType(e))return!0;i-=1}return!1}function vW(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var LD={exports:{}},fv={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cC;function yW(){if(cC)return fv;cC=1;var t=xt;function e(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,s=t.useLayoutEffect,a=t.useDebugValue;function o(h,m){var g=m(),v=n({inst:{value:g,getSnapshot:m}}),x=v[0].inst,w=v[1];return s(function(){x.value=g,x.getSnapshot=m,l(x)&&w({inst:x})},[h,g,m]),i(function(){return l(x)&&w({inst:x}),h(function(){l(x)&&w({inst:x})})},[h]),a(g),g}function l(h){var m=h.getSnapshot;h=h.value;try{var g=m();return!r(h,g)}catch{return!0}}function u(h,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return fv.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:d,fv}LD.exports=yW();var gw=LD.exports;const wW=(...t)=>e=>{t.forEach(r=>{typeof r=="function"?r(e):r&&(r.current=e)})},bW=({contentComponent:t})=>{const e=gw.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return xt.createElement(xt.Fragment,null,Object.values(e))};function kW(){const t=new Set;let e={};return{subscribe(r){return t.add(r),()=>{t.delete(r)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(r,n){e={...e,[r]:AT.createPortal(n.reactElement,n.element,r)},t.forEach(i=>i())},removeRenderer(r){const n={...e};delete n[r],e=n,t.forEach(i=>i())}}}class SW extends xt.Component{constructor(e){var r;super(e),this.editorContentRef=xt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((r=e.editor)===null||r===void 0)&&r.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const r=this.editorContentRef.current;r.append(...e.options.element.childNodes),e.setOptions({element:r}),e.contentComponent=kW(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const r=document.createElement("div");r.append(...e.options.element.childNodes),e.setOptions({element:r})}render(){const{editor:e,innerRef:r,...n}=this.props;return xt.createElement(xt.Fragment,null,xt.createElement("div",{ref:wW(r,this.editorContentRef),...n}),(e==null?void 0:e.contentComponent)&&xt.createElement(bW,{contentComponent:e.contentComponent}))}}const _W=z.forwardRef((t,e)=>{const r=xt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return xt.createElement(SW,{key:r,innerRef:e,...t})}),CW=xt.memo(_W);var EW=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!t(e[i],r[i]))return!1;return!0}if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],r.get(i[0])))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(i of e.entries())if(!r.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(r)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(e[i]!==r[i])return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;i--!==0;){var a=s[i];if(!(a==="_owner"&&e.$$typeof)&&!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r},TW=vW(EW),BD={exports:{}},dv={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uC;function AW(){if(uC)return dv;uC=1;var t=xt,e=gw;function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,a=t.useEffect,o=t.useMemo,l=t.useDebugValue;return dv.useSyncExternalStoreWithSelector=function(u,d,h,m,g){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=o(function(){function S(O){if(!T){if(T=!0,_=O,O=m(O),g!==void 0&&x.hasValue){var E=x.value;if(g(E,O))return M=E}return M=O}if(E=M,n(_,O))return E;var A=m(O);return g!==void 0&&g(E,A)?E:(_=O,M=A)}var T=!1,_,M,D=h===void 0?null:h;return[function(){return S(d())},D===null?void 0:function(){return S(D())}]},[d,h,m,g]);var w=i(u,v[0],v[1]);return a(function(){x.hasValue=!0,x.value=w},[w]),l(w),w},dv}BD.exports=AW();var NW=BD.exports;const MW=typeof window<"u"?z.useLayoutEffect:z.useEffect;class DW{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const r=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},n=this.editor;return n.on("transaction",r),()=>{n.off("transaction",r)}}}}function OW(t){var e;const[r]=z.useState(()=>new DW(t.editor)),n=NW.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:TW);return MW(()=>r.watch(t.editor),[t.editor,r]),z.useDebugValue(n),n}const FW=!1,F1=typeof window>"u",IW=F1||!!(typeof window<"u"&&window.next);class xw{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?F1||IW?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)===null||s===void 0?void 0:s.call(i,...n)},onBlur:(...n)=>{var i,s;return(s=(i=this.options.current).onBlur)===null||s===void 0?void 0:s.call(i,...n)},onCreate:(...n)=>{var i,s;return(s=(i=this.options.current).onCreate)===null||s===void 0?void 0:s.call(i,...n)},onDestroy:(...n)=>{var i,s;return(s=(i=this.options.current).onDestroy)===null||s===void 0?void 0:s.call(i,...n)},onFocus:(...n)=>{var i,s;return(s=(i=this.options.current).onFocus)===null||s===void 0?void 0:s.call(i,...n)},onSelectionUpdate:(...n)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)===null||s===void 0?void 0:s.call(i,...n)},onTransaction:(...n)=>{var i,s;return(s=(i=this.options.current).onTransaction)===null||s===void 0?void 0:s.call(i,...n)},onUpdate:(...n)=>{var i,s;return(s=(i=this.options.current).onUpdate)===null||s===void 0?void 0:s.call(i,...n)},onContentError:(...n)=>{var i,s;return(s=(i=this.options.current).onContentError)===null||s===void 0?void 0:s.call(i,...n)},onDrop:(...n)=>{var i,s;return(s=(i=this.options.current).onDrop)===null||s===void 0?void 0:s.call(i,...n)},onPaste:(...n)=>{var i,s;return(s=(i=this.options.current).onPaste)===null||s===void 0?void 0:s.call(i,...n)}};return new mW(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,r){return Object.keys(e).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&e.extensions&&r.extensions?e.extensions.length!==r.extensions.length?!1:e.extensions.every((i,s)=>{var a;return i===((a=r.extensions)===null||a===void 0?void 0:a[s])}):e[n]===r[n])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?xw.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,i)=>n===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function RW(t={},e=[]){const r=z.useRef(t);r.current=t;const[n]=z.useState(()=>new xw(r)),i=gw.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return z.useDebugValue(i),z.useEffect(n.onRender(e)),OW({editor:i,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&s===0?0:s+1}),i}const PW=z.createContext({editor:null});PW.Consumer;const LW=z.createContext({onDragStart:void 0}),BW=()=>z.useContext(LW);xt.forwardRef((t,e)=>{const{onDragStart:r}=BW(),n=t.as||"div";return xt.createElement(n,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})});const jW=/^\s*>\s$/,zW=zs.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[qd({find:jW,type:this.type})]}}),VW=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,$W=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,UW=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,HW=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,WW=tl.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ru({find:VW,type:this.type}),Ru({find:UW,type:this.type})]},addPasteRules(){return[Pu({find:$W,type:this.type}),Pu({find:HW,type:this.type})]}}),GW="listItem",fC="textStyle",dC=/^\s*([-+*])\s$/,qW=zs.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(GW,this.editor.getAttributes(fC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=qd({find:dC,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=qd({find:dC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(fC),editor:this.editor})),[t]}}),YW=/(^|[^`])`([^`]+)`(?!`)/,KW=/(^|[^`])`([^`]+)`(?!`)/g,XW=tl.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ru({find:YW,type:this.type})]},addPasteRules(){return[Pu({find:KW,type:this.type})]}}),ZW=/^```([a-z]+)?[\s\n]$/,JW=/^~~~([a-z]+)?[\s\n]$/,QW=zs.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:r}=this.options,s=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(a=>a.startsWith(r)).map(a=>a.replace(r,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",mi(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:r}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const s=n.parentOffset===n.parent.nodeSize-2,a=n.parent.textContent.endsWith(`

`);return!s||!a?!1:t.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:r,doc:n}=e,{$from:i,empty:s}=r;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0?!1:n.nodeAt(o)?t.commands.command(({tr:u})=>(u.setSelection(Pt.near(n.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[D1({find:ZW,type:this.type,getAttributes:t=>({language:t[1]})}),D1({find:JW,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Oi({key:new wa("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const r=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,s=i==null?void 0:i.mode;if(!r||!s)return!1;const{tr:a,schema:o}=t.state,l=o.text(r.replace(/\r\n?/g,`
`));return a.replaceSelectionWith(this.type.create({language:s},l)),a.selection.$from.parent.type!==this.type&&a.setSelection(Mt.near(a.doc.resolve(Math.max(0,a.selection.from-2)))),a.setMeta("paste",!0),t.dispatch(a),!0}}})]}}),eG=zs.create({name:"doc",topNode:!0,content:"block+"});function tG(t={}){return new Oi({view(e){return new rG(e,t)}})}class rG{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=a=>{this[i](a)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,s=i.getBoundingClientRect(),a=s.width/i.offsetWidth,o=s.height/i.offsetHeight;if(r){let h=e.nodeBefore,m=e.nodeAfter;if(h||m){let g=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(g){let v=g.getBoundingClientRect(),x=h?v.bottom:v.top;h&&m&&(x=(x+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*o;n={left:v.left,right:v.right,top:x-w,bottom:x+w}}}}if(!n){let h=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*a;n={left:h.left-m,right:h.left+m,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,d;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,d=-pageYOffset;else{let h=l.getBoundingClientRect(),m=h.width/l.offsetWidth,g=h.height/l.offsetHeight;u=h.left-l.scrollLeft*m,d=h.top-l.scrollTop*g}this.element.style.left=(n.left-u)/a+"px",this.element.style.top=(n.top-d)/o+"px",this.element.style.width=(n.right-n.left)/a+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!s){let a=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=EM(this.editorView.state.doc,a,this.editorView.dragging.slice);o!=null&&(a=o)}this.setCursor(a),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const nG=gi.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[tG(this.options)]}});class Ir extends Pt{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return Ir.valid(n)?new Ir(n):Pt.near(n)}content(){return Qe.empty}eq(e){return e instanceof Ir&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ir(e.resolve(r.pos))}getBookmark(){return new vw(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!iG(e)||!sG(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&Ir.valid(e))return e;let i=e.pos,s=null;for(let a=e.depth;;a--){let o=e.node(a);if(r>0?e.indexAfter(a)<o.childCount:e.index(a)>0){s=o.child(r>0?e.indexAfter(a):e.index(a)-1);break}else if(a==0)return null;i+=r;let l=e.doc.resolve(i);if(Ir.valid(l))return l}for(;;){let a=r>0?s.firstChild:s.lastChild;if(!a){if(s.isAtom&&!s.isText&&!mt.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*r),n=!1;continue e}break}s=a,i+=r;let o=e.doc.resolve(i);if(Ir.valid(o))return o}return null}}}Ir.prototype.visible=!1;Ir.findFrom=Ir.findGapCursorFrom;Pt.jsonID("gapcursor",Ir);class vw{constructor(e){this.pos=e}map(e){return new vw(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return Ir.valid(r)?new Ir(r):Pt.near(r)}}function iG(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function sG(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function aG(){return new Oi({props:{decorations:uG,createSelectionBetween(t,e,r){return e.pos==r.pos&&Ir.valid(r)?new Ir(r):null},handleClick:lG,handleKeyDown:oG,handleDOMEvents:{beforeinput:cG}}})}const oG=hD({ArrowLeft:B0("horiz",-1),ArrowRight:B0("horiz",1),ArrowUp:B0("vert",-1),ArrowDown:B0("vert",1)});function B0(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,s){let a=n.selection,o=e>0?a.$to:a.$from,l=a.empty;if(a instanceof Mt){if(!s.endOfTextblock(r)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}let u=Ir.findGapCursorFrom(o,e,l);return u?(i&&i(n.tr.setSelection(new Ir(u))),!0):!1}}function lG(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!Ir.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&mt.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Ir(n))),!0)}function cG(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Ir))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=Ie.empty;for(let a=n.length-1;a>=0;a--)i=Ie.from(n[a].createAndFill(null,i));let s=t.state.tr.replace(r.pos,r.pos,new Qe(i,0,0));return s.setSelection(Mt.near(s.doc.resolve(r.pos+1))),t.dispatch(s),!1}function uG(t){if(!(t.selection instanceof Ir))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",on.create(t.doc,[us.widget(t.selection.head,e,{key:"gapcursor"})])}const fG=gi.create({name:"gapCursor",addProseMirrorPlugins(){return[aG()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=jt(ct(t,"allowGapCursor",r)))!==null&&e!==void 0?e:null}}}),dG=zs.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",mi(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:a}=this.options,{splittableMarks:o}=n.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:d})=>{if(d&&l&&a){const h=l.filter(m=>o.includes(m.type.name));u.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),hG=zs.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,mi(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>D1({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Qp=200,wn=function(){};wn.prototype.append=function(e){return e.length?(e=wn.from(e),!this.length&&e||e.length<Qp&&this.leafAppend(e)||this.length<Qp&&e.leafPrepend(this)||this.appendInner(e)):this};wn.prototype.prepend=function(e){return e.length?wn.from(e).append(this):this};wn.prototype.appendInner=function(e){return new pG(this,e)};wn.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?wn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};wn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};wn.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};wn.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(s,a){return i.push(e(s,a))},r,n),i};wn.from=function(e){return e instanceof wn?e:e&&e.length?new jD(e):wn.empty};var jD=(function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,a,o){for(var l=s;l<a;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,a,o){for(var l=s-1;l>=a;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Qp)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Qp)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e})(wn);wn.empty=new jD([]);var pG=(function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,s,a){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(s,o),a)===!1||s>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,s)-o,a+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,s,a){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(s,o)-o,a+o)===!1||s<o&&this.left.forEachInvertedInner(n,Math.min(i,o),s,a)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(n,i):n>=s?this.right.slice(n-s,i-s):this.left.slice(n,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e})(wn);const mG=500;class Fs{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,s;r&&(i=this.remapping(n,this.items.length),s=i.maps.length);let a=e.tr,o,l,u=[],d=[];return this.items.forEach((h,m)=>{if(!h.step){i||(i=this.remapping(n,m+1),s=i.maps.length),s--,d.push(h);return}if(i){d.push(new sa(h.map));let g=h.step.map(i.slice(s)),v;g&&a.maybeStep(g).doc&&(v=a.mapping.maps[a.mapping.maps.length-1],u.push(new sa(v,void 0,void 0,u.length+d.length))),s--,v&&i.appendMap(v,s)}else a.maybeStep(h.step);if(h.selection)return o=i?h.selection.map(i.slice(s)):h.selection,l=new Fs(this.items.slice(0,n).append(d.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:a,selection:o}}addTransform(e,r,n,i){let s=[],a=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let d=0;d<e.steps.length;d++){let h=e.steps[d].invert(e.docs[d]),m=new sa(e.mapping.maps[d],h,r),g;(g=l&&l.merge(m))&&(m=g,d?s.pop():o=o.slice(0,o.length-1)),s.push(m),r&&(a++,r=void 0),i||(l=m)}let u=a-n.depth;return u>xG&&(o=gG(o,u),a-=u),new Fs(o.append(s),a)}remapping(e,r){let n=new zd;return this.items.forEach((i,s)=>{let a=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,a)},e,r),n}addMaps(e){return this.eventCount==0?this:new Fs(this.items.append(e.map(r=>new sa(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),s=e.mapping,a=e.steps.length,o=this.eventCount;this.items.forEach(m=>{m.selection&&o--},i);let l=r;this.items.forEach(m=>{let g=s.getMirror(--l);if(g==null)return;a=Math.min(a,g);let v=s.maps[g];if(m.step){let x=e.steps[g].invert(e.docs[g]),w=m.selection&&m.selection.map(s.slice(l+1,g));w&&o++,n.push(new sa(v,x,w))}else n.push(new sa(v))},i);let u=[];for(let m=r;m<a;m++)u.push(new sa(s.maps[m]));let d=this.items.slice(0,i).append(u).append(n),h=new Fs(d,o);return h.emptyItemCount()>mG&&(h=h.compress(this.items.length-n.length)),h}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],s=0;return this.items.forEach((a,o)=>{if(o>=e)i.push(a),a.selection&&s++;else if(a.step){let l=a.step.map(r.slice(n)),u=l&&l.getMap();if(n--,u&&r.appendMap(u,n),l){let d=a.selection&&a.selection.map(r.slice(n));d&&s++;let h=new sa(u.invert(),l,d),m,g=i.length-1;(m=i.length&&i[g].merge(h))?i[g]=m:i.push(h)}}else a.map&&n--},this.items.length,0),new Fs(wn.from(i.reverse()),s)}}Fs.empty=new Fs(wn.empty,0);function gG(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}class sa{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new sa(r.getMap().invert(),r,this.selection)}}}class To{constructor(e,r,n,i,s){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=s}}const xG=20;function vG(t,e,r,n){let i=r.getMeta(Yl),s;if(i)return i.historyState;r.getMeta(bG)&&(t=new To(t.done,t.undone,null,0,-1));let a=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(a&&a.getMeta(Yl))return a.getMeta(Yl).redo?new To(t.done.addTransform(r,void 0,n,pp(e)),t.undone,hC(r.mapping.maps),t.prevTime,t.prevComposition):new To(t.done,t.undone.addTransform(r,void 0,n,pp(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(a&&a.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),l=t.prevTime==0||!a&&t.prevComposition!=o&&(t.prevTime<(r.time||0)-n.newGroupDelay||!yG(r,t.prevRanges)),u=a?hv(t.prevRanges,r.mapping):hC(r.mapping.maps);return new To(t.done.addTransform(r,l?e.selection.getBookmark():void 0,n,pp(e)),Fs.empty,u,r.time,o??t.prevComposition)}else return(s=r.getMeta("rebased"))?new To(t.done.rebased(r,s),t.undone.rebased(r,s),hv(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new To(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),hv(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function yG(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let s=0;s<e.length;s+=2)n<=e[s+1]&&i>=e[s]&&(r=!0)}),r}function hC(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,s,a)=>e.push(s,a));return e}function hv(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),s=e.map(t[n+1],-1);i<=s&&r.push(i,s)}return r}function wG(t,e,r){let n=pp(e),i=Yl.get(e).spec.config,s=(r?t.undone:t.done).popEvent(e,n);if(!s)return null;let a=s.selection.resolve(s.transform.doc),o=(r?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,n),l=new To(r?o:s.remaining,r?s.remaining:o,null,0,-1);return s.transform.setSelection(a).setMeta(Yl,{redo:r,historyState:l})}let pv=!1,pC=null;function pp(t){let e=t.plugins;if(pC!=e){pv=!1,pC=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){pv=!0;break}}return pv}const Yl=new wa("history"),bG=new wa("closeHistory");function kG(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Oi({key:Yl,state:{init(){return new To(Fs.empty,Fs.empty,null,0,-1)},apply(e,r,n){return vG(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?VD:n=="historyRedo"?$D:null;return i?(r.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function zD(t,e){return(r,n)=>{let i=Yl.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let s=wG(i,r,t);s&&n(e?s.scrollIntoView():s)}return!0}}const VD=zD(!1,!0),$D=zD(!0,!0),SG=gi.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>VD(t,e),redo:()=>({state:t,dispatch:e})=>$D(t,e)}},addProseMirrorPlugins(){return[kG(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),_G=zs.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",mi(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!xW(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$from:n,$to:i}=r,s=t();return n.parentOffset===0?s.insertContentAt({from:Math.max(n.pos-1,0),to:i.pos},{type:this.name}):BH(r)?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:a,dispatch:o})=>{var l;if(o){const{$to:u}=a.selection,d=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?a.setSelection(Mt.create(a.doc,u.pos+1)):u.nodeAfter.isBlock?a.setSelection(mt.create(a.doc,u.pos)):a.setSelection(Mt.create(a.doc,u.pos));else{const h=(l=u.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();h&&(a.insert(d,h),a.setSelection(Mt.create(a.doc,d+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[gW({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),CG=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,EG=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,TG=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,AG=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,NG=tl.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ru({find:CG,type:this.type}),Ru({find:TG,type:this.type})]},addPasteRules(){return[Pu({find:EG,type:this.type}),Pu({find:AG,type:this.type})]}}),MG=zs.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",mi(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),DG="listItem",mC="textStyle",gC=/^(\d+)\.\s$/,OG=zs.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",mi(this.options.HTMLAttributes,r),0]:["ol",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(DG,this.editor.getAttributes(mC)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=qd({find:gC,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=qd({find:gC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(mC)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),FG=zs.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),IG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,RG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,PG=tl.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",mi(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ru({find:IG,type:this.type})]},addPasteRules(){return[Pu({find:RG,type:this.type})]}}),LG=zs.create({name:"text",group:"inline"}),BG=gi.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(WW.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(zW.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(qW.configure(this.options.bulletList)),this.options.code!==!1&&t.push(XW.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(QW.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(eG.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(nG.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(fG.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(dG.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(hG.configure(this.options.heading)),this.options.history!==!1&&t.push(SG.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(_G.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(NG.configure(this.options.italic)),this.options.listItem!==!1&&t.push(MG.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(OG.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(FG.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(PG.configure(this.options.strike)),this.options.text!==!1&&t.push(LG.configure(this.options.text)),t}}),jG=({value:t,onChange:e,disabled:r=!1,placeholder:n,id:i,onBlur:s,ariaDescribedBy:a,ariaInvalid:o,ariaLabelledBy:l})=>{const u=RW({extensions:[BG],content:t||"<p></p>",editable:!r,onUpdate:({editor:h})=>{e(h.getHTML())}});if(z.useEffect(()=>{!u||u.getHTML()===t||u.commands.setContent(t||"<p></p>",!1)},[u,t]),z.useEffect(()=>{u&&u.setEditable(!r)},[u,r]),z.useEffect(()=>{if(!u||!l)return;const h=document.getElementById(l);if(!h)return;const m=()=>{u.commands.focus()},g=x=>{x.preventDefault(),m()},v=x=>{(x.key===" "||x.key==="Enter")&&(x.preventDefault(),m())};return h.addEventListener("click",g),h.addEventListener("keydown",v),()=>{h.removeEventListener("click",g),h.removeEventListener("keydown",v)}},[u,l]),!u)return null;const d="px-2 py-1 border border-gray-200 rounded-md text-sm text-gray-600 transition hover:text-gray-900 hover:border-gray-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 disabled:opacity-50";return b.jsxs("div",{className:"space-y-2",id:i?`${i}-wrapper`:void 0,children:[b.jsxs("div",{className:"flex gap-1",role:"toolbar","aria-label":" ",children:[b.jsx("button",{type:"button",className:d,onClick:()=>u.chain().focus().toggleBold().run(),"aria-label":"","aria-pressed":u.isActive("bold"),disabled:r,children:"B"}),b.jsx("button",{type:"button",className:d,onClick:()=>u.chain().focus().toggleItalic().run(),"aria-label":"","aria-pressed":u.isActive("italic"),disabled:r,children:"I"}),b.jsx("button",{type:"button",className:d,onClick:()=>u.chain().focus().toggleBulletList().run(),"aria-label":" ","aria-pressed":u.isActive("bulletList"),disabled:r,children:""})]}),b.jsxs("div",{className:`border rounded-lg text-sm ${r?"bg-gray-50 text-gray-400":"focus-within:ring-2 focus-within:ring-blue-500"}`,children:[!r&&!u.state.doc.textContent&&n?b.jsx("p",{className:"px-3 py-2 text-gray-400 select-none","aria-hidden":"true",children:n}):null,b.jsx(CW,{editor:u,className:"prose prose-sm max-w-none px-3 py-2 outline-none",id:i,"aria-describedby":a,"aria-invalid":o||void 0,"aria-labelledby":l,role:"textbox","aria-multiline":"true",onBlur:s})]})]})},zG=[{value:"active",label:""},{value:"probation",label:""},{value:"vacation",label:" "},{value:"inactive",label:""},{value:"terminated",label:""}],VG=[{name:"personalInfo.lastName",label:"",required:!0,placeholder:""},{name:"personalInfo.firstName",label:"",required:!0,placeholder:""},{name:"personalInfo.middleName",label:"",placeholder:""},{name:"credentials.wfmLogin",label:" WFM",required:!0,placeholder:" "},{name:"credentials.externalLogins",label:" ",required:!0,placeholder:" 1,  2",hint:"  "},{name:"credentials.password",label:"",placeholder:"    "},{name:"orgPlacement.orgUnit",label:" ",required:!0},{name:"orgPlacement.office",label:"",required:!0},{name:"workInfo.position",label:"",required:!0},{name:"orgPlacement.timeZone",label:" ",required:!0},{name:"orgPlacement.hourNorm",label:" ",required:!0,type:"number"}],$G=[{name:"personalInfo.email",label:"Email",required:!0,type:"email"},{name:"personalInfo.phone",label:"",required:!0,type:"tel"},{name:"personalInfo.address",label:"",colSpan:"full"},{name:"personalInfo.dateOfBirth",label:" ",type:"date"},{name:"workInfo.hireDate",label:" ",type:"date"},{name:"orgPlacement.workScheme",label:" "}],UG=[{name:"preferences.preferredShifts",label:" ",hint:"  "},{name:"preferences.schemePreferences",label:" ",hint:"  ,   "},{name:"additional.personnelNumber",label:" "},{name:"additional.actualAddress",label:" ",type:"textarea",colSpan:"full"}],HG={name:"additional.tasks",label:" ",type:"textarea",hint:"     (  )",colSpan:"full",editor:"rich-text"},WG=t=>`employee-${t.replace(/\./g,"-")}`,GG=(t,e)=>e.split(".").reduce((r,n)=>{if(!r&&typeof t=="object"&&t!==null)return t[n];if(r&&typeof r=="object")return r[n]},void 0),qG=({employee:t,isOpen:e,onClose:r,onSave:n,mode:i="edit",isLoading:s=!1,onDismiss:a,onRestore:o})=>{var ue,Se,ze;const[l,u]=z.useState(null),[d,h]=z.useState(!1),[m,g]=z.useState(i==="create"),{register:v,handleSubmit:x,reset:w,watch:S,setValue:T,trigger:_,control:M,formState:{errors:D,isSubmitting:O,isValid:E}}=ET({resolver:v7,defaultValues:g7(),mode:"onChange",reValidateMode:"onChange"});z.useEffect(()=>{t&&e&&(w(m7(t),{keepErrors:!1,keepTouched:!1,keepIsDirty:!1}),_(),h(!1),u(null))},[t,e,w]),z.useEffect(()=>{g(i==="create")},[i,t==null?void 0:t.id]),z.useEffect(()=>{e||(u(null),h(!1))},[e]);const A=S("tags")??"",N=z.useMemo(()=>A.split(",").map(j=>j.trim()).filter(Boolean),[A]),P=z.useMemo(()=>t!=null&&t.tasks?t.tasks.map(j=>({...j,createdAt:j.createdAt instanceof Date?j.createdAt:new Date(j.createdAt)})).sort((j,tt)=>tt.createdAt.getTime()-j.createdAt.getTime()):[],[t]),B=z.useMemo(()=>t?t.skills.map(j=>j.name).join(", "):"",[t]),I=z.useMemo(()=>t?t.reserveSkills.map(j=>j.name).join(", "):"",[t]),ee=z.useMemo(()=>{if(!t)return[];const j=Le=>Le?Le instanceof Date?Le:new Date(Le):null,tt=(t.orgPlacement.workSchemeHistory??[]).map(Le=>({id:Le.id??`history-${Le.name}`,name:Le.name,effectiveFrom:j(Le.effectiveFrom),effectiveTo:j(Le.effectiveTo),isCurrent:!1}));return[...t.orgPlacement.workScheme?[{id:t.orgPlacement.workScheme.id??"current-scheme",name:t.orgPlacement.workScheme.name,effectiveFrom:j(t.orgPlacement.workScheme.effectiveFrom),effectiveTo:null,isCurrent:!0}]:[],...tt].sort((Le,Te)=>{const at=Le.effectiveFrom?Le.effectiveFrom.getTime():0;return(Te.effectiveFrom?Te.effectiveFrom.getTime():0)-at})},[t]),oe=s||d||O||!E;if(!e||!t)return null;const re=i==="create",se=[((ue=S("personalInfo.lastName"))==null?void 0:ue.trim())||t.personalInfo.lastName,((Se=S("personalInfo.firstName"))==null?void 0:Se.trim())||t.personalInfo.firstName].filter(Boolean).join(" ")||" ",xe=((ze=S("credentials.wfmLogin"))==null?void 0:ze.trim())||t.credentials.wfmLogin||"",H=re?"   ":"   ",ve=()=>{const j=S("credentials.wfmLogin");if(!(j!=null&&j.trim())){u("  WFM,  .");return}g(!1),u(null)},W=async j=>{if(t){h(!0);try{const tt=x7(j,t);await n(tt),T("additional.tasks","<p></p>",{shouldDirty:!1,shouldTouch:!1}),T("credentials.password",""),u(null)}catch(tt){console.error("   ",tt),u("   .  .")}finally{h(!1)}}},F=j=>{const tt=GG(D,j.name),Ne=WG(j.name),{id:qe,labelId:Le,...Te}=yu({controlId:Ne,hasError:!!tt,errorId:tt?`${Ne}-error`:void 0,hintId:j.hint?`${Ne}-hint`:void 0}),at=Te["aria-describedby"],gt=Te["aria-invalid"],J=`w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 ${tt?"border-red-400 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`;return b.jsx("div",{className:j.colSpan==="full"?"sm:col-span-2":"",children:b.jsx(vu,{label:j.label,required:j.required,fieldId:Ne,error:tt,hint:j.hint,children:j.editor==="rich-text"?b.jsx(cI,{name:j.name,control:M,render:({field:le})=>b.jsx(jG,{value:le.value??"",onChange:be=>le.onChange(be),onBlur:le.onBlur,disabled:s,placeholder:j.placeholder,id:qe,ariaDescribedBy:at,ariaInvalid:gt,ariaLabelledBy:Le})}):j.type==="textarea"?b.jsx("textarea",{id:qe,className:`${J} min-h-[92px]`,placeholder:j.placeholder,...v(j.name),...Te}):b.jsx("input",{id:qe,type:j.type??"text",placeholder:j.placeholder,min:j.type==="number"?1:void 0,className:J,...v(j.name),...Te})})},j.name)},{id:X,labelId:Z,...q}=yu({controlId:"employee-status",hasError:!!D.status,errorId:D.status?"employee-status-error":void 0}),{id:ce,labelId:Ce,...pe}=yu({controlId:"employee-tags",hasError:!!D.tags,errorId:D.tags?"employee-tags-error":void 0});return b.jsxs(ec,{open:e,onOpenChange:j=>{!j&&!s&&!d&&r()},variant:"sheet",title:se,description:H,titleHidden:!0,descriptionHidden:!0,testId:"employee-edit-drawer",contentClassName:"relative ml-auto flex h-full w-full max-w-2xl flex-col",showCloseButton:!1,preventClose:s||d,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:se})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:H})}),b.jsxs("div",{className:"flex items-start justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{className:"space-y-1",children:[b.jsx("p",{className:"text-xs uppercase text-gray-500",children:re?"  ":"  "}),b.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:se}),b.jsxs("p",{className:"text-sm text-gray-500",children:[" WFM: ",xe]})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[!re&&t.status!=="terminated"&&b.jsx("button",{type:"button",onClick:()=>{s||a==null||a(t)},className:"px-3 py-1.5 text-xs font-medium rounded-lg border border-red-200 text-red-600 hover:bg-red-50 transition-colors disabled:opacity-60",disabled:s,children:""}),!re&&t.status==="terminated"&&b.jsx("button",{type:"button",onClick:()=>{s||o==null||o(t)},className:"px-3 py-1.5 text-xs font-medium rounded-lg border border-green-200 text-green-700 hover:bg-green-50 transition-colors disabled:opacity-60",disabled:s,children:""}),b.jsx("button",{type:"button",onClick:()=>{!s&&!d&&r()},className:"text-gray-400 hover:text-gray-600","aria-label":"","data-testid":"drawer-close-button",children:""})]})]}),m?b.jsxs("div",{className:"flex-1 overflow-y-auto py-5 space-y-6",children:[b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:" "}),b.jsxs("div",{className:"space-y-4",children:[F({name:"credentials.wfmLogin",label:" WFM",required:!0,placeholder:" "}),F({name:"credentials.password",label:"",placeholder:"  "})]})]}),b.jsxs("div",{className:"flex items-center justify-end gap-3",children:[b.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:""}),b.jsx("button",{type:"button",onClick:ve,className:"px-5 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:""})]})]}):b.jsxs("form",{onSubmit:x(W),className:"flex-1 overflow-y-auto",children:[b.jsxs("div",{className:"py-5 space-y-6",children:[b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:" "}),b.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[VG.map(F),b.jsx("div",{className:"sm:col-span-2",children:b.jsx(vu,{label:"",fieldId:X,error:D.status,children:b.jsx("select",{id:X,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",...v("status"),...q,children:zG.map(j=>b.jsx("option",{value:j.value,children:j.label},j.value))})})})]})]}),b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:" "}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:$G.map(F)})]}),b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"  "}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:UG.map(F)})]}),b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"  "}),b.jsxs("div",{className:"space-y-4",children:[b.jsx(vu,{label:"",fieldId:ce,hint:"   ( 4  )",error:D.tags,children:b.jsx("textarea",{id:ce,className:`w-full min-h-[72px] px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 ${D.tags?"border-red-400 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:"VIP, ",...v("tags"),...pe})}),b.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700",children:N.length>0?b.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(j=>b.jsx("span",{className:"px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-xs font-medium border border-blue-100",children:j},j))}):b.jsx("span",{className:"text-xs text-gray-400",children:"      "})}),b.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[b.jsxs("div",{className:"sm:col-span-2",children:[b.jsx("label",{className:"block text-xs uppercase font-medium text-gray-500 mb-1",children:""}),b.jsx("div",{className:"px-3 py-2 border border-gray-200 rounded-lg text-sm text-gray-700 bg-gray-50","data-testid":"drawer-skills-summary",children:B||"  "})]}),b.jsxs("div",{className:"sm:col-span-2",children:[b.jsx("label",{className:"block text-xs uppercase font-medium text-gray-500 mb-1",children:" "}),b.jsx("div",{className:"px-3 py-2 border border-gray-200 rounded-lg text-sm text-gray-700 bg-gray-50","data-testid":"drawer-reserve-skills-summary",children:I||"   "})]})]}),F(HG),b.jsxs("div",{className:"space-y-2",children:[b.jsx("h4",{className:"text-xs uppercase font-medium text-gray-500",children:" "}),b.jsx("div",{className:"max-h-56 overflow-y-auto border border-gray-200 rounded-lg divide-y divide-gray-100",children:P.length===0?b.jsx("p",{className:"p-3 text-sm text-gray-500",children:"   ."}):P.map(j=>b.jsxs("div",{className:"px-3 py-2 text-sm text-gray-700 flex flex-col gap-1",children:[b.jsx("span",{children:j.message}),b.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[b.jsx("span",{children:j.createdAt.toLocaleString("ru-RU",{dateStyle:"short",timeStyle:"short"})}),b.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-gray-100 text-gray-600",children:[" ",j.source==="manual"?"":j.source==="bulk-edit"?" ":""]})]})]},j.id))})]})]})]}),b.jsxs("section",{children:[b.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"  "}),b.jsx("div",{className:"space-y-2",children:ee.length===0?b.jsx("p",{className:"text-sm text-gray-500",children:"   ."}):ee.map(j=>b.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 px-3 py-2 text-sm text-gray-700",children:[b.jsx("span",{className:"font-medium",children:j.name}),b.jsxs("span",{className:"text-xs text-gray-500",children:[j.isCurrent?"":"",!j.isCurrent&&j.effectiveFrom?j.effectiveFrom.toLocaleDateString("ru-RU"):"",j.effectiveTo?`  ${j.effectiveTo.toLocaleDateString("ru-RU")}`:""]})]},j.id))})]})]}),l&&b.jsx("div",{className:"pb-2 text-sm text-red-600",role:"alert",children:l}),b.jsxs("div",{className:"border-t border-gray-200 py-4 flex items-center justify-between",children:[b.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:""}),b.jsx("button",{type:"submit",disabled:oe,className:`px-5 py-2 rounded-lg text-sm font-medium transition-colors ${oe?"bg-blue-300 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,"aria-disabled":oe,children:d?"":re?" ":" "})]})]}),s&&b.jsx("div",{className:"absolute inset-0 z-20 bg-white/85 backdrop-blur-sm flex items-center justify-center",children:b.jsx("div",{className:"w-10 h-10 border-4 border-blue-200 border-t-transparent rounded-full animate-spin"})})]})};var mr=function(){return mr=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mr.apply(this,arguments)};function YG(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((n=n.apply(t,[])).next())})}function KG(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Bt(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function jr(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}var XG="ENTRIES",UD="KEYS",HD="VALUES",Nn="",mv=(function(){function t(e,r){var n=e._tree,i=Array.from(n.keys());this.set=e,this._type=r,this._path=i.length>0?[{node:n,keys:i}]:[]}return t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=tu(this._path),r=e.node,n=e.keys;if(tu(n)===Nn)return{done:!1,value:this.result()};var i=r.get(tu(n));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},t.prototype.backtrack=function(){if(this._path.length!==0){var e=tu(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var r=e.keys;return tu(r)}).filter(function(e){return e!==Nn}).join("")},t.prototype.value=function(){return tu(this._path).node.get(Nn)},t.prototype.result=function(){switch(this._type){case HD:return this.value();case UD:return this.key();default:return[this.key(),this.value()]}},t.prototype[Symbol.iterator]=function(){return this},t})(),tu=function(t){return t[t.length-1]},ZG=function(t,e,r){var n=new Map;if(e===void 0)return n;for(var i=e.length+1,s=i+r,a=new Uint8Array(s*i).fill(r+1),o=0;o<i;++o)a[o]=o;for(var l=1;l<s;++l)a[l*i]=l;return WD(t,e,r,n,a,1,i,""),n},WD=function(t,e,r,n,i,s,a,o){var l,u,d=s*a;try{e:for(var h=Bt(t.keys()),m=h.next();!m.done;m=h.next()){var g=m.value;if(g===Nn){var v=i[d-1];v<=r&&n.set(o,[t.get(g),v])}else{for(var x=s,w=0;w<g.length;++w,++x){for(var S=g[w],T=a*x,_=T-a,M=i[T],D=Math.max(0,x-r-1),O=Math.min(a-1,x+r),E=D;E<O;++E){var A=S!==e[E],N=i[_+E]+ +A,P=i[_+E+1]+1,B=i[T+E]+1,I=i[T+E+1]=Math.min(N,P,B);I<M&&(M=I)}if(M>r)continue e}WD(t.get(g),e,r,n,i,x,a,o+g)}}}catch(ee){l={error:ee}}finally{try{m&&!m.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}},gv=(function(){function t(e,r){e===void 0&&(e=new Map),r===void 0&&(r=""),this._size=void 0,this._tree=e,this._prefix=r}return t.prototype.atPrefix=function(e){var r,n;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=jr(em(this._tree,e.slice(this._prefix.length)),2),s=i[0],a=i[1];if(s===void 0){var o=jr(yw(a),2),l=o[0],u=o[1];try{for(var d=Bt(l.keys()),h=d.next();!h.done;h=d.next()){var m=h.value;if(m!==Nn&&m.startsWith(u)){var g=new Map;return g.set(m.slice(u.length),l.get(m)),new t(g,e)}}}catch(v){r={error:v}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}return new t(s,e)},t.prototype.clear=function(){this._size=void 0,this._tree.clear()},t.prototype.delete=function(e){return this._size=void 0,JG(this._tree,e)},t.prototype.entries=function(){return new mv(this,XG)},t.prototype.forEach=function(e){var r,n;try{for(var i=Bt(this),s=i.next();!s.done;s=i.next()){var a=jr(s.value,2),o=a[0],l=a[1];e(o,l,this)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.fuzzyGet=function(e,r){return ZG(this._tree,e,r)},t.prototype.get=function(e){var r=I1(this._tree,e);return r!==void 0?r.get(Nn):void 0},t.prototype.has=function(e){var r=I1(this._tree,e);return r!==void 0&&r.has(Nn)},t.prototype.keys=function(){return new mv(this,UD)},t.prototype.set=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=xv(this._tree,e);return n.set(Nn,r),this},Object.defineProperty(t.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),t.prototype.update=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=xv(this._tree,e);return n.set(Nn,r(n.get(Nn))),this},t.prototype.fetch=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=xv(this._tree,e),i=n.get(Nn);return i===void 0&&n.set(Nn,i=r()),i},t.prototype.values=function(){return new mv(this,HD)},t.prototype[Symbol.iterator]=function(){return this.entries()},t.from=function(e){var r,n,i=new t;try{for(var s=Bt(e),a=s.next();!a.done;a=s.next()){var o=jr(a.value,2),l=o[0],u=o[1];i.set(l,u)}}catch(d){r={error:d}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i},t.fromObject=function(e){return t.from(Object.entries(e))},t})(),em=function(t,e,r){var n,i;if(r===void 0&&(r=[]),e.length===0||t==null)return[t,r];try{for(var s=Bt(t.keys()),a=s.next();!a.done;a=s.next()){var o=a.value;if(o!==Nn&&e.startsWith(o))return r.push([t,o]),em(t.get(o),e.slice(o.length),r)}}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return r.push([t,e]),em(void 0,"",r)},I1=function(t,e){var r,n;if(e.length===0||t==null)return t;try{for(var i=Bt(t.keys()),s=i.next();!s.done;s=i.next()){var a=s.value;if(a!==Nn&&e.startsWith(a))return I1(t.get(a),e.slice(a.length))}}catch(o){r={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},xv=function(t,e){var r,n,i=e.length;e:for(var s=0;t&&s<i;){try{for(var a=(r=void 0,Bt(t.keys())),o=a.next();!o.done;o=a.next()){var l=o.value;if(l!==Nn&&e[s]===l[0]){for(var u=Math.min(i-s,l.length),d=1;d<u&&e[s+d]===l[d];)++d;var h=t.get(l);if(d===l.length)t=h;else{var m=new Map;m.set(l.slice(d),h),t.set(e.slice(s,s+d),m),t.delete(l),t=m}s+=d;continue e}}}catch(v){r={error:v}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}var g=new Map;return t.set(e.slice(s),g),g}return t},JG=function(t,e){var r=jr(em(t,e),2),n=r[0],i=r[1];if(n!==void 0){if(n.delete(Nn),n.size===0)GD(i);else if(n.size===1){var s=jr(n.entries().next().value,2),a=s[0],o=s[1];qD(i,a,o)}}},GD=function(t){if(t.length!==0){var e=jr(yw(t),2),r=e[0],n=e[1];if(r.delete(n),r.size===0)GD(t.slice(0,-1));else if(r.size===1){var i=jr(r.entries().next().value,2),s=i[0],a=i[1];s!==Nn&&qD(t.slice(0,-1),s,a)}}},qD=function(t,e,r){if(t.length!==0){var n=jr(yw(t),2),i=n[0],s=n[1];i.set(s+e,r),i.delete(s)}},yw=function(t){return t[t.length-1]},Of,ww="or",YD="and",QG="and_not",eq=(function(){function t(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');var r=e.autoVacuum==null||e.autoVacuum===!0?wv:e.autoVacuum;this._options=mr(mr(mr({},yv),e),{autoVacuum:r,searchOptions:mr(mr({},xC),e.searchOptions||{}),autoSuggestOptions:mr(mr({},sq),e.autoSuggestOptions||{})}),this._index=new gv,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=P1,this.addFields(this._options.fields)}return t.prototype.add=function(e){var r,n,i,s,a,o,l=this._options,u=l.extractField,d=l.tokenize,h=l.processTerm,m=l.fields,g=l.idField,v=u(e,g);if(v==null)throw new Error('MiniSearch: document does not have ID field "'.concat(g,'"'));if(this._idToShortId.has(v))throw new Error("MiniSearch: duplicate ID ".concat(v));var x=this.addDocumentId(v);this.saveStoredFields(x,e);try{for(var w=Bt(m),S=w.next();!S.done;S=w.next()){var T=S.value,_=u(e,T);if(_!=null){var M=d(_.toString(),T),D=this._fieldIds[T],O=new Set(M).size;this.addFieldLength(x,D,this._documentCount-1,O);try{for(var E=(i=void 0,Bt(M)),A=E.next();!A.done;A=E.next()){var N=A.value,P=h(N,T);if(Array.isArray(P))try{for(var B=(a=void 0,Bt(P)),I=B.next();!I.done;I=B.next()){var ee=I.value;this.addTerm(D,x,ee)}}catch(oe){a={error:oe}}finally{try{I&&!I.done&&(o=B.return)&&o.call(B)}finally{if(a)throw a.error}}else P&&this.addTerm(D,x,P)}}catch(oe){i={error:oe}}finally{try{A&&!A.done&&(s=E.return)&&s.call(E)}finally{if(i)throw i.error}}}}}catch(oe){r={error:oe}}finally{try{S&&!S.done&&(n=w.return)&&n.call(w)}finally{if(r)throw r.error}}},t.prototype.addAll=function(e){var r,n;try{for(var i=Bt(e),s=i.next();!s.done;s=i.next()){var a=s.value;this.add(a)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.addAllAsync=function(e,r){var n=this;r===void 0&&(r={});var i=r.chunkSize,s=i===void 0?10:i,a={chunk:[],promise:Promise.resolve()},o=e.reduce(function(d,h,m){var g=d.chunk,v=d.promise;return g.push(h),(m+1)%s===0?{chunk:[],promise:v.then(function(){return new Promise(function(x){return setTimeout(x,0)})}).then(function(){return n.addAll(g)})}:{chunk:g,promise:v}},a),l=o.chunk,u=o.promise;return u.then(function(){return n.addAll(l)})},t.prototype.remove=function(e){var r,n,i,s,a,o,l=this._options,u=l.tokenize,d=l.processTerm,h=l.extractField,m=l.fields,g=l.idField,v=h(e,g);if(v==null)throw new Error('MiniSearch: document does not have ID field "'.concat(g,'"'));var x=this._idToShortId.get(v);if(x==null)throw new Error("MiniSearch: cannot remove document with ID ".concat(v,": it is not in the index"));try{for(var w=Bt(m),S=w.next();!S.done;S=w.next()){var T=S.value,_=h(e,T);if(_!=null){var M=u(_.toString(),T),D=this._fieldIds[T],O=new Set(M).size;this.removeFieldLength(x,D,this._documentCount,O);try{for(var E=(i=void 0,Bt(M)),A=E.next();!A.done;A=E.next()){var N=A.value,P=d(N,T);if(Array.isArray(P))try{for(var B=(a=void 0,Bt(P)),I=B.next();!I.done;I=B.next()){var ee=I.value;this.removeTerm(D,x,ee)}}catch(oe){a={error:oe}}finally{try{I&&!I.done&&(o=B.return)&&o.call(B)}finally{if(a)throw a.error}}else P&&this.removeTerm(D,x,P)}}catch(oe){i={error:oe}}finally{try{A&&!A.done&&(s=E.return)&&s.call(E)}finally{if(i)throw i.error}}}}}catch(oe){r={error:oe}}finally{try{S&&!S.done&&(n=w.return)&&n.call(w)}finally{if(r)throw r.error}}this._storedFields.delete(x),this._documentIds.delete(x),this._idToShortId.delete(v),this._fieldLength.delete(x),this._documentCount-=1},t.prototype.removeAll=function(e){var r,n;if(e)try{for(var i=Bt(e),s=i.next();!s.done;s=i.next()){var a=s.value;this.remove(a)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new gv,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},t.prototype.discard=function(e){var r=this,n=this._idToShortId.get(e);if(n==null)throw new Error("MiniSearch: cannot discard document with ID ".concat(e,": it is not in the index"));this._idToShortId.delete(e),this._documentIds.delete(n),this._storedFields.delete(n),(this._fieldLength.get(n)||[]).forEach(function(i,s){r.removeFieldLength(n,s,r._documentCount,i)}),this._fieldLength.delete(n),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()},t.prototype.maybeAutoVacuum=function(){if(this._options.autoVacuum!==!1){var e=this._options.autoVacuum,r=e.minDirtFactor,n=e.minDirtCount,i=e.batchSize,s=e.batchWait;this.conditionalVacuum({batchSize:i,batchWait:s},{minDirtCount:n,minDirtFactor:r})}},t.prototype.discardAll=function(e){var r,n,i=this._options.autoVacuum;try{this._options.autoVacuum=!1;try{for(var s=Bt(e),a=s.next();!a.done;a=s.next()){var o=a.value;this.discard(o)}}catch(l){r={error:l}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}finally{this._options.autoVacuum=i}this.maybeAutoVacuum()},t.prototype.replace=function(e){var r=this._options,n=r.idField,i=r.extractField,s=i(e,n);this.discard(s),this.add(e)},t.prototype.vacuum=function(e){return e===void 0&&(e={}),this.conditionalVacuum(e)},t.prototype.conditionalVacuum=function(e,r){var n=this;return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&r,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(function(){var i=n._enqueuedVacuumConditions;return n._enqueuedVacuumConditions=P1,n.performVacuuming(e,i)}),this._enqueuedVacuum)):this.vacuumConditionsMet(r)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)},t.prototype.performVacuuming=function(e,r){return YG(this,void 0,void 0,function(){var n,i,s,a,o,l,u,d,h,m,g,v,x,w,S,T,_,M,D,O,E,A,N,P,B;return KG(this,function(I){switch(I.label){case 0:if(n=this._dirtCount,!this.vacuumConditionsMet(r))return[3,10];i=e.batchSize||R1.batchSize,s=e.batchWait||R1.batchWait,a=1,I.label=1;case 1:I.trys.push([1,7,8,9]),o=Bt(this._index),l=o.next(),I.label=2;case 2:if(l.done)return[3,6];u=jr(l.value,2),d=u[0],h=u[1];try{for(m=(A=void 0,Bt(h)),g=m.next();!g.done;g=m.next()){v=jr(g.value,2),x=v[0],w=v[1];try{for(S=(P=void 0,Bt(w)),T=S.next();!T.done;T=S.next())_=jr(T.value,1),M=_[0],!this._documentIds.has(M)&&(w.size<=1?h.delete(x):w.delete(M))}catch(ee){P={error:ee}}finally{try{T&&!T.done&&(B=S.return)&&B.call(S)}finally{if(P)throw P.error}}}}catch(ee){A={error:ee}}finally{try{g&&!g.done&&(N=m.return)&&N.call(m)}finally{if(A)throw A.error}}return this._index.get(d).size===0&&this._index.delete(d),a%i!==0?[3,4]:[4,new Promise(function(ee){return setTimeout(ee,s)})];case 3:I.sent(),I.label=4;case 4:a+=1,I.label=5;case 5:return l=o.next(),[3,2];case 6:return[3,9];case 7:return D=I.sent(),O={error:D},[3,9];case 8:try{l&&!l.done&&(E=o.return)&&E.call(o)}finally{if(O)throw O.error}return[7];case 9:this._dirtCount-=n,I.label=10;case 10:return[4,null];case 11:return I.sent(),this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null,[2]}})})},t.prototype.vacuumConditionsMet=function(e){if(e==null)return!0;var r=e.minDirtCount,n=e.minDirtFactor;return r=r||wv.minDirtCount,n=n||wv.minDirtFactor,this.dirtCount>=r&&this.dirtFactor>=n},Object.defineProperty(t.prototype,"isVacuuming",{get:function(){return this._currentVacuum!=null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtCount",{get:function(){return this._dirtCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtFactor",{get:function(){return this._dirtCount/(1+this._documentCount+this._dirtCount)},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return this._idToShortId.has(e)},t.prototype.getStoredFields=function(e){var r=this._idToShortId.get(e);if(r!=null)return this._storedFields.get(r)},t.prototype.search=function(e,r){var n,i;r===void 0&&(r={});var s=this.executeQuery(e,r),a=[];try{for(var o=Bt(s),l=o.next();!l.done;l=o.next()){var u=jr(l.value,2),d=u[0],h=u[1],m=h.score,g=h.terms,v=h.match,x=g.length||1,w={id:this._documentIds.get(d),score:m*x,terms:Object.keys(v),queryTerms:g,match:v};Object.assign(w,this._storedFields.get(d)),(r.filter==null||r.filter(w))&&a.push(w)}}catch(S){n={error:S}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return e===t.wildcard&&r.boostDocument==null&&this._options.searchOptions.boostDocument==null||a.sort(yC),a},t.prototype.autoSuggest=function(e,r){var n,i,s,a;r===void 0&&(r={}),r=mr(mr({},this._options.autoSuggestOptions),r);var o=new Map;try{for(var l=Bt(this.search(e,r)),u=l.next();!u.done;u=l.next()){var d=u.value,h=d.score,m=d.terms,g=m.join(" "),v=o.get(g);v!=null?(v.score+=h,v.count+=1):o.set(g,{score:h,terms:m,count:1})}}catch(D){n={error:D}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}var x=[];try{for(var w=Bt(o),S=w.next();!S.done;S=w.next()){var T=jr(S.value,2),v=T[0],_=T[1],h=_.score,m=_.terms,M=_.count;x.push({suggestion:v,terms:m,score:h/M})}}catch(D){s={error:D}}finally{try{S&&!S.done&&(a=w.return)&&a.call(w)}finally{if(s)throw s.error}}return x.sort(yC),x},Object.defineProperty(t.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"termCount",{get:function(){return this._index.size},enumerable:!1,configurable:!0}),t.loadJSON=function(e,r){if(r==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),r)},t.getDefault=function(e){if(yv.hasOwnProperty(e))return vv(yv,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},t.loadJS=function(e,r){var n,i,s,a,o,l,u=e.index,d=e.documentCount,h=e.nextId,m=e.documentIds,g=e.fieldIds,v=e.fieldLength,x=e.averageFieldLength,w=e.storedFields,S=e.dirtCount,T=e.serializationVersion;if(T!==1&&T!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var _=new t(r);_._documentCount=d,_._nextId=h,_._documentIds=j0(m),_._idToShortId=new Map,_._fieldIds=g,_._fieldLength=j0(v),_._avgFieldLength=x,_._storedFields=j0(w),_._dirtCount=S||0,_._index=new gv;try{for(var M=Bt(_._documentIds),D=M.next();!D.done;D=M.next()){var O=jr(D.value,2),E=O[0],A=O[1];_._idToShortId.set(A,E)}}catch(H){n={error:H}}finally{try{D&&!D.done&&(i=M.return)&&i.call(M)}finally{if(n)throw n.error}}try{for(var N=Bt(u),P=N.next();!P.done;P=N.next()){var B=jr(P.value,2),I=B[0],ee=B[1],oe=new Map;try{for(var re=(o=void 0,Bt(Object.keys(ee))),fe=re.next();!fe.done;fe=re.next()){var se=fe.value,xe=ee[se];T===1&&(xe=xe.ds),oe.set(parseInt(se,10),j0(xe))}}catch(H){o={error:H}}finally{try{fe&&!fe.done&&(l=re.return)&&l.call(re)}finally{if(o)throw o.error}}_._index.set(I,oe)}}catch(H){s={error:H}}finally{try{P&&!P.done&&(a=N.return)&&a.call(N)}finally{if(s)throw s.error}}return _},t.prototype.executeQuery=function(e,r){var n=this;if(r===void 0&&(r={}),e===t.wildcard)return this.executeWildcardQuery(r);if(typeof e!="string"){var i=mr(mr(mr({},r),e),{queries:void 0}),s=e.queries.map(function(w){return n.executeQuery(w,i)});return this.combineResults(s,i.combineWith)}var a=this._options,o=a.tokenize,l=a.processTerm,u=a.searchOptions,d=mr(mr({tokenize:o,processTerm:l},u),r),h=d.tokenize,m=d.processTerm,g=h(e).flatMap(function(w){return m(w)}).filter(function(w){return!!w}),v=g.map(iq(d)),x=v.map(function(w){return n.executeQuerySpec(w,d)});return this.combineResults(x,d.combineWith)},t.prototype.executeQuerySpec=function(e,r){var n,i,s,a,o=mr(mr({},this._options.searchOptions),r),l=(o.fields||this._options.fields).reduce(function(se,xe){var H;return mr(mr({},se),(H={},H[xe]=vv(o.boost,xe)||1,H))},{}),u=o.boostDocument,d=o.weights,h=o.maxFuzzy,m=o.bm25,g=mr(mr({},xC.weights),d),v=g.fuzzy,x=g.prefix,w=this._index.get(e.term),S=this.termResults(e.term,e.term,1,w,l,u,m),T,_;if(e.prefix&&(T=this._index.atPrefix(e.term)),e.fuzzy){var M=e.fuzzy===!0?.2:e.fuzzy,D=M<1?Math.min(h,Math.round(e.term.length*M)):M;D&&(_=this._index.fuzzyGet(e.term,D))}if(T)try{for(var O=Bt(T),E=O.next();!E.done;E=O.next()){var A=jr(E.value,2),N=A[0],P=A[1],B=N.length-e.term.length;if(B){_==null||_.delete(N);var I=x*N.length/(N.length+.3*B);this.termResults(e.term,N,I,P,l,u,m,S)}}}catch(se){n={error:se}}finally{try{E&&!E.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}if(_)try{for(var ee=Bt(_.keys()),oe=ee.next();!oe.done;oe=ee.next()){var N=oe.value,re=jr(_.get(N),2),fe=re[0],B=re[1];if(B){var I=v*N.length/(N.length+B);this.termResults(e.term,N,I,fe,l,u,m,S)}}}catch(se){s={error:se}}finally{try{oe&&!oe.done&&(a=ee.return)&&a.call(ee)}finally{if(s)throw s.error}}return S},t.prototype.executeWildcardQuery=function(e){var r,n,i=new Map,s=mr(mr({},this._options.searchOptions),e);try{for(var a=Bt(this._documentIds),o=a.next();!o.done;o=a.next()){var l=jr(o.value,2),u=l[0],d=l[1],h=s.boostDocument?s.boostDocument(d,"",this._storedFields.get(u)):1;i.set(u,{score:h,terms:[],match:{}})}}catch(m){r={error:m}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},t.prototype.combineResults=function(e,r){if(r===void 0&&(r=ww),e.length===0)return new Map;var n=r.toLowerCase();return e.reduce(tq[n])||new Map},t.prototype.toJSON=function(){var e,r,n,i,s=[];try{for(var a=Bt(this._index),o=a.next();!o.done;o=a.next()){var l=jr(o.value,2),u=l[0],d=l[1],h={};try{for(var m=(n=void 0,Bt(d)),g=m.next();!g.done;g=m.next()){var v=jr(g.value,2),x=v[0],w=v[1];h[x]=Object.fromEntries(w)}}catch(S){n={error:S}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}s.push([u,h])}}catch(S){e={error:S}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:s,serializationVersion:2}},t.prototype.termResults=function(e,r,n,i,s,a,o,l){var u,d,h,m,g;if(l===void 0&&(l=new Map),i==null)return l;try{for(var v=Bt(Object.keys(s)),x=v.next();!x.done;x=v.next()){var w=x.value,S=s[w],T=this._fieldIds[w],_=i.get(T);if(_!=null){var M=_.size,D=this._avgFieldLength[T];try{for(var O=(h=void 0,Bt(_.keys())),E=O.next();!E.done;E=O.next()){var A=E.value;if(!this._documentIds.has(A)){this.removeTerm(T,A,r),M-=1;continue}var N=a?a(this._documentIds.get(A),r,this._storedFields.get(A)):1;if(N){var P=_.get(A),B=this._fieldLength.get(A)[T],I=nq(P,M,this._documentCount,B,D,o),ee=n*S*N*I,oe=l.get(A);if(oe){oe.score+=ee,aq(oe.terms,e);var re=vv(oe.match,r);re?re.push(w):oe.match[r]=[w]}else l.set(A,{score:ee,terms:[e],match:(g={},g[r]=[w],g)})}}}catch(fe){h={error:fe}}finally{try{E&&!E.done&&(m=O.return)&&m.call(O)}finally{if(h)throw h.error}}}}}catch(fe){u={error:fe}}finally{try{x&&!x.done&&(d=v.return)&&d.call(v)}finally{if(u)throw u.error}}return l},t.prototype.addTerm=function(e,r,n){var i=this._index.fetch(n,wC),s=i.get(e);if(s==null)s=new Map,s.set(r,1),i.set(e,s);else{var a=s.get(r);s.set(r,(a||0)+1)}},t.prototype.removeTerm=function(e,r,n){if(!this._index.has(n)){this.warnDocumentChanged(r,e,n);return}var i=this._index.fetch(n,wC),s=i.get(e);s==null||s.get(r)==null?this.warnDocumentChanged(r,e,n):s.get(r)<=1?s.size<=1?i.delete(e):s.delete(r):s.set(r,s.get(r)-1),this._index.get(n).size===0&&this._index.delete(n)},t.prototype.warnDocumentChanged=function(e,r,n){var i,s;try{for(var a=Bt(Object.keys(this._fieldIds)),o=a.next();!o.done;o=a.next()){var l=o.value;if(this._fieldIds[l]===r){this._options.logger("warn","MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(n,'" was not present in field "').concat(l,'". Removing a document after it has changed can corrupt the index!'),"version_conflict");return}}}catch(u){i={error:u}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}},t.prototype.addDocumentId=function(e){var r=this._nextId;return this._idToShortId.set(e,r),this._documentIds.set(r,e),this._documentCount+=1,this._nextId+=1,r},t.prototype.addFields=function(e){for(var r=0;r<e.length;r++)this._fieldIds[e[r]]=r},t.prototype.addFieldLength=function(e,r,n,i){var s=this._fieldLength.get(e);s==null&&this._fieldLength.set(e,s=[]),s[r]=i;var a=this._avgFieldLength[r]||0,o=a*n+i;this._avgFieldLength[r]=o/(n+1)},t.prototype.removeFieldLength=function(e,r,n,i){if(n===1){this._avgFieldLength[r]=0;return}var s=this._avgFieldLength[r]*n-i;this._avgFieldLength[r]=s/(n-1)},t.prototype.saveStoredFields=function(e,r){var n,i,s=this._options,a=s.storeFields,o=s.extractField;if(!(a==null||a.length===0)){var l=this._storedFields.get(e);l==null&&this._storedFields.set(e,l={});try{for(var u=Bt(a),d=u.next();!d.done;d=u.next()){var h=d.value,m=o(r,h);m!==void 0&&(l[h]=m)}}catch(g){n={error:g}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}},t.wildcard=Symbol("*"),t})(),vv=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},tq=(Of={},Of[ww]=function(t,e){var r,n;try{for(var i=Bt(e.keys()),s=i.next();!s.done;s=i.next()){var a=s.value,o=t.get(a);if(o==null)t.set(a,e.get(a));else{var l=e.get(a),u=l.score,d=l.terms,h=l.match;o.score=o.score+u,o.match=Object.assign(o.match,h),vC(o.terms,d)}}}catch(m){r={error:m}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},Of[YD]=function(t,e){var r,n,i=new Map;try{for(var s=Bt(e.keys()),a=s.next();!a.done;a=s.next()){var o=a.value,l=t.get(o);if(l!=null){var u=e.get(o),d=u.score,h=u.terms,m=u.match;vC(l.terms,h),i.set(o,{score:l.score+d,terms:l.terms,match:Object.assign(l.match,m)})}}}catch(g){r={error:g}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i},Of[QG]=function(t,e){var r,n;try{for(var i=Bt(e.keys()),s=i.next();!s.done;s=i.next()){var a=s.value;t.delete(a)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},Of),rq={k:1.2,b:.7,d:.5},nq=function(t,e,r,n,i,s){var a=s.k,o=s.b,l=s.d,u=Math.log(1+(r-e+.5)/(e+.5));return u*(l+t*(a+1)/(t+a*(1-o+o*n/i)))},iq=function(t){return function(e,r,n){var i=typeof t.fuzzy=="function"?t.fuzzy(e,r,n):t.fuzzy||!1,s=typeof t.prefix=="function"?t.prefix(e,r,n):t.prefix===!0;return{term:e,fuzzy:i,prefix:s}}},yv={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t){return t.split(oq)},processTerm:function(t){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[],logger:function(t,e){typeof(console==null?void 0:console[t])=="function"&&console[t](e)},autoVacuum:!0},xC={combineWith:ww,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:rq},sq={combineWith:YD,prefix:function(t,e,r){return e===r.length-1}},R1={batchSize:1e3,batchWait:10},P1={minDirtFactor:.1,minDirtCount:20},wv=mr(mr({},R1),P1),aq=function(t,e){t.includes(e)||t.push(e)},vC=function(t,e){var r,n;try{for(var i=Bt(e),s=i.next();!s.done;s=i.next()){var a=s.value;t.includes(a)||t.push(a)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},yC=function(t,e){var r=t.score,n=e.score;return n-r},wC=function(){return new Map},j0=function(t){var e,r,n=new Map;try{for(var i=Bt(Object.keys(t)),s=i.next();!s.done;s=i.next()){var a=s.value;n.set(parseInt(a,10),t[a])}}catch(o){e={error:o}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},oq=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u;const Ff=t=>t.normalize("NFC").toLowerCase(),KD={boost:{fullName:4,login:3,team:2,position:2,tags:1},fuzzy:.2,prefix:!0},lq=t=>t.map(e=>({id:e.id,fullName:Ff([e.personalInfo.lastName,e.personalInfo.firstName,e.personalInfo.middleName??""].filter(Boolean).join(" ")),login:Ff(e.credentials.wfmLogin),position:Ff(e.workInfo.position),team:Ff(e.workInfo.team.name),tags:Ff(e.tags.join(" "))})),cq=t=>{const e=new eq({fields:["fullName","login","position","team","tags"],storeFields:["id"],searchOptions:KD});return e.addAll(t),e},uq=(t,e)=>{const r=e.trim();if(!r)return null;const n=t.search(r,KD),i=new Set,s=new Map;return n.forEach((a,o)=>{const l=String(a.id);i.add(l),s.set(l,o)}),{ids:i,order:s}},If={active:"",vacation:" ",probation:"",inactive:"",terminated:""},bC={active:"bg-green-100 text-green-800",vacation:"bg-yellow-100 text-yellow-800",probation:"bg-blue-100 text-blue-800",inactive:"bg-gray-100 text-gray-800",terminated:"bg-red-100 text-red-800"},bv=[{key:"fio",label:"..."},{key:"position",label:""},{key:"orgUnit",label:" "},{key:"team",label:""},{key:"scheme",label:" "},{key:"hourNorm",label:" "},{key:"status",label:""},{key:"hireDate",label:" "}],kC="employee-list:columns",SC="employee-list:filters",kv=()=>({search:"",team:"",status:"",skill:"",position:"",orgUnit:"",sortBy:"name",sortOrder:"asc",showInactive:!1}),xd=["#2563eb","#1d4ed8","#0ea5e9","#0f766e","#16a34a","#d97706","#db2777","#7c3aed"],bw=t=>{let e=0;for(let n=0;n<t.length;n+=1)e=(e<<5)-e+t.charCodeAt(n),e|=0;const r=Math.abs(e)%xd.length;return xd[r]},fq=[{id:"employees",label:""},{id:"skills",label:""},{id:"vacations",label:""},{id:"preferences",label:" "},{id:"schemes",label:""},{id:"tags",label:""}],dq=[{id:"csv",label:"CSV ( )"},{id:"vacations",label:""},{id:"tags",label:""}],_C='button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])',CC={:{extensions:["csv","xlsx","xls"],appendix:"Appendix 1"},:{extensions:["csv","xlsx"],appendix:"Appendix 3"},:{extensions:["csv"],appendix:"Appendix 5"}," ":{extensions:["csv"],appendix:"Appendix 4"},:{extensions:["csv"],appendix:"Appendix 5"},:{extensions:["csv"],appendix:"Appendix 6"}},EC={"CSV ( )":"employees_export",:"employees_vacations",:"employees_tags"},TC={:["login","lastName","firstName","email","hiringDate","office","groupExternalId","positionExternalId","telephonyId","personnelNumber","schemeExternalId","calendarExternalId","timeZone"],:["login","skill","start","end","priority"],:["login","","","",""]," ":["login","activityId","start","end","timeZone"],:["login","id","start","end"],:["login","",""]},XD="employee-list:tag-catalog",Sv=()=>({status:{action:"none",value:""},team:{action:"none",value:""},hourNorm:{action:"none",value:""},workScheme:{action:"none",value:""},skills:{action:"none",value:[]},reserveSkills:{action:"none",value:[]},tags:{action:"none",value:[]},comment:""}),Rf={add:" ",replace:" ",remove:"  "},hq=["add","replace","remove"],z0={status:["replace"],team:["replace"],hourNorm:["replace"],workScheme:["add","replace","remove"],skills:["add","replace","remove"],reserveSkills:["add","replace","remove"],tags:["add","replace","remove"]},Ei=4,AC=()=>{if(typeof window>"u")return{};try{const t=window.localStorage.getItem(XD);if(!t)return{};const e=JSON.parse(t);if(e&&typeof e=="object")return Object.entries(e).reduce((r,[n,i])=>(typeof i=="string"&&i.trim()?r[n]=i:r[n]=bw(n),r),{})}catch(t){console.error("     ",t)}return{}},pq=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`task-${Date.now()}-${Math.floor(Math.random()*1e4)}`,NC=(t,e,r,n)=>{switch(e){case"add":{const i=new Map(t.map(s=>[n(s),s]));return r.forEach(s=>{const a=n(s);i.has(a)||i.set(a,s)}),Array.from(i.values())}case"replace":return r;case"remove":{const i=new Set(r.map(s=>n(s)));return t.filter(s=>!i.has(n(s)))}default:return t}},mq=({employees:t,onEmployeesChange:e,onOpenQuickAdd:r,focusEmployeeId:n})=>{const[i,s]=z.useState(kv()),[a,o]=z.useState(new Set),[l,u]=z.useState(null),[d,h]=z.useState(!0),[m,g]=z.useState(!1),[v,x]=z.useState(!1),[w,S]=z.useState(!0),[T,_]=z.useState(!1),[M,D]=z.useState(!1),[O,E]=z.useState(null),[A,N]=z.useState(null),[P,B]=z.useState(()=>AC()),[I,ee]=z.useState("add"),[oe,re]=z.useState([]),[fe,se]=z.useState(""),[xe,H]=z.useState(xd[0]),[ve,W]=z.useState(!1),[F,X]=z.useState(!1),[Z,q]=z.useState(null),[ce,Ce]=z.useState(null),[pe,ue]=z.useState(!1),[Se,ze]=z.useState(!1),[j,tt]=z.useState(!1),[Ne,qe]=z.useState(Sv()),[Le,Te]=z.useState(null),[at,gt]=z.useState(null),[J,le]=z.useState(""),[be,Ve]=z.useState("CSV ( )"),[Me,Ae]=z.useState("  "),[$e,et]=z.useState(null),[st,Nt]=z.useState(null),[rt,Tt]=z.useState(!1),ar=z.useRef(null),$t=z.useRef(null),Mr=z.useRef(null),ba=z.useRef(null),Pn=z.useRef({}),xi=z.useRef(null),Sn=z.useRef(null),Fi=z.useRef(null),to=(te=!1)=>`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 ${te?"border-gray-200 text-gray-300 bg-gray-50 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,Vs="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg border border-blue-500 bg-blue-600 text-white text-sm font-medium transition-colors hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500",_n=()=>{const te=document.activeElement;te instanceof HTMLElement&&(Fi.current=te)},vi=()=>{const te=Fi.current;te&&te.isConnected&&(typeof window<"u"?window.requestAnimationFrame(()=>{te.focus()}):te.focus()),Fi.current=null},cl=()=>{const te=Sn.current;let ae=xi.current;if((!ae||!ae.isConnected)&&te&&(ae=Pn.current[te]??null),xi.current=null,Sn.current=null,!ae||!ae.isConnected)return;const de=ae.matches(_C)?ae:ae.querySelector(_C)??ae,De=()=>de.focus({preventScroll:!0});typeof window<"u"?window.setTimeout(De,0):De()},yc=()=>{_n(),_(!0)},wc=()=>{_(!1),vi()},bc=()=>{_n(),D(!0)},ro=()=>{D(!1),vi()},ul=()=>{_n(),q(null),W(!0)},ka=()=>{W(!1),vi()},no=()=>{_n(),Ce(null),X(!0)},vs=()=>{X(!1),vi()},[$s,ys]=z.useState({fio:!0,position:!0,orgUnit:!0,team:!0,scheme:!0,hourNorm:!0,status:!0,hireDate:!0});z.useEffect(()=>{const te=localStorage.getItem(kC);if(te)try{const ae=JSON.parse(te);ys(de=>({...de,...ae}))}catch(ae){console.warn("Failed to parse saved column visibility",ae)}},[]),z.useEffect(()=>{localStorage.setItem(kC,JSON.stringify($s))},[$s]),z.useEffect(()=>{const te=localStorage.getItem(SC);if(te)try{const ae=JSON.parse(te);s(de=>({...de,...ae}))}catch(ae){console.warn("Failed to parse saved filters",ae)}},[]),z.useEffect(()=>{localStorage.setItem(SC,JSON.stringify(i))},[i]),z.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(XD,JSON.stringify(P))},[P]),z.useEffect(()=>{if(t.length===0)return;const te=window.setTimeout(()=>h(!1),250);return()=>window.clearTimeout(te)},[t.length]),z.useEffect(()=>{if(!pe&&!Se)return;const te=ae=>{pe&&$t.current&&!$t.current.contains(ae.target)&&ue(!1),Se&&Mr.current&&!Mr.current.contains(ae.target)&&ze(!1)};return document.addEventListener("mousedown",te),()=>document.removeEventListener("mousedown",te)},[pe,Se]),z.useEffect(()=>{x(rt&&a.size>0)},[a,rt]),z.useEffect(()=>{const te=Date.now();st&&st>te||Ae(a.size>0?` : ${a.size}`:"  ")},[a,st]),z.useEffect(()=>{if(!st)return;const te=Date.now(),ae=Math.max(st-te,0),de=window.setTimeout(()=>Nt(null),ae);return()=>window.clearTimeout(de)},[st]),z.useEffect(()=>{if(!$e)return;const te=window.setTimeout(()=>et(null),4e3);return()=>window.clearTimeout(te)},[$e]),z.useEffect(()=>{if(!w)return;const te=ae=>{ae.key==="Escape"&&(S(!1),window.requestAnimationFrame(()=>{var de;(de=ba.current)==null||de.focus()}))};return document.addEventListener("keydown",te),()=>document.removeEventListener("keydown",te)},[w]),z.useEffect(()=>{o(te=>{const ae=new Set;return t.forEach(de=>{te.has(de.id)&&ae.add(de.id)}),ae})},[t]);const Ii=z.useCallback(te=>{o(new Set),Te(null);let ae=!1;Tt(de=>(de&&(ae=!0,Ae("  "),Nt(Date.now()+4e3)),!1)),(te==null?void 0:te.announce)!==!1&&ae&&et("   ")},[Ae,Nt,et]);z.useEffect(()=>{if(!rt)return;const te=ae=>{ae.key==="Escape"&&(j||M||ve||F||T||(ae.preventDefault(),Ii()))};return document.addEventListener("keydown",te),()=>document.removeEventListener("keydown",te)},[rt,j,M,ve,F,T,Ii]),z.useEffect(()=>{!n||!t.some(ae=>ae.id===n)||(Pn.current[n]&&(xi.current=Pn.current[n]),Sn.current=n,u(n),g(!0))},[n,t]),z.useEffect(()=>{if(!at)return;const te=window.setTimeout(()=>gt(null),4e3);return()=>window.clearTimeout(te)},[at]),z.useEffect(()=>{if(!M){E(null),N(null);return}const te=AC(),ae={};t.forEach(De=>{De.tags.forEach(We=>{ae[We]||(ae[We]=bw(We))})}),B(De=>{const We={...te,...De};return Object.entries(ae).forEach(([ot,Rt])=>{We[ot]||(We[ot]=Rt)}),We});const de=t.filter(De=>a.has(De.id));if(de.length>0){const[De,...We]=de,ot=De.tags.filter(Rt=>We.every(Lt=>Lt.tags.includes(Rt)));re(ot.slice(0,4))}else re([]);ee("add"),se(""),H(xd[0]),N(null),E(null)},[M,t,a]);const L=(te,ae)=>{s(de=>({...de,[te]:ae}))},Y=()=>{s(kv())},V=z.useMemo(()=>lq(t),[t]),U=z.useMemo(()=>cq(V),[V]),G=z.useMemo(()=>uq(U,i.search),[i.search,U]),K=z.useMemo(()=>t.filter(te=>!(!i.showInactive&&te.status==="terminated"||G&&!G.ids.has(te.id)||i.team&&te.workInfo.team.id!==i.team||i.status&&te.status!==i.status||i.position&&te.workInfo.position!==i.position||i.orgUnit&&te.orgPlacement.orgUnit!==i.orgUnit)),[t,i,G]),me=z.useMemo(()=>{const te=[...K],ae=(de,De)=>{let We="",ot="";switch(i.sortBy){case"position":We=de.workInfo.position,ot=De.workInfo.position;break;case"team":We=de.workInfo.team.name,ot=De.workInfo.team.name;break;case"hireDate":We=de.workInfo.hireDate.getTime(),ot=De.workInfo.hireDate.getTime();break;case"performance":We=de.performance.qualityScore,ot=De.performance.qualityScore;break;case"name":default:We=`${de.personalInfo.lastName} ${de.personalInfo.firstName}`.trim(),ot=`${De.personalInfo.lastName} ${De.personalInfo.firstName}`.trim();break}return typeof We=="number"&&typeof ot=="number"?i.sortOrder==="asc"?We-ot:ot-We:i.sortOrder==="asc"?String(We).localeCompare(String(ot),"ru"):String(ot).localeCompare(String(We),"ru")};return G&&G.order.size>0?(te.sort((de,De)=>{const We=G.order.get(de.id),ot=G.order.get(De.id);if(We!==void 0||ot!==void 0){if(We===void 0)return 1;if(ot===void 0)return-1;if(We!==ot)return We-ot}return ae(de,De)}),te):(te.sort(ae),te)},[K,i.sortBy,i.sortOrder,G]),Ee=z.useMemo(()=>{const te=new Map;return t.forEach(ae=>{te.set(ae.workInfo.team.id,ae.workInfo.team)}),Array.from(te.values())},[t]),ge=z.useMemo(()=>{const te=new Map;return Ee.forEach(ae=>te.set(ae.id,ae)),te},[Ee]),ye=z.useMemo(()=>{const te=new Map;return t.forEach(ae=>{const de=ae.orgPlacement.workScheme;de&&te.set(de.id,de),(ae.orgPlacement.workSchemeHistory??[]).forEach(De=>{te.set(De.id,De)})}),Array.from(te.values())},[t]),ke=z.useMemo(()=>{const te=new Map;return ye.forEach(ae=>te.set(ae.id,ae)),te},[ye]),Re=z.useMemo(()=>{const te=new Map;return t.forEach(ae=>{ae.skills.forEach(de=>{te.set(de.id,de)})}),te},[t]),Ge=z.useMemo(()=>{const te=new Map;return t.forEach(ae=>{ae.reserveSkills.forEach(de=>{te.set(de.id,de)})}),te},[t]),Ye=z.useCallback((te,ae)=>{xi.current=ae??Pn.current[te]??null,Sn.current=te,g(!0),u(te)},[u,g]),Be=z.useCallback(te=>{o(ae=>{const de=new Set(ae);return de.has(te)?de.delete(te):de.add(te),de})},[]),Pe=z.useCallback(()=>{Tt(te=>te||(et("      ."),Ae("     "),Nt(Date.now()+4e3),!0))},[Ae,Nt,et]),St=z.useMemo(()=>a.size===0?[]:t.filter(te=>a.has(te.id)),[t,a]),or=t.length,Ut=me.length,xr=z.useCallback(()=>{if(a.size===Ut&&Ut>0){o(new Set);return}o(new Set(me.map(te=>te.id)))},[a,me,Ut]),ws=60,Us=z.useMemo(()=>(Math.min(Math.max(Ut,8),16)+1)*ws,[ws,Ut]),Ki=z.useMemo(()=>{const te=[];return rt&&te.push({id:"selection",enableSorting:!1,enableHiding:!1,header:()=>b.jsx("div",{className:"flex items-center justify-center",children:b.jsx("input",{type:"checkbox","data-testid":"employee-table-select-all",className:"rounded text-blue-600 focus:ring-blue-500",checked:Ut>0&&a.size===Ut,onChange:xr,"aria-label":"  "})}),cell:({row:ae})=>{const de=ae.original,De=a.has(de.id);return b.jsx("div",{className:"flex items-center justify-center",children:b.jsx("input",{type:"checkbox","data-testid":"employee-row-checkbox",className:"rounded text-blue-600 focus:ring-blue-500",checked:De,onChange:We=>{We.stopPropagation(),Be(de.id)},"aria-label":` ${de.personalInfo.lastName} ${de.personalInfo.firstName}`})})},meta:{headerClassName:"px-4 py-2.5 flex items-center justify-center",cellClassName:"px-4 py-2.5 flex items-center justify-center",headerStyle:{flex:"0 0 56px",minWidth:56},cellStyle:{flex:"0 0 56px",minWidth:56}}}),bv.forEach(ae=>{if($s[ae.key])switch(ae.key){case"fio":te.push({id:"fio",header:ae.label,cell:({row:de})=>{const De=de.original;return b.jsxs("div",{className:"flex items-center",children:[b.jsx("img",{src:De.personalInfo.photo||"https://i.pravatar.cc/40?img=1",alt:`${De.personalInfo.lastName} ${De.personalInfo.firstName}`,className:"w-10 h-10 rounded-full object-cover"}),b.jsxs("div",{className:"ml-3 space-y-1",children:[b.jsxs("button",{type:"button",onClick:We=>{We.stopPropagation();const ot=We.currentTarget.closest("[data-row-id]");Ye(De.id,ot)},className:"text-sm font-semibold text-blue-600 hover:text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded",children:[De.personalInfo.lastName," ",De.personalInfo.firstName]}),b.jsx("div",{className:"text-xs text-gray-500",children:De.credentials.wfmLogin})]})]})},meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider",cellClassName:"px-6 py-2.5 whitespace-nowrap",headerStyle:{flex:"1 1 280px",minWidth:240},cellStyle:{flex:"1 1 280px",minWidth:240,alignItems:"center"}}});break;case"position":te.push({id:"position",header:ae.label,cell:({row:de})=>b.jsx("span",{className:"text-gray-700 truncate block max-w-full",children:de.original.workInfo.position}),meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider",cellClassName:"px-6 py-2.5 text-gray-700 overflow-hidden",headerStyle:{flex:"0 0 200px",minWidth:180,maxWidth:200},cellStyle:{flex:"0 0 200px",minWidth:180,maxWidth:200,alignItems:"center"}}});break;case"orgUnit":te.push({id:"orgUnit",header:ae.label,cell:({row:de})=>b.jsx("span",{className:"text-gray-700 truncate block max-w-full",children:de.original.orgPlacement.orgUnit}),meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider",cellClassName:"px-6 py-2.5 text-gray-700 overflow-hidden",headerStyle:{flex:"0 0 240px",minWidth:200,maxWidth:240},cellStyle:{flex:"0 0 240px",minWidth:200,maxWidth:240,alignItems:"center"}}});break;case"team":te.push({id:"team",header:ae.label,cell:({row:de})=>{const De=de.original;return b.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[b.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:De.workInfo.team.color}}),b.jsx("span",{className:"text-gray-700 truncate",children:De.workInfo.team.name})]})},meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider",cellClassName:"px-6 py-2.5 overflow-hidden",headerStyle:{flex:"0 0 220px",minWidth:200,maxWidth:220},cellStyle:{flex:"0 0 220px",minWidth:200,maxWidth:220,alignItems:"center"}}});break;case"scheme":te.push({id:"scheme",header:ae.label,cell:({row:de})=>{var De;return b.jsx("span",{className:"text-gray-700 truncate block max-w-full",children:((De=de.original.orgPlacement.workScheme)==null?void 0:De.name)??""})},meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider",cellClassName:"px-6 py-2.5 text-gray-700 overflow-hidden",headerStyle:{flex:"0 0 220px",minWidth:200,maxWidth:220},cellStyle:{flex:"0 0 220px",minWidth:200,maxWidth:220,alignItems:"center"}}});break;case"hourNorm":te.push({id:"hourNorm",header:ae.label,cell:({row:de})=>b.jsx("span",{className:"text-gray-700 text-center w-full",children:de.original.orgPlacement.hourNorm}),meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider text-center",cellClassName:"px-6 py-2.5 whitespace-nowrap text-center text-gray-700",headerStyle:{flex:"0 0 140px",minWidth:120,textAlign:"center"},cellStyle:{flex:"0 0 140px",minWidth:120,justifyContent:"center",alignItems:"center"}}});break;case"status":te.push({id:"status",header:ae.label,cell:({row:de})=>{const De=de.original;return b.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${bC[De.status]}`,children:If[De.status]})},meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider text-center",cellClassName:"px-6 py-2.5 whitespace-nowrap text-center",headerStyle:{flex:"0 0 160px",minWidth:140,textAlign:"center"},cellStyle:{flex:"0 0 160px",minWidth:140,justifyContent:"center",alignItems:"center"}}});break;case"hireDate":te.push({id:"hireDate",header:ae.label,cell:({row:de})=>b.jsx("span",{className:"text-gray-700 whitespace-nowrap",children:de.original.workInfo.hireDate.toLocaleDateString("ru-RU")}),meta:{headerClassName:"px-6 py-2.5 text-xs font-semibold uppercase text-gray-600 tracking-wider text-center",cellClassName:"px-6 py-2.5 whitespace-nowrap text-center text-gray-700",headerStyle:{flex:"0 0 160px",minWidth:140,textAlign:"center"},cellStyle:{flex:"0 0 160px",minWidth:140,justifyContent:"center",alignItems:"center"}}});break}}),te},[$s,Ye,xr,rt,a,Be,Ut]),Hr=z.useCallback(({row:te})=>{const ae=te.original,de=a.has(ae.id),De=(G==null?void 0:G.ids.has(ae.id))??!1,We=G==null?void 0:G.order.get(ae.id),ot="transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300 border-l-4 border-transparent",Rt=de?"bg-blue-50 border-l-4 border-blue-400":De?"bg-amber-50 border-l-4 border-amber-400":"hover:bg-gray-50";return{ref:Lt=>{Lt?Pn.current[ae.id]=Lt:delete Pn.current[ae.id]},tabIndex:0,"data-testid":"employee-table-row","data-row-id":ae.id,"data-search-hit":De||void 0,"data-search-rank":We!==void 0?We:void 0,className:`${ot} ${Rt}`,"aria-selected":rt?de:void 0,onFocus:()=>{Sn.current=ae.id},onClick:Lt=>{const fr=Lt.target;if(!(fr.closest('input[type="checkbox"]')||fr.closest("button"))){if(Lt.metaKey||Lt.ctrlKey){Pe(),Be(ae.id);return}if(rt){Be(ae.id);return}Ye(ae.id,Lt.currentTarget)}},onKeyDown:Lt=>{if(Lt.key==="Escape"&&rt){Lt.preventDefault(),Ii();return}if(Lt.key==="Enter"){Lt.preventDefault(),rt?Be(ae.id):Ye(ae.id,Lt.currentTarget);return}Lt.key===" "&&(Lt.preventDefault(),Pe(),Be(ae.id))}}},[Ii,Pe,Ye,rt,G,a,Be]),fl=z.useMemo(()=>{const te=new Set;return t.forEach(ae=>ae.tags.forEach(de=>te.add(de))),Array.from(te).sort((ae,de)=>ae.localeCompare(de,"ru"))},[t]),vr=z.useMemo(()=>t.find(te=>te.id===l)??null,[t,l]),hh=(te,ae)=>{z0[te].includes(ae)&&qe(de=>{const De=de[te],We=De.action===ae?"none":ae;return{...de,[te]:{...De,action:We}}})},Yu=te=>Array.isArray(te)?te.length===0:te===""||te===null||te===void 0,Ym=(te,ae)=>{qe(de=>{const De=z0[te],We=!Yu(ae)&&de[te].action==="none"&&De.length===1?De[0]:Yu(ae)?"none":de[te].action;return{...de,[te]:{action:We,value:ae}}})},kc=te=>{qe(ae=>({...ae,comment:te}))},Sc=te=>{const ae=z0[te];if(ae.length===0)return null;const de=Ne[te].action;return b.jsx("div",{className:"flex flex-wrap gap-2",role:"group","aria-label":`   ${te}`,children:ae.map(De=>{const We=de===De;return b.jsx("button",{type:"button",onClick:()=>hh(te,De),"data-testid":`matrix-action-${te}-${De}`,className:`px-3 py-1.5 text-xs font-medium border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 ${We?"bg-blue-600 text-white border-blue-600":"border-gray-300 text-gray-600 hover:bg-gray-100"}`,"aria-pressed":We,children:Rf[De]},`${te}-${De}`)})})};z.useEffect(()=>{if(!m)return;if(!vr){g(!1);return}const te=window.setTimeout(()=>g(!1),200);return()=>window.clearTimeout(te)},[vr,m]);const io=()=>{qe(Sv())},_c=()=>{if(!rt){Pe();return}if(a.size===0){Te(" ,    "),gt(null),et("        ."),Ae("     "),Nt(Date.now()+4e3);return}_n(),Te(null),gt(null);const te=()=>tt(!0);typeof window<"u"?window.setTimeout(te,0):te()},ph=()=>{tt(!1),Te(null),io(),vi()},Km=te=>{let ae=null;e(de=>de.map(De=>{if(De.id!==te.id)return De;const We=De.status==="terminated"?De.metadata.previousStatus??"active":De.status,ot=[...De.tasks??[],Ul("   ","system",{createdBy:"agent"})],Rt={...De,status:"terminated",tasks:ot,metadata:{...De.metadata,previousStatus:We,updatedAt:new Date,lastModifiedBy:"agent"}};return ae=Rt,Rt})),o(de=>{if(!de.has(te.id))return de;const De=new Set(de);return De.delete(te.id),De}),ae&&(et(`${ae.personalInfo.lastName} ${ae.personalInfo.firstName}    `),Ae(` ${ae.personalInfo.lastName} ${ae.personalInfo.firstName} `),Nt(Date.now()+4e3)),Sn.current=null,xi.current=null,Sa()},Ku=te=>{let ae=null;e(de=>de.map(De=>{if(De.id!==te.id)return De;const We=De.metadata.previousStatus??"active",ot=[...De.tasks??[],Ul("   ","system",{createdBy:"agent"})],Rt={...De,status:We,tasks:ot,metadata:{...De.metadata,previousStatus:void 0,updatedAt:new Date,lastModifiedBy:"agent"}};return ae=Rt,Rt})),ae&&(et(`${ae.personalInfo.lastName} ${ae.personalInfo.firstName}   `),Ae(` ${ae.personalInfo.lastName} ${ae.personalInfo.firstName} `),Nt(Date.now()+4e3)),Sa()},Xu=z.useMemo(()=>["status","team","hourNorm","workScheme","skills","reserveSkills","tags"].some(ae=>{const de=Ne[ae];return de.action==="none"?!1:Array.isArray(de.value)?(de.action==="remove",de.value.length>0):ae==="workScheme"&&de.action==="remove"?!0:!!de.value}),[Ne]),Zu=te=>{if(te.preventDefault(),a.size===0){Te("  .");return}const ae=Ne.comment.trim();if(!Xu&&!ae){Te("      .");return}if(Ne.status.action!=="none"&&!Ne.status.value){Te("    .");return}let de;if(Ne.team.action!=="none"){if(!Ne.team.value){Te("   .");return}if(de=ge.get(Ne.team.value),!de){Te("    .");return}}let De=null;if(Ne.hourNorm.action!=="none"){if(!Ne.hourNorm.value){Te("  .");return}const tn=Number(Ne.hourNorm.value);if(!Number.isFinite(tn)||tn<=0){Te("     .");return}De=tn}let We=null;if(Ne.workScheme.action==="add"||Ne.workScheme.action==="replace"){if(!Ne.workScheme.value){Te("    .");return}if(We=ke.get(Ne.workScheme.value)??null,!We){Te("     .");return}}const ot=(tn,Dr,kt)=>tn.map(dn=>dn.trim()).filter(dn=>dn.length>0).map(dn=>{const Sr=Array.from(Dr.values()).find(Ln=>Ln.name.toLowerCase()===dn.toLowerCase());return Sr||{id:pq(),name:dn,category:kt,level:3,verified:!1,lastAssessed:new Date,assessor:"agent",certificationRequired:!1}});let Rt=[];if(Ne.skills.action!=="none"){if(Ne.skills.value.length===0){Te("    .");return}Rt=ot(Ne.skills.value,Re,"technical")}let Lt=[];if(Ne.reserveSkills.action!=="none"){if(Ne.reserveSkills.value.length===0){Te("     .");return}Lt=ot(Ne.reserveSkills.value,Ge,"product")}let fr=[];if(Ne.tags.action!=="none"){if(fr=Ne.tags.value.map(tn=>tn.trim()).filter(Boolean),Ne.tags.action==="remove"&&fr.length===0){Te(" ,     .");return}if(Ne.tags.action!=="remove"&&fr.length===0){Te("    .");return}if(Ne.tags.action==="replace"&&fr.length>Ei){Te(`    ${Ei}   .`);return}if(Ne.tags.action==="add"&&St.some(Dr=>new Set([...Dr.tags,...fr]).size>Ei)){Te(`      ${Ei}    .`);return}}e(tn=>tn.map(Dr=>{if(!a.has(Dr.id))return Dr;let kt={...Dr};if(Ne.status.action!=="none"&&(kt={...kt,status:Ne.status.value||Dr.status}),Ne.team.action!=="none"&&de&&(kt={...kt,workInfo:{...kt.workInfo,team:de,department:de.name}}),Ne.hourNorm.action!=="none"&&De!==null&&(kt={...kt,orgPlacement:{...kt.orgPlacement,hourNorm:De}}),Ne.workScheme.action!=="none"&&(Ne.workScheme.action==="remove"?kt={...kt,orgPlacement:{...kt.orgPlacement,workScheme:void 0}}:We&&(kt={...kt,orgPlacement:{...kt.orgPlacement,workScheme:We}})),Ne.skills.action!=="none"&&(kt={...kt,skills:NC(kt.skills,Ne.skills.action,Rt,fn=>fn.name.toLowerCase())}),Ne.reserveSkills.action!=="none"&&(kt={...kt,reserveSkills:NC(kt.reserveSkills,Ne.reserveSkills.action,Lt,fn=>fn.name.toLowerCase())}),Ne.tags.action!=="none"){const fn=kt.tags??[];let dn=fn;if(Ne.tags.action==="add"){const Sr=new Set([...fn,...fr]);dn=Array.from(Sr).slice(0,Ei)}else if(Ne.tags.action==="replace")dn=fr.slice(0,Ei);else if(Ne.tags.action==="remove"){const Sr=new Set(fr);dn=fn.filter(Ln=>!Sr.has(Ln))}kt={...kt,tags:dn}}if(ae){const fn=kt.tasks??[];kt={...kt,tasks:[...fn,Ul(ae,"bulk-edit")]}}return kt={...kt,metadata:{...kt.metadata,updatedAt:new Date,lastModifiedBy:"agent"}},kt})),gt("    ."),Te(null),Ae("     "),Nt(Date.now()+4e3),ph(),Ii({announce:!1})},Sa=()=>{u(null),g(!1),cl()},Xm=te=>{e(ae=>ae.map(de=>de.id===te.id?{...te}:de)),u(te.id)},Ju=te=>{ys(ae=>({...ae,[te]:!ae[te]}))},Zt=(te,ae=Ei)=>te.map(de=>de.trim()).filter(de=>de.length>0).slice(0,ae),mh=()=>{if(a.size===0){E(" ,   ");return}const te=I==="remove"?Zt(oe,Number.POSITIVE_INFINITY):Zt(oe);if(I!=="remove"&&te.length===0){E("        .");return}if(I==="remove"&&te.length===0){E(" ,     .");return}e(ae=>ae.map(de=>{if(!a.has(de.id))return de;const De=[...de.tags];let We=De;if(I==="add"){const ot=[];De.forEach(Rt=>{ot.includes(Rt)||ot.push(Rt)}),te.forEach(Rt=>{!ot.includes(Rt)&&ot.length<Ei&&ot.push(Rt)}),We=ot}else if(I==="replace")We=te;else if(I==="remove"){const ot=new Set(te);We=De.filter(Rt=>!ot.has(Rt))}return{...de,tags:We,metadata:{...de.metadata,updatedAt:new Date,lastModifiedBy:"agent"}}})),E(null),ro()},gh=()=>{const te=fe.trim();if(!te){N("  ");return}if(P[te]){N("   ");return}B(ae=>({...ae,[te]:xe})),se(""),N(null),I!=="remove"&&re(ae=>ae.includes(te)?ae:ae.length>=Ei?(E(`    ${Ei} .`),ae):(E(null),[...ae,te]))},Cc=te=>{re(ae=>{if(ae.includes(te)){const de=ae.filter(De=>De!==te);return O&&E(null),de}return I!=="remove"&&ae.length>=Ei?(E(`    ${Ei} .`),ae):(O&&E(null),[...ae,te])})},Qu=te=>{B(ae=>{if(!ae[te])return ae;const{[te]:de,...De}=ae;return De}),re(ae=>ae.filter(de=>de!==te)),e(ae=>ae.map(de=>de.tags.includes(te)?{...de,tags:de.tags.filter(De=>De!==te),metadata:{...de.metadata,updatedAt:new Date,lastModifiedBy:"agent"}}:de))},xh=te=>{var de;const ae=(de=$t.current)==null?void 0:de.querySelector("button");ae instanceof HTMLElement?Fi.current=ae:_n(),le(te),ue(!1),ze(!1),ul()},vh=te=>{var de;const ae=(de=Mr.current)==null?void 0:de.querySelector("button");ae instanceof HTMLElement?Fi.current=ae:_n(),Ve(te),ze(!1),no()},ef=()=>{var te;q(null),(te=ar.current)==null||te.click()},Ec=te=>{var fn,dn;const ae=te.target,de=(fn=ae.files)==null?void 0:fn[0];if(!de)return;const De=J,We=CC[De],ot=((dn=de.name.split(".").pop())==null?void 0:dn.toLowerCase())??"",Rt=Sr=>{q(Sr),et(Sr),Ae(` : ${De}`),Nt(Date.now()+4e3)},Lt=Sr=>{q(Sr),et(Sr),Ae(`   : ${De}`),Nt(Date.now()+4e3)},fr=()=>{ae.value=""};if(!(We?We.extensions.includes(ot):!0)){const Sr=` ${De}  : ${We.extensions.join(", ")}.   ${de.name} .`;Rt(Sr),fr();return}if(de.size===0){Rt(` ${de.name} .     .`),fr();return}const Dr=TC[De],kt=` ${de.name}    ${De}.    ${(We==null?void 0:We.appendix)??" "}.`;if(Dr&&Dr.length>0){if(ot==="csv"){const Sr=new FileReader;Sr.onload=()=>{const Ln=String(Sr.result??""),{valid:so,missingHeaders:Ys,message:wh}=Fz(Ln,Dr);if(!so){Rt(wh??`  : ${Ys.join(", ")}.`),fr();return}Lt(kt),fr()},Sr.onerror=()=>{Rt(`    ${de.name}.`),fr()},Sr.readAsText(de,"utf-8");return}Iz(de).then(Sr=>{const Ln=Sr.map(Ys=>Ys.toLowerCase()),so=Dr.filter(Ys=>!Ln.includes(Ys.toLowerCase()));if(so.length>0){Rt(`  : ${so.join(", ")}.`);return}Lt(kt)}).catch(()=>{Rt(`    ${de.name}.`)}).finally(()=>{fr()});return}Lt(kt),fr()},Hs=()=>{const te=a.size>0?t.filter(We=>a.has(We.id)):me,ae=(We,ot)=>{const Lt=`${EC[ot]??"employees_export"}_${new Date().toISOString().slice(0,10)}.csv`,fr=new Blob([We],{type:"text/csv;charset=utf-8;"}),tn=URL.createObjectURL(fr),Dr=document.createElement("a");Dr.href=tn,Dr.download=Lt,Dr.click(),URL.revokeObjectURL(tn);const kt=` . : ${ot}.  ${Lt} .`;Ce(kt),et(kt),Ae(` : ${ot}`),Nt(Date.now()+4e3)};if(be===""){const We=Dz(te,ot=>If[ot]);if(!We){Ce("     ."),et("    ."),Ae(" :  "),Nt(Date.now()+4e3);return}ae(We,be);return}if(be===""){const We=Oz(te);if(!We){Ce("      ."),et("    ."),Ae(" :  "),Nt(Date.now()+4e3);return}ae(We,be);return}const de=bv.filter(We=>$s[We.key]),De=Mz(te,de.map(({key:We,label:ot})=>({key:We,label:ot})));ae(De,be)},Ws=z.useMemo(()=>{const{search:te,team:ae,status:de,position:De,orgUnit:We,showInactive:ot}=i;return!!te||!!ae||!!de||!!De||!!We||ot},[i]),Gs=z.useMemo(()=>{const te=[];return i.team&&te.push({label:`: ${i.team}`,onRemove:()=>L("team","")}),i.status&&te.push({label:`: ${If[i.status]}`,onRemove:()=>L("status","")}),i.position&&te.push({label:`: ${i.position}`,onRemove:()=>L("position","")}),i.orgUnit&&te.push({label:`: ${i.orgUnit}`,onRemove:()=>L("orgUnit","")}),i.showInactive&&te.push({label:" ",onRemove:()=>L("showInactive",!1)}),te},[i]),dl=z.useMemo(()=>{const te=new Set;return t.forEach(ae=>{a.has(ae.id)&&ae.tags.forEach(de=>te.add(de))}),Array.from(te).sort((ae,de)=>ae.localeCompare(de,"ru"))},[t,a]),bs=z.useCallback(te=>te.join(", "),[]),qs=z.useMemo(()=>{var tn,Dr;const te=[],{status:ae,team:de,hourNorm:De,workScheme:We,skills:ot,reserveSkills:Rt,tags:Lt,comment:fr}=Ne;if(ae.action!=="none"&&ae.value){const kt=If[ae.value]??ae.value;te.push(`  ${kt}`)}if(de.action!=="none"&&de.value){const kt=((tn=ge.get(de.value))==null?void 0:tn.name)??de.value;te.push(`  ${kt}`)}if(De.action!=="none"&&De.value&&te.push(`   ${De.value}`),We.action==="remove")te.push("   ");else if(We.action!=="none"&&We.value){const kt=((Dr=ke.get(We.value))==null?void 0:Dr.name)??We.value;te.push(`   ${kt}`)}return ot.action!=="none"&&ot.value.length>0&&te.push(`  ${Rf[ot.action]} (${bs(ot.value)})`),Rt.action!=="none"&&Rt.value.length>0&&te.push(`   ${Rf[Rt.action]} (${bs(Rt.value)})`),Lt.action!=="none"&&Lt.value.length>0&&te.push(`  ${Rf[Lt.action]} (${bs(Lt.value)})`),fr.trim()&&te.push("     ."),te},[Ne,bs,ke,ge]),tf=Object.entries(P),yh=()=>tf.length===0?b.jsx("p",{className:"text-sm text-gray-500",children:"     ,   ."}):tf.map(([te,ae])=>{const de=oe.includes(te);return b.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-gray-200 px-3 py-2",children:[b.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700",children:[b.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500",checked:de,onChange:()=>Cc(te)}),b.jsxs("span",{className:"inline-flex items-center gap-2",children:[b.jsx("span",{className:"inline-block w-4 h-4 rounded-sm border border-gray-300",style:{backgroundColor:ae}}),te]})]}),b.jsx("button",{type:"button",onClick:()=>Qu(te),className:"text-gray-400 hover:text-red-600","aria-label":`  ${te}`,children:""})]},te)}),hl=rt?a.size===0?"    ,    ":"  ":"     ";return{employees:t,onEmployeesChange:e,onOpenQuickAdd:r,focusEmployeeId:n,STATUS_LABELS:If,STATUS_BADGE_CLASSES:bC,COLUMN_ORDER:bv,createDefaultFilters:kv,TAG_COLOR_PALETTE:xd,IMPORT_OPTIONS:fq,EXPORT_OPTIONS:dq,IMPORT_CONFIG:CC,EXPORT_FILE_TITLES:EC,IMPORT_REQUIRED_HEADERS:TC,MATRIX_ACTION_LABELS:Rf,MATRIX_ACTIONS:hq,FIELD_ACTION_CONFIG:z0,createInitialBulkEditState:Sv,filters:i,setFilters:s,searchSummary:G,selectedEmployees:a,setSelectedEmployees:o,activeEmployeeId:l,setActiveEmployeeId:u,isInitialLoading:d,setIsInitialLoading:h,isDrawerLoading:m,setIsDrawerLoading:g,showBulkActions:v,setShowBulkActions:x,showFilters:w,setShowFilters:S,showColumnSettings:T,setShowColumnSettings:_,showTagManager:M,setShowTagManager:D,tagError:O,setTagError:E,tagCreationError:A,setTagCreationError:N,tagCatalog:P,setTagCatalog:B,tagAction:I,setTagAction:ee,selectedTagNames:oe,setSelectedTagNames:re,newTagName:fe,setNewTagName:se,newTagColor:xe,setNewTagColor:H,showImportModal:ve,setShowImportModal:W,showExportModal:F,setShowExportModal:X,importFeedback:Z,setImportFeedback:q,exportFeedback:ce,setExportFeedback:Ce,showImportMenu:pe,setShowImportMenu:ue,showExportMenu:Se,setShowExportMenu:ze,isBulkEditOpen:j,setIsBulkEditOpen:tt,bulkEditMatrix:Ne,setBulkEditMatrix:qe,bulkEditError:Le,setBulkEditError:Te,bulkEditSuccess:at,setBulkEditSuccess:gt,importContext:J,setImportContext:le,exportContext:be,setExportContext:Ve,liveMessage:Me,setLiveMessage:Ae,statusNotice:$e,setStatusNotice:et,selectionOverrideExpires:st,setSelectionOverrideExpires:Nt,isSelectionMode:rt,setIsSelectionMode:Tt,importInputRef:ar,importMenuAnchorRef:$t,exportMenuAnchorRef:Mr,filterToggleRef:ba,rowRefs:Pn,drawerReturnFocusRef:xi,drawerReturnFocusIdRef:Sn,lastFocusedControlRef:Fi,toolbarButtonClass:to,toolbarPrimaryButtonClass:Vs,storeFocusedControl:_n,restoreFocusedControl:vi,restoreRowFocus:cl,openColumnSettings:yc,closeColumnSettings:wc,openTagManager:bc,closeTagManager:ro,openImportModal:ul,closeImportModal:ka,openExportModal:no,closeExportModal:vs,columnVisibility:$s,setColumnVisibility:ys,clearSelection:Ii,handleFilterChange:L,handleResetFilters:Y,filteredEmployees:K,sortedEmployees:me,teamOptions:Ee,teamLookup:ge,schemeOptions:ye,schemeLookup:ke,primarySkillCatalog:Re,reserveSkillCatalog:Ge,handleOpenEmployeeDrawer:Ye,toggleEmployeeSelection:Be,enableSelectionMode:Pe,selectedEmployeeList:St,totalCount:or,visibleCount:Ut,handleSelectAll:xr,rowHeight:ws,tableHeight:Us,tableColumns:Ki,getTableRowProps:Hr,allTags:fl,activeEmployee:vr,handleFieldActionToggle:hh,isValueEmpty:Yu,updateMatrixValue:Ym,updateMatrixComment:kc,renderActionButtons:Sc,resetBulkEditState:io,handleOpenBulkEdit:_c,handleBulkEditClose:ph,handleDismissEmployee:Km,handleRestoreEmployee:Ku,hasMatrixChanges:Xu,handleBulkEditSubmit:Zu,handleDrawerClose:Sa,handleDrawerSave:Xm,toggleColumn:Ju,normalizeTagSelection:Zt,handleApplyTags:mh,handleCreateTag:gh,toggleTagSelection:Cc,handleDeleteTagDefinition:Qu,handleImportOptionSelect:xh,handleExportOptionSelect:vh,handleImportClick:ef,handleImportChange:Ec,handleExport:Hs,hasActiveFilters:Ws,activeFilterChips:Gs,selectedTags:dl,joinValues:bs,matrixSummary:qs,tagCatalogEntries:tf,renderTagCatalogList:yh,bulkEditButtonTitle:hl}},gq=({state:t})=>b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"border-b border-gray-200 p-6 space-y-4",children:b.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-center xl:justify-between gap-4",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:""}),b.jsx("p",{className:"text-gray-600",children:"        "})]}),b.jsxs("div",{className:"flex flex-wrap items-center gap-2 justify-end",children:[b.jsxs("button",{type:"button",ref:t.filterToggleRef,onClick:()=>t.setShowFilters(e=>!e),className:t.toolbarButtonClass(),"aria-label":t.showFilters?" ":" ",title:t.showFilters?" ":" ",children:[b.jsx("span",{"aria-hidden":!0,children:t.showFilters?"":""}),b.jsx("span",{children:t.showFilters?" ":" "})]}),b.jsxs("button",{type:"button",onClick:t.handleOpenBulkEdit,disabled:t.isBulkEditOpen,className:t.toolbarButtonClass(t.isBulkEditOpen),"aria-label":t.bulkEditButtonTitle,title:t.bulkEditButtonTitle,"aria-pressed":t.isSelectionMode,"data-testid":"toolbar-bulk-edit",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:" "})]}),b.jsxs("button",{type:"button",onClick:t.openTagManager,className:t.toolbarButtonClass(),"aria-label":" ",title:" ",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:""})]}),b.jsxs("div",{className:"relative",ref:t.importMenuAnchorRef,children:[b.jsxs("button",{type:"button",onClick:()=>{t.setShowImportMenu(e=>!e),t.setShowExportMenu(!1)},className:t.toolbarButtonClass(),"aria-haspopup":"true","aria-expanded":t.showImportMenu,title:"",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:""})]}),t.showImportMenu&&b.jsx("div",{className:"absolute right-0 mt-2 w-52 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:t.IMPORT_OPTIONS.map(e=>b.jsx("button",{type:"button",onClick:()=>t.handleImportOptionSelect(e.label),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:e.label},e.id))})]}),b.jsxs("div",{className:"relative",ref:t.exportMenuAnchorRef,children:[b.jsxs("button",{type:"button",onClick:()=>{t.setShowExportMenu(e=>!e),t.setShowImportMenu(!1)},className:t.toolbarButtonClass(),"aria-haspopup":"true","aria-expanded":t.showExportMenu,title:"",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:""})]}),t.showExportMenu&&b.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:t.EXPORT_OPTIONS.map(e=>b.jsx("button",{type:"button",onClick:()=>t.handleExportOptionSelect(e.label),className:"block w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:e.label},e.id))})]}),b.jsxs("button",{type:"button",onClick:t.openColumnSettings,className:t.toolbarButtonClass(),"aria-label":"  ",title:"  ",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:""})]}),b.jsxs("button",{type:"button",onClick:t.onOpenQuickAdd,className:t.toolbarPrimaryButtonClass,"aria-label":"  ",title:"  ","data-testid":"toolbar-new-employee",children:[b.jsx("span",{"aria-hidden":!0,children:""}),b.jsx("span",{children:" "})]})]})]})}),t.showBulkActions&&b.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg px-4 py-3 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 text-sm text-blue-900",children:[b.jsxs("span",{children:[" : ",t.selectedEmployees.size]}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("button",{type:"button",onClick:t.openExportModal,className:"px-3 py-1 bg-white border border-blue-200 rounded-md text-xs font-medium hover:bg-blue-100 transition-colors",children:""}),b.jsx("button",{type:"button",onClick:t.openTagManager,className:"px-3 py-1 bg-white border border-blue-200 rounded-md text-xs font-medium hover:bg-blue-100 transition-colors",children:" "}),b.jsx("button",{type:"button",onClick:()=>t.clearSelection(),className:"text-xs font-medium text-blue-800 hover:underline",children:""})]})]}),t.bulkEditSuccess&&b.jsx("div",{className:"mx-6 mt-3 rounded-lg border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-800",role:"status",children:t.bulkEditSuccess}),t.statusNotice&&b.jsx("div",{className:"mx-6 mt-3 rounded-lg border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-800",role:"status",children:t.statusNotice}),t.bulkEditError&&!t.isBulkEditOpen&&b.jsx("div",{className:"mx-6 mt-3 rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-800",role:"alert",children:t.bulkEditError})]}),xq=({state:t})=>b.jsxs("div",{className:"flex flex-col gap-3",children:[b.jsx("div",{className:"flex flex-col xl:flex-row xl:items-center xl:justify-between gap-4",children:b.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[b.jsxs("label",{className:"flex items-center gap-2",children:[b.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500",checked:t.filters.showInactive,onChange:e=>t.handleFilterChange("showInactive",e.target.checked)}),b.jsx("span",{children:" "})]}),b.jsxs("span",{children:[t.visibleCount,"/",t.totalCount]}),b.jsx("button",{type:"button",onClick:t.handleResetFilters,disabled:!t.hasActiveFilters,className:`text-sm font-medium ${t.hasActiveFilters?"text-blue-600 hover:underline":"text-gray-400 cursor-default"}`,children:"  "})]})}),t.activeFilterChips.length>0&&b.jsx("div",{className:"flex flex-wrap gap-2",children:t.activeFilterChips.map(e=>b.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs bg-blue-50 text-blue-700 border border-blue-100",children:[e.label,b.jsx("button",{type:"button",onClick:e.onRemove,className:"text-blue-600 hover:text-blue-800","aria-label":`  ${e.label}`,children:""})]},e.label))}),t.showFilters&&b.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[b.jsxs("div",{className:"md:col-span-2",children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsx("input",{type:"text",value:t.filters.search,onChange:e=>t.handleFilterChange("search",e.target.value),placeholder:", , ","data-testid":"employee-search-input",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.filters.search.trim()&&b.jsx("p",{className:"mt-1 text-xs text-gray-500",role:"status","aria-live":"polite","data-testid":"employee-search-summary",children:t.searchSummary?`: ${t.searchSummary.ids.size}`:": 0"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsxs("select",{value:t.filters.team,onChange:e=>t.handleFilterChange("team",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),Array.from(new Map(t.employees.map(e=>[e.workInfo.team.id,e.workInfo.team])).values()).map(e=>b.jsx("option",{value:e.id,children:e.name},e.id))]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsxs("select",{value:t.filters.status,onChange:e=>t.handleFilterChange("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),Object.entries(t.STATUS_LABELS).map(([e,r])=>b.jsx("option",{value:e,children:r},e))]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsx("input",{type:"text",value:t.filters.position,onChange:e=>t.handleFilterChange("position",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:" "}),b.jsx("input",{type:"text",value:t.filters.orgUnit,onChange:e=>t.handleFilterChange("orgUnit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsxs("select",{value:t.filters.sortBy,onChange:e=>t.handleFilterChange("sortBy",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"name",children:""}),b.jsx("option",{value:"position",children:""}),b.jsx("option",{value:"team",children:""}),b.jsx("option",{value:"hireDate",children:" "}),b.jsx("option",{value:"performance",children:" "})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-semibold uppercase text-gray-500 mb-1",children:""}),b.jsxs("select",{value:t.filters.sortOrder,onChange:e=>t.handleFilterChange("sortOrder",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"asc",children:""}),b.jsx("option",{value:"desc",children:""})]})]})]})})]});/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Lo(t,e){return typeof t=="function"?t(e):t}function Yi(t,e){return r=>{e.setState(n=>({...n,[t]:Lo(r,n[t])}))}}function Bm(t){return t instanceof Function}function vq(t){return Array.isArray(t)&&t.every(e=>typeof e=="number")}function yq(t,e){const r=[],n=i=>{i.forEach(s=>{r.push(s);const a=e(s);a!=null&&a.length&&n(a)})};return n(t),r}function _t(t,e,r){let n=[],i;return s=>{let a;r.key&&r.debug&&(a=Date.now());const o=t(s);if(!(o.length!==n.length||o.some((d,h)=>n[h]!==d)))return i;n=o;let u;if(r.key&&r.debug&&(u=Date.now()),i=e(...o),r==null||r.onChange==null||r.onChange(i),r.key&&r.debug&&r!=null&&r.debug()){const d=Math.round((Date.now()-a)*100)/100,h=Math.round((Date.now()-u)*100)/100,m=h/16,g=(v,x)=>{for(v=String(v);v.length<x;)v=" "+v;return v};console.info(`%c ${g(h,5)} /${g(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*m,120))}deg 100% 31%);`,r==null?void 0:r.key)}return i}}function Ct(t,e,r,n){return{debug:()=>{var i;return(i=t==null?void 0:t.debugAll)!=null?i:t[e]},key:!1,onChange:n}}function wq(t,e,r,n){const i=()=>{var a;return(a=s.getValue())!=null?a:t.options.renderFallbackValue},s={id:`${e.id}_${r.id}`,row:e,column:r,getValue:()=>e.getValue(n),renderValue:i,getContext:_t(()=>[t,r,e,s],(a,o,l,u)=>({table:a,column:o,row:l,cell:u,getValue:u.getValue,renderValue:u.renderValue}),Ct(t.options,"debugCells"))};return t._features.forEach(a=>{a.createCell==null||a.createCell(s,r,e,t)},{}),s}function bq(t,e,r,n){var i,s;const o={...t._getDefaultColumnDef(),...e},l=o.accessorKey;let u=(i=(s=o.id)!=null?s:l?typeof String.prototype.replaceAll=="function"?l.replaceAll(".","_"):l.replace(/\./g,"_"):void 0)!=null?i:typeof o.header=="string"?o.header:void 0,d;if(o.accessorFn?d=o.accessorFn:l&&(l.includes(".")?d=m=>{let g=m;for(const x of l.split(".")){var v;g=(v=g)==null?void 0:v[x]}return g}:d=m=>m[o.accessorKey]),!u)throw new Error;let h={id:`${String(u)}`,accessorFn:d,parent:n,depth:r,columnDef:o,columns:[],getFlatColumns:_t(()=>[!0],()=>{var m;return[h,...(m=h.columns)==null?void 0:m.flatMap(g=>g.getFlatColumns())]},Ct(t.options,"debugColumns")),getLeafColumns:_t(()=>[t._getOrderColumnsFn()],m=>{var g;if((g=h.columns)!=null&&g.length){let v=h.columns.flatMap(x=>x.getLeafColumns());return m(v)}return[h]},Ct(t.options,"debugColumns"))};for(const m of t._features)m.createColumn==null||m.createColumn(h,t);return h}const Un="debugHeaders";function MC(t,e,r){var n;let s={id:(n=r.id)!=null?n:e.id,column:e,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const a=[],o=l=>{l.subHeaders&&l.subHeaders.length&&l.subHeaders.map(o),a.push(l)};return o(s),a},getContext:()=>({table:t,header:s,column:e})};return t._features.forEach(a=>{a.createHeader==null||a.createHeader(s,t)}),s}const kq={createTable:t=>{t.getHeaderGroups=_t(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,r,n,i)=>{var s,a;const o=(s=n==null?void 0:n.map(h=>r.find(m=>m.id===h)).filter(Boolean))!=null?s:[],l=(a=i==null?void 0:i.map(h=>r.find(m=>m.id===h)).filter(Boolean))!=null?a:[],u=r.filter(h=>!(n!=null&&n.includes(h.id))&&!(i!=null&&i.includes(h.id)));return V0(e,[...o,...u,...l],t)},Ct(t.options,Un)),t.getCenterHeaderGroups=_t(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,r,n,i)=>(r=r.filter(s=>!(n!=null&&n.includes(s.id))&&!(i!=null&&i.includes(s.id))),V0(e,r,t,"center")),Ct(t.options,Un)),t.getLeftHeaderGroups=_t(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.left],(e,r,n)=>{var i;const s=(i=n==null?void 0:n.map(a=>r.find(o=>o.id===a)).filter(Boolean))!=null?i:[];return V0(e,s,t,"left")},Ct(t.options,Un)),t.getRightHeaderGroups=_t(()=>[t.getAllColumns(),t.getVisibleLeafColumns(),t.getState().columnPinning.right],(e,r,n)=>{var i;const s=(i=n==null?void 0:n.map(a=>r.find(o=>o.id===a)).filter(Boolean))!=null?i:[];return V0(e,s,t,"right")},Ct(t.options,Un)),t.getFooterGroups=_t(()=>[t.getHeaderGroups()],e=>[...e].reverse(),Ct(t.options,Un)),t.getLeftFooterGroups=_t(()=>[t.getLeftHeaderGroups()],e=>[...e].reverse(),Ct(t.options,Un)),t.getCenterFooterGroups=_t(()=>[t.getCenterHeaderGroups()],e=>[...e].reverse(),Ct(t.options,Un)),t.getRightFooterGroups=_t(()=>[t.getRightHeaderGroups()],e=>[...e].reverse(),Ct(t.options,Un)),t.getFlatHeaders=_t(()=>[t.getHeaderGroups()],e=>e.map(r=>r.headers).flat(),Ct(t.options,Un)),t.getLeftFlatHeaders=_t(()=>[t.getLeftHeaderGroups()],e=>e.map(r=>r.headers).flat(),Ct(t.options,Un)),t.getCenterFlatHeaders=_t(()=>[t.getCenterHeaderGroups()],e=>e.map(r=>r.headers).flat(),Ct(t.options,Un)),t.getRightFlatHeaders=_t(()=>[t.getRightHeaderGroups()],e=>e.map(r=>r.headers).flat(),Ct(t.options,Un)),t.getCenterLeafHeaders=_t(()=>[t.getCenterFlatHeaders()],e=>e.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Ct(t.options,Un)),t.getLeftLeafHeaders=_t(()=>[t.getLeftFlatHeaders()],e=>e.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Ct(t.options,Un)),t.getRightLeafHeaders=_t(()=>[t.getRightFlatHeaders()],e=>e.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Ct(t.options,Un)),t.getLeafHeaders=_t(()=>[t.getLeftHeaderGroups(),t.getCenterHeaderGroups(),t.getRightHeaderGroups()],(e,r,n)=>{var i,s,a,o,l,u;return[...(i=(s=e[0])==null?void 0:s.headers)!=null?i:[],...(a=(o=r[0])==null?void 0:o.headers)!=null?a:[],...(l=(u=n[0])==null?void 0:u.headers)!=null?l:[]].map(d=>d.getLeafHeaders()).flat()},Ct(t.options,Un))}};function V0(t,e,r,n){var i,s;let a=0;const o=function(m,g){g===void 0&&(g=1),a=Math.max(a,g),m.filter(v=>v.getIsVisible()).forEach(v=>{var x;(x=v.columns)!=null&&x.length&&o(v.columns,g+1)},0)};o(t);let l=[];const u=(m,g)=>{const v={depth:g,id:[n,`${g}`].filter(Boolean).join("_"),headers:[]},x=[];m.forEach(w=>{const S=[...x].reverse()[0],T=w.column.depth===v.depth;let _,M=!1;if(T&&w.column.parent?_=w.column.parent:(_=w.column,M=!0),S&&(S==null?void 0:S.column)===_)S.subHeaders.push(w);else{const D=MC(r,_,{id:[n,g,_.id,w==null?void 0:w.id].filter(Boolean).join("_"),isPlaceholder:M,placeholderId:M?`${x.filter(O=>O.column===_).length}`:void 0,depth:g,index:x.length});D.subHeaders.push(w),x.push(D)}v.headers.push(w),w.headerGroup=v}),l.push(v),g>0&&u(x,g-1)},d=e.map((m,g)=>MC(r,m,{depth:a,index:g}));u(d,a-1),l.reverse();const h=m=>m.filter(v=>v.column.getIsVisible()).map(v=>{let x=0,w=0,S=[0];v.subHeaders&&v.subHeaders.length?(S=[],h(v.subHeaders).forEach(_=>{let{colSpan:M,rowSpan:D}=_;x+=M,S.push(D)})):x=1;const T=Math.min(...S);return w=w+T,v.colSpan=x,v.rowSpan=w,{colSpan:x,rowSpan:w}});return h((i=(s=l[0])==null?void 0:s.headers)!=null?i:[]),l}const Sq=(t,e,r,n,i,s,a)=>{let o={id:e,index:n,original:r,depth:i,parentId:a,_valuesCache:{},_uniqueValuesCache:{},getValue:l=>{if(o._valuesCache.hasOwnProperty(l))return o._valuesCache[l];const u=t.getColumn(l);if(u!=null&&u.accessorFn)return o._valuesCache[l]=u.accessorFn(o.original,n),o._valuesCache[l]},getUniqueValues:l=>{if(o._uniqueValuesCache.hasOwnProperty(l))return o._uniqueValuesCache[l];const u=t.getColumn(l);if(u!=null&&u.accessorFn)return u.columnDef.getUniqueValues?(o._uniqueValuesCache[l]=u.columnDef.getUniqueValues(o.original,n),o._uniqueValuesCache[l]):(o._uniqueValuesCache[l]=[o.getValue(l)],o._uniqueValuesCache[l])},renderValue:l=>{var u;return(u=o.getValue(l))!=null?u:t.options.renderFallbackValue},subRows:[],getLeafRows:()=>yq(o.subRows,l=>l.subRows),getParentRow:()=>o.parentId?t.getRow(o.parentId,!0):void 0,getParentRows:()=>{let l=[],u=o;for(;;){const d=u.getParentRow();if(!d)break;l.push(d),u=d}return l.reverse()},getAllCells:_t(()=>[t.getAllLeafColumns()],l=>l.map(u=>wq(t,o,u,u.id)),Ct(t.options,"debugRows")),_getAllCellsByColumnId:_t(()=>[o.getAllCells()],l=>l.reduce((u,d)=>(u[d.column.id]=d,u),{}),Ct(t.options,"debugRows"))};for(let l=0;l<t._features.length;l++){const u=t._features[l];u==null||u.createRow==null||u.createRow(o,t)}return o},_q={createColumn:(t,e)=>{t._getFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,t.id),t.getFacetedRowModel=()=>t._getFacetedRowModel?t._getFacetedRowModel():e.getPreFilteredRowModel(),t._getFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,t.id),t.getFacetedUniqueValues=()=>t._getFacetedUniqueValues?t._getFacetedUniqueValues():new Map,t._getFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,t.id),t.getFacetedMinMaxValues=()=>{if(t._getFacetedMinMaxValues)return t._getFacetedMinMaxValues()}}},ZD=(t,e,r)=>{var n,i;const s=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((i=t.getValue(e))==null||(i=i.toString())==null||(i=i.toLowerCase())==null)&&i.includes(s))};ZD.autoRemove=t=>Ls(t);const JD=(t,e,r)=>{var n;return!!(!((n=t.getValue(e))==null||(n=n.toString())==null)&&n.includes(r))};JD.autoRemove=t=>Ls(t);const QD=(t,e,r)=>{var n;return((n=t.getValue(e))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};QD.autoRemove=t=>Ls(t);const eO=(t,e,r)=>{var n;return(n=t.getValue(e))==null?void 0:n.includes(r)};eO.autoRemove=t=>Ls(t);const tO=(t,e,r)=>!r.some(n=>{var i;return!((i=t.getValue(e))!=null&&i.includes(n))});tO.autoRemove=t=>Ls(t)||!(t!=null&&t.length);const rO=(t,e,r)=>r.some(n=>{var i;return(i=t.getValue(e))==null?void 0:i.includes(n)});rO.autoRemove=t=>Ls(t)||!(t!=null&&t.length);const nO=(t,e,r)=>t.getValue(e)===r;nO.autoRemove=t=>Ls(t);const iO=(t,e,r)=>t.getValue(e)==r;iO.autoRemove=t=>Ls(t);const kw=(t,e,r)=>{let[n,i]=r;const s=t.getValue(e);return s>=n&&s<=i};kw.resolveFilterValue=t=>{let[e,r]=t,n=typeof e!="number"?parseFloat(e):e,i=typeof r!="number"?parseFloat(r):r,s=e===null||Number.isNaN(n)?-1/0:n,a=r===null||Number.isNaN(i)?1/0:i;if(s>a){const o=s;s=a,a=o}return[s,a]};kw.autoRemove=t=>Ls(t)||Ls(t[0])&&Ls(t[1]);const ja={includesString:ZD,includesStringSensitive:JD,equalsString:QD,arrIncludes:eO,arrIncludesAll:tO,arrIncludesSome:rO,equals:nO,weakEquals:iO,inNumberRange:kw};function Ls(t){return t==null||t===""}const Cq={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:t=>({columnFilters:[],...t}),getDefaultOptions:t=>({onColumnFiltersChange:Yi("columnFilters",t),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(t,e)=>{t.getAutoFilterFn=()=>{const r=e.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(t.id);return typeof n=="string"?ja.includesString:typeof n=="number"?ja.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?ja.equals:Array.isArray(n)?ja.arrIncludes:ja.weakEquals},t.getFilterFn=()=>{var r,n;return Bm(t.columnDef.filterFn)?t.columnDef.filterFn:t.columnDef.filterFn==="auto"?t.getAutoFilterFn():(r=(n=e.options.filterFns)==null?void 0:n[t.columnDef.filterFn])!=null?r:ja[t.columnDef.filterFn]},t.getCanFilter=()=>{var r,n,i;return((r=t.columnDef.enableColumnFilter)!=null?r:!0)&&((n=e.options.enableColumnFilters)!=null?n:!0)&&((i=e.options.enableFilters)!=null?i:!0)&&!!t.accessorFn},t.getIsFiltered=()=>t.getFilterIndex()>-1,t.getFilterValue=()=>{var r;return(r=e.getState().columnFilters)==null||(r=r.find(n=>n.id===t.id))==null?void 0:r.value},t.getFilterIndex=()=>{var r,n;return(r=(n=e.getState().columnFilters)==null?void 0:n.findIndex(i=>i.id===t.id))!=null?r:-1},t.setFilterValue=r=>{e.setColumnFilters(n=>{const i=t.getFilterFn(),s=n==null?void 0:n.find(d=>d.id===t.id),a=Lo(r,s?s.value:void 0);if(DC(i,a,t)){var o;return(o=n==null?void 0:n.filter(d=>d.id!==t.id))!=null?o:[]}const l={id:t.id,value:a};if(s){var u;return(u=n==null?void 0:n.map(d=>d.id===t.id?l:d))!=null?u:[]}return n!=null&&n.length?[...n,l]:[l]})}},createRow:(t,e)=>{t.columnFilters={},t.columnFiltersMeta={}},createTable:t=>{t.setColumnFilters=e=>{const r=t.getAllLeafColumns(),n=i=>{var s;return(s=Lo(e,i))==null?void 0:s.filter(a=>{const o=r.find(l=>l.id===a.id);if(o){const l=o.getFilterFn();if(DC(l,a.value,o))return!1}return!0})};t.options.onColumnFiltersChange==null||t.options.onColumnFiltersChange(n)},t.resetColumnFilters=e=>{var r,n;t.setColumnFilters(e?[]:(r=(n=t.initialState)==null?void 0:n.columnFilters)!=null?r:[])},t.getPreFilteredRowModel=()=>t.getCoreRowModel(),t.getFilteredRowModel=()=>(!t._getFilteredRowModel&&t.options.getFilteredRowModel&&(t._getFilteredRowModel=t.options.getFilteredRowModel(t)),t.options.manualFiltering||!t._getFilteredRowModel?t.getPreFilteredRowModel():t._getFilteredRowModel())}};function DC(t,e,r){return(t&&t.autoRemove?t.autoRemove(e,r):!1)||typeof e>"u"||typeof e=="string"&&!e}const Eq=(t,e,r)=>r.reduce((n,i)=>{const s=i.getValue(t);return n+(typeof s=="number"?s:0)},0),Tq=(t,e,r)=>{let n;return r.forEach(i=>{const s=i.getValue(t);s!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}),n},Aq=(t,e,r)=>{let n;return r.forEach(i=>{const s=i.getValue(t);s!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}),n},Nq=(t,e,r)=>{let n,i;return r.forEach(s=>{const a=s.getValue(t);a!=null&&(n===void 0?a>=a&&(n=i=a):(n>a&&(n=a),i<a&&(i=a)))}),[n,i]},Mq=(t,e)=>{let r=0,n=0;if(e.forEach(i=>{let s=i.getValue(t);s!=null&&(s=+s)>=s&&(++r,n+=s)}),r)return n/r},Dq=(t,e)=>{if(!e.length)return;const r=e.map(s=>s.getValue(t));if(!vq(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),i=r.sort((s,a)=>s-a);return r.length%2!==0?i[n]:(i[n-1]+i[n])/2},Oq=(t,e)=>Array.from(new Set(e.map(r=>r.getValue(t))).values()),Fq=(t,e)=>new Set(e.map(r=>r.getValue(t))).size,Iq=(t,e)=>e.length,_v={sum:Eq,min:Tq,max:Aq,extent:Nq,mean:Mq,median:Dq,unique:Oq,uniqueCount:Fq,count:Iq},Rq={getDefaultColumnDef:()=>({aggregatedCell:t=>{var e,r;return(e=(r=t.getValue())==null||r.toString==null?void 0:r.toString())!=null?e:null},aggregationFn:"auto"}),getInitialState:t=>({grouping:[],...t}),getDefaultOptions:t=>({onGroupingChange:Yi("grouping",t),groupedColumnMode:"reorder"}),createColumn:(t,e)=>{t.toggleGrouping=()=>{e.setGrouping(r=>r!=null&&r.includes(t.id)?r.filter(n=>n!==t.id):[...r??[],t.id])},t.getCanGroup=()=>{var r,n;return((r=t.columnDef.enableGrouping)!=null?r:!0)&&((n=e.options.enableGrouping)!=null?n:!0)&&(!!t.accessorFn||!!t.columnDef.getGroupingValue)},t.getIsGrouped=()=>{var r;return(r=e.getState().grouping)==null?void 0:r.includes(t.id)},t.getGroupedIndex=()=>{var r;return(r=e.getState().grouping)==null?void 0:r.indexOf(t.id)},t.getToggleGroupingHandler=()=>{const r=t.getCanGroup();return()=>{r&&t.toggleGrouping()}},t.getAutoAggregationFn=()=>{const r=e.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(t.id);if(typeof n=="number")return _v.sum;if(Object.prototype.toString.call(n)==="[object Date]")return _v.extent},t.getAggregationFn=()=>{var r,n;if(!t)throw new Error;return Bm(t.columnDef.aggregationFn)?t.columnDef.aggregationFn:t.columnDef.aggregationFn==="auto"?t.getAutoAggregationFn():(r=(n=e.options.aggregationFns)==null?void 0:n[t.columnDef.aggregationFn])!=null?r:_v[t.columnDef.aggregationFn]}},createTable:t=>{t.setGrouping=e=>t.options.onGroupingChange==null?void 0:t.options.onGroupingChange(e),t.resetGrouping=e=>{var r,n;t.setGrouping(e?[]:(r=(n=t.initialState)==null?void 0:n.grouping)!=null?r:[])},t.getPreGroupedRowModel=()=>t.getFilteredRowModel(),t.getGroupedRowModel=()=>(!t._getGroupedRowModel&&t.options.getGroupedRowModel&&(t._getGroupedRowModel=t.options.getGroupedRowModel(t)),t.options.manualGrouping||!t._getGroupedRowModel?t.getPreGroupedRowModel():t._getGroupedRowModel())},createRow:(t,e)=>{t.getIsGrouped=()=>!!t.groupingColumnId,t.getGroupingValue=r=>{if(t._groupingValuesCache.hasOwnProperty(r))return t._groupingValuesCache[r];const n=e.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(t._groupingValuesCache[r]=n.columnDef.getGroupingValue(t.original),t._groupingValuesCache[r]):t.getValue(r)},t._groupingValuesCache={}},createCell:(t,e,r,n)=>{t.getIsGrouped=()=>e.getIsGrouped()&&e.id===r.groupingColumnId,t.getIsPlaceholder=()=>!t.getIsGrouped()&&e.getIsGrouped(),t.getIsAggregated=()=>{var i;return!t.getIsGrouped()&&!t.getIsPlaceholder()&&!!((i=r.subRows)!=null&&i.length)}}};function Pq(t,e,r){if(!(e!=null&&e.length)||!r)return t;const n=t.filter(s=>!e.includes(s.id));return r==="remove"?n:[...e.map(s=>t.find(a=>a.id===s)).filter(Boolean),...n]}const Lq={getInitialState:t=>({columnOrder:[],...t}),getDefaultOptions:t=>({onColumnOrderChange:Yi("columnOrder",t)}),createColumn:(t,e)=>{t.getIndex=_t(r=>[vd(e,r)],r=>r.findIndex(n=>n.id===t.id),Ct(e.options,"debugColumns")),t.getIsFirstColumn=r=>{var n;return((n=vd(e,r)[0])==null?void 0:n.id)===t.id},t.getIsLastColumn=r=>{var n;const i=vd(e,r);return((n=i[i.length-1])==null?void 0:n.id)===t.id}},createTable:t=>{t.setColumnOrder=e=>t.options.onColumnOrderChange==null?void 0:t.options.onColumnOrderChange(e),t.resetColumnOrder=e=>{var r;t.setColumnOrder(e?[]:(r=t.initialState.columnOrder)!=null?r:[])},t._getOrderColumnsFn=_t(()=>[t.getState().columnOrder,t.getState().grouping,t.options.groupedColumnMode],(e,r,n)=>i=>{let s=[];if(!(e!=null&&e.length))s=i;else{const a=[...e],o=[...i];for(;o.length&&a.length;){const l=a.shift(),u=o.findIndex(d=>d.id===l);u>-1&&s.push(o.splice(u,1)[0])}s=[...s,...o]}return Pq(s,r,n)},Ct(t.options,"debugTable"))}},Cv=()=>({left:[],right:[]}),Bq={getInitialState:t=>({columnPinning:Cv(),...t}),getDefaultOptions:t=>({onColumnPinningChange:Yi("columnPinning",t)}),createColumn:(t,e)=>{t.pin=r=>{const n=t.getLeafColumns().map(i=>i.id).filter(Boolean);e.setColumnPinning(i=>{var s,a;if(r==="right"){var o,l;return{left:((o=i==null?void 0:i.left)!=null?o:[]).filter(h=>!(n!=null&&n.includes(h))),right:[...((l=i==null?void 0:i.right)!=null?l:[]).filter(h=>!(n!=null&&n.includes(h))),...n]}}if(r==="left"){var u,d;return{left:[...((u=i==null?void 0:i.left)!=null?u:[]).filter(h=>!(n!=null&&n.includes(h))),...n],right:((d=i==null?void 0:i.right)!=null?d:[]).filter(h=>!(n!=null&&n.includes(h)))}}return{left:((s=i==null?void 0:i.left)!=null?s:[]).filter(h=>!(n!=null&&n.includes(h))),right:((a=i==null?void 0:i.right)!=null?a:[]).filter(h=>!(n!=null&&n.includes(h)))}})},t.getCanPin=()=>t.getLeafColumns().some(n=>{var i,s,a;return((i=n.columnDef.enablePinning)!=null?i:!0)&&((s=(a=e.options.enableColumnPinning)!=null?a:e.options.enablePinning)!=null?s:!0)}),t.getIsPinned=()=>{const r=t.getLeafColumns().map(o=>o.id),{left:n,right:i}=e.getState().columnPinning,s=r.some(o=>n==null?void 0:n.includes(o)),a=r.some(o=>i==null?void 0:i.includes(o));return s?"left":a?"right":!1},t.getPinnedIndex=()=>{var r,n;const i=t.getIsPinned();return i?(r=(n=e.getState().columnPinning)==null||(n=n[i])==null?void 0:n.indexOf(t.id))!=null?r:-1:0}},createRow:(t,e)=>{t.getCenterVisibleCells=_t(()=>[t._getAllVisibleCells(),e.getState().columnPinning.left,e.getState().columnPinning.right],(r,n,i)=>{const s=[...n??[],...i??[]];return r.filter(a=>!s.includes(a.column.id))},Ct(e.options,"debugRows")),t.getLeftVisibleCells=_t(()=>[t._getAllVisibleCells(),e.getState().columnPinning.left],(r,n)=>(n??[]).map(s=>r.find(a=>a.column.id===s)).filter(Boolean).map(s=>({...s,position:"left"})),Ct(e.options,"debugRows")),t.getRightVisibleCells=_t(()=>[t._getAllVisibleCells(),e.getState().columnPinning.right],(r,n)=>(n??[]).map(s=>r.find(a=>a.column.id===s)).filter(Boolean).map(s=>({...s,position:"right"})),Ct(e.options,"debugRows"))},createTable:t=>{t.setColumnPinning=e=>t.options.onColumnPinningChange==null?void 0:t.options.onColumnPinningChange(e),t.resetColumnPinning=e=>{var r,n;return t.setColumnPinning(e?Cv():(r=(n=t.initialState)==null?void 0:n.columnPinning)!=null?r:Cv())},t.getIsSomeColumnsPinned=e=>{var r;const n=t.getState().columnPinning;if(!e){var i,s;return!!((i=n.left)!=null&&i.length||(s=n.right)!=null&&s.length)}return!!((r=n[e])!=null&&r.length)},t.getLeftLeafColumns=_t(()=>[t.getAllLeafColumns(),t.getState().columnPinning.left],(e,r)=>(r??[]).map(n=>e.find(i=>i.id===n)).filter(Boolean),Ct(t.options,"debugColumns")),t.getRightLeafColumns=_t(()=>[t.getAllLeafColumns(),t.getState().columnPinning.right],(e,r)=>(r??[]).map(n=>e.find(i=>i.id===n)).filter(Boolean),Ct(t.options,"debugColumns")),t.getCenterLeafColumns=_t(()=>[t.getAllLeafColumns(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,r,n)=>{const i=[...r??[],...n??[]];return e.filter(s=>!i.includes(s.id))},Ct(t.options,"debugColumns"))}};function jq(t){return t||(typeof document<"u"?document:null)}const $0={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Ev=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),zq={getDefaultColumnDef:()=>$0,getInitialState:t=>({columnSizing:{},columnSizingInfo:Ev(),...t}),getDefaultOptions:t=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Yi("columnSizing",t),onColumnSizingInfoChange:Yi("columnSizingInfo",t)}),createColumn:(t,e)=>{t.getSize=()=>{var r,n,i;const s=e.getState().columnSizing[t.id];return Math.min(Math.max((r=t.columnDef.minSize)!=null?r:$0.minSize,(n=s??t.columnDef.size)!=null?n:$0.size),(i=t.columnDef.maxSize)!=null?i:$0.maxSize)},t.getStart=_t(r=>[r,vd(e,r),e.getState().columnSizing],(r,n)=>n.slice(0,t.getIndex(r)).reduce((i,s)=>i+s.getSize(),0),Ct(e.options,"debugColumns")),t.getAfter=_t(r=>[r,vd(e,r),e.getState().columnSizing],(r,n)=>n.slice(t.getIndex(r)+1).reduce((i,s)=>i+s.getSize(),0),Ct(e.options,"debugColumns")),t.resetSize=()=>{e.setColumnSizing(r=>{let{[t.id]:n,...i}=r;return i})},t.getCanResize=()=>{var r,n;return((r=t.columnDef.enableResizing)!=null?r:!0)&&((n=e.options.enableColumnResizing)!=null?n:!0)},t.getIsResizing=()=>e.getState().columnSizingInfo.isResizingColumn===t.id},createHeader:(t,e)=>{t.getSize=()=>{let r=0;const n=i=>{if(i.subHeaders.length)i.subHeaders.forEach(n);else{var s;r+=(s=i.column.getSize())!=null?s:0}};return n(t),r},t.getStart=()=>{if(t.index>0){const r=t.headerGroup.headers[t.index-1];return r.getStart()+r.getSize()}return 0},t.getResizeHandler=r=>{const n=e.getColumn(t.column.id),i=n==null?void 0:n.getCanResize();return s=>{if(!n||!i||(s.persist==null||s.persist(),Tv(s)&&s.touches&&s.touches.length>1))return;const a=t.getSize(),o=t?t.getLeafHeaders().map(S=>[S.column.id,S.column.getSize()]):[[n.id,n.getSize()]],l=Tv(s)?Math.round(s.touches[0].clientX):s.clientX,u={},d=(S,T)=>{typeof T=="number"&&(e.setColumnSizingInfo(_=>{var M,D;const O=e.options.columnResizeDirection==="rtl"?-1:1,E=(T-((M=_==null?void 0:_.startOffset)!=null?M:0))*O,A=Math.max(E/((D=_==null?void 0:_.startSize)!=null?D:0),-.999999);return _.columnSizingStart.forEach(N=>{let[P,B]=N;u[P]=Math.round(Math.max(B+B*A,0)*100)/100}),{..._,deltaOffset:E,deltaPercentage:A}}),(e.options.columnResizeMode==="onChange"||S==="end")&&e.setColumnSizing(_=>({..._,...u})))},h=S=>d("move",S),m=S=>{d("end",S),e.setColumnSizingInfo(T=>({...T,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},g=jq(r),v={moveHandler:S=>h(S.clientX),upHandler:S=>{g==null||g.removeEventListener("mousemove",v.moveHandler),g==null||g.removeEventListener("mouseup",v.upHandler),m(S.clientX)}},x={moveHandler:S=>(S.cancelable&&(S.preventDefault(),S.stopPropagation()),h(S.touches[0].clientX),!1),upHandler:S=>{var T;g==null||g.removeEventListener("touchmove",x.moveHandler),g==null||g.removeEventListener("touchend",x.upHandler),S.cancelable&&(S.preventDefault(),S.stopPropagation()),m((T=S.touches[0])==null?void 0:T.clientX)}},w=Vq()?{passive:!1}:!1;Tv(s)?(g==null||g.addEventListener("touchmove",x.moveHandler,w),g==null||g.addEventListener("touchend",x.upHandler,w)):(g==null||g.addEventListener("mousemove",v.moveHandler,w),g==null||g.addEventListener("mouseup",v.upHandler,w)),e.setColumnSizingInfo(S=>({...S,startOffset:l,startSize:a,deltaOffset:0,deltaPercentage:0,columnSizingStart:o,isResizingColumn:n.id}))}}},createTable:t=>{t.setColumnSizing=e=>t.options.onColumnSizingChange==null?void 0:t.options.onColumnSizingChange(e),t.setColumnSizingInfo=e=>t.options.onColumnSizingInfoChange==null?void 0:t.options.onColumnSizingInfoChange(e),t.resetColumnSizing=e=>{var r;t.setColumnSizing(e?{}:(r=t.initialState.columnSizing)!=null?r:{})},t.resetHeaderSizeInfo=e=>{var r;t.setColumnSizingInfo(e?Ev():(r=t.initialState.columnSizingInfo)!=null?r:Ev())},t.getTotalSize=()=>{var e,r;return(e=(r=t.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,i)=>n+i.getSize(),0))!=null?e:0},t.getLeftTotalSize=()=>{var e,r;return(e=(r=t.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,i)=>n+i.getSize(),0))!=null?e:0},t.getCenterTotalSize=()=>{var e,r;return(e=(r=t.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,i)=>n+i.getSize(),0))!=null?e:0},t.getRightTotalSize=()=>{var e,r;return(e=(r=t.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,i)=>n+i.getSize(),0))!=null?e:0}}};let U0=null;function Vq(){if(typeof U0=="boolean")return U0;let t=!1;try{const e={get passive(){return t=!0,!1}},r=()=>{};window.addEventListener("test",r,e),window.removeEventListener("test",r)}catch{t=!1}return U0=t,U0}function Tv(t){return t.type==="touchstart"}const $q={getInitialState:t=>({columnVisibility:{},...t}),getDefaultOptions:t=>({onColumnVisibilityChange:Yi("columnVisibility",t)}),createColumn:(t,e)=>{t.toggleVisibility=r=>{t.getCanHide()&&e.setColumnVisibility(n=>({...n,[t.id]:r??!t.getIsVisible()}))},t.getIsVisible=()=>{var r,n;const i=t.columns;return(r=i.length?i.some(s=>s.getIsVisible()):(n=e.getState().columnVisibility)==null?void 0:n[t.id])!=null?r:!0},t.getCanHide=()=>{var r,n;return((r=t.columnDef.enableHiding)!=null?r:!0)&&((n=e.options.enableHiding)!=null?n:!0)},t.getToggleVisibilityHandler=()=>r=>{t.toggleVisibility==null||t.toggleVisibility(r.target.checked)}},createRow:(t,e)=>{t._getAllVisibleCells=_t(()=>[t.getAllCells(),e.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),Ct(e.options,"debugRows")),t.getVisibleCells=_t(()=>[t.getLeftVisibleCells(),t.getCenterVisibleCells(),t.getRightVisibleCells()],(r,n,i)=>[...r,...n,...i],Ct(e.options,"debugRows"))},createTable:t=>{const e=(r,n)=>_t(()=>[n(),n().filter(i=>i.getIsVisible()).map(i=>i.id).join("_")],i=>i.filter(s=>s.getIsVisible==null?void 0:s.getIsVisible()),Ct(t.options,"debugColumns"));t.getVisibleFlatColumns=e("getVisibleFlatColumns",()=>t.getAllFlatColumns()),t.getVisibleLeafColumns=e("getVisibleLeafColumns",()=>t.getAllLeafColumns()),t.getLeftVisibleLeafColumns=e("getLeftVisibleLeafColumns",()=>t.getLeftLeafColumns()),t.getRightVisibleLeafColumns=e("getRightVisibleLeafColumns",()=>t.getRightLeafColumns()),t.getCenterVisibleLeafColumns=e("getCenterVisibleLeafColumns",()=>t.getCenterLeafColumns()),t.setColumnVisibility=r=>t.options.onColumnVisibilityChange==null?void 0:t.options.onColumnVisibilityChange(r),t.resetColumnVisibility=r=>{var n;t.setColumnVisibility(r?{}:(n=t.initialState.columnVisibility)!=null?n:{})},t.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!t.getIsAllColumnsVisible(),t.setColumnVisibility(t.getAllLeafColumns().reduce((i,s)=>({...i,[s.id]:r||!(s.getCanHide!=null&&s.getCanHide())}),{}))},t.getIsAllColumnsVisible=()=>!t.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),t.getIsSomeColumnsVisible=()=>t.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),t.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;t.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function vd(t,e){return e?e==="center"?t.getCenterVisibleLeafColumns():e==="left"?t.getLeftVisibleLeafColumns():t.getRightVisibleLeafColumns():t.getVisibleLeafColumns()}const Uq={createTable:t=>{t._getGlobalFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,"__global__"),t.getGlobalFacetedRowModel=()=>t.options.manualFiltering||!t._getGlobalFacetedRowModel?t.getPreFilteredRowModel():t._getGlobalFacetedRowModel(),t._getGlobalFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,"__global__"),t.getGlobalFacetedUniqueValues=()=>t._getGlobalFacetedUniqueValues?t._getGlobalFacetedUniqueValues():new Map,t._getGlobalFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,"__global__"),t.getGlobalFacetedMinMaxValues=()=>{if(t._getGlobalFacetedMinMaxValues)return t._getGlobalFacetedMinMaxValues()}}},Hq={getInitialState:t=>({globalFilter:void 0,...t}),getDefaultOptions:t=>({onGlobalFilterChange:Yi("globalFilter",t),globalFilterFn:"auto",getColumnCanGlobalFilter:e=>{var r;const n=(r=t.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[e.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(t,e)=>{t.getCanGlobalFilter=()=>{var r,n,i,s;return((r=t.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=e.options.enableGlobalFilter)!=null?n:!0)&&((i=e.options.enableFilters)!=null?i:!0)&&((s=e.options.getColumnCanGlobalFilter==null?void 0:e.options.getColumnCanGlobalFilter(t))!=null?s:!0)&&!!t.accessorFn}},createTable:t=>{t.getGlobalAutoFilterFn=()=>ja.includesString,t.getGlobalFilterFn=()=>{var e,r;const{globalFilterFn:n}=t.options;return Bm(n)?n:n==="auto"?t.getGlobalAutoFilterFn():(e=(r=t.options.filterFns)==null?void 0:r[n])!=null?e:ja[n]},t.setGlobalFilter=e=>{t.options.onGlobalFilterChange==null||t.options.onGlobalFilterChange(e)},t.resetGlobalFilter=e=>{t.setGlobalFilter(e?void 0:t.initialState.globalFilter)}}},Wq={getInitialState:t=>({expanded:{},...t}),getDefaultOptions:t=>({onExpandedChange:Yi("expanded",t),paginateExpandedRows:!0}),createTable:t=>{let e=!1,r=!1;t._autoResetExpanded=()=>{var n,i;if(!e){t._queue(()=>{e=!0});return}if((n=(i=t.options.autoResetAll)!=null?i:t.options.autoResetExpanded)!=null?n:!t.options.manualExpanding){if(r)return;r=!0,t._queue(()=>{t.resetExpanded(),r=!1})}},t.setExpanded=n=>t.options.onExpandedChange==null?void 0:t.options.onExpandedChange(n),t.toggleAllRowsExpanded=n=>{n??!t.getIsAllRowsExpanded()?t.setExpanded(!0):t.setExpanded({})},t.resetExpanded=n=>{var i,s;t.setExpanded(n?{}:(i=(s=t.initialState)==null?void 0:s.expanded)!=null?i:{})},t.getCanSomeRowsExpand=()=>t.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),t.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),t.toggleAllRowsExpanded()},t.getIsSomeRowsExpanded=()=>{const n=t.getState().expanded;return n===!0||Object.values(n).some(Boolean)},t.getIsAllRowsExpanded=()=>{const n=t.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||t.getRowModel().flatRows.some(i=>!i.getIsExpanded()))},t.getExpandedDepth=()=>{let n=0;return(t.getState().expanded===!0?Object.keys(t.getRowModel().rowsById):Object.keys(t.getState().expanded)).forEach(s=>{const a=s.split(".");n=Math.max(n,a.length)}),n},t.getPreExpandedRowModel=()=>t.getSortedRowModel(),t.getExpandedRowModel=()=>(!t._getExpandedRowModel&&t.options.getExpandedRowModel&&(t._getExpandedRowModel=t.options.getExpandedRowModel(t)),t.options.manualExpanding||!t._getExpandedRowModel?t.getPreExpandedRowModel():t._getExpandedRowModel())},createRow:(t,e)=>{t.toggleExpanded=r=>{e.setExpanded(n=>{var i;const s=n===!0?!0:!!(n!=null&&n[t.id]);let a={};if(n===!0?Object.keys(e.getRowModel().rowsById).forEach(o=>{a[o]=!0}):a=n,r=(i=r)!=null?i:!s,!s&&r)return{...a,[t.id]:!0};if(s&&!r){const{[t.id]:o,...l}=a;return l}return n})},t.getIsExpanded=()=>{var r;const n=e.getState().expanded;return!!((r=e.options.getIsRowExpanded==null?void 0:e.options.getIsRowExpanded(t))!=null?r:n===!0||n!=null&&n[t.id])},t.getCanExpand=()=>{var r,n,i;return(r=e.options.getRowCanExpand==null?void 0:e.options.getRowCanExpand(t))!=null?r:((n=e.options.enableExpanding)!=null?n:!0)&&!!((i=t.subRows)!=null&&i.length)},t.getIsAllParentsExpanded=()=>{let r=!0,n=t;for(;r&&n.parentId;)n=e.getRow(n.parentId,!0),r=n.getIsExpanded();return r},t.getToggleExpandedHandler=()=>{const r=t.getCanExpand();return()=>{r&&t.toggleExpanded()}}}},L1=0,B1=10,Av=()=>({pageIndex:L1,pageSize:B1}),Gq={getInitialState:t=>({...t,pagination:{...Av(),...t==null?void 0:t.pagination}}),getDefaultOptions:t=>({onPaginationChange:Yi("pagination",t)}),createTable:t=>{let e=!1,r=!1;t._autoResetPageIndex=()=>{var n,i;if(!e){t._queue(()=>{e=!0});return}if((n=(i=t.options.autoResetAll)!=null?i:t.options.autoResetPageIndex)!=null?n:!t.options.manualPagination){if(r)return;r=!0,t._queue(()=>{t.resetPageIndex(),r=!1})}},t.setPagination=n=>{const i=s=>Lo(n,s);return t.options.onPaginationChange==null?void 0:t.options.onPaginationChange(i)},t.resetPagination=n=>{var i;t.setPagination(n?Av():(i=t.initialState.pagination)!=null?i:Av())},t.setPageIndex=n=>{t.setPagination(i=>{let s=Lo(n,i.pageIndex);const a=typeof t.options.pageCount>"u"||t.options.pageCount===-1?Number.MAX_SAFE_INTEGER:t.options.pageCount-1;return s=Math.max(0,Math.min(s,a)),{...i,pageIndex:s}})},t.resetPageIndex=n=>{var i,s;t.setPageIndex(n?L1:(i=(s=t.initialState)==null||(s=s.pagination)==null?void 0:s.pageIndex)!=null?i:L1)},t.resetPageSize=n=>{var i,s;t.setPageSize(n?B1:(i=(s=t.initialState)==null||(s=s.pagination)==null?void 0:s.pageSize)!=null?i:B1)},t.setPageSize=n=>{t.setPagination(i=>{const s=Math.max(1,Lo(n,i.pageSize)),a=i.pageSize*i.pageIndex,o=Math.floor(a/s);return{...i,pageIndex:o,pageSize:s}})},t.setPageCount=n=>t.setPagination(i=>{var s;let a=Lo(n,(s=t.options.pageCount)!=null?s:-1);return typeof a=="number"&&(a=Math.max(-1,a)),{...i,pageCount:a}}),t.getPageOptions=_t(()=>[t.getPageCount()],n=>{let i=[];return n&&n>0&&(i=[...new Array(n)].fill(null).map((s,a)=>a)),i},Ct(t.options,"debugTable")),t.getCanPreviousPage=()=>t.getState().pagination.pageIndex>0,t.getCanNextPage=()=>{const{pageIndex:n}=t.getState().pagination,i=t.getPageCount();return i===-1?!0:i===0?!1:n<i-1},t.previousPage=()=>t.setPageIndex(n=>n-1),t.nextPage=()=>t.setPageIndex(n=>n+1),t.firstPage=()=>t.setPageIndex(0),t.lastPage=()=>t.setPageIndex(t.getPageCount()-1),t.getPrePaginationRowModel=()=>t.getExpandedRowModel(),t.getPaginationRowModel=()=>(!t._getPaginationRowModel&&t.options.getPaginationRowModel&&(t._getPaginationRowModel=t.options.getPaginationRowModel(t)),t.options.manualPagination||!t._getPaginationRowModel?t.getPrePaginationRowModel():t._getPaginationRowModel()),t.getPageCount=()=>{var n;return(n=t.options.pageCount)!=null?n:Math.ceil(t.getRowCount()/t.getState().pagination.pageSize)},t.getRowCount=()=>{var n;return(n=t.options.rowCount)!=null?n:t.getPrePaginationRowModel().rows.length}}},Nv=()=>({top:[],bottom:[]}),qq={getInitialState:t=>({rowPinning:Nv(),...t}),getDefaultOptions:t=>({onRowPinningChange:Yi("rowPinning",t)}),createRow:(t,e)=>{t.pin=(r,n,i)=>{const s=n?t.getLeafRows().map(l=>{let{id:u}=l;return u}):[],a=i?t.getParentRows().map(l=>{let{id:u}=l;return u}):[],o=new Set([...a,t.id,...s]);e.setRowPinning(l=>{var u,d;if(r==="bottom"){var h,m;return{top:((h=l==null?void 0:l.top)!=null?h:[]).filter(x=>!(o!=null&&o.has(x))),bottom:[...((m=l==null?void 0:l.bottom)!=null?m:[]).filter(x=>!(o!=null&&o.has(x))),...Array.from(o)]}}if(r==="top"){var g,v;return{top:[...((g=l==null?void 0:l.top)!=null?g:[]).filter(x=>!(o!=null&&o.has(x))),...Array.from(o)],bottom:((v=l==null?void 0:l.bottom)!=null?v:[]).filter(x=>!(o!=null&&o.has(x)))}}return{top:((u=l==null?void 0:l.top)!=null?u:[]).filter(x=>!(o!=null&&o.has(x))),bottom:((d=l==null?void 0:l.bottom)!=null?d:[]).filter(x=>!(o!=null&&o.has(x)))}})},t.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:i}=e.options;return typeof n=="function"?n(t):(r=n??i)!=null?r:!0},t.getIsPinned=()=>{const r=[t.id],{top:n,bottom:i}=e.getState().rowPinning,s=r.some(o=>n==null?void 0:n.includes(o)),a=r.some(o=>i==null?void 0:i.includes(o));return s?"top":a?"bottom":!1},t.getPinnedIndex=()=>{var r,n;const i=t.getIsPinned();if(!i)return-1;const s=(r=i==="top"?e.getTopRows():e.getBottomRows())==null?void 0:r.map(a=>{let{id:o}=a;return o});return(n=s==null?void 0:s.indexOf(t.id))!=null?n:-1}},createTable:t=>{t.setRowPinning=e=>t.options.onRowPinningChange==null?void 0:t.options.onRowPinningChange(e),t.resetRowPinning=e=>{var r,n;return t.setRowPinning(e?Nv():(r=(n=t.initialState)==null?void 0:n.rowPinning)!=null?r:Nv())},t.getIsSomeRowsPinned=e=>{var r;const n=t.getState().rowPinning;if(!e){var i,s;return!!((i=n.top)!=null&&i.length||(s=n.bottom)!=null&&s.length)}return!!((r=n[e])!=null&&r.length)},t._getPinnedRows=(e,r,n)=>{var i;return((i=t.options.keepPinnedRows)==null||i?(r??[]).map(a=>{const o=t.getRow(a,!0);return o.getIsAllParentsExpanded()?o:null}):(r??[]).map(a=>e.find(o=>o.id===a))).filter(Boolean).map(a=>({...a,position:n}))},t.getTopRows=_t(()=>[t.getRowModel().rows,t.getState().rowPinning.top],(e,r)=>t._getPinnedRows(e,r,"top"),Ct(t.options,"debugRows")),t.getBottomRows=_t(()=>[t.getRowModel().rows,t.getState().rowPinning.bottom],(e,r)=>t._getPinnedRows(e,r,"bottom"),Ct(t.options,"debugRows")),t.getCenterRows=_t(()=>[t.getRowModel().rows,t.getState().rowPinning.top,t.getState().rowPinning.bottom],(e,r,n)=>{const i=new Set([...r??[],...n??[]]);return e.filter(s=>!i.has(s.id))},Ct(t.options,"debugRows"))}},Yq={getInitialState:t=>({rowSelection:{},...t}),getDefaultOptions:t=>({onRowSelectionChange:Yi("rowSelection",t),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:t=>{t.setRowSelection=e=>t.options.onRowSelectionChange==null?void 0:t.options.onRowSelectionChange(e),t.resetRowSelection=e=>{var r;return t.setRowSelection(e?{}:(r=t.initialState.rowSelection)!=null?r:{})},t.toggleAllRowsSelected=e=>{t.setRowSelection(r=>{e=typeof e<"u"?e:!t.getIsAllRowsSelected();const n={...r},i=t.getPreGroupedRowModel().flatRows;return e?i.forEach(s=>{s.getCanSelect()&&(n[s.id]=!0)}):i.forEach(s=>{delete n[s.id]}),n})},t.toggleAllPageRowsSelected=e=>t.setRowSelection(r=>{const n=typeof e<"u"?e:!t.getIsAllPageRowsSelected(),i={...r};return t.getRowModel().rows.forEach(s=>{j1(i,s.id,n,!0,t)}),i}),t.getPreSelectedRowModel=()=>t.getCoreRowModel(),t.getSelectedRowModel=_t(()=>[t.getState().rowSelection,t.getCoreRowModel()],(e,r)=>Object.keys(e).length?Mv(t,r):{rows:[],flatRows:[],rowsById:{}},Ct(t.options,"debugTable")),t.getFilteredSelectedRowModel=_t(()=>[t.getState().rowSelection,t.getFilteredRowModel()],(e,r)=>Object.keys(e).length?Mv(t,r):{rows:[],flatRows:[],rowsById:{}},Ct(t.options,"debugTable")),t.getGroupedSelectedRowModel=_t(()=>[t.getState().rowSelection,t.getSortedRowModel()],(e,r)=>Object.keys(e).length?Mv(t,r):{rows:[],flatRows:[],rowsById:{}},Ct(t.options,"debugTable")),t.getIsAllRowsSelected=()=>{const e=t.getFilteredRowModel().flatRows,{rowSelection:r}=t.getState();let n=!!(e.length&&Object.keys(r).length);return n&&e.some(i=>i.getCanSelect()&&!r[i.id])&&(n=!1),n},t.getIsAllPageRowsSelected=()=>{const e=t.getPaginationRowModel().flatRows.filter(i=>i.getCanSelect()),{rowSelection:r}=t.getState();let n=!!e.length;return n&&e.some(i=>!r[i.id])&&(n=!1),n},t.getIsSomeRowsSelected=()=>{var e;const r=Object.keys((e=t.getState().rowSelection)!=null?e:{}).length;return r>0&&r<t.getFilteredRowModel().flatRows.length},t.getIsSomePageRowsSelected=()=>{const e=t.getPaginationRowModel().flatRows;return t.getIsAllPageRowsSelected()?!1:e.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},t.getToggleAllRowsSelectedHandler=()=>e=>{t.toggleAllRowsSelected(e.target.checked)},t.getToggleAllPageRowsSelectedHandler=()=>e=>{t.toggleAllPageRowsSelected(e.target.checked)}},createRow:(t,e)=>{t.toggleSelected=(r,n)=>{const i=t.getIsSelected();e.setRowSelection(s=>{var a;if(r=typeof r<"u"?r:!i,t.getCanSelect()&&i===r)return s;const o={...s};return j1(o,t.id,r,(a=n==null?void 0:n.selectChildren)!=null?a:!0,e),o})},t.getIsSelected=()=>{const{rowSelection:r}=e.getState();return Sw(t,r)},t.getIsSomeSelected=()=>{const{rowSelection:r}=e.getState();return z1(t,r)==="some"},t.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=e.getState();return z1(t,r)==="all"},t.getCanSelect=()=>{var r;return typeof e.options.enableRowSelection=="function"?e.options.enableRowSelection(t):(r=e.options.enableRowSelection)!=null?r:!0},t.getCanSelectSubRows=()=>{var r;return typeof e.options.enableSubRowSelection=="function"?e.options.enableSubRowSelection(t):(r=e.options.enableSubRowSelection)!=null?r:!0},t.getCanMultiSelect=()=>{var r;return typeof e.options.enableMultiRowSelection=="function"?e.options.enableMultiRowSelection(t):(r=e.options.enableMultiRowSelection)!=null?r:!0},t.getToggleSelectedHandler=()=>{const r=t.getCanSelect();return n=>{var i;r&&t.toggleSelected((i=n.target)==null?void 0:i.checked)}}}},j1=(t,e,r,n,i)=>{var s;const a=i.getRow(e,!0);r?(a.getCanMultiSelect()||Object.keys(t).forEach(o=>delete t[o]),a.getCanSelect()&&(t[e]=!0)):delete t[e],n&&(s=a.subRows)!=null&&s.length&&a.getCanSelectSubRows()&&a.subRows.forEach(o=>j1(t,o.id,r,n,i))};function Mv(t,e){const r=t.getState().rowSelection,n=[],i={},s=function(a,o){return a.map(l=>{var u;const d=Sw(l,r);if(d&&(n.push(l),i[l.id]=l),(u=l.subRows)!=null&&u.length&&(l={...l,subRows:s(l.subRows)}),d)return l}).filter(Boolean)};return{rows:s(e.rows),flatRows:n,rowsById:i}}function Sw(t,e){var r;return(r=e[t.id])!=null?r:!1}function z1(t,e,r){var n;if(!((n=t.subRows)!=null&&n.length))return!1;let i=!0,s=!1;return t.subRows.forEach(a=>{if(!(s&&!i)&&(a.getCanSelect()&&(Sw(a,e)?s=!0:i=!1),a.subRows&&a.subRows.length)){const o=z1(a,e);o==="all"?s=!0:(o==="some"&&(s=!0),i=!1)}}),i?"all":s?"some":!1}const V1=/([0-9]+)/gm,Kq=(t,e,r)=>sO(rl(t.getValue(r)).toLowerCase(),rl(e.getValue(r)).toLowerCase()),Xq=(t,e,r)=>sO(rl(t.getValue(r)),rl(e.getValue(r))),Zq=(t,e,r)=>_w(rl(t.getValue(r)).toLowerCase(),rl(e.getValue(r)).toLowerCase()),Jq=(t,e,r)=>_w(rl(t.getValue(r)),rl(e.getValue(r))),Qq=(t,e,r)=>{const n=t.getValue(r),i=e.getValue(r);return n>i?1:n<i?-1:0},eY=(t,e,r)=>_w(t.getValue(r),e.getValue(r));function _w(t,e){return t===e?0:t>e?1:-1}function rl(t){return typeof t=="number"?isNaN(t)||t===1/0||t===-1/0?"":String(t):typeof t=="string"?t:""}function sO(t,e){const r=t.split(V1).filter(Boolean),n=e.split(V1).filter(Boolean);for(;r.length&&n.length;){const i=r.shift(),s=n.shift(),a=parseInt(i,10),o=parseInt(s,10),l=[a,o].sort();if(isNaN(l[0])){if(i>s)return 1;if(s>i)return-1;continue}if(isNaN(l[1]))return isNaN(a)?-1:1;if(a>o)return 1;if(o>a)return-1}return r.length-n.length}const Pf={alphanumeric:Kq,alphanumericCaseSensitive:Xq,text:Zq,textCaseSensitive:Jq,datetime:Qq,basic:eY},tY={getInitialState:t=>({sorting:[],...t}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:t=>({onSortingChange:Yi("sorting",t),isMultiSortEvent:e=>e.shiftKey}),createColumn:(t,e)=>{t.getAutoSortingFn=()=>{const r=e.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const i of r){const s=i==null?void 0:i.getValue(t.id);if(Object.prototype.toString.call(s)==="[object Date]")return Pf.datetime;if(typeof s=="string"&&(n=!0,s.split(V1).length>1))return Pf.alphanumeric}return n?Pf.text:Pf.basic},t.getAutoSortDir=()=>{const r=e.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(t.id))=="string"?"asc":"desc"},t.getSortingFn=()=>{var r,n;if(!t)throw new Error;return Bm(t.columnDef.sortingFn)?t.columnDef.sortingFn:t.columnDef.sortingFn==="auto"?t.getAutoSortingFn():(r=(n=e.options.sortingFns)==null?void 0:n[t.columnDef.sortingFn])!=null?r:Pf[t.columnDef.sortingFn]},t.toggleSorting=(r,n)=>{const i=t.getNextSortingOrder(),s=typeof r<"u"&&r!==null;e.setSorting(a=>{const o=a==null?void 0:a.find(g=>g.id===t.id),l=a==null?void 0:a.findIndex(g=>g.id===t.id);let u=[],d,h=s?r:i==="desc";if(a!=null&&a.length&&t.getCanMultiSort()&&n?o?d="toggle":d="add":a!=null&&a.length&&l!==a.length-1?d="replace":o?d="toggle":d="replace",d==="toggle"&&(s||i||(d="remove")),d==="add"){var m;u=[...a,{id:t.id,desc:h}],u.splice(0,u.length-((m=e.options.maxMultiSortColCount)!=null?m:Number.MAX_SAFE_INTEGER))}else d==="toggle"?u=a.map(g=>g.id===t.id?{...g,desc:h}:g):d==="remove"?u=a.filter(g=>g.id!==t.id):u=[{id:t.id,desc:h}];return u})},t.getFirstSortDir=()=>{var r,n;return((r=(n=t.columnDef.sortDescFirst)!=null?n:e.options.sortDescFirst)!=null?r:t.getAutoSortDir()==="desc")?"desc":"asc"},t.getNextSortingOrder=r=>{var n,i;const s=t.getFirstSortDir(),a=t.getIsSorted();return a?a!==s&&((n=e.options.enableSortingRemoval)==null||n)&&(!(r&&(i=e.options.enableMultiRemove)!=null)||i)?!1:a==="desc"?"asc":"desc":s},t.getCanSort=()=>{var r,n;return((r=t.columnDef.enableSorting)!=null?r:!0)&&((n=e.options.enableSorting)!=null?n:!0)&&!!t.accessorFn},t.getCanMultiSort=()=>{var r,n;return(r=(n=t.columnDef.enableMultiSort)!=null?n:e.options.enableMultiSort)!=null?r:!!t.accessorFn},t.getIsSorted=()=>{var r;const n=(r=e.getState().sorting)==null?void 0:r.find(i=>i.id===t.id);return n?n.desc?"desc":"asc":!1},t.getSortIndex=()=>{var r,n;return(r=(n=e.getState().sorting)==null?void 0:n.findIndex(i=>i.id===t.id))!=null?r:-1},t.clearSorting=()=>{e.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==t.id):[])},t.getToggleSortingHandler=()=>{const r=t.getCanSort();return n=>{r&&(n.persist==null||n.persist(),t.toggleSorting==null||t.toggleSorting(void 0,t.getCanMultiSort()?e.options.isMultiSortEvent==null?void 0:e.options.isMultiSortEvent(n):!1))}}},createTable:t=>{t.setSorting=e=>t.options.onSortingChange==null?void 0:t.options.onSortingChange(e),t.resetSorting=e=>{var r,n;t.setSorting(e?[]:(r=(n=t.initialState)==null?void 0:n.sorting)!=null?r:[])},t.getPreSortedRowModel=()=>t.getGroupedRowModel(),t.getSortedRowModel=()=>(!t._getSortedRowModel&&t.options.getSortedRowModel&&(t._getSortedRowModel=t.options.getSortedRowModel(t)),t.options.manualSorting||!t._getSortedRowModel?t.getPreSortedRowModel():t._getSortedRowModel())}},rY=[kq,$q,Lq,Bq,_q,Cq,Uq,Hq,tY,Rq,Wq,Gq,qq,Yq,zq];function nY(t){var e,r;const n=[...rY,...(e=t._features)!=null?e:[]];let i={_features:n};const s=i._features.reduce((m,g)=>Object.assign(m,g.getDefaultOptions==null?void 0:g.getDefaultOptions(i)),{}),a=m=>i.options.mergeOptions?i.options.mergeOptions(s,m):{...s,...m};let l={...{},...(r=t.initialState)!=null?r:{}};i._features.forEach(m=>{var g;l=(g=m.getInitialState==null?void 0:m.getInitialState(l))!=null?g:l});const u=[];let d=!1;const h={_features:n,options:{...s,...t},initialState:l,_queue:m=>{u.push(m),d||(d=!0,Promise.resolve().then(()=>{for(;u.length;)u.shift()();d=!1}).catch(g=>setTimeout(()=>{throw g})))},reset:()=>{i.setState(i.initialState)},setOptions:m=>{const g=Lo(m,i.options);i.options=a(g)},getState:()=>i.options.state,setState:m=>{i.options.onStateChange==null||i.options.onStateChange(m)},_getRowId:(m,g,v)=>{var x;return(x=i.options.getRowId==null?void 0:i.options.getRowId(m,g,v))!=null?x:`${v?[v.id,g].join("."):g}`},getCoreRowModel:()=>(i._getCoreRowModel||(i._getCoreRowModel=i.options.getCoreRowModel(i)),i._getCoreRowModel()),getRowModel:()=>i.getPaginationRowModel(),getRow:(m,g)=>{let v=(g?i.getPrePaginationRowModel():i.getRowModel()).rowsById[m];if(!v&&(v=i.getCoreRowModel().rowsById[m],!v))throw new Error;return v},_getDefaultColumnDef:_t(()=>[i.options.defaultColumn],m=>{var g;return m=(g=m)!=null?g:{},{header:v=>{const x=v.header.column.columnDef;return x.accessorKey?x.accessorKey:x.accessorFn?x.id:null},cell:v=>{var x,w;return(x=(w=v.renderValue())==null||w.toString==null?void 0:w.toString())!=null?x:null},...i._features.reduce((v,x)=>Object.assign(v,x.getDefaultColumnDef==null?void 0:x.getDefaultColumnDef()),{}),...m}},Ct(t,"debugColumns")),_getColumnDefs:()=>i.options.columns,getAllColumns:_t(()=>[i._getColumnDefs()],m=>{const g=function(v,x,w){return w===void 0&&(w=0),v.map(S=>{const T=bq(i,S,w,x),_=S;return T.columns=_.columns?g(_.columns,T,w+1):[],T})};return g(m)},Ct(t,"debugColumns")),getAllFlatColumns:_t(()=>[i.getAllColumns()],m=>m.flatMap(g=>g.getFlatColumns()),Ct(t,"debugColumns")),_getAllFlatColumnsById:_t(()=>[i.getAllFlatColumns()],m=>m.reduce((g,v)=>(g[v.id]=v,g),{}),Ct(t,"debugColumns")),getAllLeafColumns:_t(()=>[i.getAllColumns(),i._getOrderColumnsFn()],(m,g)=>{let v=m.flatMap(x=>x.getLeafColumns());return g(v)},Ct(t,"debugColumns")),getColumn:m=>i._getAllFlatColumnsById()[m]};Object.assign(i,h);for(let m=0;m<i._features.length;m++){const g=i._features[m];g==null||g.createTable==null||g.createTable(i)}return i}function iY(){return t=>_t(()=>[t.options.data],e=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(i,s,a){s===void 0&&(s=0);const o=[];for(let u=0;u<i.length;u++){const d=Sq(t,t._getRowId(i[u],u,a),i[u],u,s,void 0,a==null?void 0:a.id);if(r.flatRows.push(d),r.rowsById[d.id]=d,o.push(d),t.options.getSubRows){var l;d.originalSubRows=t.options.getSubRows(i[u],u),(l=d.originalSubRows)!=null&&l.length&&(d.subRows=n(d.originalSubRows,s+1,d))}}return o};return r.rows=n(e),r},Ct(t.options,"debugTable","getRowModel",()=>t._autoResetPageIndex()))}function sY(){return t=>_t(()=>[t.getState().sorting,t.getPreSortedRowModel()],(e,r)=>{if(!r.rows.length||!(e!=null&&e.length))return r;const n=t.getState().sorting,i=[],s=n.filter(l=>{var u;return(u=t.getColumn(l.id))==null?void 0:u.getCanSort()}),a={};s.forEach(l=>{const u=t.getColumn(l.id);u&&(a[l.id]={sortUndefined:u.columnDef.sortUndefined,invertSorting:u.columnDef.invertSorting,sortingFn:u.getSortingFn()})});const o=l=>{const u=l.map(d=>({...d}));return u.sort((d,h)=>{for(let g=0;g<s.length;g+=1){var m;const v=s[g],x=a[v.id],w=x.sortUndefined,S=(m=v==null?void 0:v.desc)!=null?m:!1;let T=0;if(w){const _=d.getValue(v.id),M=h.getValue(v.id),D=_===void 0,O=M===void 0;if(D||O){if(w==="first")return D?-1:1;if(w==="last")return D?1:-1;T=D&&O?0:D?w:-w}}if(T===0&&(T=x.sortingFn(d,h,v.id)),T!==0)return S&&(T*=-1),x.invertSorting&&(T*=-1),T}return d.index-h.index}),u.forEach(d=>{var h;i.push(d),(h=d.subRows)!=null&&h.length&&(d.subRows=o(d.subRows))}),u};return{rows:o(r.rows),flatRows:i,rowsById:r.rowsById}},Ct(t.options,"debugTable","getSortedRowModel",()=>t._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Dv(t,e){return t?aY(t)?z.createElement(t,e):t:null}function aY(t){return oY(t)||typeof t=="function"||lY(t)}function oY(t){return typeof t=="function"&&(()=>{const e=Object.getPrototypeOf(t);return e.prototype&&e.prototype.isReactComponent})()}function lY(t){return typeof t=="object"&&typeof t.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(t.$$typeof.description)}function cY(t){const e={state:{},onStateChange:()=>{},renderFallbackValue:null,...t},[r]=z.useState(()=>({current:nY(e)})),[n,i]=z.useState(()=>r.current.initialState);return r.current.setOptions(s=>({...s,...t,state:{...n,...t.state},onStateChange:a=>{i(a),t.onStateChange==null||t.onStateChange(a)}})),r.current}function ru(t,e,r){let n=r.initialDeps??[],i;function s(){var a,o,l,u;let d;r.key&&((a=r.debug)!=null&&a.call(r))&&(d=Date.now());const h=t();if(!(h.length!==n.length||h.some((v,x)=>n[x]!==v)))return i;n=h;let g;if(r.key&&((o=r.debug)!=null&&o.call(r))&&(g=Date.now()),i=e(...h),r.key&&((l=r.debug)!=null&&l.call(r))){const v=Math.round((Date.now()-d)*100)/100,x=Math.round((Date.now()-g)*100)/100,w=x/16,S=(T,_)=>{for(T=String(T);T.length<_;)T=" "+T;return T};console.info(`%c ${S(x,5)} /${S(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(u=r==null?void 0:r.onChange)==null||u.call(r,i),i}return s.updateDeps=a=>{n=a},s}function OC(t,e){if(t===void 0)throw new Error("Unexpected undefined");return t}const uY=(t,e)=>Math.abs(t-e)<1.01,fY=(t,e,r)=>{let n;return function(...i){t.clearTimeout(n),n=t.setTimeout(()=>e.apply(this,i),r)}},FC=t=>{const{offsetWidth:e,offsetHeight:r}=t;return{width:e,height:r}},dY=t=>t,hY=t=>{const e=Math.max(t.startIndex-t.overscan,0),r=Math.min(t.endIndex+t.overscan,t.count-1),n=[];for(let i=e;i<=r;i++)n.push(i);return n},pY=(t,e)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;const i=a=>{const{width:o,height:l}=a;e({width:Math.round(o),height:Math.round(l)})};if(i(FC(r)),!n.ResizeObserver)return()=>{};const s=new n.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const u=l.borderBoxSize[0];if(u){i({width:u.inlineSize,height:u.blockSize});return}}i(FC(r))};t.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return s.observe(r,{box:"border-box"}),()=>{s.unobserve(r)}},IC={passive:!0},RC=typeof window>"u"?!0:"onscrollend"in window,mY=(t,e)=>{const r=t.scrollElement;if(!r)return;const n=t.targetWindow;if(!n)return;let i=0;const s=t.options.useScrollendEvent&&RC?()=>{}:fY(n,()=>{e(i,!1)},t.options.isScrollingResetDelay),a=d=>()=>{const{horizontal:h,isRtl:m}=t.options;i=h?r.scrollLeft*(m&&-1||1):r.scrollTop,s(),e(i,d)},o=a(!0),l=a(!1);l(),r.addEventListener("scroll",o,IC);const u=t.options.useScrollendEvent&&RC;return u&&r.addEventListener("scrollend",l,IC),()=>{r.removeEventListener("scroll",o),u&&r.removeEventListener("scrollend",l)}},gY=(t,e,r)=>{if(e!=null&&e.borderBoxSize){const n=e.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return t[r.options.horizontal?"offsetWidth":"offsetHeight"]},xY=(t,{adjustments:e=0,behavior:r},n)=>{var i,s;const a=t+e;(s=(i=n.scrollElement)==null?void 0:i.scrollTo)==null||s.call(i,{[n.options.horizontal?"left":"top"]:a,behavior:r})};class vY{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(i=>{i.forEach(s=>{const a=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var i;(i=n())==null||i.disconnect(),r=null},observe:i=>{var s;return(s=n())==null?void 0:s.observe(i,{box:"border-box"})},unobserve:i=>{var s;return(s=n())==null?void 0:s.unobserve(i)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,i])=>{typeof i>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:dY,rangeExtractor:hY,onChange:()=>{},measureElement:gY,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,i;(i=(n=this.options).onChange)==null||i.call(n,this,r)},this.maybeNotify=ru(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const i=new Map,s=new Map;for(let a=n-1;a>=0;a--){const o=r[a];if(i.has(o.lane))continue;const l=s.get(o.lane);if(l==null||o.end>l.end?s.set(o.lane,o):o.end<l.end&&i.set(o.lane,!0),i.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=ru(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(r,n,i,s,a)=>(this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:i,getItemKey:s,enabled:a}),{key:!1}),this.getMeasurements=ru(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:i,getItemKey:s,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,l);for(let d=l;d<r;d++){const h=s(d),m=this.options.lanes===1?u[d-1]:this.getFurthestMeasurement(u,d),g=m?m.end+this.options.gap:n+i,v=o.get(h),x=typeof v=="number"?v:this.options.estimateSize(d),w=g+x,S=m?m.lane:d%this.options.lanes;u[d]={index:d,start:g,size:x,end:w,key:h,lane:S}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ru(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,i,s)=>this.range=r.length>0&&n>0?yY({measurements:r,outerSize:n,scrollOffset:i,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ru(()=>{let r=null,n=null;const i=this.calculateRange();return i&&(r=i.startIndex,n=i.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,i,s,a)=>s===null||a===null?[]:r({startIndex:s,endIndex:a,overscan:n,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,i=r.getAttribute(n);return i?parseInt(i,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const i=this.indexFromElement(r),s=this.measurementsCache[i];if(!s)return;const a=s.key,o=this.elementsCache.get(a);o!==r&&(o&&this.observer.unobserve(o),this.observer.observe(r),this.elementsCache.set(a,r)),r.isConnected&&this.resizeItem(i,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const i=this.measurementsCache[r];if(!i)return;const s=this.itemSizeCache.get(i.key)??i.size,a=n-s;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,a,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,i)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(i))});return}this._measureElement(r,void 0)},this.getVirtualItems=ru(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const i=[];for(let s=0,a=r.length;s<a;s++){const o=r[s],l=n[o];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return OC(n[aO(0,n.length-1,i=>OC(n[i]).start,r)])},this.getOffsetForAlignment=(r,n,i=0)=>{const s=this.getSize(),a=this.getScrollOffset();n==="auto"&&(n=r>=a+s?"end":"start"),n==="center"?r+=(i-s)/2:n==="end"&&(r-=s);const o=this.getTotalSize()+this.options.scrollMargin-s;return Math.max(Math.min(o,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const i=this.measurementsCache[r];if(!i)return;const s=this.getSize(),a=this.getScrollOffset();if(n==="auto")if(i.end>=a+s-this.options.scrollPaddingEnd)n="end";else if(i.start<=a+this.options.scrollPaddingStart)n="start";else return[a,n];const o=n==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,n,i.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:i})},this.scrollToIndex=(r,{align:n="auto",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1));let s=0;const a=10,o=u=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(r,u);if(!d){console.warn("Failed to get offset for index:",r);return}const[h,m]=d;this._scrollToOffset(h,{adjustments:void 0,behavior:i}),this.targetWindow.requestAnimationFrame(()=>{const g=this.getScrollOffset(),v=this.getOffsetForIndex(r,m);if(!v){console.warn("Failed to get offset for index:",r);return}uY(v[0],g)||l(m)})},l=u=>{this.targetWindow&&(s++,s<a?this.targetWindow.requestAnimationFrame(()=>o(u)):console.warn(`Failed to scroll to index ${r} after ${a} attempts.`))};o(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let i;if(n.length===0)i=this.options.paddingStart;else if(this.options.lanes===1)i=((r=n[n.length-1])==null?void 0:r.end)??0;else{const s=Array(this.options.lanes).fill(null);let a=n.length-1;for(;a>=0&&s.some(o=>o===null);){const o=n[a];s[o.lane]===null&&(s[o.lane]=o.end),a--}i=Math.max(...s.filter(o=>o!==null))}return Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:i})=>{this.options.scrollToFn(r,{behavior:i,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const aO=(t,e,r,n)=>{for(;t<=e;){const i=(t+e)/2|0,s=r(i);if(s<n)t=i+1;else if(s>n)e=i-1;else return i}return t>0?t-1:0};function yY({measurements:t,outerSize:e,scrollOffset:r,lanes:n}){const i=t.length-1,s=l=>t[l].start;if(t.length<=n)return{startIndex:0,endIndex:i};let a=aO(0,i,s,r),o=a;if(n===1)for(;o<i&&t[o].end<r+e;)o++;else if(n>1){const l=Array(n).fill(0);for(;o<i&&l.some(d=>d<r+e);){const d=t[o];l[d.lane]=d.end,o++}const u=Array(n).fill(r+e);for(;a>=0&&u.some(d=>d>=r);){const d=t[a];u[d.lane]=d.start,a--}a=Math.max(0,a-a%n),o=Math.min(i,o+(n-1-o%n))}return{startIndex:a,endIndex:o}}const PC=typeof document<"u"?z.useLayoutEffect:z.useEffect;function wY(t){const e=z.useReducer(()=>({}),{})[1],r={...t,onChange:(i,s)=>{var a;s?fy.flushSync(e):e(),(a=t.onChange)==null||a.call(t,i,s)}},[n]=z.useState(()=>new vY(r));return n.setOptions(r),PC(()=>n._didMount(),[]),PC(()=>n._willUpdate()),n}function bY(t){return wY({observeElementRect:pY,observeElementOffset:mY,scrollToFn:xY,...t})}const LC={width:"100%",borderRadius:Zl("lg"),border:`1px solid ${Qr("borderMuted")}`,backgroundColor:Qr("surface"),boxShadow:my("sm")},kY={padding:"12px 24px",fontFamily:Vu("fontFamily"),fontSize:$u("sizeXs"),fontWeight:gy("fontWeightBold"),textTransform:"uppercase",letterSpacing:"0.04em",textAlign:"left",color:Qr("mutedForeground"),borderBottom:"1px solid rgba(59, 130, 246, 0.35)",backgroundColor:Qr("surfaceMuted"),position:"sticky",top:0,flex:"0 0 auto",display:"flex",alignItems:"center",whiteSpace:"nowrap"},SY={padding:"12px 24px",borderBottom:"1px solid rgba(59, 130, 246, 0.25)",fontFamily:Vu("fontFamily"),fontSize:$u("sizeSm"),color:Qr("emphasisForeground"),flex:"0 0 auto",whiteSpace:"nowrap",alignItems:"center"},_Y={padding:`${en("lg")} ${en("xl")}`,textAlign:"center",color:Qr("mutedForeground")};function CY({data:t,columns:e,height:r=420,rowHeight:n=48,testId:i,ariaLabel:s,emptyMessage:a="   ",getRowId:o,className:l,onRowClick:u,onRowKeyDown:d,onRowFocus:h,getRowProps:m,enableKeyboardNavigation:g=!0}){const[v,x]=z.useState([]),w=z.useRef(null),S=cY({data:t,columns:e,state:{sorting:v},onSortingChange:x,getCoreRowModel:iY(),getSortedRowModel:sY(),getRowId:o}),T=S.getRowModel().rows,[_,M]=z.useState(()=>T.length>0?0:-1);z.useEffect(()=>{if(g){if(!T.length){M(-1);return}M(B=>B<0?0:B>=T.length?T.length-1:B)}},[T.length,g]);const D=bY({count:T.length,estimateSize:()=>n,overscan:6,getScrollElement:()=>w.current}),O=z.useCallback((B,I=0)=>{!g||I>20||requestAnimationFrame(()=>{const ee=w.current;if(!ee)return;const oe=ee.querySelector(`tr[data-row-index="${B}"]`);oe?oe.focus({preventScroll:!0}):O(B,I+1)})},[g,D]);z.useEffect(()=>{!g||_<0||O(_)},[_,g,O]);const E=T.length===0?r:D.getTotalSize(),A=z.useMemo(()=>{if(!(!g||_<0))return _},[g,_]),N=B=>{g&&M(B)},P=(B,I)=>{if(!g)return;const{key:ee}=B,oe=T.length-1;if(ee==="ArrowDown"||ee==="j"){B.preventDefault();const re=Math.min(oe,I+1);M(re),D.scrollToIndex(re,{align:"auto"});return}if(ee==="ArrowUp"||ee==="k"){B.preventDefault();const re=Math.max(0,I-1);M(re),D.scrollToIndex(re,{align:"auto"});return}if(ee==="Home"||ee==="PageUp"){B.preventDefault(),M(0),D.scrollToIndex(0,{align:"start"});return}if(ee==="End"||ee==="PageDown"){B.preventDefault();const re=Math.max(0,oe);M(re),D.scrollToIndex(re,{align:"end"});return}if(ee==="Enter"){B.preventDefault();const re=T[I];re&&(u==null||u({row:re,index:I,event:B}))}};return T.length===0?b.jsx("div",{style:{...LC,minHeight:r},"data-testid":i,className:l,children:b.jsx("div",{style:_Y,children:a})}):b.jsx("div",{style:{...LC,height:r},"data-testid":i,className:l,children:b.jsx("div",{ref:w,style:{height:r,overflow:"auto",borderRadius:Zl("lg")},role:"presentation",children:b.jsxs("table",{"aria-label":s,style:{width:"max-content",minWidth:"100%",borderCollapse:"separate",borderSpacing:0},children:[b.jsx("thead",{style:{display:"block"},children:S.getHeaderGroups().map(B=>b.jsx("tr",{style:{display:"flex"},children:B.headers.map(I=>{const ee=I.column.getCanSort(),oe=I.column.getIsSorted(),re=I.column.columnDef.meta,fe={...kY,...(re==null?void 0:re.headerStyle)??{}},se=(re==null?void 0:re.headerClassName)??"";return b.jsx("th",{scope:"col",style:fe,className:se,"aria-sort":ee?oe==="asc"?"ascending":oe==="desc"?"descending":"none":void 0,children:ee?b.jsxs("button",{type:"button",onClick:I.column.getToggleSortingHandler(),style:{all:"unset",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:en("2xs")},"aria-label":oe?`: ${oe==="asc"?" ":" "}`:"  ",children:[Dv(I.column.columnDef.header,I.getContext()),oe?oe==="asc"?"":"":null]}):b.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:en("2xs")},children:Dv(I.column.columnDef.header,I.getContext())})},I.id)})},B.id))}),b.jsx("tbody",{style:{position:"relative",display:"block",height:E},children:D.getVirtualItems().map(B=>{const I=T[B.index],ee=B.start,oe={row:I,index:B.index},re=(m==null?void 0:m(oe))??{},{className:fe,style:se,onClick:xe,onKeyDown:H,onFocus:ve,ref:W,...F}=re,X=[fe].filter(Boolean).join(" "),Z={position:"absolute",top:ee,left:0,right:0,height:n,display:"flex",transition:"background-color 120ms ease",borderBottom:"1px solid rgba(59, 130, 246, 0.25)",...se??{}};return b.jsx("tr",{role:"row","data-row-index":B.index,...F,ref:W,onClick:q=>{xe==null||xe(q),!q.defaultPrevented&&(u==null||u({row:I,index:B.index,event:q}))},tabIndex:A===B.index?0:-1,"aria-rowindex":B.index+1,onFocus:q=>{N(B.index),h==null||h({row:I,index:B.index,event:q}),ve==null||ve(q)},onKeyDown:q=>{H==null||H(q),!(q.defaultPrevented||(d==null?void 0:d({row:I,index:B.index,event:q}))===!0)&&P(q,B.index)},style:Z,className:X,children:I.getVisibleCells().map(q=>{var ce,Ce;return b.jsx("td",{role:"cell",style:{...SY,display:"flex",alignItems:"center",backgroundColor:"transparent",...((ce=q.column.columnDef.meta)==null?void 0:ce.cellStyle)??{}},className:((Ce=q.column.columnDef.meta)==null?void 0:Ce.cellClassName)??"",children:Dv(q.column.columnDef.cell,q.getContext())},q.id)})},I.id)})})]})})})}const EY=({state:t})=>b.jsxs(b.Fragment,{children:[t.visibleCount===0?b.jsxs("div",{className:"p-12 text-center text-gray-500",children:[b.jsx("div",{className:"text-5xl mb-3",children:""}),b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"  "}),b.jsx("p",{className:"text-sm",children:"    ,   "})]}):b.jsx(CY,{data:t.sortedEmployees,columns:t.tableColumns,rowHeight:t.rowHeight,height:t.tableHeight,testId:"employee-table",ariaLabel:" ",getRowId:e=>e.id,getRowProps:t.getTableRowProps}),t.isInitialLoading&&b.jsxs("div",{className:"absolute inset-0 z-20 bg-white/85 backdrop-blur-sm flex flex-col items-center justify-center gap-6",children:[b.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-transparent rounded-full animate-spin"}),b.jsx("div",{className:"w-full max-w-4xl space-y-3 px-6",children:Array.from({length:6}).map((e,r)=>b.jsx("div",{className:"h-11 rounded-lg bg-gray-200/80 animate-pulse"},`loader-row-${r}`))})]})]}),TY=({state:t})=>b.jsx(ec,{open:t.isBulkEditOpen,onOpenChange:e=>{e||t.handleBulkEditClose()},variant:"sheet",title:"  ",description:"     ",titleHidden:!0,descriptionHidden:!0,testId:"bulk-edit-overlay",contentClassName:"relative ml-auto flex h-full w-full max-w-2xl flex-col",showCloseButton:!1,children:b.jsxs("form",{className:"flex flex-col h-full",onSubmit:t.handleBulkEditSubmit,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:"  "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:"     "})}),b.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"  "}),b.jsxs("p",{className:"text-sm text-gray-500",children:[": ",t.selectedEmployees.size," ",t.selectedEmployees.size===1?"":"","."]})]}),b.jsx("button",{type:"button",onClick:t.handleBulkEditClose,className:"text-gray-400 hover:text-gray-600","aria-label":"  ",children:""})]}),b.jsxs("div",{className:"flex-1 overflow-y-auto py-5 space-y-6",children:[t.bulkEditError&&b.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-800",role:"alert",children:t.bulkEditError}),b.jsx("div",{className:"rounded-lg border border-blue-100 bg-blue-50 px-4 py-3 text-xs text-blue-900",children:"   /  /    .       ."}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:""}),b.jsx("p",{className:"text-xs text-gray-500",children:"   ."})]}),t.renderActionButtons("status")]}),b.jsxs("select",{id:"bulk-edit-status",value:t.bulkEditMatrix.status.value,onChange:e=>t.updateMatrixValue("status",e.target.value),disabled:t.bulkEditMatrix.status.action==="none",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",children:[b.jsx("option",{value:"",children:" "}),Object.entries(t.STATUS_LABELS).map(([e,r])=>b.jsx("option",{value:e,children:r},e))]})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:""}),b.jsx("p",{className:"text-xs text-gray-500",children:"    ."})]}),t.renderActionButtons("team")]}),b.jsxs("select",{id:"bulk-edit-team",value:t.bulkEditMatrix.team.value,onChange:e=>t.updateMatrixValue("team",e.target.value),disabled:t.bulkEditMatrix.team.action==="none",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",children:[b.jsx("option",{value:"",children:" "}),t.teamOptions.map(e=>b.jsx("option",{value:e.id,children:e.name},e.id))]})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:" "}),b.jsx("p",{className:"text-xs text-gray-500",children:"   ."})]}),t.renderActionButtons("hourNorm")]}),b.jsx("input",{type:"number",min:1,step:1,value:t.bulkEditMatrix.hourNorm.value,onChange:e=>t.updateMatrixValue("hourNorm",e.target.value),disabled:t.bulkEditMatrix.hourNorm.action==="none",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",placeholder:": 40"})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:" "}),b.jsx("p",{className:"text-xs text-gray-500",children:",     ."})]}),t.renderActionButtons("workScheme")]}),b.jsxs("select",{value:t.bulkEditMatrix.workScheme.value,onChange:e=>t.updateMatrixValue("workScheme",e.target.value),disabled:t.bulkEditMatrix.workScheme.action==="none"||t.bulkEditMatrix.workScheme.action==="remove",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",children:[b.jsx("option",{value:"",children:" "}),t.schemeOptions.map(e=>b.jsx("option",{value:e.id,children:e.name},e.id))]}),t.bulkEditMatrix.workScheme.action==="remove"&&b.jsx("p",{className:"text-xs text-gray-500",children:"      ."})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:""}),b.jsx("p",{className:"text-xs text-gray-500",children:"       ."})]}),t.renderActionButtons("skills")]}),b.jsx("textarea",{value:t.bulkEditMatrix.skills.value.join(`
`),onChange:e=>{const r=e.target.value.split(/[\n,;]+/).map(i=>i.trim()).filter(Boolean),n=Array.from(new Set(r));t.setBulkEditMatrix(i=>({...i,skills:{action:n.length===0?"none":i.skills.action==="none"?"add":i.skills.action,value:n}}))},disabled:t.bulkEditMatrix.skills.action==="none",className:"w-full min-h-[92px] px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",placeholder:"CRM,   "})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:" "}),b.jsx("p",{className:"text-xs text-gray-500",children:"     ."})]}),t.renderActionButtons("reserveSkills")]}),b.jsx("textarea",{value:t.bulkEditMatrix.reserveSkills.value.join(`
`),onChange:e=>{const r=e.target.value.split(/[\n,;]+/).map(i=>i.trim()).filter(Boolean),n=Array.from(new Set(r));t.setBulkEditMatrix(i=>({...i,reserveSkills:{action:n.length===0?"none":i.reserveSkills.action==="none"?"add":i.reserveSkills.action,value:n}}))},disabled:t.bulkEditMatrix.reserveSkills.action==="none",className:"w-full min-h-[92px] px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",placeholder:", "})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:""}),b.jsx("p",{className:"text-xs text-gray-500",children:",    ."})]}),t.renderActionButtons("tags")]}),b.jsx("div",{className:"flex flex-wrap gap-2",children:t.allTags.map(e=>{const r=t.bulkEditMatrix.tags.value.includes(e);return b.jsx("button",{type:"button",onClick:()=>{t.setBulkEditMatrix(n=>{const i=new Set(n.tags.value);i.has(e)?i.delete(e):i.add(e);const s=Array.from(i);return{...n,tags:{action:s.length===0?"none":n.tags.action==="none"?"add":n.tags.action,value:s}}})},className:`px-2 py-1 rounded-full border text-xs transition-colors ${r?"bg-blue-600 text-white border-blue-600":"border-gray-300 text-gray-600 hover:bg-gray-100"}`,children:e},`bulk-tag-${e}`)})}),b.jsx("textarea",{value:t.bulkEditMatrix.tags.value.join(`
`),onChange:e=>{const r=e.target.value.split(/[\n,;]+/).map(i=>i.trim()).filter(Boolean),n=Array.from(new Set(r));t.setBulkEditMatrix(i=>({...i,tags:{action:n.length===0?"none":i.tags.action==="none"?"add":i.tags.action,value:n}}))},disabled:t.bulkEditMatrix.tags.action==="none",className:"w-full min-h-[80px] px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50 disabled:text-gray-400",placeholder:"VIP, "})]}),b.jsxs("section",{className:"space-y-3",children:[b.jsx("p",{className:"text-sm font-semibold text-gray-900",children:" / "}),b.jsx("textarea",{id:"bulk-edit-comment",value:t.bulkEditMatrix.comment,onChange:e=>t.updateMatrixComment(e.target.value),className:"w-full min-h-[92px] px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"    "}),b.jsx("p",{className:"text-xs text-gray-400",children:"      ."})]})]}),t.selectedEmployeeList.length>0&&b.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700 space-y-2",children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsx("p",{className:"font-medium text-gray-900",children:" "}),b.jsxs("span",{className:"text-xs text-gray-500",children:[": ",t.selectedEmployeeList.length]})]}),b.jsxs("ul",{className:"space-y-1 max-h-36 overflow-y-auto",children:[t.selectedEmployeeList.slice(0,8).map(e=>b.jsxs("li",{className:"flex items-center justify-between gap-3",children:[b.jsxs("span",{children:[e.personalInfo.lastName," ",e.personalInfo.firstName]}),b.jsx("span",{className:"text-xs text-gray-500",children:e.workInfo.team.name})]},e.id)),t.selectedEmployeeList.length>8&&b.jsxs("li",{className:"text-xs text-gray-500",children:["  ",t.selectedEmployeeList.length-8,""]})]})]}),t.matrixSummary.length>0&&b.jsxs("div",{className:"rounded-lg border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-900 space-y-2",children:[b.jsx("p",{className:"font-medium",children:" "}),b.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.matrixSummary.map(e=>b.jsx("li",{children:e},e))})]})]}),b.jsxs("div",{className:"py-4 border-t border-gray-200 flex justify-end gap-3",children:[b.jsx("button",{type:"button",onClick:t.handleBulkEditClose,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:""}),b.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:" "})]})]})}),AY=({state:t})=>b.jsxs(ec,{open:t.showTagManager,onOpenChange:e=>{e||t.closeTagManager()},variant:"modal",title:"  ",description:"      ",titleHidden:!0,descriptionHidden:!0,testId:"tag-manager-overlay",contentClassName:"max-w-lg w-full mx-auto",showCloseButton:!1,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:"  "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:"      "})}),b.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{children:[b.jsx("h3",{id:"tag-manager-heading",className:"text-lg font-semibold text-gray-900",children:" "}),b.jsx("p",{className:"text-sm text-gray-500",children:". Appendix 6  Tag Import Template"})]}),b.jsx("button",{type:"button",onClick:t.closeTagManager,className:"text-gray-400 hover:text-gray-600","aria-label":"  ",children:""})]}),b.jsxs("div",{className:"py-5 space-y-5",children:[b.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[b.jsxs("p",{className:"text-sm text-gray-600",children:[" : ",b.jsx("span",{className:"font-medium",children:t.selectedEmployees.size})]}),b.jsx("div",{className:"flex flex-wrap gap-2",children:t.MATRIX_ACTIONS.map(e=>b.jsx("button",{type:"button",onClick:()=>{t.setTagAction(e),t.setTagError(null),e!=="remove"&&t.setSelectedTagNames(r=>r.slice(0,Ei))},className:`px-3 py-1.5 text-xs font-medium border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 ${t.tagAction===e?"bg-blue-600 text-white border-blue-600":"border-gray-300 text-gray-600 hover:bg-gray-100"}`,"aria-pressed":t.tagAction===e,children:t.MATRIX_ACTION_LABELS[e]},`tag-action-${e}`))})]}),b.jsxs("p",{className:"text-xs text-gray-500",children:[t.tagAction==="add"&&`       ${Ei}  .`,t.tagAction==="replace"&&"      .",t.tagAction==="remove"&&" ,     ."]}),b.jsxs("div",{className:"space-y-3",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),b.jsx("input",{type:"text",value:t.newTagName,onChange:e=>{t.setNewTagName(e.target.value),t.tagCreationError&&t.setTagCreationError(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:": VIP"})]}),b.jsxs("div",{children:[b.jsx("span",{className:"block text-xs uppercase font-semibold text-gray-500 mb-2",children:""}),b.jsx("div",{className:"flex flex-wrap gap-2",children:t.TAG_COLOR_PALETTE.map(e=>b.jsx("button",{type:"button",onClick:()=>t.setNewTagColor(e),className:`w-7 h-7 rounded-full border transition-shadow ${t.newTagColor===e?"border-blue-600 ring-2 ring-blue-300":"border-transparent hover:ring-2 hover:ring-blue-200"}`,style:{backgroundColor:e},"aria-label":`  ${e}`},e))})]}),b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{type:"button",onClick:t.handleCreateTag,className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:" "}),t.tagCreationError&&b.jsx("span",{className:"text-xs text-red-600",children:t.tagCreationError})]})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("p",{className:"text-sm font-medium text-gray-700",children:" "}),b.jsx("div",{className:"max-h-64 overflow-auto space-y-2",children:t.renderTagCatalogList()})]}),t.selectedTags.length>0&&b.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3 text-xs text-gray-600 space-y-2",children:[b.jsx("p",{className:"font-semibold text-gray-700",children:"    "}),b.jsx("div",{className:"flex flex-wrap gap-2",children:t.selectedTags.map(e=>b.jsx("span",{className:"px-2 py-1 rounded-full border border-gray-200 text-xs font-medium",style:{backgroundColor:`${t.tagCatalog[e]??bw(e)}20`,color:"#1f2937"},children:e},`selected-${e}`))})]}),t.tagError&&b.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",role:"alert",children:t.tagError}),b.jsxs("div",{className:"flex items-center justify-end gap-3",children:[b.jsx("button",{type:"button",onClick:t.closeTagManager,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""}),b.jsx("button",{type:"button",onClick:t.handleApplyTags,disabled:t.selectedEmployees.size===0,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t.selectedEmployees.size===0?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:" "})]})]})]}),NY=({state:t})=>b.jsxs(ec,{open:t.showColumnSettings,onOpenChange:e=>{e||t.closeColumnSettings()},variant:"sheet",title:"  ",description:"   ",titleHidden:!0,descriptionHidden:!0,testId:"column-settings-overlay",contentClassName:"flex h-full flex-col",showCloseButton:!1,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:"  "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:"   "})}),b.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("button",{type:"button",onClick:t.closeColumnSettings,className:"text-gray-500 hover:text-gray-700","aria-label":"   ",children:""}),b.jsx("h3",{id:"column-settings-heading",className:"text-base font-semibold text-gray-900",children:" "})]}),b.jsx("button",{type:"button",onClick:t.closeColumnSettings,className:"text-gray-400 hover:text-gray-600","aria-label":"  ",children:""})]}),b.jsx("div",{className:"py-3 border-b border-gray-100",children:b.jsx("p",{className:"text-sm text-gray-500",children:"      ."})}),b.jsxs("div",{className:"flex-1 overflow-y-auto py-4 space-y-3",children:[t.COLUMN_ORDER.map(e=>b.jsxs("label",{className:"flex items-center gap-3 text-sm text-gray-700",children:[b.jsx("input",{type:"checkbox",className:"rounded text-blue-600 focus:ring-blue-500",checked:t.columnVisibility[e.key],onChange:()=>t.toggleColumn(e.key)}),b.jsx("span",{children:e.label})]},e.key)),b.jsx("button",{type:"button",onClick:()=>t.setColumnVisibility({fio:!0,position:!0,orgUnit:!0,team:!0,scheme:!0,hourNorm:!0,status:!0,hireDate:!0}),className:"text-sm text-blue-600 hover:underline",children:"  "})]}),b.jsx("div",{className:"py-4 border-t border-gray-200 flex justify-end",children:b.jsx("button",{type:"button",onClick:t.closeColumnSettings,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:" "})})]}),MY=({state:t})=>b.jsxs(b.Fragment,{children:[b.jsxs(ec,{open:t.showImportModal,onOpenChange:e=>{e||t.closeImportModal()},variant:"modal",title:" ",description:`   : ${t.importContext}`,titleHidden:!0,descriptionHidden:!0,testId:"import-modal",contentClassName:"max-w-xl w-full mx-auto",showCloseButton:!1,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:" "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:`   : ${t.importContext}`})}),b.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{children:[b.jsx("h3",{id:"import-modal-heading",className:"text-lg font-semibold text-gray-900",children:" "}),b.jsx("p",{className:"text-sm text-gray-500",children:": Appendix 1/3/4/8"})]}),b.jsx("button",{type:"button",onClick:t.closeImportModal,className:"text-gray-400 hover:text-gray-600","aria-label":" ",children:""})]}),b.jsxs("div",{className:"py-5 space-y-3 text-sm text-gray-700",children:[b.jsxs("p",{className:"text-gray-500",children:[" : ",b.jsx("span",{className:"font-medium text-gray-700",children:t.importContext})]}),b.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[b.jsx("li",{children:"    (Appendix 1  , Appendix 3  , Appendix 4  , Appendix 8  )."}),b.jsx("li",{children:"      ."}),b.jsx("li",{children:" :     ,      ."})]}),b.jsx("button",{type:"button",onClick:t.handleImportClick,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:" "}),t.importFeedback&&b.jsx("p",{className:"text-sm text-blue-700",children:t.importFeedback})]})]}),b.jsxs(ec,{open:t.showExportModal,onOpenChange:e=>{e||t.closeExportModal()},variant:"modal",title:"  ",description:` : ${t.exportContext}`,titleHidden:!0,descriptionHidden:!0,testId:"export-modal",contentClassName:"max-w-xl w-full mx-auto",showCloseButton:!1,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:"  "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:` : ${t.exportContext}`})}),b.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{children:[b.jsx("h3",{id:"export-modal-heading",className:"text-lg font-semibold text-gray-900",children:"  "}),b.jsx("p",{className:"text-sm text-gray-500",children:"    "})]}),b.jsx("button",{type:"button",onClick:t.closeExportModal,className:"text-gray-400 hover:text-gray-600","aria-label":" ",children:""})]}),b.jsxs("div",{className:"py-5 space-y-3 text-sm text-gray-700",children:[b.jsxs("p",{className:"text-gray-500",children:[": ",b.jsx("span",{className:"font-medium text-gray-700",children:t.exportContext})]}),b.jsx("p",{children:"  CSV-        .   Appendix 1,        ."}),b.jsx("button",{type:"button",onClick:t.handleExport,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:" CSV"}),t.exportFeedback&&b.jsx("p",{className:"text-sm text-blue-700",children:t.exportFeedback})]})]})]}),DY=t=>{const e=mq(t);return b.jsxs(b.Fragment,{children:[b.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",ref:e.importInputRef,className:"sr-only",onChange:e.handleImportChange}),b.jsxs("div",{className:"relative bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[b.jsx("div",{className:"sr-only","aria-live":"polite",children:e.liveMessage}),b.jsx(gq,{state:e}),b.jsx(xq,{state:e}),b.jsx(EY,{state:e})]}),b.jsx(TY,{state:e}),b.jsx(AY,{state:e}),b.jsx(NY,{state:e}),b.jsx(MY,{state:e}),b.jsx(qG,{employee:e.activeEmployee,isOpen:!!e.activeEmployee,mode:"edit",isLoading:e.isDrawerLoading,onClose:e.handleDrawerClose,onSave:e.handleDrawerSave,onDismiss:e.handleDismissEmployee,onRestore:e.handleRestoreEmployee})]})},OY=({employees:t,teams:e,onEmployeeClick:r,onEmployeeEdit:n,selectedEmployees:i=new Set,onEmployeeSelect:s,showSelectionMode:a=!1})=>{const[o,l]=z.useState({search:"",team:"",status:"",department:""}),[u,d]=z.useState({photoSize:"medium",showNames:!0,showPositions:!0,showTeams:!0,showStatus:!0,columns:6}),h={small:{size:"w-16 h-16",container:"w-20",text:"text-xs"},medium:{size:"w-20 h-20",container:"w-24",text:"text-sm"},large:{size:"w-24 h-24",container:"w-28",text:"text-base"}},m=z.useMemo(()=>t.filter(w=>{const S=!o.search||w.personalInfo.firstName.toLowerCase().includes(o.search.toLowerCase())||w.personalInfo.lastName.toLowerCase().includes(o.search.toLowerCase())||w.workInfo.position.toLowerCase().includes(o.search.toLowerCase())||w.personalInfo.email.toLowerCase().includes(o.search.toLowerCase()),T=!o.team||w.workInfo.team.id===o.team,_=!o.status||w.status===o.status,M=!o.department||w.workInfo.department===o.department;return S&&T&&_&&M}),[t,o]),g=w=>{const S={active:{color:"bg-green-500",label:""},vacation:{color:"bg-yellow-500",label:" "},probation:{color:"bg-blue-500",label:""},inactive:{color:"bg-gray-400",label:""},terminated:{color:"bg-red-500",label:""}};return S[w]||S.inactive},v=z.useMemo(()=>{const w=new Set(t.map(S=>S.workInfo.department));return Array.from(w)},[t]),x=w=>{s&&s(w)};return t.length===0?b.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),b.jsx("p",{className:"text-gray-500",children:"     "})]})}):b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),b.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs font-medium mb-2 uppercase tracking-wide",children:" "}),b.jsx("p",{className:"text-gray-600",children:"-       "})]}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 lg:mt-0",children:[b.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"   "}),b.jsx("button",{className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"  "})]})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsx("input",{type:"text",placeholder:", , ...",value:o.search,onChange:w=>l(S=>({...S,search:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:o.team,onChange:w=>l(S=>({...S,team:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),e.map(w=>b.jsx("option",{value:w.id,children:w.name},w.id))]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:o.status,onChange:w=>l(S=>({...S,status:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),b.jsx("option",{value:"active",children:""}),b.jsx("option",{value:"vacation",children:" "}),b.jsx("option",{value:"probation",children:" "}),b.jsx("option",{value:"inactive",children:""})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:o.department,onChange:w=>l(S=>({...S,department:w.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),v.map(w=>b.jsx("option",{value:w,children:w},w))]})]})]}),b.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[b.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:" "}),b.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),b.jsxs("select",{value:u.photoSize,onChange:w=>d(S=>({...S,photoSize:w.target.value})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"small",children:""}),b.jsx("option",{value:"medium",children:""}),b.jsx("option",{value:"large",children:""})]})]}),b.jsx("div",{className:"flex items-end",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:u.showNames,onChange:w=>d(S=>({...S,showNames:w.target.checked})),className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:""})]})}),b.jsx("div",{className:"flex items-end",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:u.showPositions,onChange:w=>d(S=>({...S,showPositions:w.target.checked})),className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:""})]})}),b.jsx("div",{className:"flex items-end",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:u.showTeams,onChange:w=>d(S=>({...S,showTeams:w.target.checked})),className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:""})]})}),b.jsx("div",{className:"flex items-end",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:u.showStatus,onChange:w=>d(S=>({...S,showStatus:w.target.checked})),className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:""})]})}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:u.columns,onChange:w=>d(S=>({...S,columns:parseInt(w.target.value)})),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:4,children:"4"}),b.jsx("option",{value:5,children:"5"}),b.jsx("option",{value:6,children:"6"}),b.jsx("option",{value:8,children:"8"}),b.jsx("option",{value:10,children:"10"})]})]})]})]}),b.jsxs("div",{className:"flex items-center justify-between pt-4",children:[b.jsxs("p",{className:"text-sm text-gray-600",children:[" ",b.jsx("span",{className:"font-semibold",children:m.length}),"  ",b.jsx("span",{className:"font-semibold",children:t.length})," "]}),a&&b.jsxs("p",{className:"text-sm text-blue-600",children:[": ",i.size," ()"]})]})]}),b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:""}),m.length===0?b.jsxs("div",{className:"text-center py-16",children:[b.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),b.jsx("p",{className:"text-gray-500",children:"     "})]}):b.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(${u.columns}, minmax(0, 1fr))`},children:m.map(w=>{const S=g(w.status),T=i.has(w.id),_=h[u.photoSize];return b.jsxs("div",{className:`relative group cursor-pointer transition-all duration-200 ${T?"ring-2 ring-blue-500 rounded-lg":""}`,onClick:()=>{a?x(w.id):r==null||r(w)},children:[a&&b.jsx("div",{className:"absolute top-2 left-2 z-10",children:b.jsx("input",{type:"checkbox",checked:T,onChange:M=>{M.stopPropagation(),x(w.id)},className:"rounded text-blue-600 focus:ring-blue-500 bg-white border-gray-300"})}),b.jsxs("div",{className:"text-center p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[b.jsxs("div",{className:"relative mx-auto mb-3",style:{width:"fit-content"},children:[b.jsx("img",{src:w.personalInfo.photo||"https://i.pravatar.cc/150?img=1",alt:`${w.personalInfo.firstName} ${w.personalInfo.lastName}`,className:`${_.size} rounded-full object-cover border-4 border-gray-100 shadow-sm group-hover:shadow-md transition-shadow`}),u.showStatus&&b.jsx("div",{className:`absolute -bottom-1 -right-1 w-5 h-5 ${S.color} rounded-full border-2 border-white shadow-sm`,title:S.label})]}),b.jsxs("div",{className:"space-y-1",children:[u.showNames&&b.jsx("h3",{className:`font-semibold text-gray-900 ${_.text} leading-tight`,children:w.personalInfo.firstName}),u.showNames&&b.jsx("h3",{className:`font-semibold text-gray-900 ${_.text} leading-tight`,children:w.personalInfo.lastName}),u.showPositions&&b.jsx("p",{className:`text-gray-600 ${_.text==="text-xs"?"text-xs":"text-sm"} leading-tight`,children:w.workInfo.position}),u.showTeams&&b.jsxs("div",{className:"flex items-center justify-center gap-1",children:[b.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:w.workInfo.team.color}}),b.jsx("span",{className:`text-gray-500 ${_.text==="text-xs"?"text-xs":"text-sm"}`,children:w.workInfo.team.name})]})]}),b.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:b.jsxs("div",{className:"flex gap-1",children:[b.jsx("button",{onClick:M=>{M.stopPropagation(),r==null||r(w)},className:"p-1 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-colors",title:"",children:b.jsx("span",{className:"text-sm",children:""})}),b.jsx("button",{onClick:M=>{M.stopPropagation(),n==null||n(w)},className:"p-1 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-colors",title:"",children:b.jsx("span",{className:"text-sm",children:""})})]})})]})]},w.id)})})]}),b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" "}),b.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.filter(w=>w.personalInfo.photo).length}),b.jsx("div",{className:"text-sm text-gray-600",children:" "})]}),b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.filter(w=>!w.personalInfo.photo).length}),b.jsx("div",{className:"text-sm text-gray-600",children:" "})]}),b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.filter(w=>w.status==="active").length}),b.jsx("div",{className:"text-sm text-gray-600",children:""})]}),b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-2xl font-bold text-purple-600",children:v.length}),b.jsx("div",{className:"text-sm text-gray-600",children:""})]})]})]})]})},FY=({employees:t,selectedEmployee:e,onEmployeeSelect:r,timeRange:n="month",showComparison:i=!0})=>{const[s,a]=z.useState("qualityScore"),[o,l]=z.useState("overview"),[u,d]=z.useState("qualityScore"),[h,m]=z.useState("desc"),g=[{id:"qualityScore",label:" ",key:"qualityScore",format:"percentage",target:90,icon:"",color:"#10b981",description:"    "},{id:"adherenceScore",label:" ",key:"adherenceScore",format:"percentage",target:85,icon:"",color:"#3b82f6",description:"   "},{id:"callsPerHour",label:"  ",key:"callsPerHour",format:"decimal",target:12,icon:"",color:"#8b5cf6",description:"     "},{id:"averageHandleTime",label:"  ",key:"averageHandleTime",format:"time",target:8,icon:"",color:"#f59e0b",description:"     ()"},{id:"customerSatisfaction",label:" ",key:"customerSatisfaction",format:"decimal",target:4.5,icon:"",color:"#ef4444",description:"   "}],v=z.useMemo(()=>t.map(_=>{const M={};return g.forEach(D=>{const O=_.performance[D.key],N=[...t.map(I=>I.performance[D.key])].sort((I,ee)=>ee-I).indexOf(O)+1,P=Math.random()*10-5,B=P>1?"up":P<-1?"down":"stable";M[D.id]={value:O,trend:B,change:Math.abs(P),rank:N}}),{employee:_,metrics:M}}).sort((_,M)=>{var E,A;const D=((E=_.metrics[u])==null?void 0:E.value)||0,O=((A=M.metrics[u])==null?void 0:A.value)||0;return h==="desc"?O-D:D-O}),[t,u,h]),x=_=>Number.isFinite(_)?(Math.trunc(_*10)/10).toFixed(1).replace(/\.0$/,".0"):"",w=(_,M)=>{if(!Number.isFinite(_))return"";switch(M){case"percentage":return`${x(_)}%`;case"decimal":return x(_);case"time":return`${x(_)} `;case"number":return Math.round(_).toString();default:return x(_)}},S=(_,M)=>{if(!M.target)return M.color;const D=_/M.target;return D>=1.1?"#10b981":D>=.9?"#3b82f6":D>=.7?"#f59e0b":"#ef4444"},T=_=>{switch(_){case"up":return"";case"down":return"";case"stable":return"";default:return""}};return t.length===0?b.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"   "}),b.jsx("p",{className:"text-gray-500",children:"     "})]})}):b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),b.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs font-medium mb-2 uppercase tracking-wide",children:" "}),b.jsx("p",{className:"text-gray-600",children:" KPI     -"})]}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 lg:mt-0",children:[b.jsxs("select",{value:n,className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"week",children:" "}),b.jsx("option",{value:"month",children:" "}),b.jsx("option",{value:"quarter",children:" "}),b.jsx("option",{value:"year",children:" "})]}),b.jsx("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:["overview","detailed","comparison"].map(_=>b.jsx("button",{onClick:()=>l(_),className:`px-4 py-2 text-sm font-medium transition-colors ${o===_?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:_==="overview"?"":_==="detailed"?"":""},_))})]})]}),b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:g.map(_=>{const M=t.reduce((O,E)=>O+E.performance[_.key],0)/t.length,D=S(M,_);return b.jsxs("div",{onClick:()=>a(_.id),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${s===_.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[b.jsxs("div",{className:"flex items-center justify-between mb-2",children:[b.jsx("span",{className:"text-2xl",children:_.icon}),b.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:D}})]}),b.jsx("h3",{className:"font-medium text-gray-900 text-sm mb-1",children:_.label}),b.jsx("div",{className:"text-xl font-bold",style:{color:D},children:w(M,_.format)}),_.target&&b.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[": ",w(_.target,_.format)]})]},_.id)})})]}),b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[b.jsx("div",{className:"p-6 border-b border-gray-200",children:b.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:" "}),b.jsxs("div",{className:"flex gap-3",children:[b.jsx("select",{value:u,onChange:_=>d(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:g.map(_=>b.jsxs("option",{value:_.id,children:[" : ",_.label]},_.id))}),b.jsx("button",{onClick:()=>m(h==="desc"?"asc":"desc"),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:h==="desc"?" ":" "})]})]})}),b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"w-full",children:[b.jsx("thead",{className:"bg-gray-50",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),g.map(_=>b.jsxs("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:[_.icon," ",_.label]},_.id)),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),b.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.slice(0,10).map(({employee:_,metrics:M})=>b.jsxs("tr",{className:"hover:bg-gray-50",children:[b.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx("img",{src:_.personalInfo.photo||"https://i.pravatar.cc/40?img=1",alt:`${_.personalInfo.firstName} ${_.personalInfo.lastName}`,className:"w-10 h-10 rounded-full mr-3"}),b.jsxs("div",{children:[b.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[_.personalInfo.firstName," ",_.personalInfo.lastName]}),b.jsx("div",{className:"text-sm text-gray-500",children:_.workInfo.position})]})]})}),g.map(D=>{const O=M[D.id],E=S(O.value,D);return b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsx("span",{className:"text-sm font-semibold",style:{color:E},children:w(O.value,D.format)}),b.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[b.jsx("span",{className:"text-xs",children:T(O.trend)}),b.jsxs("span",{className:"text-xs text-gray-500",children:["#",O.rank]})]})]})},D.id)}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:b.jsx("button",{onClick:()=>r==null?void 0:r(_),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:""})})]},_.id))})]})})]}),b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:" "}),b.jsx("div",{className:"h-64 bg-gray-50 rounded-lg flex items-center justify-center border-2 border-dashed border-gray-300",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),b.jsx("p",{className:"text-gray-500",children:" "}),b.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"  Chart.js   "})]})})]})]})},IY=La({login:An().trim().min(1," ").regex(/^[a-zA-Z0-9._-]{3,}$/u," 3  (, , ._- )"),password:An().trim().min(6,"  6 "),confirm:An().trim().min(1," ")}).superRefine((t,e)=>{t.password!==t.confirm&&e.addIssue({path:["confirm"],code:He.custom,message:"  "})}),H0=()=>({login:"",password:"",confirm:""}),RY={id:"team_default",name:" ",description:"     ",color:"#2563eb",managerId:"mgr_default",memberCount:0,targetUtilization:.8},PY=(t,e,r)=>{const n=Date.now(),i=`EMP${n.toString().slice(-5)}`,s={...r},a=`${t}@demo.local`;return{employeeId:i,status:"probation",personalInfo:{firstName:"",lastName:"",middleName:"",email:a,phone:"+7 (000) 000-00-00",photo:`https://i.pravatar.cc/150?u=${encodeURIComponent(t)}`,address:s.description?`: ${s.description}`:"  "},credentials:{wfmLogin:t,externalLogins:[t],passwordSet:!0,passwordLastUpdated:new Date},workInfo:{position:" ()",team:s,manager:typeof s.managerId=="string"?s.managerId:" ",hireDate:new Date,contractType:"full-time",workLocation:s.description??" 1010.ru",department:s.name},orgPlacement:{orgUnit:s.name,office:s.description??" 1010.ru",timeZone:"Europe/Moscow",hourNorm:40,workScheme:{id:`scheme_quick_add_${n}`,name:" ",effectiveFrom:new Date}},skills:[],reserveSkills:[],tags:[" "],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"09:00",end:"18:00"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:0,adherenceScore:0,customerSatisfaction:0,lastEvaluation:new Date},certifications:[],personnelNumber:`PN-${n.toString().slice(-5)}`,actualAddress:s.description?` ${s.description}`:" 1010.ru, .  12",tasks:[Ul("  ","system",{createdBy:"system"}),Ul(" ","system",{createdBy:"system"})]}},LY=({teams:t,isOpen:e,onClose:r,onSubmit:n})=>{const i=z.useMemo(()=>t[0]??RY,[t]),s=z.useRef(!1),{register:a,handleSubmit:o,reset:l,formState:{errors:u,isSubmitting:d}}=ET({resolver:ZN(IY),defaultValues:H0(),mode:"onSubmit",reValidateMode:"onChange"});z.useEffect(()=>{e&&(l(H0()),s.current=!1)},[e,l]);const h=async O=>{s.current=!0;const E=O.login.trim().toLowerCase(),A=PY(E,O.password.trim(),i);await new Promise(N=>setTimeout(N,200)),n(A),l(H0()),r({restoreFocus:!1})},m=()=>{l(H0()),r({restoreFocus:!0})},{id:g,labelId:v,...x}=yu({controlId:"quick-add-login",hasError:!!u.login,errorId:u.login?"quick-add-login-error":void 0}),{id:w,labelId:S,...T}=yu({controlId:"quick-add-password",hasError:!!u.password,errorId:u.password?"quick-add-password-error":void 0}),{id:_,labelId:M,...D}=yu({controlId:"quick-add-confirm",hasError:!!u.confirm,errorId:u.confirm?"quick-add-confirm-error":void 0});return b.jsxs(ec,{open:e,onOpenChange:O=>{if(!O&&!d){if(s.current){s.current=!1;return}m()}},variant:"modal",title:"  ",description:"      ",titleHidden:!0,descriptionHidden:!0,testId:"quick-add-modal",contentClassName:"max-w-md w-full mx-auto",showCloseButton:!1,preventClose:d,closeOnOverlayClick:!1,closeOnEscape:!d,children:[b.jsx(Jl,{asChild:!0,children:b.jsx(Yn,{children:"  "})}),b.jsx(Ql,{asChild:!0,children:b.jsx(Yn,{children:"      "})}),b.jsxs("div",{className:"flex items-start justify-between py-4 border-b border-gray-200",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"  "}),b.jsx("p",{className:"text-sm text-gray-500",children:"  :        WFM."})]}),b.jsx("button",{type:"button",onClick:()=>{d||m()},className:"text-gray-400 hover:text-gray-600","aria-label":"  ",disabled:d,children:""})]}),b.jsxs("form",{onSubmit:o(h),noValidate:!0,className:"py-5 space-y-5",children:[b.jsx(vu,{label:" WFM",required:!0,fieldId:g,error:u.login,children:b.jsx("input",{id:g,type:"text",autoFocus:!0,placeholder:", i.ivanov",className:`w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${u.login?"border-red-400 focus:ring-red-500":"border-gray-300"}`,...a("login"),...x})}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[b.jsx(vu,{label:"",required:!0,fieldId:w,error:u.password,children:b.jsx("input",{id:w,type:"password",placeholder:" 6 ",className:`w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${u.password?"border-red-400 focus:ring-red-500":"border-gray-300"}`,...a("password"),...T})}),b.jsx(vu,{label:"",required:!0,fieldId:_,error:u.confirm,children:b.jsx("input",{id:_,type:"password",placeholder:" ",className:`w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${u.confirm?"border-red-400 focus:ring-red-500":"border-gray-300"}`,...a("confirm"),...D})})]}),b.jsx("div",{className:"rounded-md bg-gray-50 border border-gray-200 px-4 py-3 text-sm text-gray-600 space-y-1",children:b.jsxs("p",{children:["     ",i.name,".         ."]})}),b.jsxs("div",{className:"flex items-center justify-end gap-3",children:[b.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50 transition-colors",disabled:d,children:""}),b.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors disabled:opacity-60",disabled:d,children:d?"":" "})]})]})]})},BY=({employees:t,onStatusChange:e,onBulkStatusChange:r,canModifyStatus:n=()=>!0})=>{const[i,s]=z.useState(new Set),[a,o]=z.useState({currentStatus:"",team:"",search:"",showPendingChanges:!1}),[l,u]=z.useState(!1),[d,h]=z.useState(null),[m,g]=z.useState([]),v=[{from:"probation",to:"active",label:"  ",color:"#10b981",icon:"",requiresReason:!0,requiresApproval:!0,description:"   "},{from:"active",to:"vacation",label:"  ",color:"#f59e0b",icon:"",requiresReason:!1,requiresApproval:!1,description:"  - "},{from:"vacation",to:"active",label:"  ",color:"#3b82f6",icon:"",requiresReason:!1,requiresApproval:!1,description:"   "},{from:"active",to:"inactive",label:"",color:"#6b7280",icon:"",requiresReason:!0,requiresApproval:!0,description:"   "},{from:"inactive",to:"active",label:"",color:"#10b981",icon:"",requiresReason:!0,requiresApproval:!1,description:"   "},{from:"active",to:"terminated",label:"",color:"#ef4444",icon:"",requiresReason:!0,requiresApproval:!0,description:"  "},{from:"probation",to:"terminated",label:" ()",color:"#ef4444",icon:"",requiresReason:!0,requiresApproval:!0,description:"    "}],x=z.useMemo(()=>t.filter(E=>{const A=!a.currentStatus||E.status===a.currentStatus,N=!a.team||E.workInfo.team.id===a.team,P=!a.search||E.personalInfo.firstName.toLowerCase().includes(a.search.toLowerCase())||E.personalInfo.lastName.toLowerCase().includes(a.search.toLowerCase())||E.workInfo.position.toLowerCase().includes(a.search.toLowerCase());return A&&N&&P}),[t,a]),w=E=>v.filter(A=>A.from===E.status&&n(E)),S=E=>{const A={active:{color:"bg-green-100 text-green-800",label:"",dot:"bg-green-500"},vacation:{color:"bg-yellow-100 text-yellow-800",label:" ",dot:"bg-yellow-500"},probation:{color:"bg-blue-100 text-blue-800",label:"",dot:"bg-blue-500"},inactive:{color:"bg-gray-100 text-gray-800",label:"",dot:"bg-gray-400"},terminated:{color:"bg-red-100 text-red-800",label:"",dot:"bg-red-500"}};return A[E]||A.inactive},T=E=>{const A=new Set(i);A.has(E)?A.delete(E):A.add(E),s(A)},_=()=>{i.size===x.length?s(new Set):s(new Set(x.map(E=>E.id)))},M=E=>{h(E),u(!0)},D=z.useMemo(()=>{const E=new Map;return t.forEach(A=>{E.has(A.workInfo.team.id)||E.set(A.workInfo.team.id,A.workInfo.team)}),Array.from(E.values())},[t]),O=z.useMemo(()=>{const E={active:0,vacation:0,probation:0,inactive:0,terminated:0};return t.forEach(A=>{E[A.status]++}),E},[t]);return t.length===0?b.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:b.jsxs("div",{className:"text-center",children:[b.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"   "}),b.jsx("p",{className:"text-gray-500",children:"     "})]})}):b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[b.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"  "}),b.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs font-medium mb-2 uppercase tracking-wide",children:" "}),b.jsx("p",{className:"text-gray-600",children:"   : , , "})]}),b.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4 lg:mt-0",children:[i.size>0&&b.jsxs("button",{onClick:()=>M(t.filter(E=>i.has(E.id))),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:["  (",i.size,")"]}),b.jsx("button",{className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium",children:"   "})]})]}),b.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:Object.entries(O).map(([E,A])=>{const N=S(E);return b.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[b.jsxs("div",{className:"flex items-center justify-center mb-2",children:[b.jsx("div",{className:`w-3 h-3 rounded-full ${N.dot} mr-2`}),b.jsx("span",{className:"text-2xl font-bold text-gray-900",children:A})]}),b.jsx("div",{className:"text-sm text-gray-600",children:N.label})]},E)})}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsx("input",{type:"text",placeholder:", , ...",value:a.search,onChange:E=>o(A=>({...A,search:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:a.currentStatus,onChange:E=>o(A=>({...A,currentStatus:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),b.jsx("option",{value:"active",children:""}),b.jsx("option",{value:"vacation",children:" "}),b.jsx("option",{value:"probation",children:" "}),b.jsx("option",{value:"inactive",children:""}),b.jsx("option",{value:"terminated",children:""})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),b.jsxs("select",{value:a.team,onChange:E=>o(A=>({...A,team:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[b.jsx("option",{value:"",children:" "}),D.map(E=>b.jsx("option",{value:E.id,children:E.name},E.id))]})]}),b.jsx("div",{className:"flex items-end",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:a.showPendingChanges,onChange:E=>o(A=>({...A,showPendingChanges:E.target.checked})),className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:" "})]})})]})]}),b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[b.jsx("div",{className:"p-6 border-b border-gray-200",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[" (",x.length,")"]}),b.jsx("div",{className:"flex items-center gap-3",children:b.jsxs("label",{className:"flex items-center space-x-2",children:[b.jsx("input",{type:"checkbox",checked:i.size===x.length&&x.length>0,onChange:_,className:"rounded text-blue-600 focus:ring-blue-500"}),b.jsx("span",{className:"text-sm text-gray-700",children:" "})]})})]})}),b.jsx("div",{className:"overflow-x-auto",children:b.jsxs("table",{className:"w-full",children:[b.jsx("thead",{className:"bg-gray-50",children:b.jsxs("tr",{children:[b.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:" "}),b.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),b.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(E=>{const A=S(E.status),N=w(E);return b.jsxs("tr",{className:"hover:bg-gray-50",children:[b.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx("img",{src:E.personalInfo.photo||"https://i.pravatar.cc/40?img=1",alt:`${E.personalInfo.firstName} ${E.personalInfo.lastName}`,className:"w-10 h-10 rounded-full mr-3"}),b.jsxs("div",{children:[b.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[E.personalInfo.firstName," ",E.personalInfo.lastName]}),b.jsx("div",{className:"text-sm text-gray-500",children:E.workInfo.position})]})]})}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:b.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A.color}`,children:[b.jsx("div",{className:`w-2 h-2 rounded-full ${A.dot} mr-1.5`}),A.label]})}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:b.jsxs("div",{className:"flex items-center justify-center",children:[b.jsx("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:E.workInfo.team.color}}),b.jsx("span",{className:"text-sm text-gray-900",children:E.workInfo.team.name})]})}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500",children:E.metadata.updatedAt.toLocaleDateString()}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:N.length>0?b.jsxs("div",{className:"flex justify-center gap-1",children:[N.slice(0,2).map(P=>b.jsxs("button",{onClick:()=>M(E),className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded",style:{backgroundColor:P.color+"20",color:P.color},title:P.description,children:[b.jsx("span",{className:"mr-1",children:P.icon}),P.label]},P.to)),N.length>2&&b.jsxs("button",{className:"text-xs text-gray-500 hover:text-gray-700",children:["+",N.length-2]})]}):b.jsx("span",{className:"text-sm text-gray-400",children:" "})}),b.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:b.jsx("input",{type:"checkbox",checked:i.has(E.id),onChange:()=>T(E.id),className:"rounded text-blue-600 focus:ring-blue-500"})})]},E.id)})})]})})]}),l&&b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:b.jsx("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:b.jsxs("div",{className:"p-6",children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"  "}),b.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[b.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),b.jsx("p",{className:"text-gray-500",children:"   "}),b.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"    "})]}),b.jsx("div",{className:"flex justify-end gap-3 mt-6",children:b.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:""})})]})})})]})},jY=({employees:t,onCertificationUpdate:e,onTrainingAssign:r,onCertificationRenew:n})=>{const[i,s]=z.useState("overview"),[a,o]=z.useState(""),[l,u]=z.useState(""),[d,h]=z.useState(!1),[m,g]=z.useState({status:"",category:"",search:""}),v=[{id:"customer-service-101",name:"  ",description:"        ",duration:16,category:"mandatory",skills:[""," "],expirationPeriod:24,provider:"  ",format:"hybrid",certificationAwarded:!0},{id:"crm-advanced",name:"   CRM",description:"  CRM ",duration:8,category:"role-specific",skills:["CRM ",""],expirationPeriod:12,provider:" ",cost:15e3,format:"online",prerequisites:["crm-basics"],certificationAwarded:!0},{id:"safety-training",name:"   ",description:"    ",duration:4,category:"mandatory",skills:[""],expirationPeriod:12,provider:" ",format:"classroom",certificationAwarded:!0}],[x,w]=z.useState([{employeeId:"emp_001",trainingId:"customer-service-101",status:"completed",startDate:new Date("2024-01-15"),completionDate:new Date("2024-01-22"),expirationDate:new Date("2026-01-22"),score:92,attempts:1,lastActivity:new Date("2024-01-22")},{employeeId:"emp_001",trainingId:"safety-training",status:"completed",startDate:new Date("2024-02-01"),completionDate:new Date("2024-02-01"),expirationDate:new Date("2025-02-01"),score:85,attempts:1,lastActivity:new Date("2024-02-01")},{employeeId:"emp_002",trainingId:"customer-service-101",status:"in-progress",startDate:new Date("2024-02-10"),attempts:1,lastActivity:new Date("2024-02-15")}]),S=z.useMemo(()=>{const M=[],D=new Date,O=new Date(D.getTime()+720*60*60*1e3);return t.forEach(E=>{E.certifications.forEach(P=>{P.expirationDate&&(P.expirationDate<D&&P.status==="active"?M.push({type:"expired",employeeId:E.id,certificationId:P.id,message:` "${P.name}" `,priority:"high",dueDate:P.expirationDate}):P.expirationDate<O&&P.status==="active"&&M.push({type:"expiring",employeeId:E.id,certificationId:P.id,message:` "${P.name}"   ${Math.ceil((P.expirationDate.getTime()-D.getTime())/(1440*60*1e3))} `,priority:"medium",dueDate:P.expirationDate}))});const A=v.filter(P=>P.category==="mandatory"),N=x.filter(P=>P.employeeId===E.id);A.forEach(P=>{const B=N.find(I=>I.trainingId===P.id);(!B||B.status==="expired"||B.status==="failed")&&M.push({type:"missing",employeeId:E.id,trainingId:P.id,message:` : ${P.name}`,priority:"high"})})}),M.sort((E,A)=>{const N={high:3,medium:2,low:1};return N[A.priority]-N[E.priority]})},[t,x]),T=M=>({"not-started":{color:"bg-gray-100 text-gray-800",text:" ",icon:""},"in-progress":{color:"bg-blue-100 text-blue-800",text:" ",icon:""},completed:{color:"bg-green-100 text-green-800",text:"",icon:""},expired:{color:"bg-red-100 text-red-800",text:"",icon:""},failed:{color:"bg-orange-100 text-orange-800",text:" ",icon:""}})[M],_=()=>{const[M,D]=z.useState(new Set);if(!d)return null;const O=v.find(E=>E.id===l);return O?b.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:b.jsxs("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto shadow-2xl",children:[b.jsxs("div",{className:"border-b border-gray-200 p-6",children:[b.jsx("h3",{className:"text-xl font-bold text-gray-900",children:" "}),b.jsx("p",{className:"text-gray-600 mt-1",children:O.name})]}),b.jsxs("div",{className:"p-6",children:[b.jsxs("div",{className:"mb-4",children:[b.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:" :"}),b.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg",children:t.map(E=>{const A=M.has(E.id),N=x.find(P=>P.employeeId===E.id&&P.trainingId===O.id);return b.jsx("div",{className:`p-3 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${A?"bg-blue-50":""}`,onClick:()=>{const P=new Set(M);P.has(E.id)?P.delete(E.id):P.add(E.id),D(P)},children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("input",{type:"checkbox",checked:A,onChange:()=>{},className:"rounded text-blue-600"}),b.jsxs("div",{children:[b.jsxs("p",{className:"font-medium text-gray-900",children:[E.personalInfo.firstName," ",E.personalInfo.lastName]}),b.jsx("p",{className:"text-sm text-gray-600",children:E.workInfo.position})]})]}),N&&b.jsx("span",{className:`px-2 py-1 text-xs rounded ${T(N.status).color}`,children:T(N.status).text})]})},E.id)})})]}),b.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[b.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"  :"}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[b.jsxs("div",{children:[b.jsx("span",{className:"text-blue-700",children:":"})," ",O.duration," "]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-blue-700",children:":"})," ",O.format==="online"?"":O.format==="classroom"?"":""]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-blue-700",children:":"})," ",O.category==="mandatory"?"":O.category==="optional"?"":" "]}),O.cost&&b.jsxs("div",{children:[b.jsx("span",{className:"text-blue-700",children:":"})," ",O.cost," "]})]})]})]}),b.jsxs("div",{className:"border-t border-gray-200 p-6 flex justify-end gap-3",children:[b.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:""}),b.jsxs("button",{onClick:()=>{r==null||r(Array.from(M),O.id),h(!1),D(new Set)},disabled:M.size===0,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:["  (",M.size,")"]})]})]})}):null};return b.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[b.jsxs("div",{className:"border-b border-gray-200 p-6",children:[b.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start mb-6",children:[b.jsxs("div",{className:"mb-4 lg:mb-0",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:" "}),b.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 text-xs font-medium mb-2 uppercase tracking-wide",children:" "}),b.jsx("p",{className:"text-gray-600",children:" ,    "})]}),b.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:b.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[b.jsx("span",{className:"mr-2",children:""})," "]})})]}),S.length>0&&b.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("span",{className:"text-red-600 text-xl",children:""}),b.jsxs("div",{className:"flex-1",children:[b.jsxs("h4",{className:"font-medium text-red-900 mb-1",children:[" : ",S.length," "]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[b.jsxs("div",{className:"text-red-800",children:[": ",S.filter(M=>M.type==="expired").length]}),b.jsxs("div",{className:"text-red-800",children:[": ",S.filter(M=>M.type==="expiring").length]}),b.jsxs("div",{className:"text-red-800",children:[": ",S.filter(M=>M.type==="missing").length]})]})]})]})}),b.jsx("div",{className:"flex border-b border-gray-200",children:[{id:"overview",label:"",icon:""},{id:"certifications",label:"",icon:""},{id:"training",label:"",icon:""},{id:"compliance",label:"",icon:""}].map(M=>b.jsxs("button",{onClick:()=>s(M.id),className:`px-6 py-3 font-medium text-sm border-b-2 transition-colors ${i===M.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[b.jsx("span",{className:"mr-2",children:M.icon}),M.label]},M.id))})]}),b.jsxs("div",{className:"p-6",children:[i==="overview"&&b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[b.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-green-600 text-sm font-medium",children:" "}),b.jsx("p",{className:"text-2xl font-bold text-green-900",children:t.reduce((M,D)=>M+D.certifications.filter(O=>O.status==="active").length,0)})]}),b.jsx("span",{className:"text-3xl text-green-600",children:""})]})}),b.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-blue-600 text-sm font-medium",children:"  "}),b.jsx("p",{className:"text-2xl font-bold text-blue-900",children:x.filter(M=>M.status==="in-progress").length})]}),b.jsx("span",{className:"text-3xl text-blue-600",children:""})]})}),b.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-yellow-600 text-sm font-medium",children:" "}),b.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:S.filter(M=>M.type==="expiring").length})]}),b.jsx("span",{className:"text-3xl text-yellow-600",children:""})]})}),b.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-red-600 text-sm font-medium",children:" "}),b.jsx("p",{className:"text-2xl font-bold text-red-900",children:S.filter(M=>M.type==="expired"||M.type==="missing").length})]}),b.jsx("span",{className:"text-3xl text-red-600",children:""})]})})]}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" "}),b.jsx("div",{className:"space-y-3",children:S.slice(0,5).map((M,D)=>{const O=t.find(E=>E.id===M.employeeId);return O?b.jsx("div",{className:`border rounded-lg p-4 ${M.priority==="high"?"border-red-200 bg-red-50":M.priority==="medium"?"border-yellow-200 bg-yellow-50":"border-gray-200 bg-gray-50"}`,children:b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("span",{className:"text-2xl",children:M.type==="expired"?"":M.type==="expiring"?"":M.type==="missing"?"":""}),b.jsxs("div",{children:[b.jsxs("p",{className:"font-medium text-gray-900",children:[O.personalInfo.firstName," ",O.personalInfo.lastName]}),b.jsx("p",{className:"text-sm text-gray-600",children:M.message})]})]}),b.jsxs("div",{className:"flex gap-2",children:[M.type==="expiring"&&b.jsx("button",{onClick:()=>{M.certificationId&&(n==null||n(M.employeeId,M.certificationId))},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:""}),M.type==="missing"&&b.jsx("button",{onClick:()=>{M.trainingId&&(u(M.trainingId),h(!0))},className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:""})]})]})},D):null})})]})]}),i==="training"&&b.jsx("div",{className:"space-y-6",children:b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" "}),b.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(M=>{const D=x.filter(E=>E.trainingId===M.id).length,O=x.filter(E=>E.trainingId===M.id&&E.status==="completed").length;return b.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[b.jsxs("div",{className:"flex items-start justify-between mb-4",children:[b.jsxs("div",{children:[b.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:M.name}),b.jsx("p",{className:"text-sm text-gray-600",children:M.description})]}),b.jsx("button",{onClick:()=>{u(M.id),h(!0)},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:""})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:":"})," ",M.duration,""]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:":"})," ",M.format==="online"?"":M.format==="classroom"?"":""]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:":"})," ",D]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:":"})," ",O]})]}),b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsx("span",{className:`px-2 py-1 text-xs rounded ${M.category==="mandatory"?"bg-red-100 text-red-800":M.category==="role-specific"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:M.category==="mandatory"?"":M.category==="role-specific"?" ":""}),M.certificationAwarded&&b.jsx("span",{className:"text-sm text-green-600",children:" "})]})]},M.id)})})]})}),i==="compliance"&&b.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-gray-300 rounded-xl",children:[b.jsx("div",{className:"text-6xl text-gray-400 mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),b.jsx("p",{className:"text-gray-500 mb-4",children:"       "}),b.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 max-w-md mx-auto",children:[b.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" :"}),b.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 text-left",children:[b.jsx("li",{children:"    "}),b.jsx("li",{children:"   "}),b.jsx("li",{children:"    "}),b.jsx("li",{children:"  "})]})]})]}),i==="certifications"&&b.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-gray-300 rounded-xl",children:[b.jsx("div",{className:"text-6xl text-gray-400 mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:" "}),b.jsx("p",{className:"text-gray-500",children:"   "})]})]}),b.jsx(_,{})]})},oO="employee-management-parity:employees",zY=t=>typeof t=="string"&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z/.test(t),VY=t=>{try{return JSON.parse(t,(e,r)=>zY(r)?new Date(r):r)}catch(e){return console.error("     ",e),null}},$Y=t=>JSON.stringify(t,(e,r)=>r instanceof Date?r.toISOString():r),UY=()=>{if(typeof window>"u")return W0;try{const t=window.localStorage.getItem(oO);if(!t)return W0;const e=VY(t);return Array.isArray(e)&&e.length>0?e:W0}catch(t){return console.error("     localStorage",t),W0}},ea=(t,e,r="system")=>{const n=new Date(e);return t.map((i,s)=>Ul(i,r,{createdAt:new Date(n.getTime()+s*10*60*1e3),createdBy:"system"}))},ta={support:{id:"team_support",name:" ",description:"    1010.ru",color:"#2563eb",managerId:"mgr_support",memberCount:18,targetUtilization:.85},quality:{id:"team_quality",name:" ",description:"    ",color:"#9333ea",managerId:"mgr_quality",memberCount:9,targetUtilization:.8},sales:{id:"team_sales",name:" B2B",description:"   ",color:"#f97316",managerId:"mgr_sales",memberCount:14,targetUtilization:.78},operations:{id:"team_operations",name:" ",description:"   ",color:"#0f766e",managerId:"mgr_ops",memberCount:22,targetUtilization:.88},hr:{id:"team_hr",name:"HR-",description:",    ",color:"#ef4444",managerId:"mgr_hr",memberCount:6,targetUtilization:.7},training:{id:"team_training",name:" ",description:"   ",color:"#a855f7",managerId:"mgr_training",memberCount:11,targetUtilization:.75}},W0=[{id:"emp_001",employeeId:"EMP001",status:"active",personalInfo:{firstName:"",lastName:"",middleName:"",email:"dinara.abdullaeva@company.com",phone:"+996555123456",photo:"https://i.pravatar.cc/150?img=1",address:". ,   12",emergencyContact:{name:" ",phone:"+996555123457",relationship:""}},credentials:{wfmLogin:"d.abdullaeva",externalLogins:["crm","telephony"],passwordSet:!0,passwordLastUpdated:new Date("2024-01-05")},workInfo:{position:" ",team:{...ta.support},manager:" ..",hireDate:new Date("2021-03-15"),contractType:"full-time",salary:45e3,workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Europe/Moscow",hourNorm:40,workScheme:{id:"scheme-support-day",name:" ",effectiveFrom:new Date("2022-03-15")},workSchemeHistory:[{id:"scheme-support-flex-2021",name:" ",effectiveFrom:new Date("2021-06-01"),effectiveTo:new Date("2022-03-14")},{id:"scheme-support-night-2020",name:" ",effectiveFrom:new Date("2020-01-01"),effectiveTo:new Date("2021-05-31")}]},skills:[{id:"s1",name:" ",category:"communication",level:5,verified:!0,lastAssessed:new Date("2024-01-15"),assessor:" ..",certificationRequired:!1,priority:1},{id:"s2",name:"CRM ",category:"technical",level:4,verified:!0,lastAssessed:new Date("2024-02-01"),assessor:" ..",certificationRequired:!0,priority:2}],reserveSkills:[{id:"s3",name:" 3",category:"product",level:3,verified:!1,lastAssessed:new Date("2023-10-20"),assessor:" ..",certificationRequired:!1,priority:3}],tags:[""," ",""],preferences:{preferredShifts:["morning","day"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"08:00",end:"17:00"},schemePreferences:[" ","   "]},performance:{averageHandleTime:7.5,callsPerHour:12.5,qualityScore:94,adherenceScore:87,customerSatisfaction:4.8,lastEvaluation:new Date("2024-01-30")},certifications:[],metadata:{createdAt:new Date("2021-03-10"),updatedAt:new Date("2024-02-15"),createdBy:"admin_001",lastModifiedBy:"mgr_001",lastLogin:new Date("2024-02-14T09:30:00")},personnelNumber:"PN-001",actualAddress:". ,   12",tasks:ea([" "," "],"2024-01-12T09:00:00Z")},{id:"emp_002",employeeId:"EMP002",status:"vacation",personalInfo:{firstName:"",lastName:"",middleName:"",email:"a.musaeva@company.com",phone:"+996700112299",photo:"https://i.pravatar.cc/150?img=5",address:". , .  88",emergencyContact:{name:" ",phone:"+996700113355",relationship:""}},credentials:{wfmLogin:"a.musaeva",externalLogins:["quality","crm"],passwordSet:!0,passwordLastUpdated:new Date("2023-12-20")},workInfo:{position:"   ",team:{...ta.quality},manager:" ..",hireDate:new Date("2019-06-01"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Asia/Bishkek",hourNorm:40,workScheme:{id:"scheme-quality-flex",name:" ",effectiveFrom:new Date("2021-01-05")},workSchemeHistory:[{id:"scheme-quality-standard-2020",name:"  5/2",effectiveFrom:new Date("2020-02-01"),effectiveTo:new Date("2021-01-04")},{id:"scheme-quality-remote-2019",name:" ",effectiveFrom:new Date("2019-07-01"),effectiveTo:new Date("2020-01-31")}]},skills:[{id:"s4",name:" ",category:"communication",level:5,verified:!0,lastAssessed:new Date("2024-02-10"),assessor:" ..",certificationRequired:!1},{id:"s5",name:" ",category:"technical",level:4,verified:!0,lastAssessed:new Date("2023-11-14"),assessor:" ..",certificationRequired:!1}],reserveSkills:[],tags:[" ",""],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!1,push:!0,scheduleChanges:!0,announcements:!0,reminders:!1},language:"ru",workingHours:{start:"10:00",end:"19:00"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:97,adherenceScore:92,customerSatisfaction:4.9,lastEvaluation:new Date("2024-02-05")},certifications:[],metadata:{createdAt:new Date("2019-05-20"),updatedAt:new Date("2024-01-18"),createdBy:"admin_002",lastModifiedBy:"mgr_quality",lastLogin:new Date("2024-01-25T12:45:00")},personnelNumber:"PN-002",actualAddress:". , .  88",tasks:ea([" ","  "],"2024-02-03T10:15:00Z")},{id:"emp_003",employeeId:"EMP003",status:"probation",personalInfo:{firstName:"",lastName:"",middleName:"",email:"ruslan.akhmetov@company.com",phone:"+996770445566",photo:"https://i.pravatar.cc/150?img=11",address:". , .  45"},credentials:{wfmLogin:"r.akhmetov",externalLogins:["crm"],passwordSet:!1},workInfo:{position:"  ",team:{...ta.support},manager:" ..",hireDate:new Date("2024-08-12"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Europe/Moscow",hourNorm:36,workScheme:{id:"scheme-support-evening",name:" ",effectiveFrom:new Date("2024-08-01")},workSchemeHistory:[{id:"scheme-support-onboarding-2024",name:" + ",effectiveFrom:new Date("2024-07-01"),effectiveTo:new Date("2024-07-31")}]},skills:[{id:"s6",name:" ",category:"communication",level:3,verified:!1,lastAssessed:new Date("2024-08-20"),assessor:" ..",certificationRequired:!1},{id:"s7",name:"  ",category:"product",level:2,verified:!1,lastAssessed:new Date("2024-08-20"),assessor:"  1",certificationRequired:!1}],reserveSkills:[],tags:["",""],preferences:{preferredShifts:["evening"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!1,reminders:!0},language:"ru",workingHours:{start:"13:00",end:"22:00"},schemePreferences:[" "]},performance:{averageHandleTime:9.2,callsPerHour:10.1,qualityScore:88,adherenceScore:75,customerSatisfaction:4.3,lastEvaluation:new Date("2024-08-25")},certifications:[],metadata:{createdAt:new Date("2024-08-12"),updatedAt:new Date("2024-08-27"),createdBy:"mgr_support",lastModifiedBy:"mentor_01"},personnelNumber:"PN-003",actualAddress:". , .  45",tasks:ea([" ","  "],"2024-02-18T08:30:00Z")},{id:"emp_004",employeeId:"EMP004",status:"terminated",personalInfo:{firstName:"",lastName:"",middleName:"",email:"p.chernova@company.com",phone:"+996555667788",photo:"https://i.pravatar.cc/150?img=14",address:". , .  3"},credentials:{wfmLogin:"p.chernova",externalLogins:["sales-crm"],passwordSet:!0,passwordLastUpdated:new Date("2023-04-02")},workInfo:{position:"   B2B",team:{...ta.sales},manager:" ..",hireDate:new Date("2018-02-10"),contractType:"full-time",salary:78e3,workLocation:" ",department:" B2B"},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Europe/Moscow",hourNorm:40,workScheme:{id:"scheme-sales-field",name:" ",effectiveFrom:new Date("2020-01-01")},workSchemeHistory:[{id:"scheme-sales-classic-2019",name:" ",effectiveFrom:new Date("2019-02-01"),effectiveTo:new Date("2019-12-31")},{id:"scheme-sales-intern-2018",name:" ",effectiveFrom:new Date("2018-02-10"),effectiveTo:new Date("2019-01-31")}]},skills:[{id:"s8",name:" B2B",category:"communication",level:4,verified:!0,lastAssessed:new Date("2023-03-20"),assessor:" ..",certificationRequired:!0},{id:"s9",name:"",category:"soft-skill",level:5,verified:!0,lastAssessed:new Date("2023-03-20"),assessor:" ..",certificationRequired:!1}],reserveSkills:[],tags:["","B2B"],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!0,push:!1,scheduleChanges:!1,announcements:!0,reminders:!1},language:"ru",workingHours:{start:"09:30",end:"18:30"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:0,adherenceScore:0,customerSatisfaction:4.6,lastEvaluation:new Date("2023-04-10")},certifications:[],metadata:{createdAt:new Date("2018-02-01"),updatedAt:new Date("2024-04-12"),createdBy:"admin_sales",lastModifiedBy:"hr_partner",lastLogin:new Date("2024-04-01T18:45:00")},personnelNumber:"PN-004",actualAddress:". , .  3",tasks:ea(["  ","  "],"2024-01-28T11:00:00Z")},{id:"emp_005",employeeId:"EMP005",status:"active",personalInfo:{firstName:"",lastName:"",middleName:"",email:"sergey.nikitin@company.com",phone:"+996500778899",photo:"https://i.pravatar.cc/150?img=21",address:". , .  24-17"},credentials:{wfmLogin:"s.nikitin",externalLogins:["scheduler","crm"],passwordSet:!0,passwordLastUpdated:new Date("2024-06-03")},workInfo:{position:" ",team:{...ta.operations},manager:" ..",hireDate:new Date("2020-11-01"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Asia/Bishkek",hourNorm:40,workScheme:{id:"scheme-operations-shift",name:"  2/2",effectiveFrom:new Date("2021-02-01")},workSchemeHistory:[{id:"scheme-operations-admin-2020",name:" ",effectiveFrom:new Date("2020-01-01"),effectiveTo:new Date("2021-01-31")}]},skills:[{id:"s10",name:" ",category:"soft-skill",level:4,verified:!0,lastAssessed:new Date("2024-06-01"),assessor:" ..",certificationRequired:!1},{id:"s11",name:" ",category:"technical",level:4,verified:!0,lastAssessed:new Date("2024-05-15"),assessor:" ..",certificationRequired:!0}],reserveSkills:[{id:"s12",name:" ",category:"product",level:3,verified:!1,lastAssessed:new Date("2023-12-03"),assessor:" ..",certificationRequired:!1}],tags:[""," "],preferences:{preferredShifts:["day","night"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"07:00",end:"19:00"},schemePreferences:["  2/2"]},performance:{averageHandleTime:6.1,callsPerHour:0,qualityScore:92,adherenceScore:89,customerSatisfaction:4.7,lastEvaluation:new Date("2024-06-10")},certifications:[],metadata:{createdAt:new Date("2020-10-20"),updatedAt:new Date("2024-06-15"),createdBy:"mgr_ops",lastModifiedBy:"mgr_ops",lastLogin:new Date("2024-07-02T07:10:00")},personnelNumber:"PN-005",actualAddress:". , .  24-17",tasks:ea(["  ","  "],"2024-02-09T07:45:00Z")},{id:"emp_006",employeeId:"EMP006",status:"inactive",personalInfo:{firstName:"",lastName:"",middleName:"",email:"victoria.zhumabaeva@company.com",phone:"+996509336699",photo:"https://i.pravatar.cc/150?img=28",address:". , .  10"},credentials:{wfmLogin:"v.zhumabaeva",externalLogins:["hr-portal"],passwordSet:!0,passwordLastUpdated:new Date("2022-10-01")},workInfo:{position:"HR -",team:{...ta.hr},manager:" ..",hireDate:new Date("2019-04-05"),contractType:"full-time",workLocation:" ",department:"HR-"},orgPlacement:{orgUnit:"HR",office:" ",timeZone:"Europe/Moscow",hourNorm:40,workScheme:{id:"scheme-hr-flex",name:" ",effectiveFrom:new Date("2022-01-10")},workSchemeHistory:[{id:"scheme-hr-admin-2020",name:" ",effectiveFrom:new Date("2020-01-01"),effectiveTo:new Date("2022-01-09")}]},skills:[{id:"s13",name:" ",category:"soft-skill",level:4,verified:!0,lastAssessed:new Date("2023-09-01"),assessor:" ..",certificationRequired:!1},{id:"s14",name:" ",category:"soft-skill",level:4,verified:!0,lastAssessed:new Date("2023-09-01"),assessor:" ..",certificationRequired:!1}],reserveSkills:[],tags:["HR",""],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!1,push:!0,scheduleChanges:!1,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"09:00",end:"18:00"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:0,adherenceScore:0,customerSatisfaction:4.2,lastEvaluation:new Date("2023-12-01")},certifications:[],metadata:{createdAt:new Date("2019-03-25"),updatedAt:new Date("2024-03-12"),createdBy:"admin_hr",lastModifiedBy:"admin_hr",lastLogin:new Date("2024-02-28T15:00:00")},personnelNumber:"PN-006",actualAddress:". , .  10",tasks:ea([" "," "],"2024-01-22T09:20:00Z")},{id:"emp_007",employeeId:"EMP007",status:"active",personalInfo:{firstName:"",lastName:"",middleName:"",email:"arman.zhaksylykov@company.com",phone:"+996555001144",photo:"https://i.pravatar.cc/150?img=31",address:". , .  115"},credentials:{wfmLogin:"a.zhaksylykov",externalLogins:["sales-crm","telegram"],passwordSet:!0,passwordLastUpdated:new Date("2024-05-11")},workInfo:{position:"-",team:{...ta.sales},manager:" ..",hireDate:new Date("2021-09-15"),contractType:"full-time",workLocation:" ",department:" B2B"},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Asia/Almaty",hourNorm:40,workScheme:{id:"scheme-sales-standard",name:" ",effectiveFrom:new Date("2021-09-15")},workSchemeHistory:[{id:"scheme-sales-training-2021",name:" +  ",effectiveFrom:new Date("2021-06-01"),effectiveTo:new Date("2021-09-14")}]},skills:[{id:"s15",name:"  VIP ",category:"communication",level:5,verified:!0,lastAssessed:new Date("2024-05-01"),assessor:" ..",certificationRequired:!0},{id:"s16",name:" ",category:"language",level:4,verified:!0,lastAssessed:new Date("2024-04-20"),assessor:"HR  ",certificationRequired:!1}],reserveSkills:[{id:"s17",name:"SaaS ",category:"product",level:3,verified:!1,lastAssessed:new Date("2023-10-15"),assessor:" ..",certificationRequired:!1}],tags:["VIP",""],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"09:00",end:"18:00"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:0,adherenceScore:91,customerSatisfaction:4.9,lastEvaluation:new Date("2024-05-25")},certifications:[],metadata:{createdAt:new Date("2021-09-10"),updatedAt:new Date("2024-05-30"),createdBy:"admin_sales",lastModifiedBy:"mgr_sales",lastLogin:new Date("2024-06-28T10:20:00")},personnelNumber:"PN-007",actualAddress:". , .  115",tasks:ea([" VIP-","-"],"2024-02-12T13:10:00Z")},{id:"emp_008",employeeId:"EMP008",status:"vacation",personalInfo:{firstName:"",lastName:"",middleName:"",email:"kamila.usmanova@company.com",phone:"+996775998877",photo:"https://i.pravatar.cc/150?img=37",address:". , .  123"},credentials:{wfmLogin:"k.usmanova",externalLogins:["lms","teams"],passwordSet:!0,passwordLastUpdated:new Date("2024-03-01")},workInfo:{position:"  ",team:{...ta.training},manager:" ..",hireDate:new Date("2017-01-20"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Asia/Bishkek",hourNorm:38,workScheme:{id:"scheme-training-flex",name:" ",effectiveFrom:new Date("2022-09-01")},workSchemeHistory:[{id:"scheme-training-admin-2021",name:" ",effectiveFrom:new Date("2021-03-01"),effectiveTo:new Date("2022-08-31")}]},skills:[{id:"s18",name:" ",category:"communication",level:5,verified:!0,lastAssessed:new Date("2024-02-12"),assessor:" ..",certificationRequired:!1},{id:"s19",name:"  ",category:"technical",level:4,verified:!0,lastAssessed:new Date("2024-02-12"),assessor:" ..",certificationRequired:!1}],reserveSkills:[],tags:["",""],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!1,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"09:30",end:"18:30"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:99,adherenceScore:95,customerSatisfaction:4.8,lastEvaluation:new Date("2024-03-10")},certifications:[],metadata:{createdAt:new Date("2017-01-10"),updatedAt:new Date("2024-03-01"),createdBy:"admin_training",lastModifiedBy:"mgr_training",lastLogin:new Date("2024-03-05T11:30:00")},personnelNumber:"PN-008",actualAddress:". , .  123",tasks:ea([" "," "],"2024-01-16T14:05:00Z")},{id:"emp_009",employeeId:"EMP009",status:"probation",personalInfo:{firstName:"",lastName:"",middleName:"",email:"anna.melnikova@company.com",phone:"+996707554433",photo:"https://i.pravatar.cc/150?img=45",address:". , .   18"},credentials:{wfmLogin:"a.melnikova",externalLogins:["quality","analytics"],passwordSet:!1},workInfo:{position:" ",team:{...ta.quality},manager:" ..",hireDate:new Date("2024-05-06"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:" ",office:" ",timeZone:"Asia/Bishkek",hourNorm:40,workScheme:{id:"scheme-quality-analyst",name:" ",effectiveFrom:new Date("2024-05-06")},workSchemeHistory:[{id:"scheme-quality-onboarding-2024",name:" + ",effectiveFrom:new Date("2024-04-01"),effectiveTo:new Date("2024-05-05")}]},skills:[{id:"s20",name:"Power BI",category:"technical",level:3,verified:!1,lastAssessed:new Date("2024-06-01"),assessor:" ..",certificationRequired:!1},{id:"s21",name:"SQL ",category:"technical",level:3,verified:!1,lastAssessed:new Date("2024-06-01"),assessor:" ..",certificationRequired:!1}],reserveSkills:[],tags:[""," "],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!1,push:!0,scheduleChanges:!0,announcements:!0,reminders:!1},language:"ru",workingHours:{start:"09:00",end:"18:00"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:0,adherenceScore:82,customerSatisfaction:4.5,lastEvaluation:new Date("2024-06-15")},certifications:[],metadata:{createdAt:new Date("2024-05-03"),updatedAt:new Date("2024-06-18"),createdBy:"mgr_quality",lastModifiedBy:"mentor_quality"},personnelNumber:"PN-009",actualAddress:". , .   18",tasks:ea(["  Power BI"," "],"2024-02-25T15:40:00Z")},{id:"emp_010",employeeId:"EMP010",status:"active",personalInfo:{firstName:"",lastName:"",middleName:"",email:"dmitry.lebedev@company.com",phone:"+996709445599",photo:"https://i.pravatar.cc/150?img=52",address:". , .  142"},credentials:{wfmLogin:"d.lebedev",externalLogins:["scheduler","excel"],passwordSet:!0,passwordLastUpdated:new Date("2024-02-14")},workInfo:{position:" ",team:{...ta.operations},manager:" ..",hireDate:new Date("2016-07-12"),contractType:"full-time",workLocation:" ",department:" "},orgPlacement:{orgUnit:"",office:" ",timeZone:"Europe/Moscow",hourNorm:40,workScheme:{id:"scheme-operations-planner",name:" ",effectiveFrom:new Date("2016-07-12")},workSchemeHistory:[{id:"scheme-operations-night-2018",name:"  2/2",effectiveFrom:new Date("2018-05-01"),effectiveTo:new Date("2020-03-31")},{id:"scheme-operations-flex-2020",name:" ",effectiveFrom:new Date("2020-04-01"),effectiveTo:new Date("2022-12-31")}]},skills:[{id:"s22",name:" ",category:"technical",level:5,verified:!0,lastAssessed:new Date("2024-02-01"),assessor:" ..",certificationRequired:!0},{id:"s23",name:"Excel ",category:"technical",level:5,verified:!0,lastAssessed:new Date("2024-02-01"),assessor:" ..",certificationRequired:!1}],reserveSkills:[{id:"s24",name:"Python ",category:"technical",level:3,verified:!1,lastAssessed:new Date("2023-11-18"),assessor:" ..",certificationRequired:!1}],tags:["","Excel"],preferences:{preferredShifts:["day"],notifications:{email:!0,sms:!0,push:!0,scheduleChanges:!0,announcements:!0,reminders:!0},language:"ru",workingHours:{start:"08:30",end:"17:30"},schemePreferences:[" "]},performance:{averageHandleTime:0,callsPerHour:0,qualityScore:95,adherenceScore:93,customerSatisfaction:4.9,lastEvaluation:new Date("2024-02-10")},certifications:[],metadata:{createdAt:new Date("2016-07-01"),updatedAt:new Date("2024-04-05"),createdBy:"admin_ops",lastModifiedBy:"mgr_ops",lastLogin:new Date("2024-04-20T08:10:00")},personnelNumber:"PN-010",actualAddress:". , .  142",tasks:ea([" ","   "],"2024-02-02T16:20:00Z")}],HY=()=>{var x;const[t,e]=z.useState(()=>UY()),[r,n]=z.useState("list"),[i,s]=z.useState(!1),[a,o]=z.useState(null),l=z.useRef(null),u=z.useMemo(()=>{const w=new Map;return t.forEach(S=>{w.set(S.workInfo.team.id,S.workInfo.team)}),Array.from(w.values())},[t]),d=z.useCallback(w=>{e(S=>w(S))},[]),h=z.useCallback(()=>{const w=typeof document<"u"?document.activeElement:null;l.current=w instanceof HTMLElement?w:null,s(!0),n("list")},[]),m=z.useCallback(w=>{s(!1);const S=(w==null?void 0:w.restoreFocus)!==!1,T=l.current;l.current=null,S&&T&&T.isConnected&&(typeof window<"u"?window.requestAnimationFrame(()=>{T.focus()}):T.focus())},[]),g=z.useCallback(w=>{const S=Date.now(),T={...w,id:`emp_${S}`,metadata:{createdAt:new Date(S),updatedAt:new Date(S),createdBy:"agent",lastModifiedBy:"agent"}};e(_=>[T,..._]),s(!1),o(T.id),n("list")},[]);z.useEffect(()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(oO,$Y(t))}catch(w){console.error("     localStorage",w)}},[t]),z.useEffect(()=>(typeof window<"u"&&(window.__openQuickAdd=h),()=>{typeof window<"u"&&delete window.__openQuickAdd}),[h]),z.useEffect(()=>{if(!a)return;const w=window.setTimeout(()=>o(null),1500);return()=>window.clearTimeout(w)},[a]);const v=[{id:"list",label:" ",icon:""},{id:"gallery",label:" ",icon:""},{id:"performance",label:"",icon:""},{id:"statusManager",label:"",icon:""},{id:"certifications",label:"",icon:""},{id:"skills",label:"",icon:""}];return b.jsxs("div",{className:"min-h-screen bg-gray-50",children:[b.jsx("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsx("div",{className:"flex items-center justify-between h-16",children:b.jsxs("div",{className:"flex items-center gap-4",children:[b.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:b.jsx("span",{className:"text-white font-bold text-sm",children:"WFM"})}),b.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"  - 1010.ru"})]})})})}),b.jsx("div",{className:"bg-white border-b border-gray-200",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsx("nav",{className:"flex space-x-1",children:v.map(w=>b.jsxs("button",{onClick:()=>n(w.id),className:`px-6 py-3 text-sm font-medium border-b-2 transition-all ${r===w.id?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[b.jsx("span",{"aria-hidden":!0,children:w.icon})," ",w.label]},w.id))})})}),b.jsx("div",{className:"bg-blue-50 border-b border-blue-200 py-2",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("span",{className:"text-sm text-blue-800",children:[b.jsx("strong",{children:" :"})," ",(x=v.find(w=>w.id===r))==null?void 0:x.label]})})}),b.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r==="list"&&b.jsx(DY,{employees:t,onEmployeesChange:d,onOpenQuickAdd:h,focusEmployeeId:a}),r==="gallery"&&b.jsx(OY,{employees:t,teams:u}),r==="performance"&&b.jsx(FY,{employees:t}),r==="statusManager"&&b.jsx(BY,{employees:t}),r==="certifications"&&b.jsx(jY,{employees:t}),r==="skills"&&b.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-gray-300 rounded-xl",children:[b.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),b.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:""}),b.jsx("p",{className:"text-gray-500",children:"    "})]})]}),b.jsx(LY,{teams:u,isOpen:i,onClose:m,onSubmit:g})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function uh(t){return t+.5|0}const Bo=(t,e,r)=>Math.max(Math.min(t,r),e);function Jf(t){return Bo(uh(t*2.55),0,255)}function Ko(t){return Bo(uh(t*255),0,255)}function za(t){return Bo(uh(t/2.55)/100,0,1)}function BC(t){return Bo(uh(t*100),0,100)}const is={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},$1=[..."0123456789ABCDEF"],WY=t=>$1[t&15],GY=t=>$1[(t&240)>>4]+$1[t&15],G0=t=>(t&240)>>4===(t&15),qY=t=>G0(t.r)&&G0(t.g)&&G0(t.b)&&G0(t.a);function YY(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&is[t[1]]*17,g:255&is[t[2]]*17,b:255&is[t[3]]*17,a:e===5?is[t[4]]*17:255}:(e===7||e===9)&&(r={r:is[t[1]]<<4|is[t[2]],g:is[t[3]]<<4|is[t[4]],b:is[t[5]]<<4|is[t[6]],a:e===9?is[t[7]]<<4|is[t[8]]:255})),r}const KY=(t,e)=>t<255?e(t):"";function XY(t){var e=qY(t)?WY:GY;return t?"#"+e(t.r)+e(t.g)+e(t.b)+KY(t.a,e):void 0}const ZY=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function lO(t,e,r){const n=e*Math.min(r,1-r),i=(s,a=(s+t/30)%12)=>r-n*Math.max(Math.min(a-3,9-a,1),-1);return[i(0),i(8),i(4)]}function JY(t,e,r){const n=(i,s=(i+t/60)%6)=>r-r*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function QY(t,e,r){const n=lO(t,1,.5);let i;for(e+r>1&&(i=1/(e+r),e*=i,r*=i),i=0;i<3;i++)n[i]*=1-e-r,n[i]+=e;return n}function eK(t,e,r,n,i){return t===i?(e-r)/n+(e<r?6:0):e===i?(r-t)/n+2:(t-e)/n+4}function Cw(t){const r=t.r/255,n=t.g/255,i=t.b/255,s=Math.max(r,n,i),a=Math.min(r,n,i),o=(s+a)/2;let l,u,d;return s!==a&&(d=s-a,u=o>.5?d/(2-s-a):d/(s+a),l=eK(r,n,i,d,s),l=l*60+.5),[l|0,u||0,o]}function Ew(t,e,r,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,n)).map(Ko)}function Tw(t,e,r){return Ew(lO,t,e,r)}function tK(t,e,r){return Ew(QY,t,e,r)}function rK(t,e,r){return Ew(JY,t,e,r)}function cO(t){return(t%360+360)%360}function nK(t){const e=ZY.exec(t);let r=255,n;if(!e)return;e[5]!==n&&(r=e[6]?Jf(+e[5]):Ko(+e[5]));const i=cO(+e[2]),s=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?n=tK(i,s,a):e[1]==="hsv"?n=rK(i,s,a):n=Tw(i,s,a),{r:n[0],g:n[1],b:n[2],a:r}}function iK(t,e){var r=Cw(t);r[0]=cO(r[0]+e),r=Tw(r),t.r=r[0],t.g=r[1],t.b=r[2]}function sK(t){if(!t)return;const e=Cw(t),r=e[0],n=BC(e[1]),i=BC(e[2]);return t.a<255?`hsla(${r}, ${n}%, ${i}%, ${za(t.a)})`:`hsl(${r}, ${n}%, ${i}%)`}const jC={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},zC={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function aK(){const t={},e=Object.keys(zC),r=Object.keys(jC);let n,i,s,a,o;for(n=0;n<e.length;n++){for(a=o=e[n],i=0;i<r.length;i++)s=r[i],o=o.replace(s,jC[s]);s=parseInt(zC[a],16),t[o]=[s>>16&255,s>>8&255,s&255]}return t}let q0;function oK(t){q0||(q0=aK(),q0.transparent=[0,0,0,0]);const e=q0[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const lK=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function cK(t){const e=lK.exec(t);let r=255,n,i,s;if(e){if(e[7]!==n){const a=+e[7];r=e[8]?Jf(a):Bo(a*255,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?Jf(n):Bo(n,0,255)),i=255&(e[4]?Jf(i):Bo(i,0,255)),s=255&(e[6]?Jf(s):Bo(s,0,255)),{r:n,g:i,b:s,a:r}}}function uK(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${za(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Ov=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,nu=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function fK(t,e,r){const n=nu(za(t.r)),i=nu(za(t.g)),s=nu(za(t.b));return{r:Ko(Ov(n+r*(nu(za(e.r))-n))),g:Ko(Ov(i+r*(nu(za(e.g))-i))),b:Ko(Ov(s+r*(nu(za(e.b))-s))),a:t.a+r*(e.a-t.a)}}function Y0(t,e,r){if(t){let n=Cw(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*r,e===0?360:1)),n=Tw(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function uO(t,e){return t&&Object.assign(e||{},t)}function VC(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Ko(t[3]))):(e=uO(t,{r:0,g:0,b:0,a:1}),e.a=Ko(e.a)),e}function dK(t){return t.charAt(0)==="r"?cK(t):nK(t)}class Yd{constructor(e){if(e instanceof Yd)return e;const r=typeof e;let n;r==="object"?n=VC(e):r==="string"&&(n=YY(e)||oK(e)||dK(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=uO(this._rgb);return e&&(e.a=za(e.a)),e}set rgb(e){this._rgb=VC(e)}rgbString(){return this._valid?uK(this._rgb):void 0}hexString(){return this._valid?XY(this._rgb):void 0}hslString(){return this._valid?sK(this._rgb):void 0}mix(e,r){if(e){const n=this.rgb,i=e.rgb;let s;const a=r===s?.5:r,o=2*a-1,l=n.a-i.a,u=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-u,n.r=255&u*n.r+s*i.r+.5,n.g=255&u*n.g+s*i.g+.5,n.b=255&u*n.b+s*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(e,r){return e&&(this._rgb=fK(this._rgb,e._rgb,r)),this}clone(){return new Yd(this.rgb)}alpha(e){return this._rgb.a=Ko(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=uh(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Y0(this._rgb,2,e),this}darken(e){return Y0(this._rgb,2,-e),this}saturate(e){return Y0(this._rgb,1,e),this}desaturate(e){return Y0(this._rgb,1,-e),this}rotate(e){return iK(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ia(){}const hK=(()=>{let t=0;return()=>t++})();function Ar(t){return t==null}function ln(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Gt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ei(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function ra(t,e){return ei(t)?t:e}function Ht(t,e){return typeof t>"u"?e:t}const pK=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function br(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function ur(t,e,r,n){let i,s,a;if(ln(t))for(s=t.length,i=0;i<s;i++)e.call(r,t[i],i);else if(Gt(t))for(a=Object.keys(t),s=a.length,i=0;i<s;i++)e.call(r,t[a[i]],a[i])}function tm(t,e){let r,n,i,s;if(!t||!e||t.length!==e.length)return!1;for(r=0,n=t.length;r<n;++r)if(i=t[r],s=e[r],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function rm(t){if(ln(t))return t.map(rm);if(Gt(t)){const e=Object.create(null),r=Object.keys(t),n=r.length;let i=0;for(;i<n;++i)e[r[i]]=rm(t[r[i]]);return e}return t}function fO(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function mK(t,e,r,n){if(!fO(t))return;const i=e[t],s=r[t];Gt(i)&&Gt(s)?Kd(i,s,n):e[t]=rm(s)}function Kd(t,e,r){const n=ln(e)?e:[e],i=n.length;if(!Gt(t))return t;r=r||{};const s=r.merger||mK;let a;for(let o=0;o<i;++o){if(a=n[o],!Gt(a))continue;const l=Object.keys(a);for(let u=0,d=l.length;u<d;++u)s(l[u],t,a,r)}return t}function yd(t,e){return Kd(t,e,{merger:gK})}function gK(t,e,r){if(!fO(t))return;const n=e[t],i=r[t];Gt(n)&&Gt(i)?yd(n,i):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=rm(i))}const $C={"":t=>t,x:t=>t.x,y:t=>t.y};function xK(t){const e=t.split("."),r=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(r.push(n),n="");return r}function vK(t){const e=xK(t);return r=>{for(const n of e){if(n==="")break;r=r&&r[n]}return r}}function nm(t,e){return($C[e]||($C[e]=vK(e)))(t)}function Aw(t){return t.charAt(0).toUpperCase()+t.slice(1)}const im=t=>typeof t<"u",nl=t=>typeof t=="function",UC=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function yK(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const dr=Math.PI,bn=2*dr,wK=bn+dr,sm=Number.POSITIVE_INFINITY,bK=dr/180,Fn=dr/2,El=dr/4,HC=dr*2/3,dO=Math.log10,Lu=Math.sign;function wd(t,e,r){return Math.abs(t-e)<r}function WC(t){const e=Math.round(t);t=wd(t,e,t/1e3)?e:t;const r=Math.pow(10,Math.floor(dO(t))),n=t/r;return(n<=1?1:n<=2?2:n<=5?5:10)*r}function kK(t){const e=[],r=Math.sqrt(t);let n;for(n=1;n<r;n++)t%n===0&&(e.push(n),e.push(t/n));return r===(r|0)&&e.push(r),e.sort((i,s)=>i-s).pop(),e}function SK(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function am(t){return!SK(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function _K(t,e){const r=Math.round(t);return r-e<=t&&r+e>=t}function CK(t,e,r){let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n][r],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function zl(t){return t*(dr/180)}function EK(t){return t*(180/dr)}function GC(t){if(!ei(t))return;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r++;return r}function hO(t,e){const r=e.x-t.x,n=e.y-t.y,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s<-.5*dr&&(s+=bn),{angle:s,distance:i}}function U1(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function TK(t,e){return(t-e+wK)%bn-dr}function zi(t){return(t%bn+bn)%bn}function Nw(t,e,r,n){const i=zi(t),s=zi(e),a=zi(r),o=zi(s-i),l=zi(a-i),u=zi(i-s),d=zi(i-a);return i===s||i===a||n&&s===a||o>l&&u<d}function Mi(t,e,r){return Math.max(e,Math.min(r,t))}function AK(t){return Mi(t,-32768,32767)}function Ha(t,e,r,n=1e-6){return t>=Math.min(e,r)-n&&t<=Math.max(e,r)+n}function Mw(t,e,r){r=r||(a=>t[a]<e);let n=t.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,r(s)?i=s:n=s;return{lo:i,hi:n}}const H1=(t,e,r,n)=>Mw(t,r,n?i=>{const s=t[i][e];return s<r||s===r&&t[i+1][e]===r}:i=>t[i][e]<r),NK=(t,e,r)=>Mw(t,r,n=>t[n][e]>=r);function MK(t,e,r){let n=0,i=t.length;for(;n<i&&t[n]<e;)n++;for(;i>n&&t[i-1]>r;)i--;return n>0||i<t.length?t.slice(n,i):t}const pO=["push","pop","shift","splice","unshift"];function DK(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),pO.forEach(r=>{const n="_onData"+Aw(r),i=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...s){const a=i.apply(this,s);return t._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...s)}),a}})})}function qC(t,e){const r=t._chartjs;if(!r)return;const n=r.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(pO.forEach(s=>{delete t[s]}),delete t._chartjs)}function OK(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const mO=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function gO(t,e){let r=[],n=!1;return function(...i){r=i,n||(n=!0,mO.call(window,()=>{n=!1,t.apply(e,r)}))}}function FK(t,e){let r;return function(...n){return e?(clearTimeout(r),r=setTimeout(t,e,n)):t.apply(this,n),e}}const Dw=t=>t==="start"?"left":t==="end"?"right":"center",Hn=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,IK=(t,e,r,n)=>t===(n?"left":"right")?r:t==="center"?(e+r)/2:e,K0=t=>t===0||t===1,YC=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*bn/r)),KC=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*bn/r)+1,bd={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Fn)+1,easeOutSine:t=>Math.sin(t*Fn),easeInOutSine:t=>-.5*(Math.cos(dr*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>K0(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>K0(t)?t:YC(t,.075,.3),easeOutElastic:t=>K0(t)?t:KC(t,.075,.3),easeInOutElastic(t){return K0(t)?t:t<.5?.5*YC(t*2,.1125,.45):.5+.5*KC(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-bd.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?bd.easeInBounce(t*2)*.5:bd.easeOutBounce(t*2-1)*.5+.5};function Ow(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function XC(t){return Ow(t)?t:new Yd(t)}function Fv(t){return Ow(t)?t:new Yd(t).saturate(.5).darken(.1).hexString()}const RK=["x","y","borderWidth","radius","tension"],PK=["color","borderColor","backgroundColor"];function LK(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:PK},numbers:{type:"number",properties:RK}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function BK(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ZC=new Map;function jK(t,e){e=e||{};const r=t+JSON.stringify(e);let n=ZC.get(r);return n||(n=new Intl.NumberFormat(t,e),ZC.set(r,n)),n}function xO(t,e,r){return jK(e,r).format(t)}const zK={values(t){return ln(t)?t:""+t},numeric(t,e,r){if(t===0)return"0";const n=this.chart.options.locale;let i,s=t;if(r.length>1){const u=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(u<1e-4||u>1e15)&&(i="scientific"),s=VK(t,r)}const a=dO(Math.abs(s)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),xO(t,n,l)}};function VK(t,e){let r=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(r)>=1&&t!==Math.floor(t)&&(r=t-Math.floor(t)),r}var vO={formatters:zK};function $K(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:vO.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const cc=Object.create(null),W1=Object.create(null);function kd(t,e){if(!e)return t;const r=e.split(".");for(let n=0,i=r.length;n<i;++n){const s=r[n];t=t[s]||(t[s]=Object.create(null))}return t}function Iv(t,e,r){return typeof e=="string"?Kd(kd(t,e),r):Kd(kd(t,""),e)}class UK{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>Fv(i.backgroundColor),this.hoverBorderColor=(n,i)=>Fv(i.borderColor),this.hoverColor=(n,i)=>Fv(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return Iv(this,e,r)}get(e){return kd(this,e)}describe(e,r){return Iv(W1,e,r)}override(e,r){return Iv(cc,e,r)}route(e,r,n,i){const s=kd(this,e),a=kd(this,n),o="_"+r;Object.defineProperties(s,{[o]:{value:s[r],writable:!0},[r]:{enumerable:!0,get(){const l=this[o],u=a[i];return Gt(l)?Object.assign({},u,l):Ht(l,u)},set(l){this[o]=l}}})}apply(e){e.forEach(r=>r(this))}}var Vr=new UK({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[LK,BK,$K]);function HK(t){return!t||Ar(t.size)||Ar(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function JC(t,e,r,n,i){let s=e[i];return s||(s=e[i]=t.measureText(i).width,r.push(i)),s>n&&(n=s),n}function Tl(t,e,r){const n=t.currentDevicePixelRatio,i=r!==0?Math.max(r/2,.5):0;return Math.round((e-i)*n)/n+i}function QC(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function G1(t,e,r,n){yO(t,e,r,n,null)}function yO(t,e,r,n,i){let s,a,o,l,u,d,h,m;const g=e.pointStyle,v=e.rotation,x=e.radius;let w=(v||0)*bK;if(g&&typeof g=="object"&&(s=g.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(r,n),t.rotate(w),t.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),t.restore();return}if(!(isNaN(x)||x<=0)){switch(t.beginPath(),g){default:i?t.ellipse(r,n,i/2,x,0,0,bn):t.arc(r,n,x,0,bn),t.closePath();break;case"triangle":d=i?i/2:x,t.moveTo(r+Math.sin(w)*d,n-Math.cos(w)*x),w+=HC,t.lineTo(r+Math.sin(w)*d,n-Math.cos(w)*x),w+=HC,t.lineTo(r+Math.sin(w)*d,n-Math.cos(w)*x),t.closePath();break;case"rectRounded":u=x*.516,l=x-u,a=Math.cos(w+El)*l,h=Math.cos(w+El)*(i?i/2-u:l),o=Math.sin(w+El)*l,m=Math.sin(w+El)*(i?i/2-u:l),t.arc(r-h,n-o,u,w-dr,w-Fn),t.arc(r+m,n-a,u,w-Fn,w),t.arc(r+h,n+o,u,w,w+Fn),t.arc(r-m,n+a,u,w+Fn,w+dr),t.closePath();break;case"rect":if(!v){l=Math.SQRT1_2*x,d=i?i/2:l,t.rect(r-d,n-l,2*d,2*l);break}w+=El;case"rectRot":h=Math.cos(w)*(i?i/2:x),a=Math.cos(w)*x,o=Math.sin(w)*x,m=Math.sin(w)*(i?i/2:x),t.moveTo(r-h,n-o),t.lineTo(r+m,n-a),t.lineTo(r+h,n+o),t.lineTo(r-m,n+a),t.closePath();break;case"crossRot":w+=El;case"cross":h=Math.cos(w)*(i?i/2:x),a=Math.cos(w)*x,o=Math.sin(w)*x,m=Math.sin(w)*(i?i/2:x),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+m,n-a),t.lineTo(r-m,n+a);break;case"star":h=Math.cos(w)*(i?i/2:x),a=Math.cos(w)*x,o=Math.sin(w)*x,m=Math.sin(w)*(i?i/2:x),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+m,n-a),t.lineTo(r-m,n+a),w+=El,h=Math.cos(w)*(i?i/2:x),a=Math.cos(w)*x,o=Math.sin(w)*x,m=Math.sin(w)*(i?i/2:x),t.moveTo(r-h,n-o),t.lineTo(r+h,n+o),t.moveTo(r+m,n-a),t.lineTo(r-m,n+a);break;case"line":a=i?i/2:Math.cos(w)*x,o=Math.sin(w)*x,t.moveTo(r-a,n-o),t.lineTo(r+a,n+o);break;case"dash":t.moveTo(r,n),t.lineTo(r+Math.cos(w)*(i?i/2:x),n+Math.sin(w)*x);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Xd(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function jm(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function zm(t){t.restore()}function WK(t,e,r,n,i){if(!e)return t.lineTo(r.x,r.y);if(i==="middle"){const s=(e.x+r.x)/2;t.lineTo(s,e.y),t.lineTo(s,r.y)}else i==="after"!=!!n?t.lineTo(e.x,r.y):t.lineTo(r.x,e.y);t.lineTo(r.x,r.y)}function GK(t,e,r,n){if(!e)return t.lineTo(r.x,r.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?r.cp2x:r.cp1x,n?r.cp2y:r.cp1y,r.x,r.y)}function qK(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ar(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function YK(t,e,r,n,i){if(i.strikethrough||i.underline){const s=t.measureText(n),a=e-s.actualBoundingBoxLeft,o=e+s.actualBoundingBoxRight,l=r-s.actualBoundingBoxAscent,u=r+s.actualBoundingBoxDescent,d=i.strikethrough?(l+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=i.decorationWidth||2,t.moveTo(a,d),t.lineTo(o,d),t.stroke()}}function KK(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function Zd(t,e,r,n,i,s={}){const a=ln(e)?e:[e],o=s.strokeWidth>0&&s.strokeColor!=="";let l,u;for(t.save(),t.font=i.string,qK(t,s),l=0;l<a.length;++l)u=a[l],s.backdrop&&KK(t,s.backdrop),o&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),Ar(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(u,r,n,s.maxWidth)),t.fillText(u,r,n,s.maxWidth),YK(t,r,n,u,s),n+=Number(i.lineHeight);t.restore()}function om(t,e){const{x:r,y:n,w:i,h:s,radius:a}=e;t.arc(r+a.topLeft,n+a.topLeft,a.topLeft,1.5*dr,dr,!0),t.lineTo(r,n+s-a.bottomLeft),t.arc(r+a.bottomLeft,n+s-a.bottomLeft,a.bottomLeft,dr,Fn,!0),t.lineTo(r+i-a.bottomRight,n+s),t.arc(r+i-a.bottomRight,n+s-a.bottomRight,a.bottomRight,Fn,0,!0),t.lineTo(r+i,n+a.topRight),t.arc(r+i-a.topRight,n+a.topRight,a.topRight,0,-Fn,!0),t.lineTo(r+a.topLeft,n)}const XK=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,ZK=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function JK(t,e){const r=(""+t).match(XK);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const QK=t=>+t||0;function Fw(t,e){const r={},n=Gt(e),i=n?Object.keys(e):e,s=Gt(t)?n?a=>Ht(t[a],t[e[a]]):a=>t[a]:()=>t;for(const a of i)r[a]=QK(s(a));return r}function wO(t){return Fw(t,{top:"y",right:"x",bottom:"y",left:"x"})}function ku(t){return Fw(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ms(t){const e=wO(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Zn(t,e){t=t||{},e=e||Vr.font;let r=Ht(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let n=Ht(t.style,e.style);n&&!(""+n).match(ZK)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Ht(t.family,e.family),lineHeight:JK(Ht(t.lineHeight,e.lineHeight),r),size:r,style:n,weight:Ht(t.weight,e.weight),string:""};return i.string=HK(i),i}function X0(t,e,r,n){let i,s,a;for(i=0,s=t.length;i<s;++i)if(a=t[i],a!==void 0&&a!==void 0)return a}function eX(t,e,r){const{min:n,max:i}=t,s=pK(e,(i-n)/2),a=(o,l)=>r&&o===0?0:o+l;return{min:a(n,-Math.abs(s)),max:a(i,s)}}function vc(t,e){return Object.assign(Object.create(t),e)}function Iw(t,e=[""],r,n,i=()=>t[0]){const s=r||t;typeof n>"u"&&(n=_O("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:n,_getTarget:i,override:o=>Iw([o,...t],e,s,n)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete t[0][l],!0},get(o,l){return kO(o,l,()=>lX(l,e,t,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(o,l){return tE(o).includes(l)},ownKeys(o){return tE(o)},set(o,l,u){const d=o._storage||(o._storage=i());return o[l]=d[l]=u,delete o._keys,!0}})}function Bu(t,e,r,n){const i={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:bO(t,n),setContext:s=>Bu(t,s,r,n),override:s=>Bu(t.override(s),e,r,n)};return new Proxy(i,{deleteProperty(s,a){return delete s[a],delete t[a],!0},get(s,a,o){return kO(s,a,()=>rX(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(t,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,a)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,a){return Reflect.has(t,a)},ownKeys(){return Reflect.ownKeys(t)},set(s,a,o){return t[a]=o,delete s[a],!0}})}function bO(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=t;return{allKeys:i,scriptable:r,indexable:n,isScriptable:nl(r)?r:()=>r,isIndexable:nl(n)?n:()=>n}}const tX=(t,e)=>t?t+Aw(e):e,Rw=(t,e)=>Gt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function kO(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const n=r();return t[e]=n,n}function rX(t,e,r){const{_proxy:n,_context:i,_subProxy:s,_descriptors:a}=t;let o=n[e];return nl(o)&&a.isScriptable(e)&&(o=nX(e,o,t,r)),ln(o)&&o.length&&(o=iX(e,o,t,a.isIndexable)),Rw(e,o)&&(o=Bu(o,i,s&&s[e],a)),o}function nX(t,e,r,n){const{_proxy:i,_context:s,_subProxy:a,_stack:o}=r;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);o.add(t);let l=e(s,a||n);return o.delete(t),Rw(t,l)&&(l=Pw(i._scopes,i,t,l)),l}function iX(t,e,r,n){const{_proxy:i,_context:s,_subProxy:a,_descriptors:o}=r;if(typeof s.index<"u"&&n(t))return e[s.index%e.length];if(Gt(e[0])){const l=e,u=i._scopes.filter(d=>d!==l);e=[];for(const d of l){const h=Pw(u,i,t,d);e.push(Bu(h,s,a&&a[t],o))}}return e}function SO(t,e,r){return nl(t)?t(e,r):t}const sX=(t,e)=>t===!0?e:typeof t=="string"?nm(e,t):void 0;function aX(t,e,r,n,i){for(const s of e){const a=sX(r,s);if(a){t.add(a);const o=SO(a._fallback,r,i);if(typeof o<"u"&&o!==r&&o!==n)return o}else if(a===!1&&typeof n<"u"&&r!==n)return null}return!1}function Pw(t,e,r,n){const i=e._rootScopes,s=SO(e._fallback,r,n),a=[...t,...i],o=new Set;o.add(n);let l=eE(o,a,r,s||r,n);return l===null||typeof s<"u"&&s!==r&&(l=eE(o,a,s,l,n),l===null)?!1:Iw(Array.from(o),[""],i,s,()=>oX(e,r,n))}function eE(t,e,r,n,i){for(;r;)r=aX(t,e,r,n,i);return r}function oX(t,e,r){const n=t._getTarget();e in n||(n[e]={});const i=n[e];return ln(i)&&Gt(r)?r:i||{}}function lX(t,e,r,n){let i;for(const s of e)if(i=_O(tX(s,t),r),typeof i<"u")return Rw(t,i)?Pw(r,n,t,i):i}function _O(t,e){for(const r of e){if(!r)continue;const n=r[t];if(typeof n<"u")return n}}function tE(t){let e=t._keys;return e||(e=t._keys=cX(t._scopes)),e}function cX(t){const e=new Set;for(const r of t)for(const n of Object.keys(r).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}const uX=Number.EPSILON||1e-14,ju=(t,e)=>e<t.length&&!t[e].skip&&t[e],CO=t=>t==="x"?"y":"x";function fX(t,e,r,n){const i=t.skip?e:t,s=e,a=r.skip?e:r,o=U1(s,i),l=U1(a,s);let u=o/(o+l),d=l/(o+l);u=isNaN(u)?0:u,d=isNaN(d)?0:d;const h=n*u,m=n*d;return{previous:{x:s.x-h*(a.x-i.x),y:s.y-h*(a.y-i.y)},next:{x:s.x+m*(a.x-i.x),y:s.y+m*(a.y-i.y)}}}function dX(t,e,r){const n=t.length;let i,s,a,o,l,u=ju(t,0);for(let d=0;d<n-1;++d)if(l=u,u=ju(t,d+1),!(!l||!u)){if(wd(e[d],0,uX)){r[d]=r[d+1]=0;continue}i=r[d]/e[d],s=r[d+1]/e[d],o=Math.pow(i,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),r[d]=i*a*e[d],r[d+1]=s*a*e[d])}}function hX(t,e,r="x"){const n=CO(r),i=t.length;let s,a,o,l=ju(t,0);for(let u=0;u<i;++u){if(a=o,o=l,l=ju(t,u+1),!o)continue;const d=o[r],h=o[n];a&&(s=(d-a[r])/3,o[`cp1${r}`]=d-s,o[`cp1${n}`]=h-s*e[u]),l&&(s=(l[r]-d)/3,o[`cp2${r}`]=d+s,o[`cp2${n}`]=h+s*e[u])}}function pX(t,e="x"){const r=CO(e),n=t.length,i=Array(n).fill(0),s=Array(n);let a,o,l,u=ju(t,0);for(a=0;a<n;++a)if(o=l,l=u,u=ju(t,a+1),!!l){if(u){const d=u[e]-l[e];i[a]=d!==0?(u[r]-l[r])/d:0}s[a]=o?u?Lu(i[a-1])!==Lu(i[a])?0:(i[a-1]+i[a])/2:i[a-1]:i[a]}dX(t,i,s),hX(t,s,e)}function Z0(t,e,r){return Math.max(Math.min(t,r),e)}function mX(t,e){let r,n,i,s,a,o=Xd(t[0],e);for(r=0,n=t.length;r<n;++r)a=s,s=o,o=r<n-1&&Xd(t[r+1],e),s&&(i=t[r],a&&(i.cp1x=Z0(i.cp1x,e.left,e.right),i.cp1y=Z0(i.cp1y,e.top,e.bottom)),o&&(i.cp2x=Z0(i.cp2x,e.left,e.right),i.cp2y=Z0(i.cp2y,e.top,e.bottom)))}function gX(t,e,r,n,i){let s,a,o,l;if(e.spanGaps&&(t=t.filter(u=>!u.skip)),e.cubicInterpolationMode==="monotone")pX(t,i);else{let u=n?t[t.length-1]:t[0];for(s=0,a=t.length;s<a;++s)o=t[s],l=fX(u,o,t[Math.min(s+1,a-(n?0:1))%a],e.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,u=o}e.capBezierPoints&&mX(t,r)}function Lw(){return typeof window<"u"&&typeof document<"u"}function Bw(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function lm(t,e,r){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[r])):n=t,n}const Vm=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function xX(t,e){return Vm(t).getPropertyValue(e)}const vX=["top","right","bottom","left"];function Kl(t,e,r){const n={};r=r?"-"+r:"";for(let i=0;i<4;i++){const s=vX[i];n[s]=parseFloat(t[e+"-"+s+r])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const yX=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function wX(t,e){const r=t.touches,n=r&&r.length?r[0]:t,{offsetX:i,offsetY:s}=n;let a=!1,o,l;if(yX(i,s,t.target))o=i,l=s;else{const u=e.getBoundingClientRect();o=n.clientX-u.left,l=n.clientY-u.top,a=!0}return{x:o,y:l,box:a}}function Nl(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:n}=e,i=Vm(r),s=i.boxSizing==="border-box",a=Kl(i,"padding"),o=Kl(i,"border","width"),{x:l,y:u,box:d}=wX(t,r),h=a.left+(d&&o.left),m=a.top+(d&&o.top);let{width:g,height:v}=e;return s&&(g-=a.width+o.width,v-=a.height+o.height),{x:Math.round((l-h)/g*r.width/n),y:Math.round((u-m)/v*r.height/n)}}function bX(t,e,r){let n,i;if(e===void 0||r===void 0){const s=t&&Bw(t);if(!s)e=t.clientWidth,r=t.clientHeight;else{const a=s.getBoundingClientRect(),o=Vm(s),l=Kl(o,"border","width"),u=Kl(o,"padding");e=a.width-u.width-l.width,r=a.height-u.height-l.height,n=lm(o.maxWidth,s,"clientWidth"),i=lm(o.maxHeight,s,"clientHeight")}}return{width:e,height:r,maxWidth:n||sm,maxHeight:i||sm}}const J0=t=>Math.round(t*10)/10;function kX(t,e,r,n){const i=Vm(t),s=Kl(i,"margin"),a=lm(i.maxWidth,t,"clientWidth")||sm,o=lm(i.maxHeight,t,"clientHeight")||sm,l=bX(t,e,r);let{width:u,height:d}=l;if(i.boxSizing==="content-box"){const m=Kl(i,"border","width"),g=Kl(i,"padding");u-=g.width+m.width,d-=g.height+m.height}return u=Math.max(0,u-s.width),d=Math.max(0,n?u/n:d-s.height),u=J0(Math.min(u,a,l.maxWidth)),d=J0(Math.min(d,o,l.maxHeight)),u&&!d&&(d=J0(u/2)),(e!==void 0||r!==void 0)&&n&&l.height&&d>l.height&&(d=l.height,u=J0(Math.floor(d*n))),{width:u,height:d}}function rE(t,e,r){const n=e||1,i=Math.floor(t.height*n),s=Math.floor(t.width*n);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const a=t.canvas;return a.style&&(r||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||a.height!==i||a.width!==s?(t.currentDevicePixelRatio=n,a.height=i,a.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const SX=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Lw()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function nE(t,e){const r=xX(t,e),n=r&&r.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Ml(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:t.y+r*(e.y-t.y)}}function _X(t,e,r,n){return{x:t.x+r*(e.x-t.x),y:n==="middle"?r<.5?t.y:e.y:n==="after"?r<1?t.y:e.y:r>0?e.y:t.y}}function CX(t,e,r,n){const i={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},a=Ml(t,i,r),o=Ml(i,s,r),l=Ml(s,e,r),u=Ml(a,o,r),d=Ml(o,l,r);return Ml(u,d,r)}const EX=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,n){return r-n},leftForLtr(r,n){return r-n}}},TX=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Su(t,e,r){return t?EX(e,r):TX()}function EO(t,e){let r,n;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,n=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=n)}function TO(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function AO(t){return t==="angle"?{between:Nw,compare:TK,normalize:zi}:{between:Ha,compare:(e,r)=>e-r,normalize:e=>e}}function iE({start:t,end:e,count:r,loop:n,style:i}){return{start:t%r,end:e%r,loop:n&&(e-t+1)%r===0,style:i}}function AX(t,e,r){const{property:n,start:i,end:s}=r,{between:a,normalize:o}=AO(n),l=e.length;let{start:u,end:d,loop:h}=t,m,g;if(h){for(u+=l,d+=l,m=0,g=l;m<g&&a(o(e[u%l][n]),i,s);++m)u--,d--;u%=l,d%=l}return d<u&&(d+=l),{start:u,end:d,loop:h,style:t.style}}function NO(t,e,r){if(!r)return[t];const{property:n,start:i,end:s}=r,a=e.length,{compare:o,between:l,normalize:u}=AO(n),{start:d,end:h,loop:m,style:g}=AX(t,e,r),v=[];let x=!1,w=null,S,T,_;const M=()=>l(i,_,S)&&o(i,_)!==0,D=()=>o(s,S)===0||l(s,_,S),O=()=>x||M(),E=()=>!x||D();for(let A=d,N=d;A<=h;++A)T=e[A%a],!T.skip&&(S=u(T[n]),S!==_&&(x=l(S,i,s),w===null&&O()&&(w=o(S,i)===0?A:N),w!==null&&E()&&(v.push(iE({start:w,end:A,loop:m,count:a,style:g})),w=null),N=A,_=S));return w!==null&&v.push(iE({start:w,end:h,loop:m,count:a,style:g})),v}function MO(t,e){const r=[],n=t.segments;for(let i=0;i<n.length;i++){const s=NO(n[i],t.points,e);s.length&&r.push(...s)}return r}function NX(t,e,r,n){let i=0,s=e-1;if(r&&!n)for(;i<e&&!t[i].skip;)i++;for(;i<e&&t[i].skip;)i++;for(i%=e,r&&(s+=i);s>i&&t[s%e].skip;)s--;return s%=e,{start:i,end:s}}function MX(t,e,r,n){const i=t.length,s=[];let a=e,o=t[e],l;for(l=e+1;l<=r;++l){const u=t[l%i];u.skip||u.stop?o.skip||(n=!1,s.push({start:e%i,end:(l-1)%i,loop:n}),e=a=u.stop?l:null):(a=l,o.skip&&(e=l)),o=u}return a!==null&&s.push({start:e%i,end:a%i,loop:n}),s}function DX(t,e){const r=t.points,n=t.options.spanGaps,i=r.length;if(!i)return[];const s=!!t._loop,{start:a,end:o}=NX(r,i,s,n);if(n===!0)return sE(t,[{start:a,end:o,loop:s}],r,e);const l=o<a?o+i:o,u=!!t._fullLoop&&a===0&&o===i-1;return sE(t,MX(r,a,l,u),r,e)}function sE(t,e,r,n){return!n||!n.setContext||!r?e:OX(t,e,r,n)}function OX(t,e,r,n){const i=t._chart.getContext(),s=aE(t.options),{_datasetIndex:a,options:{spanGaps:o}}=t,l=r.length,u=[];let d=s,h=e[0].start,m=h;function g(v,x,w,S){const T=o?-1:1;if(v!==x){for(v+=l;r[v%l].skip;)v-=T;for(;r[x%l].skip;)x+=T;v%l!==x%l&&(u.push({start:v%l,end:x%l,loop:w,style:S}),d=S,h=x%l)}}for(const v of e){h=o?h:v.start;let x=r[h%l],w;for(m=h+1;m<=v.end;m++){const S=r[m%l];w=aE(n.setContext(vc(i,{type:"segment",p0:x,p1:S,p0DataIndex:(m-1)%l,p1DataIndex:m%l,datasetIndex:a}))),FX(w,d)&&g(h,m-1,v.loop,d),x=S,d=w}h<m-1&&g(h,m-1,v.loop,d)}return u}function aE(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function FX(t,e){if(!e)return!1;const r=[],n=function(i,s){return Ow(s)?(r.includes(s)||r.push(s),r.indexOf(s)):s};return JSON.stringify(t,n)!==JSON.stringify(e,n)}function Q0(t,e,r){return t.options.clip?t[r]:e[r]}function IX(t,e){const{xScale:r,yScale:n}=t;return r&&n?{left:Q0(r,e,"left"),right:Q0(r,e,"right"),top:Q0(n,e,"top"),bottom:Q0(n,e,"bottom")}:e}function DO(t,e){const r=e._clip;if(r.disabled)return!1;const n=IX(e,t.chartArea);return{left:r.left===!1?0:n.left-(r.left===!0?0:r.left),right:r.right===!1?t.width:n.right+(r.right===!0?0:r.right),top:r.top===!1?0:n.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?t.height:n.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class RX{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,n,i){const s=r.listeners[i],a=r.duration;s.forEach(o=>o({chart:e,initial:r.initial,numSteps:a,currentStep:Math.min(n-r.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=mO.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),o=!0):(s[a]=s[s.length-1],s.pop());o&&(i.draw(),this._notify(i,n,e,"progress")),s.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),r+=s.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let n=r.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,n)),n}listen(e,r,n){this._getAnims(e).listeners[r].push(n)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const n=r.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ra=new RX;const oE="transparent",PX={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const n=XC(t||oE),i=n.valid&&XC(e||oE);return i&&i.valid?i.mix(n,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class LX{constructor(e,r,n,i){const s=r[n];i=X0([e.to,i,s,e.from]);const a=X0([e.from,s,i]);this._active=!0,this._fn=e.fn||PX[e.type||typeof a],this._easing=bd[e.easing]||bd.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(e,r,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,a=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=X0([e.to,r,i,e.from]),this._from=X0([e.from,i,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,n=this._duration,i=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||r<n),!this._active){this._target[i]=o,this._notify(!0);return}if(r<0){this._target[i]=s;return}l=r/n%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,o,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,n)=>{e.push({res:r,rej:n})})}_notify(e){const r=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][r]()}}class OO{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!Gt(e))return;const r=Object.keys(Vr.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Gt(s))return;const a={};for(const o of r)a[o]=s[o];(ln(s.properties)&&s.properties||[i]).forEach(o=>{(o===i||!n.has(o))&&n.set(o,a)})})}_animateOptions(e,r){const n=r.options,i=jX(e,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&BX(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,r){const n=this._properties,i=[],s=e.$animations||(e.$animations={}),a=Object.keys(r),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const u=a[l];if(u.charAt(0)==="$")continue;if(u==="options"){i.push(...this._animateOptions(e,r));continue}const d=r[u];let h=s[u];const m=n.get(u);if(h)if(m&&h.active()){h.update(m,d,o);continue}else h.cancel();if(!m||!m.duration){e[u]=d;continue}s[u]=h=new LX(m,e,u,d),i.push(h)}return i}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const n=this._createAnimations(e,r);if(n.length)return Ra.add(this._chart,n),!0}}function BX(t,e){const r=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const s=t[n[i]];s&&s.active()&&r.push(s.wait())}return Promise.all(r)}function jX(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function lE(t,e){const r=t&&t.options||{},n=r.reverse,i=r.min===void 0?e:0,s=r.max===void 0?e:0;return{start:n?s:i,end:n?i:s}}function zX(t,e,r){if(r===!1)return!1;const n=lE(t,r),i=lE(e,r);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function VX(t){let e,r,n,i;return Gt(t)?(e=t.top,r=t.right,n=t.bottom,i=t.left):e=r=n=i=t,{top:e,right:r,bottom:n,left:i,disabled:t===!1}}function FO(t,e){const r=[],n=t._getSortedDatasetMetas(e);let i,s;for(i=0,s=n.length;i<s;++i)r.push(n[i].index);return r}function cE(t,e,r,n={}){const i=t.keys,s=n.mode==="single";let a,o,l,u;if(e===null)return;let d=!1;for(a=0,o=i.length;a<o;++a){if(l=+i[a],l===r){if(d=!0,n.all)continue;break}u=t.values[l],ei(u)&&(s||e===0||Lu(e)===Lu(u))&&(e+=u)}return!d&&!n.all?0:e}function $X(t,e){const{iScale:r,vScale:n}=e,i=r.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",a=Object.keys(t),o=new Array(a.length);let l,u,d;for(l=0,u=a.length;l<u;++l)d=a[l],o[l]={[i]:d,[s]:t[d]};return o}function Rv(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function UX(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function HX(t){const{min:e,max:r,minDefined:n,maxDefined:i}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}function WX(t,e,r){const n=t[e]||(t[e]={});return n[r]||(n[r]={})}function uE(t,e,r,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const s=t[i.index];if(r&&s>0||!r&&s<0)return i.index}return null}function fE(t,e){const{chart:r,_cachedMeta:n}=t,i=r._stacks||(r._stacks={}),{iScale:s,vScale:a,index:o}=n,l=s.axis,u=a.axis,d=UX(s,a,n),h=e.length;let m;for(let g=0;g<h;++g){const v=e[g],{[l]:x,[u]:w}=v,S=v._stacks||(v._stacks={});m=S[u]=WX(i,d,x),m[o]=w,m._top=uE(m,a,!0,n.type),m._bottom=uE(m,a,!1,n.type);const T=m._visualValues||(m._visualValues={});T[o]=w}}function Pv(t,e){const r=t.scales;return Object.keys(r).filter(n=>r[n].axis===e).shift()}function GX(t,e){return vc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function qX(t,e,r){return vc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function Lf(t,e){const r=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const i of e){const s=i._stacks;if(!s||s[n]===void 0||s[n][r]===void 0)return;delete s[n][r],s[n]._visualValues!==void 0&&s[n]._visualValues[r]!==void 0&&delete s[n]._visualValues[r]}}}const Lv=t=>t==="reset"||t==="none",dE=(t,e)=>e?t:Object.assign({},t),YX=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:FO(r,!0),values:null};class mp{constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Rv(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Lf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,n=this.getDataset(),i=(h,m,g,v)=>h==="x"?m:h==="r"?v:g,s=r.xAxisID=Ht(n.xAxisID,Pv(e,"x")),a=r.yAxisID=Ht(n.yAxisID,Pv(e,"y")),o=r.rAxisID=Ht(n.rAxisID,Pv(e,"r")),l=r.indexAxis,u=r.iAxisID=i(l,s,a,o),d=r.vAxisID=i(l,a,s,o);r.xScale=this.getScaleForId(s),r.yScale=this.getScaleForId(a),r.rScale=this.getScaleForId(o),r.iScale=this.getScaleForId(u),r.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&qC(this._data,this),e._stacked&&Lf(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),n=this._data;if(Gt(r)){const i=this._cachedMeta;this._data=$X(r,i)}else if(n!==r){if(n){qC(n,this);const i=this._cachedMeta;Lf(i),i._parsed=[]}r&&Object.isExtensible(r)&&DK(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=r._stacked;r._stacked=Rv(r.vScale,r),r.stack!==n.stack&&(i=!0,Lf(r),r.stack=n.stack),this._resyncElements(e),(i||s!==r._stacked)&&(fE(this,r._parsed),r._stacked=Rv(r.vScale,r))}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:a}=n,o=s.axis;let l=e===0&&r===i.length?!0:n._sorted,u=e>0&&n._parsed[e-1],d,h,m;if(this._parsing===!1)n._parsed=i,n._sorted=!0,m=i;else{ln(i[e])?m=this.parseArrayData(n,i,e,r):Gt(i[e])?m=this.parseObjectData(n,i,e,r):m=this.parsePrimitiveData(n,i,e,r);const g=()=>h[o]===null||u&&h[o]<u[o];for(d=0;d<r;++d)n._parsed[d+e]=h=m[d],l&&(g()&&(l=!1),u=h);n._sorted=l}a&&fE(this,m)}parsePrimitiveData(e,r,n,i){const{iScale:s,vScale:a}=e,o=s.axis,l=a.axis,u=s.getLabels(),d=s===a,h=new Array(i);let m,g,v;for(m=0,g=i;m<g;++m)v=m+n,h[m]={[o]:d||s.parse(u[v],v),[l]:a.parse(r[v],v)};return h}parseArrayData(e,r,n,i){const{xScale:s,yScale:a}=e,o=new Array(i);let l,u,d,h;for(l=0,u=i;l<u;++l)d=l+n,h=r[d],o[l]={x:s.parse(h[0],d),y:a.parse(h[1],d)};return o}parseObjectData(e,r,n,i){const{xScale:s,yScale:a}=e,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,u=new Array(i);let d,h,m,g;for(d=0,h=i;d<h;++d)m=d+n,g=r[m],u[d]={x:s.parse(nm(g,o),m),y:a.parse(nm(g,l),m)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,n){const i=this.chart,s=this._cachedMeta,a=r[e.axis],o={keys:FO(i,!0),values:r._stacks[e.axis]._visualValues};return cE(o,a,s.index,{mode:n})}updateRangeFromParsed(e,r,n,i){const s=n[r.axis];let a=s===null?NaN:s;const o=i&&n._stacks[r.axis];i&&o&&(i.values=o,a=cE(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,r){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&e===n.iScale,a=i.length,o=this._getOtherScale(e),l=YX(r,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=HX(o);let m,g;function v(){g=i[m];const x=g[o.axis];return!ei(g[e.axis])||d>x||h<x}for(m=0;m<a&&!(!v()&&(this.updateRangeFromParsed(u,e,g,l),s));++m);if(s){for(m=a-1;m>=0;--m)if(!v()){this.updateRangeFromParsed(u,e,g,l);break}}return u}getAllParsedValues(e){const r=this._cachedMeta._parsed,n=[];let i,s,a;for(i=0,s=r.length;i<s;++i)a=r[i][e.axis],ei(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,n=r.iScale,i=r.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=VX(Ht(this.options.clip,zX(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,n=this._cachedMeta,i=n.data||[],s=r.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||i.length-o,u=this.options.drawActiveElementsOnTop;let d;for(n.dataset&&n.dataset.draw(e,s,o,l),d=o;d<o+l;++d){const h=i[d];h.hidden||(h.active&&u?a.push(h):h.draw(e,s))}for(d=0;d<a.length;++d)a[d].draw(e,s)}getStyle(e,r){const n=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,r,n){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];s=a.$context||(a.$context=qX(this.getContext(),e,a)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=GX(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!r,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",n){const i=r==="active",s=this._cachedDataOpts,a=e+"-"+r,o=s[a],l=this.enableOptionSharing&&im(n);if(o)return dE(o,l);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),h=i?[`${e}Hover`,"hover",e,""]:[e,""],m=u.getOptionScopes(this.getDataset(),d),g=Object.keys(Vr.elements[e]),v=()=>this.getContext(n,i,r),x=u.resolveNamedOptions(m,g,v,h);return x.$shared&&(x.$shared=l,s[a]=Object.freeze(dE(x,l))),x}_resolveAnimations(e,r,n){const i=this.chart,s=this._cachedDataOpts,a=`animation-${r}`,o=s[a];if(o)return o;let l;if(i.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,r),m=d.getOptionScopes(this.getDataset(),h);l=d.createResolver(m,this.getContext(e,n,r))}const u=new OO(i,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||Lv(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const n=this.resolveDataElementOptions(e,r),i=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(r,s)||s!==i;return this.updateSharedOptions(s,r,n),{sharedOptions:s,includeOptions:a}}updateElement(e,r,n,i){Lv(i)?Object.assign(e,n):this._resolveAnimations(r,i).update(e,n)}updateSharedOptions(e,r,n){e&&!Lv(r)&&this._resolveAnimations(void 0,r).update(e,n)}_setStyle(e,r,n,i){e.active=i;const s=this.getStyle(r,i);this._resolveAnimations(r,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,r,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,r,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,n=this._cachedMeta.data;for(const[o,l,u]of this._syncList)this[o](l,u);this._syncList=[];const i=n.length,s=r.length,a=Math.min(s,i);a&&this.parse(0,a),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,r,n=!0){const i=this._cachedMeta,s=i.data,a=e+r;let o;const l=u=>{for(u.length+=r,o=u.length-1;o>=a;o--)u[o]=u[o-r]};for(l(s),o=e;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,r),n&&this.updateElements(s,e,r,"reset")}updateElements(e,r,n,i){}_removeElements(e,r){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,r);n._stacked&&Lf(n,i)}n.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,n,i]=e;this[r](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}wt(mp,"defaults",{}),wt(mp,"datasetElementType",null),wt(mp,"dataElementType",null);function Al(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class jw{constructor(e){wt(this,"options");this.options=e||{}}static override(e){Object.assign(jw.prototype,e)}init(){}formats(){return Al()}parse(){return Al()}format(){return Al()}add(){return Al()}diff(){return Al()}startOf(){return Al()}endOf(){return Al()}}var cm={_date:jw};function KX(t,e,r,n){const{controller:i,data:s,_sorted:a}=t,o=i._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(o&&e===o.axis&&e!=="r"&&a&&s.length){const u=o._reversePixels?NK:H1;if(n){if(i._sharedOptions){const d=s[0],h=typeof d.getRange=="function"&&d.getRange(e);if(h){const m=u(s,e,r-h),g=u(s,e,r+h);return{lo:m.lo,hi:g.hi}}}}else{const d=u(s,e,r);if(l){const{vScale:h}=i._cachedMeta,{_parsed:m}=t,g=m.slice(0,d.lo+1).reverse().findIndex(x=>!Ar(x[h.axis]));d.lo-=Math.max(0,g);const v=m.slice(d.hi).findIndex(x=>!Ar(x[h.axis]));d.hi+=Math.max(0,v)}return d}}return{lo:0,hi:s.length-1}}function $m(t,e,r,n,i){const s=t.getSortedVisibleDatasetMetas(),a=r[e];for(let o=0,l=s.length;o<l;++o){const{index:u,data:d}=s[o],{lo:h,hi:m}=KX(s[o],e,a,i);for(let g=h;g<=m;++g){const v=d[g];v.skip||n(v,u,g)}}}function XX(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(n,i){const s=e?Math.abs(n.x-i.x):0,a=r?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function Bv(t,e,r,n,i){const s=[];return!i&&!t.isPointInArea(e)||$m(t,r,e,function(o,l,u){!i&&!Xd(o,t.chartArea,0)||o.inRange(e.x,e.y,n)&&s.push({element:o,datasetIndex:l,index:u})},!0),s}function ZX(t,e,r,n){let i=[];function s(a,o,l){const{startAngle:u,endAngle:d}=a.getProps(["startAngle","endAngle"],n),{angle:h}=hO(a,{x:e.x,y:e.y});Nw(h,u,d)&&i.push({element:a,datasetIndex:o,index:l})}return $m(t,r,e,s),i}function JX(t,e,r,n,i,s){let a=[];const o=XX(r);let l=Number.POSITIVE_INFINITY;function u(d,h,m){const g=d.inRange(e.x,e.y,i);if(n&&!g)return;const v=d.getCenterPoint(i);if(!(!!s||t.isPointInArea(v))&&!g)return;const w=o(e,v);w<l?(a=[{element:d,datasetIndex:h,index:m}],l=w):w===l&&a.push({element:d,datasetIndex:h,index:m})}return $m(t,r,e,u),a}function jv(t,e,r,n,i,s){return!s&&!t.isPointInArea(e)?[]:r==="r"&&!n?ZX(t,e,r,i):JX(t,e,r,n,i,s)}function hE(t,e,r,n,i){const s=[],a=r==="x"?"inXRange":"inYRange";let o=!1;return $m(t,r,e,(l,u,d)=>{l[a]&&l[a](e[r],i)&&(s.push({element:l,datasetIndex:u,index:d}),o=o||l.inRange(e.x,e.y,i))}),n&&!o?[]:s}var QX={modes:{index(t,e,r,n){const i=Nl(e,t),s=r.axis||"x",a=r.includeInvisible||!1,o=r.intersect?Bv(t,i,s,n,a):jv(t,i,s,!1,n,a),l=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=o[0].index,h=u.data[d];h&&!h.skip&&l.push({element:h,datasetIndex:u.index,index:d})}),l):[]},dataset(t,e,r,n){const i=Nl(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;let o=r.intersect?Bv(t,i,s,n,a):jv(t,i,s,!1,n,a);if(o.length>0){const l=o[0].datasetIndex,u=t.getDatasetMeta(l).data;o=[];for(let d=0;d<u.length;++d)o.push({element:u[d],datasetIndex:l,index:d})}return o},point(t,e,r,n){const i=Nl(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;return Bv(t,i,s,n,a)},nearest(t,e,r,n){const i=Nl(e,t),s=r.axis||"xy",a=r.includeInvisible||!1;return jv(t,i,s,r.intersect,n,a)},x(t,e,r,n){const i=Nl(e,t);return hE(t,i,"x",r.intersect,n)},y(t,e,r,n){const i=Nl(e,t);return hE(t,i,"y",r.intersect,n)}}};const IO=["left","top","right","bottom"];function Bf(t,e){return t.filter(r=>r.pos===e)}function pE(t,e){return t.filter(r=>IO.indexOf(r.pos)===-1&&r.box.axis===e)}function jf(t,e){return t.sort((r,n)=>{const i=e?n:r,s=e?r:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function eZ(t){const e=[];let r,n,i,s,a,o;for(r=0,n=(t||[]).length;r<n;++r)i=t[r],{position:s,options:{stack:a,stackWeight:o=1}}=i,e.push({index:r,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:a&&s+a,stackWeight:o});return e}function tZ(t){const e={};for(const r of t){const{stack:n,pos:i,stackWeight:s}=r;if(!n||!IO.includes(i))continue;const a=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return e}function rZ(t,e){const r=tZ(t),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let s,a,o;for(s=0,a=t.length;s<a;++s){o=t[s];const{fullSize:l}=o.box,u=r[o.stack],d=u&&o.stackWeight/u.weight;o.horizontal?(o.width=d?d*n:l&&e.availableWidth,o.height=i):(o.width=n,o.height=d?d*i:l&&e.availableHeight)}return r}function nZ(t){const e=eZ(t),r=jf(e.filter(u=>u.box.fullSize),!0),n=jf(Bf(e,"left"),!0),i=jf(Bf(e,"right")),s=jf(Bf(e,"top"),!0),a=jf(Bf(e,"bottom")),o=pE(e,"x"),l=pE(e,"y");return{fullSize:r,leftAndTop:n.concat(s),rightAndBottom:i.concat(l).concat(a).concat(o),chartArea:Bf(e,"chartArea"),vertical:n.concat(i).concat(l),horizontal:s.concat(a).concat(o)}}function mE(t,e,r,n){return Math.max(t[r],e[r])+Math.max(t[n],e[n])}function RO(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function iZ(t,e,r,n){const{pos:i,box:s}=r,a=t.maxPadding;if(!Gt(i)){r.size&&(t[i]-=r.size);const h=n[r.stack]||{size:0,count:1};h.size=Math.max(h.size,r.horizontal?s.height:s.width),r.size=h.size/h.count,t[i]+=r.size}s.getPadding&&RO(a,s.getPadding());const o=Math.max(0,e.outerWidth-mE(a,t,"left","right")),l=Math.max(0,e.outerHeight-mE(a,t,"top","bottom")),u=o!==t.w,d=l!==t.h;return t.w=o,t.h=l,r.horizontal?{same:u,other:d}:{same:d,other:u}}function sZ(t){const e=t.maxPadding;function r(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function aZ(t,e){const r=e.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(a=>{s[a]=Math.max(e[a],r[a])}),s}return n(t?["left","right"]:["top","bottom"])}function Qf(t,e,r,n){const i=[];let s,a,o,l,u,d;for(s=0,a=t.length,u=0;s<a;++s){o=t[s],l=o.box,l.update(o.width||e.w,o.height||e.h,aZ(o.horizontal,e));const{same:h,other:m}=iZ(e,r,o,n);u|=h&&i.length,d=d||m,l.fullSize||i.push(o)}return u&&Qf(i,e,r,n)||d}function ep(t,e,r,n,i){t.top=r,t.left=e,t.right=e+n,t.bottom=r+i,t.width=n,t.height=i}function gE(t,e,r,n){const i=r.padding;let{x:s,y:a}=e;for(const o of t){const l=o.box,u=n[o.stack]||{placed:0,weight:1},d=o.stackWeight/u.weight||1;if(o.horizontal){const h=e.w*d,m=u.size||l.height;im(u.start)&&(a=u.start),l.fullSize?ep(l,i.left,a,r.outerWidth-i.right-i.left,m):ep(l,e.left+u.placed,a,h,m),u.start=a,u.placed+=h,a=l.bottom}else{const h=e.h*d,m=u.size||l.width;im(u.start)&&(s=u.start),l.fullSize?ep(l,s,i.top,m,r.outerHeight-i.bottom-i.top):ep(l,s,e.top+u.placed,m,h),u.start=s,u.placed+=h,s=l.right}}e.x=s,e.y=a}var fs={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,n){if(!t)return;const i=ms(t.options.layout.padding),s=Math.max(e-i.width,0),a=Math.max(r-i.height,0),o=nZ(t.boxes),l=o.vertical,u=o.horizontal;ur(t.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=l.reduce((x,w)=>w.box.options&&w.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:r,padding:i,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/d,hBoxMaxHeight:a/2}),m=Object.assign({},i);RO(m,ms(n));const g=Object.assign({maxPadding:m,w:s,h:a,x:i.left,y:i.top},i),v=rZ(l.concat(u),h);Qf(o.fullSize,g,h,v),Qf(l,g,h,v),Qf(u,g,h,v)&&Qf(l,g,h,v),sZ(g),gE(o.leftAndTop,g,h,v),g.x+=g.w,g.y+=g.h,gE(o.rightAndBottom,g,h,v),t.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},ur(o.chartArea,x=>{const w=x.box;Object.assign(w,t.chartArea),w.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class PO{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,n){}removeEventListener(e,r,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,n,i){return r=Math.max(0,r||e.width),n=n||e.height,{width:r,height:Math.max(0,i?Math.floor(r/i):n)}}isAttached(e){return!0}updateConfig(e){}}class oZ extends PO{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const gp="$chartjs",lZ={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},xE=t=>t===null||t==="";function cZ(t,e){const r=t.style,n=t.getAttribute("height"),i=t.getAttribute("width");if(t[gp]={initial:{height:n,width:i,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",xE(i)){const s=nE(t,"width");s!==void 0&&(t.width=s)}if(xE(n))if(t.style.height==="")t.height=t.width/(e||2);else{const s=nE(t,"height");s!==void 0&&(t.height=s)}return t}const LO=SX?{passive:!0}:!1;function uZ(t,e,r){t&&t.addEventListener(e,r,LO)}function fZ(t,e,r){t&&t.canvas&&t.canvas.removeEventListener(e,r,LO)}function dZ(t,e){const r=lZ[t.type]||t.type,{x:n,y:i}=Nl(t,e);return{type:r,chart:e,native:t,x:n!==void 0?n:null,y:i!==void 0?i:null}}function um(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function hZ(t,e,r){const n=t.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||um(o.addedNodes,n),a=a&&!um(o.removedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}function pZ(t,e,r){const n=t.canvas,i=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||um(o.removedNodes,n),a=a&&!um(o.addedNodes,n);a&&r()});return i.observe(document,{childList:!0,subtree:!0}),i}const Jd=new Map;let vE=0;function BO(){const t=window.devicePixelRatio;t!==vE&&(vE=t,Jd.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function mZ(t,e){Jd.size||window.addEventListener("resize",BO),Jd.set(t,e)}function gZ(t){Jd.delete(t),Jd.size||window.removeEventListener("resize",BO)}function xZ(t,e,r){const n=t.canvas,i=n&&Bw(n);if(!i)return;const s=gO((o,l)=>{const u=i.clientWidth;r(o,l),u<i.clientWidth&&r()},window),a=new ResizeObserver(o=>{const l=o[0],u=l.contentRect.width,d=l.contentRect.height;u===0&&d===0||s(u,d)});return a.observe(i),mZ(t,s),a}function zv(t,e,r){r&&r.disconnect(),e==="resize"&&gZ(t)}function vZ(t,e,r){const n=t.canvas,i=gO(s=>{t.ctx!==null&&r(dZ(s,t))},t);return uZ(n,e,i),i}class yZ extends PO{acquireContext(e,r){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(cZ(e,r),n):null}releaseContext(e){const r=e.canvas;if(!r[gp])return!1;const n=r[gp].initial;["height","width"].forEach(s=>{const a=n[s];Ar(a)?r.removeAttribute(s):r.setAttribute(s,a)});const i=n.style||{};return Object.keys(i).forEach(s=>{r.style[s]=i[s]}),r.width=r.width,delete r[gp],!0}addEventListener(e,r,n){this.removeEventListener(e,r);const i=e.$proxies||(e.$proxies={}),a={attach:hZ,detach:pZ,resize:xZ}[r]||vZ;i[r]=a(e,r,n)}removeEventListener(e,r){const n=e.$proxies||(e.$proxies={}),i=n[r];if(!i)return;({attach:zv,detach:zv,resize:zv}[r]||fZ)(e,r,i),n[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,n,i){return kX(e,r,n,i)}isAttached(e){const r=e&&Bw(e);return!!(r&&r.isConnected)}}function wZ(t){return!Lw()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?oZ:yZ}var op;let eo=(op=class{constructor(){wt(this,"x");wt(this,"y");wt(this,"active",!1);wt(this,"options");wt(this,"$animations")}tooltipPosition(e){const{x:r,y:n}=this.getProps(["x","y"],e);return{x:r,y:n}}hasValue(){return am(this.x)&&am(this.y)}getProps(e,r){const n=this.$animations;if(!r||!n)return this;const i={};return e.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}},wt(op,"defaults",{}),wt(op,"defaultRoutes"),op);function bZ(t,e){const r=t.options.ticks,n=kZ(t),i=Math.min(r.maxTicksLimit||n,n),s=r.major.enabled?_Z(e):[],a=s.length,o=s[0],l=s[a-1],u=[];if(a>i)return CZ(e,u,s,a/i),u;const d=SZ(s,e,i);if(a>0){let h,m;const g=a>1?Math.round((l-o)/(a-1)):null;for(tp(e,u,d,Ar(g)?0:o-g,o),h=0,m=a-1;h<m;h++)tp(e,u,d,s[h],s[h+1]);return tp(e,u,d,l,Ar(g)?e.length:l+g),u}return tp(e,u,d),u}function kZ(t){const e=t.options.offset,r=t._tickSize(),n=t._length/r+(e?0:1),i=t._maxLength/r;return Math.floor(Math.min(n,i))}function SZ(t,e,r){const n=EZ(t),i=e.length/r;if(!n)return Math.max(i,1);const s=kK(n);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>i)return l}return Math.max(i,1)}function _Z(t){const e=[];let r,n;for(r=0,n=t.length;r<n;r++)t[r].major&&e.push(r);return e}function CZ(t,e,r,n){let i=0,s=r[0],a;for(n=Math.ceil(n),a=0;a<t.length;a++)a===s&&(e.push(t[a]),i++,s=r[i*n])}function tp(t,e,r,n,i){const s=Ht(n,0),a=Math.min(Ht(i,t.length),t.length);let o=0,l,u,d;for(r=Math.ceil(r),i&&(l=i-n,r=l/Math.floor(l/r)),d=s;d<0;)o++,d=Math.round(s+o*r);for(u=Math.max(s,0);u<a;u++)u===d&&(e.push(t[u]),o++,d=Math.round(s+o*r))}function EZ(t){const e=t.length;let r,n;if(e<2)return!1;for(n=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==n)return!1;return n}const TZ=t=>t==="left"?"right":t==="right"?"left":t,yE=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r,wE=(t,e)=>Math.min(e||t,t);function bE(t,e){const r=[],n=t.length/e,i=t.length;let s=0;for(;s<i;s+=n)r.push(t[Math.floor(s)]);return r}function AZ(t,e,r){const n=t.ticks.length,i=Math.min(e,n-1),s=t._startPixel,a=t._endPixel,o=1e-6;let l=t.getPixelForTick(i),u;if(!(r&&(n===1?u=Math.max(l-s,a-l):e===0?u=(t.getPixelForTick(1)-l)/2:u=(l-t.getPixelForTick(i-1))/2,l+=i<e?u:-u,l<s-o||l>a+o)))return l}function NZ(t,e){ur(t,r=>{const n=r.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete r.data[n[s]];n.splice(0,i)}})}function zf(t){return t.drawTicks?t.tickLength:0}function kE(t,e){if(!t.display)return 0;const r=Zn(t.font,e),n=ms(t.padding);return(ln(t.text)?t.text.length:1)*r.lineHeight+n.height}function MZ(t,e){return vc(t,{scale:e,type:"scale"})}function DZ(t,e,r){return vc(t,{tick:r,index:e,type:"tick"})}function OZ(t,e,r){let n=Dw(t);return(r&&e!=="right"||!r&&e==="right")&&(n=TZ(n)),n}function FZ(t,e,r,n){const{top:i,left:s,bottom:a,right:o,chart:l}=t,{chartArea:u,scales:d}=l;let h=0,m,g,v;const x=a-i,w=o-s;if(t.isHorizontal()){if(g=Hn(n,s,o),Gt(r)){const S=Object.keys(r)[0],T=r[S];v=d[S].getPixelForValue(T)+x-e}else r==="center"?v=(u.bottom+u.top)/2+x-e:v=yE(t,r,e);m=o-s}else{if(Gt(r)){const S=Object.keys(r)[0],T=r[S];g=d[S].getPixelForValue(T)-w+e}else r==="center"?g=(u.left+u.right)/2-w+e:g=yE(t,r,e);v=Hn(n,a,i),h=r==="left"?-Fn:Fn}return{titleX:g,titleY:v,maxWidth:m,rotation:h}}class qu extends eo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:n,_suggestedMax:i}=this;return e=ra(e,Number.POSITIVE_INFINITY),r=ra(r,Number.NEGATIVE_INFINITY),n=ra(n,Number.POSITIVE_INFINITY),i=ra(i,Number.NEGATIVE_INFINITY),{min:ra(e,n),max:ra(r,i),minDefined:ei(e),maxDefined:ei(r)}}getMinMax(e){let{min:r,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),a;if(i&&s)return{min:r,max:n};const o=this.getMatchingVisibleMetas();for(let l=0,u=o.length;l<u;++l)a=o[l].controller.getMinMax(this,e),i||(r=Math.min(r,a.min)),s||(n=Math.max(n,a.max));return r=s&&r>n?n:r,n=i&&r>n?r:n,{min:ra(r,ra(n,r)),max:ra(n,ra(r,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){br(this.options.beforeUpdate,[this])}update(e,r,n){const{beginAtZero:i,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=eX(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?bE(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=bZ(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,n;this.isHorizontal()?(r=this.left,n=this.right):(r=this.top,n=this.bottom,e=!e),this._startPixel=r,this._endPixel=n,this._reversePixels=e,this._length=n-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){br(this.options.afterUpdate,[this])}beforeSetDimensions(){br(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){br(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),br(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){br(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n],s.label=br(r.callback,[s.value,n,e],this)}afterTickToLabelConversion(){br(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){br(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,n=wE(this.ticks.length,e.ticks.maxTicksLimit),i=r.minRotation||0,s=r.maxRotation;let a=i,o,l,u;if(!this._isVisible()||!r.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const d=this._getLabelSizes(),h=d.widest.width,m=d.highest.height,g=Mi(this.chart.width-h,0,this.maxWidth);o=e.offset?this.maxWidth/n:g/(n-1),h+6>o&&(o=g/(n-(e.offset?.5:1)),l=this.maxHeight-zf(e.grid)-r.padding-kE(e.title,this.chart.options.font),u=Math.sqrt(h*h+m*m),a=EK(Math.min(Math.asin(Mi((d.highest.height+6)/o,-1,1)),Math.asin(Mi(l/u,-1,1))-Math.asin(Mi(m/u,-1,1)))),a=Math.max(i,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){br(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){br(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:n,title:i,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=kE(i,r.options.font);if(o?(e.width=this.maxWidth,e.height=zf(s)+l):(e.height=this.maxHeight,e.width=zf(s)+l),n.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:m}=this._getLabelSizes(),g=n.padding*2,v=zl(this.labelRotation),x=Math.cos(v),w=Math.sin(v);if(o){const S=n.mirror?0:w*h.width+x*m.height;e.height=Math.min(this.maxHeight,e.height+S+g)}else{const S=n.mirror?0:x*h.width+w*m.height;e.width=Math.min(this.maxWidth,e.width+S+g)}this._calculatePadding(u,d,w,x)}}this._handleMargins(),o?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,n,i){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,u=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,g=0;l?u?(m=i*e.width,g=n*r.height):(m=n*e.height,g=i*r.width):s==="start"?g=r.width:s==="end"?m=e.width:s!=="inner"&&(m=e.width/2,g=r.width/2),this.paddingLeft=Math.max((m-d+a)*this.width/(this.width-d),0),this.paddingRight=Math.max((g-h+a)*this.width/(this.width-h),0)}else{let d=r.height/2,h=e.height/2;s==="start"?(d=0,h=e.height):s==="end"&&(d=r.height,h=0),this.paddingTop=d+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){br(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,n;for(r=0,n=e.length;r<n;r++)Ar(e[r].label)&&(e.splice(r,1),n--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let n=this.ticks;r<n.length&&(n=bE(n,r)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,r,n){const{ctx:i,_longestTextCache:s}=this,a=[],o=[],l=Math.floor(r/wE(r,n));let u=0,d=0,h,m,g,v,x,w,S,T,_,M,D;for(h=0;h<r;h+=l){if(v=e[h].label,x=this._resolveTickFontOptions(h),i.font=w=x.string,S=s[w]=s[w]||{data:{},gc:[]},T=x.lineHeight,_=M=0,!Ar(v)&&!ln(v))_=JC(i,S.data,S.gc,_,v),M=T;else if(ln(v))for(m=0,g=v.length;m<g;++m)D=v[m],!Ar(D)&&!ln(D)&&(_=JC(i,S.data,S.gc,_,D),M+=T);a.push(_),o.push(M),u=Math.max(_,u),d=Math.max(M,d)}NZ(s,r);const O=a.indexOf(u),E=o.indexOf(d),A=N=>({width:a[N]||0,height:o[N]||0});return{first:A(0),last:A(r-1),widest:A(O),highest:A(E),widths:a,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return AK(this._alignToPixels?Tl(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const n=r[e];return n.$context||(n.$context=DZ(this.getContext(),e,n))}return this.$context||(this.$context=MZ(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=zl(this.labelRotation),n=Math.abs(Math.cos(r)),i=Math.abs(Math.sin(r)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*n>o*i?o/n:l/i:l*i<o*n?l/n:o/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,n=this.chart,i=this.options,{grid:s,position:a,border:o}=i,l=s.offset,u=this.isHorizontal(),h=this.ticks.length+(l?1:0),m=zf(s),g=[],v=o.setContext(this.getContext()),x=v.display?v.width:0,w=x/2,S=function(fe){return Tl(n,fe,x)};let T,_,M,D,O,E,A,N,P,B,I,ee;if(a==="top")T=S(this.bottom),E=this.bottom-m,N=T-w,B=S(e.top)+w,ee=e.bottom;else if(a==="bottom")T=S(this.top),B=e.top,ee=S(e.bottom)-w,E=T+w,N=this.top+m;else if(a==="left")T=S(this.right),O=this.right-m,A=T-w,P=S(e.left)+w,I=e.right;else if(a==="right")T=S(this.left),P=e.left,I=S(e.right)-w,O=T+w,A=this.left+m;else if(r==="x"){if(a==="center")T=S((e.top+e.bottom)/2+.5);else if(Gt(a)){const fe=Object.keys(a)[0],se=a[fe];T=S(this.chart.scales[fe].getPixelForValue(se))}B=e.top,ee=e.bottom,E=T+w,N=E+m}else if(r==="y"){if(a==="center")T=S((e.left+e.right)/2);else if(Gt(a)){const fe=Object.keys(a)[0],se=a[fe];T=S(this.chart.scales[fe].getPixelForValue(se))}O=T-w,A=O-m,P=e.left,I=e.right}const oe=Ht(i.ticks.maxTicksLimit,h),re=Math.max(1,Math.ceil(h/oe));for(_=0;_<h;_+=re){const fe=this.getContext(_),se=s.setContext(fe),xe=o.setContext(fe),H=se.lineWidth,ve=se.color,W=xe.dash||[],F=xe.dashOffset,X=se.tickWidth,Z=se.tickColor,q=se.tickBorderDash||[],ce=se.tickBorderDashOffset;M=AZ(this,_,l),M!==void 0&&(D=Tl(n,M,H),u?O=A=P=I=D:E=N=B=ee=D,g.push({tx1:O,ty1:E,tx2:A,ty2:N,x1:P,y1:B,x2:I,y2:ee,width:H,color:ve,borderDash:W,borderDashOffset:F,tickWidth:X,tickColor:Z,tickBorderDash:q,tickBorderDashOffset:ce}))}return this._ticksLength=h,this._borderValue=T,g}_computeLabelItems(e){const r=this.axis,n=this.options,{position:i,ticks:s}=n,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:u,padding:d,mirror:h}=s,m=zf(n.grid),g=m+d,v=h?-d:g,x=-zl(this.labelRotation),w=[];let S,T,_,M,D,O,E,A,N,P,B,I,ee="middle";if(i==="top")O=this.bottom-v,E=this._getXAxisLabelAlignment();else if(i==="bottom")O=this.top+v,E=this._getXAxisLabelAlignment();else if(i==="left"){const re=this._getYAxisLabelAlignment(m);E=re.textAlign,D=re.x}else if(i==="right"){const re=this._getYAxisLabelAlignment(m);E=re.textAlign,D=re.x}else if(r==="x"){if(i==="center")O=(e.top+e.bottom)/2+g;else if(Gt(i)){const re=Object.keys(i)[0],fe=i[re];O=this.chart.scales[re].getPixelForValue(fe)+g}E=this._getXAxisLabelAlignment()}else if(r==="y"){if(i==="center")D=(e.left+e.right)/2-g;else if(Gt(i)){const re=Object.keys(i)[0],fe=i[re];D=this.chart.scales[re].getPixelForValue(fe)}E=this._getYAxisLabelAlignment(m).textAlign}r==="y"&&(l==="start"?ee="top":l==="end"&&(ee="bottom"));const oe=this._getLabelSizes();for(S=0,T=o.length;S<T;++S){_=o[S],M=_.label;const re=s.setContext(this.getContext(S));A=this.getPixelForTick(S)+s.labelOffset,N=this._resolveTickFontOptions(S),P=N.lineHeight,B=ln(M)?M.length:1;const fe=B/2,se=re.color,xe=re.textStrokeColor,H=re.textStrokeWidth;let ve=E;a?(D=A,E==="inner"&&(S===T-1?ve=this.options.reverse?"left":"right":S===0?ve=this.options.reverse?"right":"left":ve="center"),i==="top"?u==="near"||x!==0?I=-B*P+P/2:u==="center"?I=-oe.highest.height/2-fe*P+P:I=-oe.highest.height+P/2:u==="near"||x!==0?I=P/2:u==="center"?I=oe.highest.height/2-fe*P:I=oe.highest.height-B*P,h&&(I*=-1),x!==0&&!re.showLabelBackdrop&&(D+=P/2*Math.sin(x))):(O=A,I=(1-B)*P/2);let W;if(re.showLabelBackdrop){const F=ms(re.backdropPadding),X=oe.heights[S],Z=oe.widths[S];let q=I-F.top,ce=0-F.left;switch(ee){case"middle":q-=X/2;break;case"bottom":q-=X;break}switch(E){case"center":ce-=Z/2;break;case"right":ce-=Z;break;case"inner":S===T-1?ce-=Z:S>0&&(ce-=Z/2);break}W={left:ce,top:q,width:Z+F.width,height:X+F.height,color:re.backdropColor}}w.push({label:M,font:N,textOffset:I,options:{rotation:x,color:se,strokeColor:xe,strokeWidth:H,textAlign:ve,textBaseline:ee,translation:[D,O],backdrop:W}})}return w}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-zl(this.labelRotation))return e==="top"?"left":"right";let i="center";return r.align==="start"?i="left":r.align==="end"?i="right":r.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,a=this._getLabelSizes(),o=e+s,l=a.widest.width;let u,d;return r==="left"?i?(d=this.right+s,n==="near"?u="left":n==="center"?(u="center",d+=l/2):(u="right",d+=l)):(d=this.right-o,n==="near"?u="right":n==="center"?(u="center",d-=l/2):(u="left",d=this.left)):r==="right"?i?(d=this.left+s,n==="near"?u="right":n==="center"?(u="center",d-=l/2):(u="left",d-=l)):(d=this.left+o,n==="near"?u="left":n==="center"?(u="center",d+=l/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:n,top:i,width:s,height:a}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(n,i,s,a),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?r.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const r=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,a;const o=(l,u,d)=>{!d.width||!d.color||(n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.setLineDash(d.borderDash||[]),n.lineDashOffset=d.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(r.display)for(s=0,a=i.length;s<a;++s){const l=i[s];r.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),r.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),a=n.display?s.width:0;if(!a)return;const o=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let u,d,h,m;this.isHorizontal()?(u=Tl(e,this.left,a)-a/2,d=Tl(e,this.right,o)+o/2,h=m=l):(h=Tl(e,this.top,a)-a/2,m=Tl(e,this.bottom,o)+o/2,u=d=l),r.save(),r.lineWidth=s.width,r.strokeStyle=s.color,r.beginPath(),r.moveTo(u,h),r.lineTo(d,m),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&jm(n,i);const s=this.getLabelItems(e);for(const a of s){const o=a.options,l=a.font,u=a.label,d=a.textOffset;Zd(n,u,0,d,l,o)}i&&zm(n)}drawTitle(){const{ctx:e,options:{position:r,title:n,reverse:i}}=this;if(!n.display)return;const s=Zn(n.font),a=ms(n.padding),o=n.align;let l=s.lineHeight/2;r==="bottom"||r==="center"||Gt(r)?(l+=a.bottom,ln(n.text)&&(l+=s.lineHeight*(n.text.length-1))):l+=a.top;const{titleX:u,titleY:d,maxWidth:h,rotation:m}=FZ(this,l,r,o);Zd(e,n.text,0,0,s,{color:n.color,maxWidth:h,rotation:m,textAlign:OZ(o,r,i),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,n=Ht(e.grid&&e.grid.z,-1),i=Ht(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==qu.prototype.draw?[{z:r,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:r,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,a;for(s=0,a=r.length;s<a;++s){const o=r[s];o[n]===this.id&&(!e||o.type===e)&&i.push(o)}return i}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return Zn(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class rp{constructor(e,r,n){this.type=e,this.scope=r,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let n;PZ(r)&&(n=this.register(r));const i=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,IZ(e,a,n),this.override&&Vr.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const r=this.items,n=e.id,i=this.scope;n in r&&delete r[n],i&&n in Vr[i]&&(delete Vr[i][n],this.override&&delete cc[n])}}function IZ(t,e,r){const n=Kd(Object.create(null),[r?Vr.get(r):{},Vr.get(e),t.defaults]);Vr.set(e,n),t.defaultRoutes&&RZ(e,t.defaultRoutes),t.descriptors&&Vr.describe(e,t.descriptors)}function RZ(t,e){Object.keys(e).forEach(r=>{const n=r.split("."),i=n.pop(),s=[t].concat(n).join("."),a=e[r].split("."),o=a.pop(),l=a.join(".");Vr.route(s,i,l,o)})}function PZ(t){return"id"in t&&"defaults"in t}class LZ{constructor(){this.controllers=new rp(mp,"datasets",!0),this.elements=new rp(eo,"elements"),this.plugins=new rp(Object,"plugins"),this.scales=new rp(qu,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,n){[...r].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):ur(i,a=>{const o=n||this._getRegistryForType(a);this._exec(e,o,a)})})}_exec(e,r,n){const i=Aw(e);br(n["before"+i],[],n),r[e](n),br(n["after"+i],[],n)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const n=this._typedRegistries[r];if(n.isForType(e))return n}return this.plugins}_get(e,r,n){const i=r.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var aa=new LZ;class BZ{constructor(){this._init=[]}notify(e,r,n,i){r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=i?this._descriptors(e).filter(i):this._descriptors(e),a=this._notify(s,e,r,n);return r==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,r,n,i){i=i||{};for(const s of e){const a=s.plugin,o=a[n],l=[r,i,s.options];if(br(o,l,a)===!1&&i.cancelable)return!1}return!0}invalidate(){Ar(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const n=e&&e.config,i=Ht(n.options&&n.options.plugins,{}),s=jZ(n);return i===!1&&!r?[]:VZ(e,s,i,r)}_notifyStateChanges(e){const r=this._oldCache||[],n=this._cache,i=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(i(r,n),e,"stop"),this._notify(i(n,r),e,"start")}}function jZ(t){const e={},r=[],n=Object.keys(aa.plugins.items);for(let s=0;s<n.length;s++)r.push(aa.getPlugin(n[s]));const i=t.plugins||[];for(let s=0;s<i.length;s++){const a=i[s];r.indexOf(a)===-1&&(r.push(a),e[a.id]=!0)}return{plugins:r,localIds:e}}function zZ(t,e){return!e&&t===!1?null:t===!0?{}:t}function VZ(t,{plugins:e,localIds:r},n,i){const s=[],a=t.getContext();for(const o of e){const l=o.id,u=zZ(n[l],i);u!==null&&s.push({plugin:o,options:$Z(t.config,{plugin:o,local:r[l]},u,a)})}return s}function $Z(t,{plugin:e,local:r},n,i){const s=t.pluginScopeKeys(e),a=t.getOptionScopes(n,s);return r&&e.defaults&&a.push(e.defaults),t.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function q1(t,e){const r=Vr.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function UZ(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function HZ(t,e){return t===e?"_index_":"_value_"}function SE(t){if(t==="x"||t==="y"||t==="r")return t}function WZ(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Y1(t,...e){if(SE(t))return t;for(const r of e){const n=r.axis||WZ(r.position)||t.length>1&&SE(t[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function _E(t,e,r){if(r[e+"AxisID"]===t)return{axis:e}}function GZ(t,e){if(e.data&&e.data.datasets){const r=e.data.datasets.filter(n=>n.xAxisID===t||n.yAxisID===t);if(r.length)return _E(t,"x",r[0])||_E(t,"y",r[0])}return{}}function qZ(t,e){const r=cc[t.type]||{scales:{}},n=e.scales||{},i=q1(t.type,e),s=Object.create(null);return Object.keys(n).forEach(a=>{const o=n[a];if(!Gt(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=Y1(a,o,GZ(a,t),Vr.scales[o.type]),u=HZ(l,i),d=r.scales||{};s[a]=yd(Object.create(null),[{axis:l},o,d[l],d[u]])}),t.data.datasets.forEach(a=>{const o=a.type||t.type,l=a.indexAxis||q1(o,e),d=(cc[o]||{}).scales||{};Object.keys(d).forEach(h=>{const m=UZ(h,l),g=a[m+"AxisID"]||m;s[g]=s[g]||Object.create(null),yd(s[g],[{axis:m},n[g],d[h]])})}),Object.keys(s).forEach(a=>{const o=s[a];yd(o,[Vr.scales[o.type],Vr.scale])}),s}function jO(t){const e=t.options||(t.options={});e.plugins=Ht(e.plugins,{}),e.scales=qZ(t,e)}function zO(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function YZ(t){return t=t||{},t.data=zO(t.data),jO(t),t}const CE=new Map,VO=new Set;function np(t,e){let r=CE.get(t);return r||(r=e(),CE.set(t,r),VO.add(r)),r}const Vf=(t,e,r)=>{const n=nm(e,r);n!==void 0&&t.add(n)};class KZ{constructor(e){this._config=YZ(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=zO(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),jO(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return np(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return np(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return np(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,n=this.type;return np(`${n}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const n=this._scopeCache;let i=n.get(e);return(!i||r)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,r,n){const{options:i,type:s}=this,a=this._cachedScopes(e,n),o=a.get(r);if(o)return o;const l=new Set;r.forEach(d=>{e&&(l.add(e),d.forEach(h=>Vf(l,e,h))),d.forEach(h=>Vf(l,i,h)),d.forEach(h=>Vf(l,cc[s]||{},h)),d.forEach(h=>Vf(l,Vr,h)),d.forEach(h=>Vf(l,W1,h))});const u=Array.from(l);return u.length===0&&u.push(Object.create(null)),VO.has(r)&&a.set(r,u),u}chartOptionScopes(){const{options:e,type:r}=this;return[e,cc[r]||{},Vr.datasets[r]||{},{type:r},Vr,W1]}resolveNamedOptions(e,r,n,i=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=EE(this._resolverCache,e,i);let l=a;if(ZZ(a,r)){s.$shared=!1,n=nl(n)?n():n;const u=this.createResolver(e,n,o);l=Bu(a,n,u)}for(const u of r)s[u]=l[u];return s}createResolver(e,r,n=[""],i){const{resolver:s}=EE(this._resolverCache,e,n);return Gt(r)?Bu(s,r,void 0,i):s}}function EE(t,e,r){let n=t.get(e);n||(n=new Map,t.set(e,n));const i=r.join();let s=n.get(i);return s||(s={resolver:Iw(e,r),subPrefixes:r.filter(o=>!o.toLowerCase().includes("hover"))},n.set(i,s)),s}const XZ=t=>Gt(t)&&Object.getOwnPropertyNames(t).some(e=>nl(t[e]));function ZZ(t,e){const{isScriptable:r,isIndexable:n}=bO(t);for(const i of e){const s=r(i),a=n(i),o=(a||s)&&t[i];if(s&&(nl(o)||XZ(o))||a&&ln(o))return!0}return!1}var JZ="4.5.0";const QZ=["top","bottom","left","right","chartArea"];function TE(t,e){return t==="top"||t==="bottom"||QZ.indexOf(t)===-1&&e==="x"}function AE(t,e){return function(r,n){return r[t]===n[t]?r[e]-n[e]:r[t]-n[t]}}function NE(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),br(r&&r.onComplete,[t],e)}function eJ(t){const e=t.chart,r=e.options.animation;br(r&&r.onProgress,[t],e)}function $O(t){return Lw()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const xp={},ME=t=>{const e=$O(t);return Object.values(xp).filter(r=>r.canvas===e).pop()};function tJ(t,e,r){const n=Object.keys(t);for(const i of n){const s=+i;if(s>=e){const a=t[i];delete t[i],(r>0||s>e)&&(t[s+r]=a)}}}function rJ(t,e,r,n){return!r||t.type==="mouseout"?null:n?e:t}class Ao{static register(...e){aa.add(...e),DE()}static unregister(...e){aa.remove(...e),DE()}constructor(e,r){const n=this.config=new KZ(r),i=$O(e),s=ME(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||wZ(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,a.aspectRatio),l=o&&o.canvas,u=l&&l.height,d=l&&l.width;if(this.id=hK(),this.ctx=o,this.canvas=l,this.width=d,this.height=u,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new BZ,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=FK(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],xp[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ra.listen(this,"complete",NE),Ra.listen(this,"progress",eJ),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:n,height:i,_aspectRatio:s}=this;return Ar(e)?r&&s?s:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return aa}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():rE(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return QC(this.canvas,this.ctx),this}stop(){return Ra.stop(this),this}resize(e,r){Ra.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,e,r,s),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,rE(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),br(n.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};ur(r,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,r=e.scales,n=this.scales,i=Object.keys(n).reduce((a,o)=>(a[o]=!1,a),{});let s=[];r&&(s=s.concat(Object.keys(r).map(a=>{const o=r[a],l=Y1(a,o),u=l==="r",d=l==="x";return{options:o,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),ur(s,a=>{const o=a.options,l=o.id,u=Y1(l,o),d=Ht(o.type,a.dtype);(o.position===void 0||TE(o.position,u)!==TE(a.dposition))&&(o.position=a.dposition),i[l]=!0;let h=null;if(l in n&&n[l].type===d)h=n[l];else{const m=aa.getScale(d);h=new m({id:l,type:d,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(o,e)}),ur(i,(a,o)=>{a||delete n[o]}),ur(n,a=>{fs.configure(this,a,a.options),fs.addBox(this,a)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,n=e.length;if(e.sort((i,s)=>i.index-s.index),n>r){for(let i=r;i<n;++i)this._destroyDatasetMeta(i);e.splice(r,n-r)}this._sortedMetasets=e.slice(0).sort(AE("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((n,i)=>{r.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=r.length;n<i;n++){const s=r[n];let a=this.getDatasetMeta(n);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(n),a=this.getDatasetMeta(n)),a.type=o,a.indexAxis=s.indexAxis||q1(o,this.options),a.order=s.order||0,a.index=n,a.label=""+s.label,a.visible=this.isDatasetVisible(n),a.controller)a.controller.updateIndex(n),a.controller.linkScales();else{const l=aa.getController(o),{datasetElementType:u,dataElementType:d}=Vr.datasets[o];Object.assign(l,{dataElementType:aa.getElement(d),datasetElementType:u&&aa.getElement(u)}),a.controller=new l(this,n),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){ur(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const n=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),m=!i&&s.indexOf(h)===-1;h.buildOrUpdateElements(m),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||ur(s,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(AE("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){ur(this.scales,e=>{fs.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!UC(r,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of r){const a=n==="_removeElements"?-s:s;tJ(e,i,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,n=s=>new Set(e.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),i=n(0);for(let s=1;s<r;s++)if(!UC(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;fs.update(this,this.width,this.height,e);const r=this.chartArea,n=r.width<=0||r.height<=0;this._layers=[],ur(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,n=this.data.datasets.length;r<n;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,n=this.data.datasets.length;r<n;++r)this._updateDataset(r,nl(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(r),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ra.has(this)?this.attached&&!Ra.running(this)&&Ra.start(this):(this.draw(),NE({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,n=[];let i,s;for(i=0,s=r.length;i<s;++i){const a=r[i];(!e||a.visible)&&n.push(a)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=DO(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&jm(r,i),e.controller.draw(),i&&zm(r),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return Xd(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,n,i){const s=QX.modes[r];return typeof s=="function"?s(this,e,n,i):[]}getDatasetMeta(e){const r=this.data.datasets[e],n=this._metasets;let i=n.filter(s=>s&&s._dataset===r).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=vc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!r.hidden}setDatasetVisibility(e,r){const n=this.getDatasetMeta(e);n.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,n){const i=n?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,i);im(r)?(s.data[r].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(s,{visible:n}),this.update(o=>o.datasetIndex===e?i:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),Ra.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),QC(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete xp[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,n=(s,a)=>{r.addEventListener(this,s,a),e[s]=a},i=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};ur(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,n=(l,u)=>{r.addEventListener(this,l,u),e[l]=u},i=(l,u)=>{e[l]&&(r.removeEventListener(this,l,u),delete e[l])},s=(l,u)=>{this.canvas&&this.resize(l,u)};let a;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",s),n("detach",a)};a=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",o)},r.isAttached(this.canvas)?o():a()}unbindEvents(){ur(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},ur(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,n){const i=n?"set":"remove";let s,a,o,l;for(r==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,l=e.length;o<l;++o){a=e[o];const u=a&&this.getDatasetMeta(a.datasetIndex).controller;u&&u[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],n=e.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!tm(n,r)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,r))}notifyPlugins(e,r,n){return this._plugins.notify(this,e,r,n)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,n){const i=this.options.hover,s=(l,u)=>l.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),a=s(r,e),o=n?e:s(e,r);a.length&&this.updateHoverStyle(a,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(e,r){const n={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},i=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(e,r,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(e,r,n){const{_active:i=[],options:s}=this,a=r,o=this._getActiveElements(e,i,n,a),l=yK(e),u=rJ(e,this._lastEvent,n,l);n&&(this._lastEvent=null,br(s.onHover,[e,o,this],this),l&&br(s.onClick,[e,o,this],this));const d=!tm(o,i);return(d||r)&&(this._active=o,this._updateHoverStyles(o,i,r)),this._lastEvent=u,d}_getActiveElements(e,r,n,i){if(e.type==="mouseout")return[];if(!n)return r;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}}wt(Ao,"defaults",Vr),wt(Ao,"instances",xp),wt(Ao,"overrides",cc),wt(Ao,"registry",aa),wt(Ao,"version",JZ),wt(Ao,"getChart",ME);function DE(){return ur(Ao.instances,t=>t._plugins.invalidate())}function nJ(t,e,r){const{startAngle:n,x:i,y:s,outerRadius:a,innerRadius:o,options:l}=e,{borderWidth:u,borderJoinStyle:d}=l,h=Math.min(u/a,zi(n-r));if(t.beginPath(),t.arc(i,s,a-u/2,n+h/2,r-h/2),o>0){const m=Math.min(u/o,zi(n-r));t.arc(i,s,o+u/2,r-m/2,n+m/2,!0)}else{const m=Math.min(u/2,a*zi(n-r));if(d==="round")t.arc(i,s,m,r-dr/2,n+dr/2,!0);else if(d==="bevel"){const g=2*m*m,v=-g*Math.cos(r+dr/2)+i,x=-g*Math.sin(r+dr/2)+s,w=g*Math.cos(n+dr/2)+i,S=g*Math.sin(n+dr/2)+s;t.lineTo(v,x),t.lineTo(w,S)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function iJ(t,e,r){const{startAngle:n,pixelMargin:i,x:s,y:a,outerRadius:o,innerRadius:l}=e;let u=i/o;t.beginPath(),t.arc(s,a,o,n-u,r+u),l>i?(u=i/l,t.arc(s,a,l,r+u,n-u,!0)):t.arc(s,a,i,r+Fn,n-Fn),t.closePath(),t.clip()}function sJ(t){return Fw(t,["outerStart","outerEnd","innerStart","innerEnd"])}function aJ(t,e,r,n){const i=sJ(t.options.borderRadius),s=(r-e)/2,a=Math.min(s,n*e/2),o=l=>{const u=(r-Math.min(s,l))*n/2;return Mi(l,0,Math.min(s,u))};return{outerStart:o(i.outerStart),outerEnd:o(i.outerEnd),innerStart:Mi(i.innerStart,0,a),innerEnd:Mi(i.innerEnd,0,a)}}function iu(t,e,r,n){return{x:r+t*Math.cos(e),y:n+t*Math.sin(e)}}function fm(t,e,r,n,i,s){const{x:a,y:o,startAngle:l,pixelMargin:u,innerRadius:d}=e,h=Math.max(e.outerRadius+n+r-u,0),m=d>0?d+n+r+u:0;let g=0;const v=i-l;if(n){const re=d>0?d-n:0,fe=h>0?h-n:0,se=(re+fe)/2,xe=se!==0?v*se/(se+n):v;g=(v-xe)/2}const x=Math.max(.001,v*h-r/dr)/h,w=(v-x)/2,S=l+w+g,T=i-w-g,{outerStart:_,outerEnd:M,innerStart:D,innerEnd:O}=aJ(e,m,h,T-S),E=h-_,A=h-M,N=S+_/E,P=T-M/A,B=m+D,I=m+O,ee=S+D/B,oe=T-O/I;if(t.beginPath(),s){const re=(N+P)/2;if(t.arc(a,o,h,N,re),t.arc(a,o,h,re,P),M>0){const H=iu(A,P,a,o);t.arc(H.x,H.y,M,P,T+Fn)}const fe=iu(I,T,a,o);if(t.lineTo(fe.x,fe.y),O>0){const H=iu(I,oe,a,o);t.arc(H.x,H.y,O,T+Fn,oe+Math.PI)}const se=(T-O/m+(S+D/m))/2;if(t.arc(a,o,m,T-O/m,se,!0),t.arc(a,o,m,se,S+D/m,!0),D>0){const H=iu(B,ee,a,o);t.arc(H.x,H.y,D,ee+Math.PI,S-Fn)}const xe=iu(E,S,a,o);if(t.lineTo(xe.x,xe.y),_>0){const H=iu(E,N,a,o);t.arc(H.x,H.y,_,S-Fn,N)}}else{t.moveTo(a,o);const re=Math.cos(N)*h+a,fe=Math.sin(N)*h+o;t.lineTo(re,fe);const se=Math.cos(P)*h+a,xe=Math.sin(P)*h+o;t.lineTo(se,xe)}t.closePath()}function oJ(t,e,r,n,i){const{fullCircles:s,startAngle:a,circumference:o}=e;let l=e.endAngle;if(s){fm(t,e,r,n,l,i);for(let u=0;u<s;++u)t.fill();isNaN(o)||(l=a+(o%bn||bn))}return fm(t,e,r,n,l,i),t.fill(),l}function lJ(t,e,r,n,i){const{fullCircles:s,startAngle:a,circumference:o,options:l}=e,{borderWidth:u,borderJoinStyle:d,borderDash:h,borderDashOffset:m,borderRadius:g}=l,v=l.borderAlign==="inner";if(!u)return;t.setLineDash(h||[]),t.lineDashOffset=m,v?(t.lineWidth=u*2,t.lineJoin=d||"round"):(t.lineWidth=u,t.lineJoin=d||"bevel");let x=e.endAngle;if(s){fm(t,e,r,n,x,i);for(let w=0;w<s;++w)t.stroke();isNaN(o)||(x=a+(o%bn||bn))}v&&iJ(t,e,x),l.selfJoin&&x-a>=dr&&g===0&&d!=="miter"&&nJ(t,e,x),s||(fm(t,e,r,n,x,i),t.stroke())}class ed extends eo{constructor(r){super();wt(this,"circumference");wt(this,"endAngle");wt(this,"fullCircles");wt(this,"innerRadius");wt(this,"outerRadius");wt(this,"pixelMargin");wt(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.getProps(["x","y"],i),{angle:a,distance:o}=hO(s,{x:r,y:n}),{startAngle:l,endAngle:u,innerRadius:d,outerRadius:h,circumference:m}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),g=(this.options.spacing+this.options.borderWidth)/2,v=Ht(m,u-l),x=Nw(a,l,u)&&l!==u,w=v>=bn||x,S=Ha(o,d+g,h+g);return w&&S}getCenterPoint(r){const{x:n,y:i,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:u,spacing:d}=this.options,h=(s+a)/2,m=(o+l+d+u)/2;return{x:n+Math.cos(h)*m,y:i+Math.sin(h)*m}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:n,circumference:i}=this,s=(n.offset||0)/4,a=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>bn?Math.floor(i/bn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const l=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(l)*s,Math.sin(l)*s);const u=1-Math.sin(Math.min(dr,i||0)),d=s*u;r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,oJ(r,this,d,a,o),lJ(r,this,d,a,o),r.restore()}}wt(ed,"id","arc"),wt(ed,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),wt(ed,"defaultRoutes",{backgroundColor:"backgroundColor"}),wt(ed,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});function UO(t,e,r=e){t.lineCap=Ht(r.borderCapStyle,e.borderCapStyle),t.setLineDash(Ht(r.borderDash,e.borderDash)),t.lineDashOffset=Ht(r.borderDashOffset,e.borderDashOffset),t.lineJoin=Ht(r.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Ht(r.borderWidth,e.borderWidth),t.strokeStyle=Ht(r.borderColor,e.borderColor)}function cJ(t,e,r){t.lineTo(r.x,r.y)}function uJ(t){return t.stepped?WK:t.tension||t.cubicInterpolationMode==="monotone"?GK:cJ}function HO(t,e,r={}){const n=t.length,{start:i=0,end:s=n-1}=r,{start:a,end:o}=e,l=Math.max(i,a),u=Math.min(s,o),d=i<a&&s<a||i>o&&s>o;return{count:n,start:l,loop:e.loop,ilen:u<l&&!d?n+u-l:u-l}}function fJ(t,e,r,n){const{points:i,options:s}=e,{count:a,start:o,loop:l,ilen:u}=HO(i,r,n),d=uJ(s);let{move:h=!0,reverse:m}=n||{},g,v,x;for(g=0;g<=u;++g)v=i[(o+(m?u-g:g))%a],!v.skip&&(h?(t.moveTo(v.x,v.y),h=!1):d(t,x,v,m,s.stepped),x=v);return l&&(v=i[(o+(m?u:0))%a],d(t,x,v,m,s.stepped)),!!l}function dJ(t,e,r,n){const i=e.points,{count:s,start:a,ilen:o}=HO(i,r,n),{move:l=!0,reverse:u}=n||{};let d=0,h=0,m,g,v,x,w,S;const T=M=>(a+(u?o-M:M))%s,_=()=>{x!==w&&(t.lineTo(d,w),t.lineTo(d,x),t.lineTo(d,S))};for(l&&(g=i[T(0)],t.moveTo(g.x,g.y)),m=0;m<=o;++m){if(g=i[T(m)],g.skip)continue;const M=g.x,D=g.y,O=M|0;O===v?(D<x?x=D:D>w&&(w=D),d=(h*d+M)/++h):(_(),t.lineTo(M,D),v=O,h=0,x=w=D),S=D}_()}function K1(t){const e=t.options,r=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!r?dJ:fJ}function hJ(t){return t.stepped?_X:t.tension||t.cubicInterpolationMode==="monotone"?CX:Ml}function pJ(t,e,r,n){let i=e._path;i||(i=e._path=new Path2D,e.path(i,r,n)&&i.closePath()),UO(t,e.options),t.stroke(i)}function mJ(t,e,r,n){const{segments:i,options:s}=e,a=K1(e);for(const o of i)UO(t,s,o.style),t.beginPath(),a(t,e,o,{start:r,end:r+n-1})&&t.closePath(),t.stroke()}const gJ=typeof Path2D=="function";function xJ(t,e,r,n){gJ&&!e.options.segment?pJ(t,e,r,n):mJ(t,e,r,n)}class jo extends eo{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,r){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;gX(this._points,n,e,i,r),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=DX(this,this.options.segment))}first(){const e=this.segments,r=this.points;return e.length&&r[e[0].start]}last(){const e=this.segments,r=this.points,n=e.length;return n&&r[e[n-1].end]}interpolate(e,r){const n=this.options,i=e[r],s=this.points,a=MO(this,{property:r,start:i,end:i});if(!a.length)return;const o=[],l=hJ(n);let u,d;for(u=0,d=a.length;u<d;++u){const{start:h,end:m}=a[u],g=s[h],v=s[m];if(g===v){o.push(g);continue}const x=Math.abs((i-g[r])/(v[r]-g[r])),w=l(g,v,x,n.stepped);w[r]=e[r],o.push(w)}return o.length===1?o[0]:o}pathSegment(e,r,n){return K1(this)(e,this,r,n)}path(e,r,n){const i=this.segments,s=K1(this);let a=this._loop;r=r||0,n=n||this.points.length-r;for(const o of i)a&=s(e,this,o,{start:r,end:r+n-1});return!!a}draw(e,r,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),xJ(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}wt(jo,"id","line"),wt(jo,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),wt(jo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),wt(jo,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function OE(t,e,r,n){const i=t.options,{[r]:s}=t.getProps([r],n);return Math.abs(e-s)<i.radius+i.hitRadius}class vp extends eo{constructor(r){super();wt(this,"parsed");wt(this,"skip");wt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,n,i){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],i);return Math.pow(r-a,2)+Math.pow(n-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(r,n){return OE(this,r,"x",n)}inYRange(r,n){return OE(this,r,"y",n)}getCenterPoint(r){const{x:n,y:i}=this.getProps(["x","y"],r);return{x:n,y:i}}size(r){r=r||this.options||{};let n=r.radius||0;n=Math.max(n,n&&r.hoverRadius||0);const i=n&&r.borderWidth||0;return(n+i)*2}draw(r,n){const i=this.options;this.skip||i.radius<.1||!Xd(this,n,this.size(i)/2)||(r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.fillStyle=i.backgroundColor,G1(r,i,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}wt(vp,"id","point"),wt(vp,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),wt(vp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function WO(t,e){const{x:r,y:n,base:i,width:s,height:a}=t.getProps(["x","y","base","width","height"],e);let o,l,u,d,h;return t.horizontal?(h=a/2,o=Math.min(r,i),l=Math.max(r,i),u=n-h,d=n+h):(h=s/2,o=r-h,l=r+h,u=Math.min(n,i),d=Math.max(n,i)),{left:o,top:u,right:l,bottom:d}}function zo(t,e,r,n){return t?0:Mi(e,r,n)}function vJ(t,e,r){const n=t.options.borderWidth,i=t.borderSkipped,s=wO(n);return{t:zo(i.top,s.top,0,r),r:zo(i.right,s.right,0,e),b:zo(i.bottom,s.bottom,0,r),l:zo(i.left,s.left,0,e)}}function yJ(t,e,r){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),i=t.options.borderRadius,s=ku(i),a=Math.min(e,r),o=t.borderSkipped,l=n||Gt(i);return{topLeft:zo(!l||o.top||o.left,s.topLeft,0,a),topRight:zo(!l||o.top||o.right,s.topRight,0,a),bottomLeft:zo(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:zo(!l||o.bottom||o.right,s.bottomRight,0,a)}}function wJ(t){const e=WO(t),r=e.right-e.left,n=e.bottom-e.top,i=vJ(t,r/2,n/2),s=yJ(t,r/2,n/2);return{outer:{x:e.left,y:e.top,w:r,h:n,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:r-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Vv(t,e,r,n){const i=e===null,s=r===null,o=t&&!(i&&s)&&WO(t,n);return o&&(i||Ha(e,o.left,o.right))&&(s||Ha(r,o.top,o.bottom))}function bJ(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function kJ(t,e){t.rect(e.x,e.y,e.w,e.h)}function $v(t,e,r={}){const n=t.x!==r.x?-e:0,i=t.y!==r.y?-e:0,s=(t.x+t.w!==r.x+r.w?e:0)-n,a=(t.y+t.h!==r.y+r.h?e:0)-i;return{x:t.x+n,y:t.y+i,w:t.w+s,h:t.h+a,radius:t.radius}}class yp extends eo{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:r,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:a}=wJ(this),o=bJ(a.radius)?om:kJ;e.save(),(a.w!==s.w||a.h!==s.h)&&(e.beginPath(),o(e,$v(a,r,s)),e.clip(),o(e,$v(s,-r,a)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,$v(s,r)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,r,n){return Vv(this,e,r,n)}inXRange(e,r){return Vv(this,e,null,r)}inYRange(e,r){return Vv(this,null,e,r)}getCenterPoint(e){const{x:r,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(r+i)/2:r,y:s?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}wt(yp,"id","bar"),wt(yp,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),wt(yp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function SJ(t,e,r){const n=t.segments,i=t.points,s=e.points,a=[];for(const o of n){let{start:l,end:u}=o;u=Um(l,u,i);const d=X1(r,i[l],i[u],o.loop);if(!e.segments){a.push({source:o,target:d,start:i[l],end:i[u]});continue}const h=MO(e,d);for(const m of h){const g=X1(r,s[m.start],s[m.end],m.loop),v=NO(o,i,g);for(const x of v)a.push({source:x,target:m,start:{[r]:FE(d,g,"start",Math.max)},end:{[r]:FE(d,g,"end",Math.min)}})}}return a}function X1(t,e,r,n){if(n)return;let i=e[t],s=r[t];return t==="angle"&&(i=zi(i),s=zi(s)),{property:t,start:i,end:s}}function _J(t,e){const{x:r=null,y:n=null}=t||{},i=e.points,s=[];return e.segments.forEach(({start:a,end:o})=>{o=Um(a,o,i);const l=i[a],u=i[o];n!==null?(s.push({x:l.x,y:n}),s.push({x:u.x,y:n})):r!==null&&(s.push({x:r,y:l.y}),s.push({x:r,y:u.y}))}),s}function Um(t,e,r){for(;e>t;e--){const n=r[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function FE(t,e,r,n){return t&&e?n(t[r],e[r]):t?t[r]:e?e[r]:0}function GO(t,e){let r=[],n=!1;return ln(t)?(n=!0,r=t):r=_J(t,e),r.length?new jo({points:r,options:{tension:0},_loop:n,_fullLoop:n}):null}function IE(t){return t&&t.fill!==!1}function CJ(t,e,r){let i=t[e].fill;const s=[e];let a;if(!r)return i;for(;i!==!1&&s.indexOf(i)===-1;){if(!ei(i))return i;if(a=t[i],!a)return!1;if(a.visible)return i;s.push(i),i=a.fill}return!1}function EJ(t,e,r){const n=MJ(t);if(Gt(n))return isNaN(n.value)?!1:n;let i=parseFloat(n);return ei(i)&&Math.floor(i)===i?TJ(n[0],e,i,r):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function TJ(t,e,r,n){return(t==="-"||t==="+")&&(r=e+r),r===e||r<0||r>=n?!1:r}function AJ(t,e){let r=null;return t==="start"?r=e.bottom:t==="end"?r=e.top:Gt(t)?r=e.getPixelForValue(t.value):e.getBasePixel&&(r=e.getBasePixel()),r}function NJ(t,e,r){let n;return t==="start"?n=r:t==="end"?n=e.options.reverse?e.min:e.max:Gt(t)?n=t.value:n=e.getBaseValue(),n}function MJ(t){const e=t.options,r=e.fill;let n=Ht(r&&r.target,r);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function DJ(t){const{scale:e,index:r,line:n}=t,i=[],s=n.segments,a=n.points,o=OJ(e,r);o.push(GO({x:null,y:e.bottom},n));for(let l=0;l<s.length;l++){const u=s[l];for(let d=u.start;d<=u.end;d++)FJ(i,a[d],o)}return new jo({points:i,options:{}})}function OJ(t,e){const r=[],n=t.getMatchingVisibleMetas("line");for(let i=0;i<n.length;i++){const s=n[i];if(s.index===e)break;s.hidden||r.unshift(s.dataset)}return r}function FJ(t,e,r){const n=[];for(let i=0;i<r.length;i++){const s=r[i],{first:a,last:o,point:l}=IJ(s,e,"x");if(!(!l||a&&o)){if(a)n.unshift(l);else if(t.push(l),!o)break}}t.push(...n)}function IJ(t,e,r){const n=t.interpolate(e,r);if(!n)return{};const i=n[r],s=t.segments,a=t.points;let o=!1,l=!1;for(let u=0;u<s.length;u++){const d=s[u],h=a[d.start][r],m=a[d.end][r];if(Ha(i,h,m)){o=i===h,l=i===m;break}}return{first:o,last:l,point:n}}class qO{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,r,n){const{x:i,y:s,radius:a}=this;return r=r||{start:0,end:bn},e.arc(i,s,a,r.end,r.start,!0),!n.bounds}interpolate(e){const{x:r,y:n,radius:i}=this,s=e.angle;return{x:r+Math.cos(s)*i,y:n+Math.sin(s)*i,angle:s}}}function RJ(t){const{chart:e,fill:r,line:n}=t;if(ei(r))return PJ(e,r);if(r==="stack")return DJ(t);if(r==="shape")return!0;const i=LJ(t);return i instanceof qO?i:GO(i,n)}function PJ(t,e){const r=t.getDatasetMeta(e);return r&&t.isDatasetVisible(e)?r.dataset:null}function LJ(t){return(t.scale||{}).getPointPositionForValue?jJ(t):BJ(t)}function BJ(t){const{scale:e={},fill:r}=t,n=AJ(r,e);if(ei(n)){const i=e.isHorizontal();return{x:i?n:null,y:i?null:n}}return null}function jJ(t){const{scale:e,fill:r}=t,n=e.options,i=e.getLabels().length,s=n.reverse?e.max:e.min,a=NJ(r,e,s),o=[];if(n.grid.circular){const l=e.getPointPositionForValue(0,s);return new qO({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(a)})}for(let l=0;l<i;++l)o.push(e.getPointPositionForValue(l,a));return o}function Uv(t,e,r){const n=RJ(e),{chart:i,index:s,line:a,scale:o,axis:l}=e,u=a.options,d=u.fill,h=u.backgroundColor,{above:m=h,below:g=h}=d||{},v=i.getDatasetMeta(s),x=DO(i,v);n&&a.points.length&&(jm(t,r),zJ(t,{line:a,target:n,above:m,below:g,area:r,scale:o,axis:l,clip:x}),zm(t))}function zJ(t,e){const{line:r,target:n,above:i,below:s,area:a,scale:o,clip:l}=e,u=r._loop?"angle":e.axis;t.save();let d=s;s!==i&&(u==="x"?(RE(t,n,a.top),Hv(t,{line:r,target:n,color:i,scale:o,property:u,clip:l}),t.restore(),t.save(),RE(t,n,a.bottom)):u==="y"&&(PE(t,n,a.left),Hv(t,{line:r,target:n,color:s,scale:o,property:u,clip:l}),t.restore(),t.save(),PE(t,n,a.right),d=i)),Hv(t,{line:r,target:n,color:d,scale:o,property:u,clip:l}),t.restore()}function RE(t,e,r){const{segments:n,points:i}=e;let s=!0,a=!1;t.beginPath();for(const o of n){const{start:l,end:u}=o,d=i[l],h=i[Um(l,u,i)];s?(t.moveTo(d.x,d.y),s=!1):(t.lineTo(d.x,r),t.lineTo(d.x,d.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(h.x,r)}t.lineTo(e.first().x,r),t.closePath(),t.clip()}function PE(t,e,r){const{segments:n,points:i}=e;let s=!0,a=!1;t.beginPath();for(const o of n){const{start:l,end:u}=o,d=i[l],h=i[Um(l,u,i)];s?(t.moveTo(d.x,d.y),s=!1):(t.lineTo(r,d.y),t.lineTo(d.x,d.y)),a=!!e.pathSegment(t,o,{move:a}),a?t.closePath():t.lineTo(r,h.y)}t.lineTo(r,e.first().y),t.closePath(),t.clip()}function Hv(t,e){const{line:r,target:n,property:i,color:s,scale:a,clip:o}=e,l=SJ(r,n,i);for(const{source:u,target:d,start:h,end:m}of l){const{style:{backgroundColor:g=s}={}}=u,v=n!==!0;t.save(),t.fillStyle=g,VJ(t,a,o,v&&X1(i,h,m)),t.beginPath();const x=!!r.pathSegment(t,u);let w;if(v){x?t.closePath():LE(t,n,m,i);const S=!!n.pathSegment(t,d,{move:x,reverse:!0});w=x&&S,w||LE(t,n,h,i)}t.closePath(),t.fill(w?"evenodd":"nonzero"),t.restore()}}function VJ(t,e,r,n){const i=e.chart.chartArea,{property:s,start:a,end:o}=n||{};if(s==="x"||s==="y"){let l,u,d,h;s==="x"?(l=a,u=i.top,d=o,h=i.bottom):(l=i.left,u=a,d=i.right,h=o),t.beginPath(),r&&(l=Math.max(l,r.left),d=Math.min(d,r.right),u=Math.max(u,r.top),h=Math.min(h,r.bottom)),t.rect(l,u,d-l,h-u),t.clip()}}function LE(t,e,r,n){const i=e.interpolate(r,n);i&&t.lineTo(i.x,i.y)}var $J={id:"filler",afterDatasetsUpdate(t,e,r){const n=(t.data.datasets||[]).length,i=[];let s,a,o,l;for(a=0;a<n;++a)s=t.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof jo&&(l={visible:t.isDatasetVisible(a),index:a,fill:EJ(o,a,n),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,i.push(l);for(a=0;a<n;++a)l=i[a],!(!l||l.fill===!1)&&(l.fill=CJ(i,a,r.propagate))},beforeDraw(t,e,r){const n=r.drawTime==="beforeDraw",i=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let a=i.length-1;a>=0;--a){const o=i[a].$filler;o&&(o.line.updateControlPoints(s,o.axis),n&&o.fill&&Uv(t.ctx,o,s))}},beforeDatasetsDraw(t,e,r){if(r.drawTime!=="beforeDatasetsDraw")return;const n=t.getSortedVisibleDatasetMetas();for(let i=n.length-1;i>=0;--i){const s=n[i].$filler;IE(s)&&Uv(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,e,r){const n=e.meta.$filler;!IE(n)||r.drawTime!=="beforeDatasetDraw"||Uv(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const BE=(t,e)=>{let{boxHeight:r=e,boxWidth:n=e}=t;return t.usePointStyle&&(r=Math.min(r,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:r,itemHeight:Math.max(e,r)}},UJ=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class jE extends eo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,n){this.maxWidth=e,this.maxHeight=r,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=br(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(n=>e.filter(n,this.chart.data))),e.sort&&(r=r.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Zn(n.font),s=i.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=BE(n,s);let u,d;r.font=i.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(a,s,o,l)+10):(d=this.maxHeight,u=this._fitCols(a,i,o,l)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,r,n,i){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.lineWidths=[0],d=i+o;let h=e;s.textAlign="left",s.textBaseline="middle";let m=-1,g=-d;return this.legendItems.forEach((v,x)=>{const w=n+r/2+s.measureText(v.text).width;(x===0||u[u.length-1]+w+2*o>a)&&(h+=d,u[u.length-(x>0?0:1)]=0,g+=d,m++),l[x]={left:0,top:g,row:m,width:w,height:i},u[u.length-1]+=w+o}),h}_fitCols(e,r,n,i){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],u=this.columnSizes=[],d=a-e;let h=o,m=0,g=0,v=0,x=0;return this.legendItems.forEach((w,S)=>{const{itemWidth:T,itemHeight:_}=HJ(n,r,s,w,i);S>0&&g+_+2*o>d&&(h+=m+o,u.push({width:m,height:g}),v+=m+o,x++,m=g=0),l[S]={left:v,top:g,col:x,width:T,height:_},m=Math.max(m,T),g+=_+o}),h+=m,u.push({width:m,height:g}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:n,labels:{padding:i},rtl:s}}=this,a=Su(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=Hn(n,this.left+i,this.right-this.lineWidths[o]);for(const u of r)o!==u.row&&(o=u.row,l=Hn(n,this.left+i,this.right-this.lineWidths[o])),u.top+=this.top+e+i,u.left=a.leftForLtr(a.x(l),u.width),l+=u.width+i}else{let o=0,l=Hn(n,this.top+e+i,this.bottom-this.columnSizes[o].height);for(const u of r)u.col!==o&&(o=u.col,l=Hn(n,this.top+e+i,this.bottom-this.columnSizes[o].height)),u.top=l,u.left+=this.left+i,u.left=a.leftForLtr(a.x(u.left),u.width),l+=u.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;jm(e,this),this._draw(),zm(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:n,ctx:i}=this,{align:s,labels:a}=e,o=Vr.color,l=Su(e.rtl,this.left,this.width),u=Zn(a.font),{padding:d}=a,h=u.size,m=h/2;let g;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=u.string;const{boxWidth:v,boxHeight:x,itemHeight:w}=BE(a,h),S=function(O,E,A){if(isNaN(v)||v<=0||isNaN(x)||x<0)return;i.save();const N=Ht(A.lineWidth,1);if(i.fillStyle=Ht(A.fillStyle,o),i.lineCap=Ht(A.lineCap,"butt"),i.lineDashOffset=Ht(A.lineDashOffset,0),i.lineJoin=Ht(A.lineJoin,"miter"),i.lineWidth=N,i.strokeStyle=Ht(A.strokeStyle,o),i.setLineDash(Ht(A.lineDash,[])),a.usePointStyle){const P={radius:x*Math.SQRT2/2,pointStyle:A.pointStyle,rotation:A.rotation,borderWidth:N},B=l.xPlus(O,v/2),I=E+m;yO(i,P,B,I,a.pointStyleWidth&&v)}else{const P=E+Math.max((h-x)/2,0),B=l.leftForLtr(O,v),I=ku(A.borderRadius);i.beginPath(),Object.values(I).some(ee=>ee!==0)?om(i,{x:B,y:P,w:v,h:x,radius:I}):i.rect(B,P,v,x),i.fill(),N!==0&&i.stroke()}i.restore()},T=function(O,E,A){Zd(i,A.text,O,E+w/2,u,{strikethrough:A.hidden,textAlign:l.textAlign(A.textAlign)})},_=this.isHorizontal(),M=this._computeTitleHeight();_?g={x:Hn(s,this.left+d,this.right-n[0]),y:this.top+d+M,line:0}:g={x:this.left+d,y:Hn(s,this.top+M+d,this.bottom-r[0].height),line:0},EO(this.ctx,e.textDirection);const D=w+d;this.legendItems.forEach((O,E)=>{i.strokeStyle=O.fontColor,i.fillStyle=O.fontColor;const A=i.measureText(O.text).width,N=l.textAlign(O.textAlign||(O.textAlign=a.textAlign)),P=v+m+A;let B=g.x,I=g.y;l.setWidth(this.width),_?E>0&&B+P+d>this.right&&(I=g.y+=D,g.line++,B=g.x=Hn(s,this.left+d,this.right-n[g.line])):E>0&&I+D>this.bottom&&(B=g.x=B+r[g.line].width+d,g.line++,I=g.y=Hn(s,this.top+M+d,this.bottom-r[g.line].height));const ee=l.x(B);if(S(ee,I,O),B=IK(N,B+v+m,_?B+P:this.right,e.rtl),T(l.x(B),I,O),_)g.x+=P+d;else if(typeof O.text!="string"){const oe=u.lineHeight;g.y+=YO(O,oe)+d}else g.y+=D}),TO(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,n=Zn(r.font),i=ms(r.padding);if(!r.display)return;const s=Su(e.rtl,this.left,this.width),a=this.ctx,o=r.position,l=n.size/2,u=i.top+l;let d,h=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),d=this.top+u,h=Hn(e.align,h,this.right-m);else{const v=this.columnSizes.reduce((x,w)=>Math.max(x,w.height),0);d=u+Hn(e.align,this.top,this.bottom-v-e.labels.padding-this._computeTitleHeight())}const g=Hn(o,h,h+m);a.textAlign=s.textAlign(Dw(o)),a.textBaseline="middle",a.strokeStyle=r.color,a.fillStyle=r.color,a.font=n.string,Zd(a,r.text,g,d,n)}_computeTitleHeight(){const e=this.options.title,r=Zn(e.font),n=ms(e.padding);return e.display?r.lineHeight+n.height:0}_getLegendItemAt(e,r){let n,i,s;if(Ha(e,this.left,this.right)&&Ha(r,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Ha(e,i.left,i.left+i.width)&&Ha(r,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const r=this.options;if(!qJ(e.type,r))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=UJ(i,n);i&&!s&&br(r.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!s&&br(r.onHover,[e,n,this],this)}else n&&br(r.onClick,[e,n,this],this)}}function HJ(t,e,r,n,i){const s=WJ(n,t,e,r),a=GJ(i,n,e.lineHeight);return{itemWidth:s,itemHeight:a}}function WJ(t,e,r,n){let i=t.text;return i&&typeof i!="string"&&(i=i.reduce((s,a)=>s.length>a.length?s:a)),e+r.size/2+n.measureText(i).width}function GJ(t,e,r){let n=t;return typeof e.text!="string"&&(n=YO(e,r)),n}function YO(t,e){const r=t.text?t.text.length:0;return e*r}function qJ(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var YJ={id:"legend",_element:jE,start(t,e,r){const n=t.legend=new jE({ctx:t.ctx,options:r,chart:t});fs.configure(t,n,r),fs.addBox(t,n)},stop(t){fs.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const n=t.legend;fs.configure(t,n,r),n.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const n=e.datasetIndex,i=r.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:n,textAlign:i,color:s,useBorderRadius:a,borderRadius:o}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const u=l.controller.getStyle(r?0:void 0),d=ms(u.borderWidth);return{text:e[l.index].label,fillStyle:u.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:i||u.textAlign,borderRadius:a&&(o||u.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class KO extends eo{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=r;const i=ln(n.text)?n.text.length:1;this._padding=ms(n.padding);const s=i*Zn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:r,left:n,bottom:i,right:s,options:a}=this,o=a.align;let l=0,u,d,h;return this.isHorizontal()?(d=Hn(o,n,s),h=r+e,u=s-n):(a.position==="left"?(d=n+e,h=Hn(o,i,r),l=dr*-.5):(d=s-e,h=Hn(o,r,i),l=dr*.5),u=i-r),{titleX:d,titleY:h,maxWidth:u,rotation:l}}draw(){const e=this.ctx,r=this.options;if(!r.display)return;const n=Zn(r.font),s=n.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:u}=this._drawArgs(s);Zd(e,r.text,0,0,n,{color:r.color,maxWidth:l,rotation:u,textAlign:Dw(r.align),textBaseline:"middle",translation:[a,o]})}}function KJ(t,e){const r=new KO({ctx:t.ctx,options:e,chart:t});fs.configure(t,r,e),fs.addBox(t,r),t.titleBlock=r}var XJ={id:"title",_element:KO,start(t,e,r){KJ(t,r)},stop(t){const e=t.titleBlock;fs.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,r){const n=t.titleBlock;fs.configure(t,n,r),n.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const td={average(t){if(!t.length)return!1;let e,r,n=new Set,i=0,s=0;for(e=0,r=t.length;e<r;++e){const o=t[e].element;if(o&&o.hasValue()){const l=o.tooltipPosition();n.add(l.x),i+=l.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:i/s}},nearest(t,e){if(!t.length)return!1;let r=e.x,n=e.y,i=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=t.length;s<a;++s){const l=t[s].element;if(l&&l.hasValue()){const u=l.getCenterPoint(),d=U1(e,u);d<i&&(i=d,o=l)}}if(o){const l=o.tooltipPosition();r=l.x,n=l.y}return{x:r,y:n}}};function ia(t,e){return e&&(ln(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Pa(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function ZJ(t,e){const{element:r,datasetIndex:n,index:i}=e,s=t.getDatasetMeta(n).controller,{label:a,value:o}=s.getLabelAndValue(i);return{chart:t,label:a,parsed:s.getParsed(i),raw:t.data.datasets[n].data[i],formattedValue:o,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:r}}function zE(t,e){const r=t.chart.ctx,{body:n,footer:i,title:s}=t,{boxWidth:a,boxHeight:o}=e,l=Zn(e.bodyFont),u=Zn(e.titleFont),d=Zn(e.footerFont),h=s.length,m=i.length,g=n.length,v=ms(e.padding);let x=v.height,w=0,S=n.reduce((M,D)=>M+D.before.length+D.lines.length+D.after.length,0);if(S+=t.beforeBody.length+t.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),S){const M=e.displayColors?Math.max(o,l.lineHeight):l.lineHeight;x+=g*M+(S-g)*l.lineHeight+(S-1)*e.bodySpacing}m&&(x+=e.footerMarginTop+m*d.lineHeight+(m-1)*e.footerSpacing);let T=0;const _=function(M){w=Math.max(w,r.measureText(M).width+T)};return r.save(),r.font=u.string,ur(t.title,_),r.font=l.string,ur(t.beforeBody.concat(t.afterBody),_),T=e.displayColors?a+2+e.boxPadding:0,ur(n,M=>{ur(M.before,_),ur(M.lines,_),ur(M.after,_)}),T=0,r.font=d.string,ur(t.footer,_),r.restore(),w+=v.width,{width:w,height:x}}function JJ(t,e){const{y:r,height:n}=e;return r<n/2?"top":r>t.height-n/2?"bottom":"center"}function QJ(t,e,r,n){const{x:i,width:s}=n,a=r.caretSize+r.caretPadding;if(t==="left"&&i+s+a>e.width||t==="right"&&i-s-a<0)return!0}function eQ(t,e,r,n){const{x:i,width:s}=r,{width:a,chartArea:{left:o,right:l}}=t;let u="center";return n==="center"?u=i<=(o+l)/2?"left":"right":i<=s/2?u="left":i>=a-s/2&&(u="right"),QJ(u,t,e,r)&&(u="center"),u}function VE(t,e,r){const n=r.yAlign||e.yAlign||JJ(t,r);return{xAlign:r.xAlign||e.xAlign||eQ(t,e,r,n),yAlign:n}}function tQ(t,e){let{x:r,width:n}=t;return e==="right"?r-=n:e==="center"&&(r-=n/2),r}function rQ(t,e,r){let{y:n,height:i}=t;return e==="top"?n+=r:e==="bottom"?n-=i+r:n-=i/2,n}function $E(t,e,r,n){const{caretSize:i,caretPadding:s,cornerRadius:a}=t,{xAlign:o,yAlign:l}=r,u=i+s,{topLeft:d,topRight:h,bottomLeft:m,bottomRight:g}=ku(a);let v=tQ(e,o);const x=rQ(e,l,u);return l==="center"?o==="left"?v+=u:o==="right"&&(v-=u):o==="left"?v-=Math.max(d,m)+i:o==="right"&&(v+=Math.max(h,g)+i),{x:Mi(v,0,n.width-e.width),y:Mi(x,0,n.height-e.height)}}function ip(t,e,r){const n=ms(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function UE(t){return ia([],Pa(t))}function nQ(t,e,r){return vc(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function HE(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const XO={beforeTitle:Ia,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,n=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return r[e.dataIndex]}return""},afterTitle:Ia,beforeBody:Ia,beforeLabel:Ia,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return Ar(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Ia,afterBody:Ia,beforeFooter:Ia,footer:Ia,afterFooter:Ia};function Ci(t,e,r,n){const i=t[e].call(r,n);return typeof i>"u"?XO[e].call(r,n):i}class Z1 extends eo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&r.options.animation&&n.animations,s=new OO(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=nQ(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:n}=r,i=Ci(n,"beforeTitle",this,e),s=Ci(n,"title",this,e),a=Ci(n,"afterTitle",this,e);let o=[];return o=ia(o,Pa(i)),o=ia(o,Pa(s)),o=ia(o,Pa(a)),o}getBeforeBody(e,r){return UE(Ci(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:n}=r,i=[];return ur(e,s=>{const a={before:[],lines:[],after:[]},o=HE(n,s);ia(a.before,Pa(Ci(o,"beforeLabel",this,s))),ia(a.lines,Ci(o,"label",this,s)),ia(a.after,Pa(Ci(o,"afterLabel",this,s))),i.push(a)}),i}getAfterBody(e,r){return UE(Ci(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:n}=r,i=Ci(n,"beforeFooter",this,e),s=Ci(n,"footer",this,e),a=Ci(n,"afterFooter",this,e);let o=[];return o=ia(o,Pa(i)),o=ia(o,Pa(s)),o=ia(o,Pa(a)),o}_createItems(e){const r=this._active,n=this.chart.data,i=[],s=[],a=[];let o=[],l,u;for(l=0,u=r.length;l<u;++l)o.push(ZJ(this.chart,r[l]));return e.filter&&(o=o.filter((d,h,m)=>e.filter(d,h,m,n))),e.itemSort&&(o=o.sort((d,h)=>e.itemSort(d,h,n))),ur(o,d=>{const h=HE(e.callbacks,d);i.push(Ci(h,"labelColor",this,d)),s.push(Ci(h,"labelPointStyle",this,d)),a.push(Ci(h,"labelTextColor",this,d))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(e,r){const n=this.options.setContext(this.getContext()),i=this._active;let s,a=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const o=td[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const l=this._size=zE(this,n),u=Object.assign({},o,l),d=VE(this.chart,n,u),h=$E(n,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,n,i){const s=this.getCaretPosition(e,n,i);r.lineTo(s.x1,s.y1),r.lineTo(s.x2,s.y2),r.lineTo(s.x3,s.y3)}getCaretPosition(e,r,n){const{xAlign:i,yAlign:s}=this,{caretSize:a,cornerRadius:o}=n,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:h}=ku(o),{x:m,y:g}=e,{width:v,height:x}=r;let w,S,T,_,M,D;return s==="center"?(M=g+x/2,i==="left"?(w=m,S=w-a,_=M+a,D=M-a):(w=m+v,S=w+a,_=M-a,D=M+a),T=w):(i==="left"?S=m+Math.max(l,d)+a:i==="right"?S=m+v-Math.max(u,h)-a:S=this.caretX,s==="top"?(_=g,M=_-a,w=S-a,T=S+a):(_=g+x,M=_+a,w=S+a,T=S-a),D=_),{x1:w,x2:S,x3:T,y1:_,y2:M,y3:D}}drawTitle(e,r,n){const i=this.title,s=i.length;let a,o,l;if(s){const u=Su(n.rtl,this.x,this.width);for(e.x=ip(this,n.titleAlign,n),r.textAlign=u.textAlign(n.titleAlign),r.textBaseline="middle",a=Zn(n.titleFont),o=n.titleSpacing,r.fillStyle=n.titleColor,r.font=a.string,l=0;l<s;++l)r.fillText(i[l],u.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o,l+1===s&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,r,n,i,s){const a=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:l,boxWidth:u}=s,d=Zn(s.bodyFont),h=ip(this,"left",s),m=i.x(h),g=l<d.lineHeight?(d.lineHeight-l)/2:0,v=r.y+g;if(s.usePointStyle){const x={radius:Math.min(u,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},w=i.leftForLtr(m,u)+u/2,S=v+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,G1(e,x,w,S),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,G1(e,x,w,S)}else{e.lineWidth=Gt(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const x=i.leftForLtr(m,u),w=i.leftForLtr(i.xPlus(m,1),u-2),S=ku(a.borderRadius);Object.values(S).some(T=>T!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,om(e,{x,y:v,w:u,h:l,radius:S}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),om(e,{x:w,y:v+1,w:u-2,h:l-2,radius:S}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,v,u,l),e.strokeRect(x,v,u,l),e.fillStyle=a.backgroundColor,e.fillRect(w,v+1,u-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,r,n){const{body:i}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:u,boxPadding:d}=n,h=Zn(n.bodyFont);let m=h.lineHeight,g=0;const v=Su(n.rtl,this.x,this.width),x=function(A){r.fillText(A,v.x(e.x+g),e.y+m/2),e.y+=m+s},w=v.textAlign(a);let S,T,_,M,D,O,E;for(r.textAlign=a,r.textBaseline="middle",r.font=h.string,e.x=ip(this,w,n),r.fillStyle=n.bodyColor,ur(this.beforeBody,x),g=o&&w!=="right"?a==="center"?u/2+d:u+2+d:0,M=0,O=i.length;M<O;++M){for(S=i[M],T=this.labelTextColors[M],r.fillStyle=T,ur(S.before,x),_=S.lines,o&&_.length&&(this._drawColorBox(r,e,M,v,n),m=Math.max(h.lineHeight,l)),D=0,E=_.length;D<E;++D)x(_[D]),m=h.lineHeight;ur(S.after,x)}g=0,m=h.lineHeight,ur(this.afterBody,x),e.y-=s}drawFooter(e,r,n){const i=this.footer,s=i.length;let a,o;if(s){const l=Su(n.rtl,this.x,this.width);for(e.x=ip(this,n.footerAlign,n),e.y+=n.footerMarginTop,r.textAlign=l.textAlign(n.footerAlign),r.textBaseline="middle",a=Zn(n.footerFont),r.fillStyle=n.footerColor,r.font=a.string,o=0;o<s;++o)r.fillText(i[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,r,n,i){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=e,{width:u,height:d}=n,{topLeft:h,topRight:m,bottomLeft:g,bottomRight:v}=ku(i.cornerRadius);r.fillStyle=i.backgroundColor,r.strokeStyle=i.borderColor,r.lineWidth=i.borderWidth,r.beginPath(),r.moveTo(o+h,l),a==="top"&&this.drawCaret(e,r,n,i),r.lineTo(o+u-m,l),r.quadraticCurveTo(o+u,l,o+u,l+m),a==="center"&&s==="right"&&this.drawCaret(e,r,n,i),r.lineTo(o+u,l+d-v),r.quadraticCurveTo(o+u,l+d,o+u-v,l+d),a==="bottom"&&this.drawCaret(e,r,n,i),r.lineTo(o+g,l+d),r.quadraticCurveTo(o,l+d,o,l+d-g),a==="center"&&s==="left"&&this.drawCaret(e,r,n,i),r.lineTo(o,l+h),r.quadraticCurveTo(o,l,o+h,l),r.closePath(),r.fill(),i.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const a=td[e.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=zE(this,e),l=Object.assign({},a,this._size),u=VE(r,e,l),d=$E(e,l,u,r);(i._to!==d.x||s._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(r);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=ms(r.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,r),EO(e,r.textDirection),s.y+=a.top,this.drawTitle(s,e,r),this.drawBody(s,e,r),this.drawFooter(s,e,r),TO(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const n=this._active,i=e.map(({datasetIndex:o,index:l})=>{const u=this.chart.getDatasetMeta(o);if(!u)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:u.data[l],index:l}}),s=!tm(n,i),a=this._positionChanged(i,r);(s||a)&&(this._active=i,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,n=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],a=this._getActiveElements(e,s,r,n),o=this._positionChanged(a,e),l=r||!tm(a,s)||o;return l&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),l}_getActiveElements(e,r,n,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return r.filter(o=>this.chart.data.datasets[o.datasetIndex]&&this.chart.getDatasetMeta(o.datasetIndex).controller.getParsed(o.index)!==void 0);const a=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&a.reverse(),a}_positionChanged(e,r){const{caretX:n,caretY:i,options:s}=this,a=td[s.position].call(this,e,r);return a!==!1&&(n!==a.x||i!==a.y)}}wt(Z1,"positioners",td);var iQ={id:"tooltip",_element:Z1,positioners:td,afterInit(t,e,r){r&&(t.tooltip=new Z1({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:XO},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const sQ=(t,e,r,n)=>(typeof e=="string"?(r=t.push(e)-1,n.unshift({index:r,label:e})):isNaN(e)&&(r=null),r);function aQ(t,e,r,n){const i=t.indexOf(e);if(i===-1)return sQ(t,e,r,n);const s=t.lastIndexOf(e);return i!==s?r:i}const oQ=(t,e)=>t===null?null:Mi(Math.round(t),0,e);function WE(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class J1 extends qu{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const r=this._addedLabels;if(r.length){const n=this.getLabels();for(const{index:i,label:s}of r)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,r){if(Ar(e))return null;const n=this.getLabels();return r=isFinite(r)&&n[r]===e?r:aQ(n,e,Ht(r,e),this._addedLabels),oQ(r,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:r}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),r||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,r=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=e===0&&r===s.length-1?s:s.slice(e,r+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=r;a++)i.push({value:a});return i}getLabelForValue(e){return WE.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}wt(J1,"id","category"),wt(J1,"defaults",{ticks:{callback:WE}});function lQ(t,e){const r=[],{bounds:i,step:s,min:a,max:o,precision:l,count:u,maxTicks:d,maxDigits:h,includeBounds:m}=t,g=s||1,v=d-1,{min:x,max:w}=e,S=!Ar(a),T=!Ar(o),_=!Ar(u),M=(w-x)/(h+1);let D=WC((w-x)/v/g)*g,O,E,A,N;if(D<1e-14&&!S&&!T)return[{value:x},{value:w}];N=Math.ceil(w/D)-Math.floor(x/D),N>v&&(D=WC(N*D/v/g)*g),Ar(l)||(O=Math.pow(10,l),D=Math.ceil(D*O)/O),i==="ticks"?(E=Math.floor(x/D)*D,A=Math.ceil(w/D)*D):(E=x,A=w),S&&T&&s&&_K((o-a)/s,D/1e3)?(N=Math.round(Math.min((o-a)/D,d)),D=(o-a)/N,E=a,A=o):_?(E=S?a:E,A=T?o:A,N=u-1,D=(A-E)/N):(N=(A-E)/D,wd(N,Math.round(N),D/1e3)?N=Math.round(N):N=Math.ceil(N));const P=Math.max(GC(D),GC(E));O=Math.pow(10,Ar(l)?P:l),E=Math.round(E*O)/O,A=Math.round(A*O)/O;let B=0;for(S&&(m&&E!==a?(r.push({value:a}),E<a&&B++,wd(Math.round((E+B*D)*O)/O,a,GE(a,M,t))&&B++):E<a&&B++);B<N;++B){const I=Math.round((E+B*D)*O)/O;if(T&&I>o)break;r.push({value:I})}return T&&m&&A!==o?r.length&&wd(r[r.length-1].value,o,GE(o,M,t))?r[r.length-1].value=o:r.push({value:o}):(!T||A===o)&&r.push({value:A}),r}function GE(t,e,{horizontal:r,minRotation:n}){const i=zl(n),s=(r?Math.sin(i):Math.cos(i))||.001,a=.75*e*(""+t).length;return Math.min(e/s,a)}class cQ extends qu{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,r){return Ar(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:r,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const a=l=>i=r?i:l,o=l=>s=n?s:l;if(e){const l=Lu(i),u=Lu(s);l<0&&u<0?o(0):l>0&&u>0&&a(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);o(s+l),e||a(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:r,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),r=r||11),r&&(i=Math.min(r,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,r=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:r.includeBounds!==!1},s=this._range||this,a=lQ(i,s);return e.bounds==="ticks"&&CK(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let r=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-r)/Math.max(e.length-1,1)/2;r-=i,n+=i}this._startValue=r,this._endValue=n,this._valueRange=n-r}getLabelForValue(e){return xO(e,this.chart.options.locale,this.options.ticks.format)}}class Q1 extends cQ{determineDataLimits(){const{min:e,max:r}=this.getMinMax(!0);this.min=ei(e)?e:0,this.max=ei(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),r=e?this.width:this.height,n=zl(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}wt(Q1,"id","linear"),wt(Q1,"defaults",{ticks:{callback:vO.formatters.numeric}});const Hm={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ni=Object.keys(Hm);function qE(t,e){return t-e}function YE(t,e){if(Ar(e))return null;const r=t._adapter,{parser:n,round:i,isoWeekday:s}=t._parseOpts;let a=e;return typeof n=="function"&&(a=n(a)),ei(a)||(a=typeof n=="string"?r.parse(a,n):r.parse(a)),a===null?null:(i&&(a=i==="week"&&(am(s)||s===!0)?r.startOf(a,"isoWeek",s):r.startOf(a,i)),+a)}function KE(t,e,r,n){const i=Ni.length;for(let s=Ni.indexOf(t);s<i-1;++s){const a=Hm[Ni[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((r-e)/(o*a.size))<=n)return Ni[s]}return Ni[i-1]}function uQ(t,e,r,n,i){for(let s=Ni.length-1;s>=Ni.indexOf(r);s--){const a=Ni[s];if(Hm[a].common&&t._adapter.diff(i,n,a)>=e-1)return a}return Ni[r?Ni.indexOf(r):0]}function fQ(t){for(let e=Ni.indexOf(t)+1,r=Ni.length;e<r;++e)if(Hm[Ni[e]].common)return Ni[e]}function XE(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:n,hi:i}=Mw(r,e),s=r[n]>=e?r[n]:r[i];t[s]=!0}}function dQ(t,e,r,n){const i=t._adapter,s=+i.startOf(e[0].value,n),a=e[e.length-1].value;let o,l;for(o=s;o<=a;o=+i.add(o,1,n))l=r[o],l>=0&&(e[l].major=!0);return e}function ZE(t,e,r){const n=[],i={},s=e.length;let a,o;for(a=0;a<s;++a)o=e[a],i[o]=a,n.push({value:o,major:!1});return s===0||!r?n:dQ(t,n,i,r)}class Qd extends qu{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const n=e.time||(e.time={}),i=this._adapter=new cm._date(e.adapters.date);i.init(r),yd(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:YE(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,n=e.time.unit||"day";let{min:i,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(u){!a&&!isNaN(u.min)&&(i=Math.min(i,u.min)),!o&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!a||!o)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=ei(i)&&!isNaN(i)?i:+r.startOf(Date.now(),n),s=ei(s)&&!isNaN(s)?s:+r.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],n=e[e.length-1]),{min:r,max:n}}buildTicks(){const e=this.options,r=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,a=this.max,o=MK(i,s,a);return this._unit=r.unit||(n.autoSkip?KE(r.minUnit,this.min,this.max,this._getLabelCapacity(s)):uQ(this,o.length,r.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:fQ(this._unit),this.initOffsets(i),e.reverse&&o.reverse(),ZE(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,n=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?r=1-i:r=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;r=Mi(r,0,a),n=Mi(n,0,a),this._offsets={start:r,end:n,factor:1/(r+1+n)}}_generate(){const e=this._adapter,r=this.min,n=this.max,i=this.options,s=i.time,a=s.unit||KE(s.minUnit,r,n,this._getLabelCapacity(r)),o=Ht(i.ticks.stepSize,1),l=a==="week"?s.isoWeekday:!1,u=am(l)||l===!0,d={};let h=r,m,g;if(u&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,u?"day":a),e.diff(n,r,a)>1e5*o)throw new Error(r+" and "+n+" are too far apart with stepSize of "+o+" "+a);const v=i.ticks.source==="data"&&this.getDataTimestamps();for(m=h,g=0;m<n;m=+e.add(m,o,a),g++)XE(d,m,v);return(m===n||i.bounds==="ticks"||g===1)&&XE(d,m,v),Object.keys(d).sort(qE).map(x=>+x)}getLabelForValue(e){const r=this._adapter,n=this.options.time;return n.tooltipFormat?r.format(e,n.tooltipFormat):r.format(e,n.displayFormats.datetime)}format(e,r){const i=this.options.time.displayFormats,s=this._unit,a=r||i[s];return this._adapter.format(e,a)}_tickFormatFunction(e,r,n,i){const s=this.options,a=s.ticks.callback;if(a)return br(a,[e,r,n],this);const o=s.time.displayFormats,l=this._unit,u=this._majorUnit,d=l&&o[l],h=u&&o[u],m=n[r],g=u&&h&&m&&m.major;return this._adapter.format(e,i||(g?h:d))}generateTickLabels(e){let r,n,i;for(r=0,n=e.length;r<n;++r)i=e[r],i.label=this._tickFormatFunction(i.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+n)*r.factor)}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,n=this.ctx.measureText(e).width,i=zl(this.isHorizontal()?r.maxRotation:r.minRotation),s=Math.cos(i),a=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*s+o*a,h:n*a+o*s}}_getLabelCapacity(e){const r=this.options.time,n=r.displayFormats,i=n[r.unit]||n.millisecond,s=this._tickFormatFunction(e,0,ZE(this,[e],this._majorUnit),i),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],r,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(r=0,n=i.length;r<n;++r)e=e.concat(i[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,n;if(e.length)return e;const i=this.getLabels();for(r=0,n=i.length;r<n;++r)e.push(YE(this,i[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return OK(e.sort(qE))}}wt(Qd,"id","time"),wt(Qd,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function sp(t,e,r){let n=0,i=t.length-1,s,a,o,l;r?(e>=t[n].pos&&e<=t[i].pos&&({lo:n,hi:i}=H1(t,"pos",e)),{pos:s,time:o}=t[n],{pos:a,time:l}=t[i]):(e>=t[n].time&&e<=t[i].time&&({lo:n,hi:i}=H1(t,"time",e)),{time:s,pos:o}=t[n],{time:a,pos:l}=t[i]);const u=a-s;return u?o+(l-o)*(e-s)/u:o}class JE extends Qd{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=sp(r,this.min),this._tableRange=sp(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:n}=this,i=[],s=[];let a,o,l,u,d;for(a=0,o=e.length;a<o;++a)u=e[a],u>=r&&u<=n&&i.push(u);if(i.length<2)return[{time:r,pos:0},{time:n,pos:1}];for(a=0,o=i.length;a<o;++a)d=i[a+1],l=i[a-1],u=i[a],Math.round((d+l)/2)!==u&&s.push({time:u,pos:a/(o-1)});return s}_generate(){const e=this.min,r=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(r)||n.length===1)&&n.push(r),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),n=this.getLabelTimestamps();return r.length&&n.length?e=this.normalize(r.concat(n)):e=r.length?r:n,e=this._cache.all=e,e}getDecimalForValue(e){return(sp(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,n=this.getDecimalForPixel(e)/r.factor-r.end;return sp(this._table,n*this._tableRange+this._minPos,!0)}}wt(JE,"id","timeseries"),wt(JE,"defaults",Qd.defaults);function Za(t){"@babel/helpers - typeof";return Za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Za(t)}function kr(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function pt(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function bt(t){pt(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||Za(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function ZO(t,e){pt(2,arguments);var r=bt(t),n=kr(e);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function zw(t,e){pt(2,arguments);var r=bt(t),n=kr(e);if(isNaN(n))return new Date(NaN);if(!n)return r;var i=r.getDate(),s=new Date(r.getTime());s.setMonth(r.getMonth()+n+1,0);var a=s.getDate();return i>=a?s:(r.setFullYear(s.getFullYear(),s.getMonth(),i),r)}function fh(t,e){pt(2,arguments);var r=bt(t).getTime(),n=kr(e);return new Date(r+n)}var hQ=36e5;function pQ(t,e){pt(2,arguments);var r=kr(e);return fh(t,r*hQ)}var mQ={};function ll(){return mQ}function QE(t,e){var r,n,i,s,a,o,l,u;pt(1,arguments);var d=ll(),h=kr((r=(n=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&n!==void 0?n:(l=d.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=bt(t),g=m.getDay(),v=(g<h?7:0)+g-h;return m.setDate(m.getDate()-v),m.setHours(0,0,0,0),m}function dm(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function ey(t){pt(1,arguments);var e=bt(t);return e.setHours(0,0,0,0),e}var gQ=864e5;function xQ(t,e){pt(2,arguments);var r=ey(t),n=ey(e),i=r.getTime()-dm(r),s=n.getTime()-dm(n);return Math.round((i-s)/gQ)}var vQ=6e4;function yQ(t,e){pt(2,arguments);var r=kr(e);return fh(t,r*vQ)}function wQ(t,e){pt(2,arguments);var r=kr(e),n=r*3;return zw(t,n)}function bQ(t,e){pt(2,arguments);var r=kr(e);return fh(t,r*1e3)}function kQ(t,e){pt(2,arguments);var r=kr(e),n=r*7;return ZO(t,n)}function SQ(t,e){pt(2,arguments);var r=kr(e);return zw(t,r*12)}function Sd(t,e){pt(2,arguments);var r=bt(t),n=bt(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}var Wm=6e4,Gm=36e5,_Q=1e3;function CQ(t){return pt(1,arguments),t instanceof Date||Za(t)==="object"&&Object.prototype.toString.call(t)==="[object Date]"}function JO(t){if(pt(1,arguments),!CQ(t)&&typeof t!="number")return!1;var e=bt(t);return!isNaN(Number(e))}function EQ(t,e){pt(2,arguments);var r=bt(t),n=bt(e),i=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return i*12+s}function TQ(t,e){pt(2,arguments);var r=bt(t),n=bt(e);return r.getFullYear()-n.getFullYear()}function eT(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function QO(t,e){pt(2,arguments);var r=bt(t),n=bt(e),i=eT(r,n),s=Math.abs(xQ(r,n));r.setDate(r.getDate()-i*s);var a=+(eT(r,n)===-i),o=i*(s-a);return o===0?0:o}function qm(t,e){return pt(2,arguments),bt(t).getTime()-bt(e).getTime()}var tT={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},AQ="trunc";function dh(t){return t?tT[t]:tT[AQ]}function NQ(t,e,r){pt(2,arguments);var n=qm(t,e)/Gm;return dh(void 0)(n)}function MQ(t,e,r){pt(2,arguments);var n=qm(t,e)/Wm;return dh(void 0)(n)}function eF(t){pt(1,arguments);var e=bt(t);return e.setHours(23,59,59,999),e}function tF(t){pt(1,arguments);var e=bt(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function DQ(t){pt(1,arguments);var e=bt(t);return eF(e).getTime()===tF(e).getTime()}function rF(t,e){pt(2,arguments);var r=bt(t),n=bt(e),i=Sd(r,n),s=Math.abs(EQ(r,n)),a;if(s<1)a=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*s);var o=Sd(r,n)===-i;DQ(bt(t))&&s===1&&Sd(t,n)===1&&(o=!1),a=i*(s-Number(o))}return a===0?0:a}function OQ(t,e,r){pt(2,arguments);var n=rF(t,e)/3;return dh(void 0)(n)}function FQ(t,e,r){pt(2,arguments);var n=qm(t,e)/1e3;return dh(void 0)(n)}function IQ(t,e,r){pt(2,arguments);var n=QO(t,e)/7;return dh(void 0)(n)}function RQ(t,e){pt(2,arguments);var r=bt(t),n=bt(e),i=Sd(r,n),s=Math.abs(TQ(r,n));r.setFullYear(1584),n.setFullYear(1584);var a=Sd(r,n)===-i,o=i*(s-Number(a));return o===0?0:o}function PQ(t){pt(1,arguments);var e=bt(t);return e.setSeconds(0,0),e}function LQ(t){pt(1,arguments);var e=bt(t),r=e.getMonth(),n=r-r%3;return e.setMonth(n,1),e.setHours(0,0,0,0),e}function BQ(t){pt(1,arguments);var e=bt(t);return e.setDate(1),e.setHours(0,0,0,0),e}function jQ(t){pt(1,arguments);var e=bt(t),r=e.getFullYear();return e.setFullYear(r+1,0,0),e.setHours(23,59,59,999),e}function zQ(t){pt(1,arguments);var e=bt(t),r=new Date(0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}function VQ(t){pt(1,arguments);var e=bt(t);return e.setMinutes(59,59,999),e}function $Q(t,e){var r,n,i,s,a,o;pt(1,arguments);var l=ll(),u=kr((r=(n=(i=(s=void 0)!==null&&s!==void 0?s:void 0)!==null&&i!==void 0?i:l.weekStartsOn)!==null&&n!==void 0?n:(a=l.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&r!==void 0?r:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=bt(t),h=d.getDay(),m=(h<u?-7:0)+6-(h-u);return d.setDate(d.getDate()+m),d.setHours(23,59,59,999),d}function UQ(t){pt(1,arguments);var e=bt(t);return e.setSeconds(59,999),e}function HQ(t){pt(1,arguments);var e=bt(t),r=e.getMonth(),n=r-r%3+3;return e.setMonth(n,0),e.setHours(23,59,59,999),e}function WQ(t){pt(1,arguments);var e=bt(t);return e.setMilliseconds(999),e}function nF(t,e){pt(2,arguments);var r=kr(e);return fh(t,-r)}var GQ=864e5;function qQ(t){pt(1,arguments);var e=bt(t),r=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var n=e.getTime(),i=r-n;return Math.floor(i/GQ)+1}function zu(t){pt(1,arguments);var e=1,r=bt(t),n=r.getUTCDay(),i=(n<e?7:0)+n-e;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function iF(t){pt(1,arguments);var e=bt(t),r=e.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var i=zu(n),s=new Date(0);s.setUTCFullYear(r,0,4),s.setUTCHours(0,0,0,0);var a=zu(s);return e.getTime()>=i.getTime()?r+1:e.getTime()>=a.getTime()?r:r-1}function YQ(t){pt(1,arguments);var e=iF(t),r=new Date(0);r.setUTCFullYear(e,0,4),r.setUTCHours(0,0,0,0);var n=zu(r);return n}var KQ=6048e5;function sF(t){pt(1,arguments);var e=bt(t),r=zu(e).getTime()-YQ(e).getTime();return Math.round(r/KQ)+1}function Ja(t,e){var r,n,i,s,a,o,l,u;pt(1,arguments);var d=ll(),h=kr((r=(n=(i=(s=e==null?void 0:e.weekStartsOn)!==null&&s!==void 0?s:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&n!==void 0?n:(l=d.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&r!==void 0?r:0);if(!(h>=0&&h<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=bt(t),g=m.getUTCDay(),v=(g<h?7:0)+g-h;return m.setUTCDate(m.getUTCDate()-v),m.setUTCHours(0,0,0,0),m}function Vw(t,e){var r,n,i,s,a,o,l,u;pt(1,arguments);var d=bt(t),h=d.getUTCFullYear(),m=ll(),g=kr((r=(n=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&i!==void 0?i:m.firstWeekContainsDate)!==null&&n!==void 0?n:(l=m.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(g>=1&&g<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(h+1,0,g),v.setUTCHours(0,0,0,0);var x=Ja(v,e),w=new Date(0);w.setUTCFullYear(h,0,g),w.setUTCHours(0,0,0,0);var S=Ja(w,e);return d.getTime()>=x.getTime()?h+1:d.getTime()>=S.getTime()?h:h-1}function XQ(t,e){var r,n,i,s,a,o,l,u;pt(1,arguments);var d=ll(),h=kr((r=(n=(i=(s=e==null?void 0:e.firstWeekContainsDate)!==null&&s!==void 0?s:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&i!==void 0?i:d.firstWeekContainsDate)!==null&&n!==void 0?n:(l=d.locale)===null||l===void 0||(u=l.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&r!==void 0?r:1),m=Vw(t,e),g=new Date(0);g.setUTCFullYear(m,0,h),g.setUTCHours(0,0,0,0);var v=Ja(g,e);return v}var ZQ=6048e5;function aF(t,e){pt(1,arguments);var r=bt(t),n=Ja(r,e).getTime()-XQ(r,e).getTime();return Math.round(n/ZQ)+1}function cr(t,e){for(var r=t<0?"-":"",n=Math.abs(t).toString();n.length<e;)n="0"+n;return r+n}var ko={y:function(e,r){var n=e.getUTCFullYear(),i=n>0?n:1-n;return cr(r==="yy"?i%100:i,r.length)},M:function(e,r){var n=e.getUTCMonth();return r==="M"?String(n+1):cr(n+1,2)},d:function(e,r){return cr(e.getUTCDate(),r.length)},a:function(e,r){var n=e.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(e,r){return cr(e.getUTCHours()%12||12,r.length)},H:function(e,r){return cr(e.getUTCHours(),r.length)},m:function(e,r){return cr(e.getUTCMinutes(),r.length)},s:function(e,r){return cr(e.getUTCSeconds(),r.length)},S:function(e,r){var n=r.length,i=e.getUTCMilliseconds(),s=Math.floor(i*Math.pow(10,n-3));return cr(s,r.length)}},su={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},JQ={G:function(e,r,n){var i=e.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,r,n){if(r==="yo"){var i=e.getUTCFullYear(),s=i>0?i:1-i;return n.ordinalNumber(s,{unit:"year"})}return ko.y(e,r)},Y:function(e,r,n,i){var s=Vw(e,i),a=s>0?s:1-s;if(r==="YY"){var o=a%100;return cr(o,2)}return r==="Yo"?n.ordinalNumber(a,{unit:"year"}):cr(a,r.length)},R:function(e,r){var n=iF(e);return cr(n,r.length)},u:function(e,r){var n=e.getUTCFullYear();return cr(n,r.length)},Q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"Q":return String(i);case"QQ":return cr(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,r,n){var i=Math.ceil((e.getUTCMonth()+1)/3);switch(r){case"q":return String(i);case"qq":return cr(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,r,n){var i=e.getUTCMonth();switch(r){case"M":case"MM":return ko.M(e,r);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,r,n){var i=e.getUTCMonth();switch(r){case"L":return String(i+1);case"LL":return cr(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,r,n,i){var s=aF(e,i);return r==="wo"?n.ordinalNumber(s,{unit:"week"}):cr(s,r.length)},I:function(e,r,n){var i=sF(e);return r==="Io"?n.ordinalNumber(i,{unit:"week"}):cr(i,r.length)},d:function(e,r,n){return r==="do"?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):ko.d(e,r)},D:function(e,r,n){var i=qQ(e);return r==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):cr(i,r.length)},E:function(e,r,n){var i=e.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,r,n,i){var s=e.getUTCDay(),a=(s-i.weekStartsOn+8)%7||7;switch(r){case"e":return String(a);case"ee":return cr(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,r,n,i){var s=e.getUTCDay(),a=(s-i.weekStartsOn+8)%7||7;switch(r){case"c":return String(a);case"cc":return cr(a,r.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,r,n){var i=e.getUTCDay(),s=i===0?7:i;switch(r){case"i":return String(s);case"ii":return cr(s,r.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,r,n){var i=e.getUTCHours(),s=i/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,r,n){var i=e.getUTCHours(),s;switch(i===12?s=su.noon:i===0?s=su.midnight:s=i/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,r,n){var i=e.getUTCHours(),s;switch(i>=17?s=su.evening:i>=12?s=su.afternoon:i>=4?s=su.morning:s=su.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,r,n){if(r==="ho"){var i=e.getUTCHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return ko.h(e,r)},H:function(e,r,n){return r==="Ho"?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):ko.H(e,r)},K:function(e,r,n){var i=e.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(i,{unit:"hour"}):cr(i,r.length)},k:function(e,r,n){var i=e.getUTCHours();return i===0&&(i=24),r==="ko"?n.ordinalNumber(i,{unit:"hour"}):cr(i,r.length)},m:function(e,r,n){return r==="mo"?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):ko.m(e,r)},s:function(e,r,n){return r==="so"?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):ko.s(e,r)},S:function(e,r){return ko.S(e,r)},X:function(e,r,n,i){var s=i._originalDate||e,a=s.getTimezoneOffset();if(a===0)return"Z";switch(r){case"X":return nT(a);case"XXXX":case"XX":return Dl(a);case"XXXXX":case"XXX":default:return Dl(a,":")}},x:function(e,r,n,i){var s=i._originalDate||e,a=s.getTimezoneOffset();switch(r){case"x":return nT(a);case"xxxx":case"xx":return Dl(a);case"xxxxx":case"xxx":default:return Dl(a,":")}},O:function(e,r,n,i){var s=i._originalDate||e,a=s.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+rT(a,":");case"OOOO":default:return"GMT"+Dl(a,":")}},z:function(e,r,n,i){var s=i._originalDate||e,a=s.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+rT(a,":");case"zzzz":default:return"GMT"+Dl(a,":")}},t:function(e,r,n,i){var s=i._originalDate||e,a=Math.floor(s.getTime()/1e3);return cr(a,r.length)},T:function(e,r,n,i){var s=i._originalDate||e,a=s.getTime();return cr(a,r.length)}};function rT(t,e){var r=t>0?"-":"+",n=Math.abs(t),i=Math.floor(n/60),s=n%60;if(s===0)return r+String(i);var a=e;return r+String(i)+a+cr(s,2)}function nT(t,e){if(t%60===0){var r=t>0?"-":"+";return r+cr(Math.abs(t)/60,2)}return Dl(t,e)}function Dl(t,e){var r=e||"",n=t>0?"-":"+",i=Math.abs(t),s=cr(Math.floor(i/60),2),a=cr(i%60,2);return n+s+r+a}var iT=function(e,r){switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},oF=function(e,r){switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},QQ=function(e,r){var n=e.match(/(P+)(p+)?/)||[],i=n[1],s=n[2];if(!s)return iT(e,r);var a;switch(i){case"P":a=r.dateTime({width:"short"});break;case"PP":a=r.dateTime({width:"medium"});break;case"PPP":a=r.dateTime({width:"long"});break;case"PPPP":default:a=r.dateTime({width:"full"});break}return a.replace("{{date}}",iT(i,r)).replace("{{time}}",oF(s,r))},ty={p:oF,P:QQ},eee=["D","DD"],tee=["YY","YYYY"];function lF(t){return eee.indexOf(t)!==-1}function cF(t){return tee.indexOf(t)!==-1}function hm(t,e,r){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var ree={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nee=function(e,r,n){var i,s=ree[e];return typeof s=="string"?i=s:r===1?i=s.one:i=s.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function _u(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var iee={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},see={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},aee={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},oee={date:_u({formats:iee,defaultWidth:"full"}),time:_u({formats:see,defaultWidth:"full"}),dateTime:_u({formats:aee,defaultWidth:"full"})},lee={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},cee=function(e,r,n,i){return lee[e]};function la(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var s=t.defaultFormattingWidth||t.defaultWidth,a=r!=null&&r.width?String(r.width):s;i=t.formattingValues[a]||t.formattingValues[s]}else{var o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}var u=t.argumentCallback?t.argumentCallback(e):e;return i[u]}}var uee={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},fee={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dee={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hee={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},pee={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mee={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},gee=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},xee={ordinalNumber:gee,era:la({values:uee,defaultWidth:"wide"}),quarter:la({values:fee,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:la({values:dee,defaultWidth:"wide"}),day:la({values:hee,defaultWidth:"wide"}),dayPeriod:la({values:pee,defaultWidth:"wide",formattingValues:mee,defaultFormattingWidth:"wide"})};function ca(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;var a=s[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?yee(o,function(h){return h.test(a)}):vee(o,function(h){return h.test(a)}),u;u=t.valueCallback?t.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;var d=e.slice(a.length);return{value:u,rest:d}}}function vee(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function yee(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function uF(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],s=e.match(t.parsePattern);if(!s)return null;var a=t.valueCallback?t.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;var o=e.slice(i.length);return{value:a,rest:o}}}var wee=/^(\d+)(th|st|nd|rd)?/i,bee=/\d+/i,kee={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},See={any:[/^b/i,/^(a|c)/i]},_ee={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Cee={any:[/1/i,/2/i,/3/i,/4/i]},Eee={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Tee={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Aee={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Nee={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Mee={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Dee={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Oee={ordinalNumber:uF({matchPattern:wee,parsePattern:bee,valueCallback:function(e){return parseInt(e,10)}}),era:ca({matchPatterns:kee,defaultMatchWidth:"wide",parsePatterns:See,defaultParseWidth:"any"}),quarter:ca({matchPatterns:_ee,defaultMatchWidth:"wide",parsePatterns:Cee,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:ca({matchPatterns:Eee,defaultMatchWidth:"wide",parsePatterns:Tee,defaultParseWidth:"any"}),day:ca({matchPatterns:Aee,defaultMatchWidth:"wide",parsePatterns:Nee,defaultParseWidth:"any"}),dayPeriod:ca({matchPatterns:Mee,defaultMatchWidth:"any",parsePatterns:Dee,defaultParseWidth:"any"})},fF={code:"en-US",formatDistance:nee,formatLong:oee,formatRelative:cee,localize:xee,match:Oee,options:{weekStartsOn:0,firstWeekContainsDate:1}},Fee=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Iee=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ree=/^'([^]*?)'?$/,Pee=/''/g,Lee=/[a-zA-Z]/;function Bee(t,e,r){var n,i,s,a,o,l,u,d,h,m,g,v,x,w,S,T,_,M;pt(2,arguments);var D=String(e),O=ll(),E=(n=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:O.locale)!==null&&n!==void 0?n:fF,A=kr((s=(a=(o=(l=r==null?void 0:r.firstWeekContainsDate)!==null&&l!==void 0?l:r==null||(u=r.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&o!==void 0?o:O.firstWeekContainsDate)!==null&&a!==void 0?a:(h=O.locale)===null||h===void 0||(m=h.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&s!==void 0?s:1);if(!(A>=1&&A<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var N=kr((g=(v=(x=(w=r==null?void 0:r.weekStartsOn)!==null&&w!==void 0?w:r==null||(S=r.locale)===null||S===void 0||(T=S.options)===null||T===void 0?void 0:T.weekStartsOn)!==null&&x!==void 0?x:O.weekStartsOn)!==null&&v!==void 0?v:(_=O.locale)===null||_===void 0||(M=_.options)===null||M===void 0?void 0:M.weekStartsOn)!==null&&g!==void 0?g:0);if(!(N>=0&&N<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!E.localize)throw new RangeError("locale must contain localize property");if(!E.formatLong)throw new RangeError("locale must contain formatLong property");var P=bt(t);if(!JO(P))throw new RangeError("Invalid time value");var B=dm(P),I=nF(P,B),ee={firstWeekContainsDate:A,weekStartsOn:N,locale:E,_originalDate:P},oe=D.match(Iee).map(function(re){var fe=re[0];if(fe==="p"||fe==="P"){var se=ty[fe];return se(re,E.formatLong)}return re}).join("").match(Fee).map(function(re){if(re==="''")return"'";var fe=re[0];if(fe==="'")return jee(re);var se=JQ[fe];if(se)return!(r!=null&&r.useAdditionalWeekYearTokens)&&cF(re)&&hm(re,e,String(t)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&lF(re)&&hm(re,e,String(t)),se(I,re,E.localize,ee);if(fe.match(Lee))throw new RangeError("Format string contains an unescaped latin alphabet character `"+fe+"`");return re}).join("");return oe}function jee(t){var e=t.match(Ree);return e?e[1].replace(Pee,"'"):t}function zee(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function sT(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Vee(t,e){if(t){if(typeof t=="string")return sT(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sT(t,e):void 0}}function aT(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Vee(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var u=r.next();return a=u.done,u},e:function(u){o=!0,s=u},f:function(){try{a||r.return==null||r.return()}finally{if(o)throw s}}}}function nt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ry(t,e){return ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ry(t,e)}function tr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ry(t,e)}function pm(t){return pm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pm(t)}function dF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dF=function(){return!!t})()}function $ee(t,e){if(e&&(Za(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nt(t)}function rr(t){var e=dF();return function(){var r,n=pm(t);if(e){var i=pm(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $ee(this,r)}}function qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uee(t,e){if(Za(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Za(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hF(t){var e=Uee(t,"string");return Za(e)=="symbol"?e:e+""}function Hee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hF(n.key),n)}}function Yt(t,e,r){return e&&Hee(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xe(t,e,r){return(e=hF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Wee=10,pF=(function(){function t(){qt(this,t),Xe(this,"priority",void 0),Xe(this,"subPriority",0)}return Yt(t,[{key:"validate",value:function(r,n){return!0}}]),t})(),Gee=(function(t){tr(r,t);var e=rr(r);function r(n,i,s,a,o){var l;return qt(this,r),l=e.call(this),l.value=n,l.validateValue=i,l.setValue=s,l.priority=a,o&&(l.subPriority=o),l}return Yt(r,[{key:"validate",value:function(i,s){return this.validateValue(i,this.value,s)}},{key:"set",value:function(i,s,a){return this.setValue(i,s,this.value,a)}}]),r})(pF),qee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",Wee),Xe(nt(n),"subPriority",-1),n}return Yt(r,[{key:"set",value:function(i,s){if(s.timestampIsSet)return i;var a=new Date(0);return a.setFullYear(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),a.setHours(i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()),a}}]),r})(pF),sr=(function(){function t(){qt(this,t),Xe(this,"incompatibleTokens",void 0),Xe(this,"priority",void 0),Xe(this,"subPriority",void 0)}return Yt(t,[{key:"run",value:function(r,n,i,s){var a=this.parse(r,n,i,s);return a?{setter:new Gee(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}},{key:"validate",value:function(r,n,i){return!0}}]),t})(),Yee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",140),Xe(nt(n),"incompatibleTokens",["R","u","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(i,{width:"abbreviated"})||a.era(i,{width:"narrow"});case"GGGGG":return a.era(i,{width:"narrow"});case"GGGG":default:return a.era(i,{width:"wide"})||a.era(i,{width:"abbreviated"})||a.era(i,{width:"narrow"})}}},{key:"set",value:function(i,s,a){return s.era=a,i.setUTCFullYear(a,0,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),$r={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ua={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ur(t,e){return t&&{value:e(t.value),rest:t.rest}}function Nr(t,e){var r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function fa(t,e){var r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};var n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,a=r[5]?parseInt(r[5],10):0;return{value:n*(i*Gm+s*Wm+a*_Q),rest:e.slice(r[0].length)}}function mF(t){return Nr($r.anyDigitsSigned,t)}function Pr(t,e){switch(t){case 1:return Nr($r.singleDigit,e);case 2:return Nr($r.twoDigits,e);case 3:return Nr($r.threeDigits,e);case 4:return Nr($r.fourDigits,e);default:return Nr(new RegExp("^\\d{1,"+t+"}"),e)}}function mm(t,e){switch(t){case 1:return Nr($r.singleDigitSigned,e);case 2:return Nr($r.twoDigitsSigned,e);case 3:return Nr($r.threeDigitsSigned,e);case 4:return Nr($r.fourDigitsSigned,e);default:return Nr(new RegExp("^-?\\d{1,"+t+"}"),e)}}function $w(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function gF(t,e){var r=e>0,n=r?e:1-e,i;if(n<=50)i=t||100;else{var s=n+50,a=Math.floor(s/100)*100,o=t>=s%100;i=t+a-(o?100:0)}return r?i:1-i}function xF(t){return t%400===0||t%4===0&&t%100!==0}var Kee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",130),Xe(nt(n),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){var o=function(u){return{year:u,isTwoDigitYear:s==="yy"}};switch(s){case"y":return Ur(Pr(4,i),o);case"yo":return Ur(a.ordinalNumber(i,{unit:"year"}),o);default:return Ur(Pr(s.length,i),o)}}},{key:"validate",value:function(i,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(i,s,a){var o=i.getUTCFullYear();if(a.isTwoDigitYear){var l=gF(a.year,o);return i.setUTCFullYear(l,0,1),i.setUTCHours(0,0,0,0),i}var u=!("era"in s)||s.era===1?a.year:1-a.year;return i.setUTCFullYear(u,0,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),Xee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",130),Xe(nt(n),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){var o=function(u){return{year:u,isTwoDigitYear:s==="YY"}};switch(s){case"Y":return Ur(Pr(4,i),o);case"Yo":return Ur(a.ordinalNumber(i,{unit:"year"}),o);default:return Ur(Pr(s.length,i),o)}}},{key:"validate",value:function(i,s){return s.isTwoDigitYear||s.year>0}},{key:"set",value:function(i,s,a,o){var l=Vw(i,o);if(a.isTwoDigitYear){var u=gF(a.year,l);return i.setUTCFullYear(u,0,o.firstWeekContainsDate),i.setUTCHours(0,0,0,0),Ja(i,o)}var d=!("era"in s)||s.era===1?a.year:1-a.year;return i.setUTCFullYear(d,0,o.firstWeekContainsDate),i.setUTCHours(0,0,0,0),Ja(i,o)}}]),r})(sr),Zee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",130),Xe(nt(n),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s){return mm(s==="R"?4:s.length,i)}},{key:"set",value:function(i,s,a){var o=new Date(0);return o.setUTCFullYear(a,0,4),o.setUTCHours(0,0,0,0),zu(o)}}]),r})(sr),Jee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",130),Xe(nt(n),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s){return mm(s==="u"?4:s.length,i)}},{key:"set",value:function(i,s,a){return i.setUTCFullYear(a,0,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),Qee=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",120),Xe(nt(n),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"Q":case"QQ":return Pr(s.length,i);case"Qo":return a.ordinalNumber(i,{unit:"quarter"});case"QQQ":return a.quarter(i,{width:"abbreviated",context:"formatting"})||a.quarter(i,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(i,{width:"wide",context:"formatting"})||a.quarter(i,{width:"abbreviated",context:"formatting"})||a.quarter(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=1&&s<=4}},{key:"set",value:function(i,s,a){return i.setUTCMonth((a-1)*3,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),ete=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",120),Xe(nt(n),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"q":case"qq":return Pr(s.length,i);case"qo":return a.ordinalNumber(i,{unit:"quarter"});case"qqq":return a.quarter(i,{width:"abbreviated",context:"standalone"})||a.quarter(i,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(i,{width:"wide",context:"standalone"})||a.quarter(i,{width:"abbreviated",context:"standalone"})||a.quarter(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=1&&s<=4}},{key:"set",value:function(i,s,a){return i.setUTCMonth((a-1)*3,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),tte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Xe(nt(n),"priority",110),n}return Yt(r,[{key:"parse",value:function(i,s,a){var o=function(u){return u-1};switch(s){case"M":return Ur(Nr($r.month,i),o);case"MM":return Ur(Pr(2,i),o);case"Mo":return Ur(a.ordinalNumber(i,{unit:"month"}),o);case"MMM":return a.month(i,{width:"abbreviated",context:"formatting"})||a.month(i,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(i,{width:"wide",context:"formatting"})||a.month(i,{width:"abbreviated",context:"formatting"})||a.month(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,a){return i.setUTCMonth(a,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr),rte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",110),Xe(nt(n),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){var o=function(u){return u-1};switch(s){case"L":return Ur(Nr($r.month,i),o);case"LL":return Ur(Pr(2,i),o);case"Lo":return Ur(a.ordinalNumber(i,{unit:"month"}),o);case"LLL":return a.month(i,{width:"abbreviated",context:"standalone"})||a.month(i,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(i,{width:"wide",context:"standalone"})||a.month(i,{width:"abbreviated",context:"standalone"})||a.month(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,a){return i.setUTCMonth(a,1),i.setUTCHours(0,0,0,0),i}}]),r})(sr);function nte(t,e,r){pt(2,arguments);var n=bt(t),i=kr(e),s=aF(n,r)-i;return n.setUTCDate(n.getUTCDate()-s*7),n}var ite=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",100),Xe(nt(n),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"w":return Nr($r.week,i);case"wo":return a.ordinalNumber(i,{unit:"week"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=53}},{key:"set",value:function(i,s,a,o){return Ja(nte(i,a,o),o)}}]),r})(sr);function ste(t,e){pt(2,arguments);var r=bt(t),n=kr(e),i=sF(r)-n;return r.setUTCDate(r.getUTCDate()-i*7),r}var ate=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",100),Xe(nt(n),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"I":return Nr($r.week,i);case"Io":return a.ordinalNumber(i,{unit:"week"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=53}},{key:"set",value:function(i,s,a){return zu(ste(i,a))}}]),r})(sr),ote=[31,28,31,30,31,30,31,31,30,31,30,31],lte=[31,29,31,30,31,30,31,31,30,31,30,31],cte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"subPriority",1),Xe(nt(n),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"d":return Nr($r.date,i);case"do":return a.ordinalNumber(i,{unit:"date"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){var a=i.getUTCFullYear(),o=xF(a),l=i.getUTCMonth();return o?s>=1&&s<=lte[l]:s>=1&&s<=ote[l]}},{key:"set",value:function(i,s,a){return i.setUTCDate(a),i.setUTCHours(0,0,0,0),i}}]),r})(sr),ute=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"subpriority",1),Xe(nt(n),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"D":case"DD":return Nr($r.dayOfYear,i);case"Do":return a.ordinalNumber(i,{unit:"date"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){var a=i.getUTCFullYear(),o=xF(a);return o?s>=1&&s<=366:s>=1&&s<=365}},{key:"set",value:function(i,s,a){return i.setUTCMonth(0,a),i.setUTCHours(0,0,0,0),i}}]),r})(sr);function Uw(t,e,r){var n,i,s,a,o,l,u,d;pt(2,arguments);var h=ll(),m=kr((n=(i=(s=(a=r==null?void 0:r.weekStartsOn)!==null&&a!==void 0?a:r==null||(o=r.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:h.weekStartsOn)!==null&&i!==void 0?i:(u=h.locale)===null||u===void 0||(d=u.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&n!==void 0?n:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=bt(t),v=kr(e),x=g.getUTCDay(),w=v%7,S=(w+7)%7,T=(S<m?7:0)+v-x;return g.setUTCDate(g.getUTCDate()+T),g}var fte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"incompatibleTokens",["D","i","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"E":case"EE":case"EEE":return a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(i,{width:"wide",context:"formatting"})||a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,a,o){return i=Uw(i,a,o),i.setUTCHours(0,0,0,0),i}}]),r})(sr),dte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a,o){var l=function(d){var h=Math.floor((d-1)/7)*7;return(d+o.weekStartsOn+6)%7+h};switch(s){case"e":case"ee":return Ur(Pr(s.length,i),l);case"eo":return Ur(a.ordinalNumber(i,{unit:"day"}),l);case"eee":return a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"});case"eeeee":return a.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(i,{width:"wide",context:"formatting"})||a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,a,o){return i=Uw(i,a,o),i.setUTCHours(0,0,0,0),i}}]),r})(sr),hte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a,o){var l=function(d){var h=Math.floor((d-1)/7)*7;return(d+o.weekStartsOn+6)%7+h};switch(s){case"c":case"cc":return Ur(Pr(s.length,i),l);case"co":return Ur(a.ordinalNumber(i,{unit:"day"}),l);case"ccc":return a.day(i,{width:"abbreviated",context:"standalone"})||a.day(i,{width:"short",context:"standalone"})||a.day(i,{width:"narrow",context:"standalone"});case"ccccc":return a.day(i,{width:"narrow",context:"standalone"});case"cccccc":return a.day(i,{width:"short",context:"standalone"})||a.day(i,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(i,{width:"wide",context:"standalone"})||a.day(i,{width:"abbreviated",context:"standalone"})||a.day(i,{width:"short",context:"standalone"})||a.day(i,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(i,s){return s>=0&&s<=6}},{key:"set",value:function(i,s,a,o){return i=Uw(i,a,o),i.setUTCHours(0,0,0,0),i}}]),r})(sr);function pte(t,e){pt(2,arguments);var r=kr(e);r%7===0&&(r=r-7);var n=1,i=bt(t),s=i.getUTCDay(),a=r%7,o=(a+7)%7,l=(o<n?7:0)+r-s;return i.setUTCDate(i.getUTCDate()+l),i}var mte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",90),Xe(nt(n),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){var o=function(u){return u===0?7:u};switch(s){case"i":case"ii":return Pr(s.length,i);case"io":return a.ordinalNumber(i,{unit:"day"});case"iii":return Ur(a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"}),o);case"iiiii":return Ur(a.day(i,{width:"narrow",context:"formatting"}),o);case"iiiiii":return Ur(a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"}),o);case"iiii":default:return Ur(a.day(i,{width:"wide",context:"formatting"})||a.day(i,{width:"abbreviated",context:"formatting"})||a.day(i,{width:"short",context:"formatting"})||a.day(i,{width:"narrow",context:"formatting"}),o)}}},{key:"validate",value:function(i,s){return s>=1&&s<=7}},{key:"set",value:function(i,s,a){return i=pte(i,a),i.setUTCHours(0,0,0,0),i}}]),r})(sr),gte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",80),Xe(nt(n),"incompatibleTokens",["b","B","H","k","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"a":case"aa":case"aaa":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})||a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,a){return i.setUTCHours($w(a),0,0,0),i}}]),r})(sr),xte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",80),Xe(nt(n),"incompatibleTokens",["a","B","H","k","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"b":case"bb":case"bbb":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})||a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,a){return i.setUTCHours($w(a),0,0,0),i}}]),r})(sr),vte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",80),Xe(nt(n),"incompatibleTokens",["a","b","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"B":case"BB":case"BBB":return a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(i,{width:"wide",context:"formatting"})||a.dayPeriod(i,{width:"abbreviated",context:"formatting"})||a.dayPeriod(i,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(i,s,a){return i.setUTCHours($w(a),0,0,0),i}}]),r})(sr),yte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",70),Xe(nt(n),"incompatibleTokens",["H","K","k","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"h":return Nr($r.hour12h,i);case"ho":return a.ordinalNumber(i,{unit:"hour"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=12}},{key:"set",value:function(i,s,a){var o=i.getUTCHours()>=12;return o&&a<12?i.setUTCHours(a+12,0,0,0):!o&&a===12?i.setUTCHours(0,0,0,0):i.setUTCHours(a,0,0,0),i}}]),r})(sr),wte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",70),Xe(nt(n),"incompatibleTokens",["a","b","h","K","k","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"H":return Nr($r.hour23h,i);case"Ho":return a.ordinalNumber(i,{unit:"hour"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=23}},{key:"set",value:function(i,s,a){return i.setUTCHours(a,0,0,0),i}}]),r})(sr),bte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",70),Xe(nt(n),"incompatibleTokens",["h","H","k","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"K":return Nr($r.hour11h,i);case"Ko":return a.ordinalNumber(i,{unit:"hour"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=11}},{key:"set",value:function(i,s,a){var o=i.getUTCHours()>=12;return o&&a<12?i.setUTCHours(a+12,0,0,0):i.setUTCHours(a,0,0,0),i}}]),r})(sr),kte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",70),Xe(nt(n),"incompatibleTokens",["a","b","h","H","K","t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"k":return Nr($r.hour24h,i);case"ko":return a.ordinalNumber(i,{unit:"hour"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=1&&s<=24}},{key:"set",value:function(i,s,a){var o=a<=24?a%24:a;return i.setUTCHours(o,0,0,0),i}}]),r})(sr),Ste=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",60),Xe(nt(n),"incompatibleTokens",["t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"m":return Nr($r.minute,i);case"mo":return a.ordinalNumber(i,{unit:"minute"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=59}},{key:"set",value:function(i,s,a){return i.setUTCMinutes(a,0,0),i}}]),r})(sr),_te=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",50),Xe(nt(n),"incompatibleTokens",["t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s,a){switch(s){case"s":return Nr($r.second,i);case"so":return a.ordinalNumber(i,{unit:"second"});default:return Pr(s.length,i)}}},{key:"validate",value:function(i,s){return s>=0&&s<=59}},{key:"set",value:function(i,s,a){return i.setUTCSeconds(a,0),i}}]),r})(sr),Cte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",30),Xe(nt(n),"incompatibleTokens",["t","T"]),n}return Yt(r,[{key:"parse",value:function(i,s){var a=function(l){return Math.floor(l*Math.pow(10,-s.length+3))};return Ur(Pr(s.length,i),a)}},{key:"set",value:function(i,s,a){return i.setUTCMilliseconds(a),i}}]),r})(sr),Ete=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",10),Xe(nt(n),"incompatibleTokens",["t","T","x"]),n}return Yt(r,[{key:"parse",value:function(i,s){switch(s){case"X":return fa(ua.basicOptionalMinutes,i);case"XX":return fa(ua.basic,i);case"XXXX":return fa(ua.basicOptionalSeconds,i);case"XXXXX":return fa(ua.extendedOptionalSeconds,i);case"XXX":default:return fa(ua.extended,i)}}},{key:"set",value:function(i,s,a){return s.timestampIsSet?i:new Date(i.getTime()-a)}}]),r})(sr),Tte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",10),Xe(nt(n),"incompatibleTokens",["t","T","X"]),n}return Yt(r,[{key:"parse",value:function(i,s){switch(s){case"x":return fa(ua.basicOptionalMinutes,i);case"xx":return fa(ua.basic,i);case"xxxx":return fa(ua.basicOptionalSeconds,i);case"xxxxx":return fa(ua.extendedOptionalSeconds,i);case"xxx":default:return fa(ua.extended,i)}}},{key:"set",value:function(i,s,a){return s.timestampIsSet?i:new Date(i.getTime()-a)}}]),r})(sr),Ate=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",40),Xe(nt(n),"incompatibleTokens","*"),n}return Yt(r,[{key:"parse",value:function(i){return mF(i)}},{key:"set",value:function(i,s,a){return[new Date(a*1e3),{timestampIsSet:!0}]}}]),r})(sr),Nte=(function(t){tr(r,t);var e=rr(r);function r(){var n;qt(this,r);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=e.call.apply(e,[this].concat(s)),Xe(nt(n),"priority",20),Xe(nt(n),"incompatibleTokens","*"),n}return Yt(r,[{key:"parse",value:function(i){return mF(i)}},{key:"set",value:function(i,s,a){return[new Date(a),{timestampIsSet:!0}]}}]),r})(sr),Mte={G:new Yee,y:new Kee,Y:new Xee,R:new Zee,u:new Jee,Q:new Qee,q:new ete,M:new tte,L:new rte,w:new ite,I:new ate,d:new cte,D:new ute,E:new fte,e:new dte,c:new hte,i:new mte,a:new gte,b:new xte,B:new vte,h:new yte,H:new wte,K:new bte,k:new kte,m:new Ste,s:new _te,S:new Cte,X:new Ete,x:new Tte,t:new Ate,T:new Nte},Dte=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ote=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Fte=/^'([^]*?)'?$/,Ite=/''/g,Rte=/\S/,Pte=/[a-zA-Z]/;function Lte(t,e,r,n){var i,s,a,o,l,u,d,h,m,g,v,x,w,S,T,_,M,D;pt(3,arguments);var O=String(t),E=String(e),A=ll(),N=(i=(s=n==null?void 0:n.locale)!==null&&s!==void 0?s:A.locale)!==null&&i!==void 0?i:fF;if(!N.match)throw new RangeError("locale must contain match property");var P=kr((a=(o=(l=(u=n==null?void 0:n.firstWeekContainsDate)!==null&&u!==void 0?u:n==null||(d=n.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&l!==void 0?l:A.firstWeekContainsDate)!==null&&o!==void 0?o:(m=A.locale)===null||m===void 0||(g=m.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(P>=1&&P<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var B=kr((v=(x=(w=(S=n==null?void 0:n.weekStartsOn)!==null&&S!==void 0?S:n==null||(T=n.locale)===null||T===void 0||(_=T.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&w!==void 0?w:A.weekStartsOn)!==null&&x!==void 0?x:(M=A.locale)===null||M===void 0||(D=M.options)===null||D===void 0?void 0:D.weekStartsOn)!==null&&v!==void 0?v:0);if(!(B>=0&&B<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(E==="")return O===""?bt(r):new Date(NaN);var I={firstWeekContainsDate:P,weekStartsOn:B,locale:N},ee=[new qee],oe=E.match(Ote).map(function(pe){var ue=pe[0];if(ue in ty){var Se=ty[ue];return Se(pe,N.formatLong)}return pe}).join("").match(Dte),re=[],fe=aT(oe),se;try{var xe=function(){var ue=se.value;!(n!=null&&n.useAdditionalWeekYearTokens)&&cF(ue)&&hm(ue,E,t),!(n!=null&&n.useAdditionalDayOfYearTokens)&&lF(ue)&&hm(ue,E,t);var Se=ue[0],ze=Mte[Se];if(ze){var j=ze.incompatibleTokens;if(Array.isArray(j)){var tt=re.find(function(qe){return j.includes(qe.token)||qe.token===Se});if(tt)throw new RangeError("The format string mustn't contain `".concat(tt.fullToken,"` and `").concat(ue,"` at the same time"))}else if(ze.incompatibleTokens==="*"&&re.length>0)throw new RangeError("The format string mustn't contain `".concat(ue,"` and any other token at the same time"));re.push({token:Se,fullToken:ue});var Ne=ze.run(O,ue,N.match,I);if(!Ne)return{v:new Date(NaN)};ee.push(Ne.setter),O=Ne.rest}else{if(Se.match(Pte))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Se+"`");if(ue==="''"?ue="'":Se==="'"&&(ue=Bte(ue)),O.indexOf(ue)===0)O=O.slice(ue.length);else return{v:new Date(NaN)}}};for(fe.s();!(se=fe.n()).done;){var H=xe();if(Za(H)==="object")return H.v}}catch(pe){fe.e(pe)}finally{fe.f()}if(O.length>0&&Rte.test(O))return new Date(NaN);var ve=ee.map(function(pe){return pe.priority}).sort(function(pe,ue){return ue-pe}).filter(function(pe,ue,Se){return Se.indexOf(pe)===ue}).map(function(pe){return ee.filter(function(ue){return ue.priority===pe}).sort(function(ue,Se){return Se.subPriority-ue.subPriority})}).map(function(pe){return pe[0]}),W=bt(r);if(isNaN(W.getTime()))return new Date(NaN);var F=nF(W,dm(W)),X={},Z=aT(ve),q;try{for(Z.s();!(q=Z.n()).done;){var ce=q.value;if(!ce.validate(F,I))return new Date(NaN);var Ce=ce.set(F,X,I);Array.isArray(Ce)?(F=Ce[0],zee(X,Ce[1])):F=Ce}}catch(pe){Z.e(pe)}finally{Z.f()}return F}function Bte(t){return t.match(Fte)[1].replace(Ite,"'")}function jte(t){pt(1,arguments);var e=bt(t);return e.setMinutes(0,0,0),e}function zte(t){pt(1,arguments);var e=bt(t);return e.setMilliseconds(0),e}function Vte(t,e){var r;pt(1,arguments);var n=kr((r=e==null?void 0:e.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof t=="string"||Object.prototype.toString.call(t)==="[object String]"))return new Date(NaN);var i=Wte(t),s;if(i.date){var a=Gte(i.date,n);s=qte(a.restDateString,a.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);var o=s.getTime(),l=0,u;if(i.time&&(l=Yte(i.time),isNaN(l)))return new Date(NaN);if(i.timezone){if(u=Kte(i.timezone),isNaN(u))return new Date(NaN)}else{var d=new Date(o+l),h=new Date(0);return h.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),h.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),h}return new Date(o+l+u)}var ap={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$te=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ute=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Hte=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Wte(t){var e={},r=t.split(ap.dateTimeDelimiter),n;if(r.length>2)return e;if(/:/.test(r[0])?n=r[0]:(e.date=r[0],n=r[1],ap.timeZoneDelimiter.test(e.date)&&(e.date=t.split(ap.timeZoneDelimiter)[0],n=t.substr(e.date.length,t.length))),n){var i=ap.timezone.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}function Gte(t,e){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};var i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:t.slice((n[1]||n[2]).length)}}function qte(t,e){if(e===null)return new Date(NaN);var r=t.match($te);if(!r)return new Date(NaN);var n=!!r[4],i=$f(r[1]),s=$f(r[2])-1,a=$f(r[3]),o=$f(r[4]),l=$f(r[5])-1;if(n)return ere(e,o,l)?Xte(e,o,l):new Date(NaN);var u=new Date(0);return!Jte(e,s,a)||!Qte(e,i)?new Date(NaN):(u.setUTCFullYear(e,s,Math.max(i,a)),u)}function $f(t){return t?parseInt(t):1}function Yte(t){var e=t.match(Ute);if(!e)return NaN;var r=Wv(e[1]),n=Wv(e[2]),i=Wv(e[3]);return tre(r,n,i)?r*Gm+n*Wm+i*1e3:NaN}function Wv(t){return t&&parseFloat(t.replace(",","."))||0}function Kte(t){if(t==="Z")return 0;var e=t.match(Hte);if(!e)return 0;var r=e[1]==="+"?-1:1,n=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return rre(n,i)?r*(n*Gm+i*Wm):NaN}function Xte(t,e,r){var n=new Date(0);n.setUTCFullYear(t,0,4);var i=n.getUTCDay()||7,s=(e-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}var Zte=[31,null,31,30,31,30,31,31,30,31,30,31];function vF(t){return t%400===0||t%4===0&&t%100!==0}function Jte(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(Zte[e]||(vF(t)?29:28))}function Qte(t,e){return e>=1&&e<=(vF(t)?366:365)}function ere(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}function tre(t,e,r){return t===24?e===0&&r===0:r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}function rre(t,e){return e>=0&&e<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const nre={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};cm._date.override({_id:"date-fns",formats:function(){return nre},parse:function(t,e){if(t===null||typeof t>"u")return null;const r=typeof t;return r==="number"||t instanceof Date?t=bt(t):r==="string"&&(typeof e=="string"?t=Lte(t,e,new Date,this.options):t=Vte(t,this.options)),JO(t)?t.getTime():null},format:function(t,e){return Bee(t,e,this.options)},add:function(t,e,r){switch(r){case"millisecond":return fh(t,e);case"second":return bQ(t,e);case"minute":return yQ(t,e);case"hour":return pQ(t,e);case"day":return ZO(t,e);case"week":return kQ(t,e);case"month":return zw(t,e);case"quarter":return wQ(t,e);case"year":return SQ(t,e);default:return t}},diff:function(t,e,r){switch(r){case"millisecond":return qm(t,e);case"second":return FQ(t,e);case"minute":return MQ(t,e);case"hour":return NQ(t,e);case"day":return QO(t,e);case"week":return IQ(t,e);case"month":return rF(t,e);case"quarter":return OQ(t,e);case"year":return RQ(t,e);default:return 0}},startOf:function(t,e,r){switch(e){case"second":return zte(t);case"minute":return PQ(t);case"hour":return jte(t);case"day":return ey(t);case"week":return QE(t);case"isoWeek":return QE(t,{weekStartsOn:+r});case"month":return BQ(t);case"quarter":return LQ(t);case"year":return zQ(t);default:return t}},endOf:function(t,e){switch(e){case"second":return WQ(t);case"minute":return UQ(t);case"hour":return VQ(t);case"day":return eF(t);case"week":return $Q(t);case"month":return tF(t);case"quarter":return HQ(t);case"year":return jQ(t);default:return t}}});function oT(t,e,r){pt(2,arguments);var n=Ja(t,r),i=Ja(e,r);return n.getTime()===i.getTime()}function Uf(t,e){if(t.one!==void 0&&e===1)return t.one;var r=e%10,n=e%100;return r===1&&n!==11?t.singularNominative.replace("{{count}}",String(e)):r>=2&&r<=4&&(n<10||n>20)?t.singularGenitive.replace("{{count}}",String(e)):t.pluralGenitive.replace("{{count}}",String(e))}function si(t){return function(e,r){return r!=null&&r.addSuffix?r.comparison&&r.comparison>0?t.future?Uf(t.future,e):" "+Uf(t.regular,e):t.past?Uf(t.past,e):Uf(t.regular,e)+" ":Uf(t.regular,e)}}var ire={lessThanXSeconds:si({regular:{one:" ",singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{one:",   ",singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),xSeconds:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "},past:{singularNominative:"{{count}}  ",singularGenitive:"{{count}}  ",pluralGenitive:"{{count}}  "},future:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "}}),halfAMinute:function(e,r){return r!=null&&r.addSuffix?r.comparison&&r.comparison>0?" ":" ":""},lessThanXMinutes:si({regular:{one:" ",singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{one:",   ",singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),xMinutes:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "},past:{singularNominative:"{{count}}  ",singularGenitive:"{{count}}  ",pluralGenitive:"{{count}}  "},future:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "}}),aboutXHours:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xHours:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),xDays:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXWeeks:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xWeeks:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXMonths:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xMonths:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),aboutXYears:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}}),xYears:si({regular:{singularNominative:"{{count}} ",singularGenitive:"{{count}} ",pluralGenitive:"{{count}} "}}),overXYears:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:",   {{count}} ",singularGenitive:",   {{count}} ",pluralGenitive:",   {{count}} "}}),almostXYears:si({regular:{singularNominative:" {{count}} ",singularGenitive:" {{count}} ",pluralGenitive:" {{count}} "},future:{singularNominative:"  {{count}} ",singularGenitive:"  {{count}} ",pluralGenitive:"  {{count}} "}})},sre=function(e,r,n){return ire[e](r,n)},are={full:"EEEE, d MMMM y '.'",long:"d MMMM y '.'",medium:"d MMM y '.'",short:"dd.MM.y"},ore={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},lre={any:"{{date}}, {{time}}"},cre={date:_u({formats:are,defaultWidth:"full"}),time:_u({formats:ore,defaultWidth:"full"}),dateTime:_u({formats:lre,defaultWidth:"any"})},Hw=["","","","","","",""];function ure(t){var e=Hw[t];switch(t){case 0:return"'  "+e+" ' p";case 1:case 2:case 4:return"'  "+e+" ' p";case 3:case 5:case 6:return"'  "+e+" ' p"}}function lT(t){var e=Hw[t];return t===2?"' "+e+" ' p":"' "+e+" ' p"}function fre(t){var e=Hw[t];switch(t){case 0:return"'  "+e+" ' p";case 1:case 2:case 4:return"'  "+e+" ' p";case 3:case 5:case 6:return"'  "+e+" ' p"}}var dre={lastWeek:function(e,r,n){var i=e.getUTCDay();return oT(e,r,n)?lT(i):ure(i)},yesterday:"' ' p",today:"' ' p",tomorrow:"' ' p",nextWeek:function(e,r,n){var i=e.getUTCDay();return oT(e,r,n)?lT(i):fre(i)},other:"P"},hre=function(e,r,n,i){var s=dre[e];return typeof s=="function"?s(r,n,i):s},pre={narrow:[" ..",".."],abbreviated:[" . .",". ."],wide:["  "," "]},mre={narrow:["1","2","3","4"],abbreviated:["1- .","2- .","3- .","4- ."],wide:["1- ","2- ","3- ","4- "]},gre={narrow:["","","","","","","","","","","",""],abbreviated:[".",".","",".","","","",".",".",".",".","."],wide:["","","","","","","","","","","",""]},xre={narrow:["","","","","","","","","","","",""],abbreviated:[".",".",".",".","",".",".",".",".",".",".","."],wide:["","","","","","","","","","","",""]},vre={narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},yre={narrow:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},abbreviated:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},wre={narrow:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},abbreviated:{am:"",pm:"",midnight:".",noon:".",morning:"",afternoon:"",evening:".",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},bre=function(e,r){var n=Number(e),i=r==null?void 0:r.unit,s;return i==="date"?s="-":i==="week"||i==="minute"||i==="second"?s="-":s="-",n+s},kre={ordinalNumber:bre,era:la({values:pre,defaultWidth:"wide"}),quarter:la({values:mre,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:la({values:gre,defaultWidth:"wide",formattingValues:xre,defaultFormattingWidth:"wide"}),day:la({values:vre,defaultWidth:"wide"}),dayPeriod:la({values:yre,defaultWidth:"any",formattingValues:wre,defaultFormattingWidth:"wide"})},Sre=/^(\d+)(-?(||||||||||))?/i,_re=/\d+/i,Cre={narrow:/^(( )?\.?\s?\.?)/i,abbreviated:/^(( )?\.?\s?\.?)/i,wide:/^(  | | )/i},Ere={any:[/^/i,/^/i]},Tre={narrow:/^[1234]/i,abbreviated:/^[1234](-?[]??)? .?/i,wide:/^[1234](-?[]??)? /i},Are={any:[/1/i,/2/i,/3/i,/4/i]},Nre={narrow:/^[]/i,abbreviated:/^(||?||[]|[]?|[]?||?||?|)\.?/i,wide:/^([]|[]|?|[]|[]|[]|[]|?|[]|[]|[]|[]|[])/i},Mre={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^/i,/^/i,/^/i,/^/i,/^[]/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i]},Dre={narrow:/^[]/i,short:/^(|||||||||||)\.?/i,abbreviated:/^(||||||||||||).?/i,wide:/^([]|?|?|[]|?|[]|[])/i},Ore={narrow:[/^/i,/^/i,/^/i,/^/i,/^/i,/^/i,/^/i],any:[/^[]/i,/^[]/i,/^/i,/^/i,/^/i,/^[]/i,/^[]/i]},Fre={narrow:/^([]|\.?|\.?|[]|||\.?|[])/i,abbreviated:/^([]|\.?|\.?|[]|||\.?|[])/i,wide:/^([]|||[]|||?|[])/i},Ire={any:{am:/^/i,pm:/^/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^[]/i,evening:/^/i,night:/^/i}},Rre={ordinalNumber:uF({matchPattern:Sre,parsePattern:_re,valueCallback:function(e){return parseInt(e,10)}}),era:ca({matchPatterns:Cre,defaultMatchWidth:"wide",parsePatterns:Ere,defaultParseWidth:"any"}),quarter:ca({matchPatterns:Tre,defaultMatchWidth:"wide",parsePatterns:Are,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:ca({matchPatterns:Nre,defaultMatchWidth:"wide",parsePatterns:Mre,defaultParseWidth:"any"}),day:ca({matchPatterns:Dre,defaultMatchWidth:"wide",parsePatterns:Ore,defaultParseWidth:"any"}),dayPeriod:ca({matchPatterns:Fre,defaultMatchWidth:"wide",parsePatterns:Ire,defaultParseWidth:"any"})},Pre={code:"ru",formatDistance:sre,formatLong:cre,formatRelative:hre,localize:kre,match:Rre,options:{weekStartsOn:1,firstWeekContainsDate:1}};let cT=!1;const Lre=()=>{var t;cT||(Ao.register(J1,Q1,vp,jo,yp,ed,XJ,iQ,YJ,$J,Qd),typeof((t=cm._date)==null?void 0:t.override)=="function"&&cm._date.override({locale:Pre}),cT=!0)};let uT=!1;const Bre=()=>{uT||(Lre(),uT=!0)};function jre(){return b.jsx(HY,{})}Bre();nI.createRoot(document.getElementById("root")).render(b.jsx(xt.StrictMode,{children:b.jsx(jre,{})}));
