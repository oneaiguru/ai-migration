# features/admin/exception-management.feature

Функционал: Управление исключениями календаря
  Как менеджер по персоналу
  Я хочу управлять праздничными и исключительными днями
  Чтобы расписание отражало нерабочие дни и события

  Предыстория:
    Дано я вошёл в систему управления персоналом
    И у меня есть права менеджера
    И я нахожусь на странице "Задать исключения"

  @exceptions @calendar
  Сценарий: Добавить праздничный день
    Дано администратор открывает модуль "Задать исключения"
    Когда выбирает дату "23 февраля 2025" как "Праздничный день"
    И указывает описание "День защитника Отечества"
    Тогда исключение сохраняется в календаре
    И дата помечается как нерабочая
    И сотрудникам отправляются уведомления

  Сценарий: Изменить описание существующего исключения
    Дано создано исключение на дату "01.05.2025" с описанием "Праздник весны"
    Когда я открываю его для редактирования
    И изменяю описание на "Праздник труда"
    Тогда изменения сохраняются
    И календарь отображает новое описание

  Сценарий: Деактивировать прошедшее исключение
    Дано в списке есть прошедшее исключение "31.12.2024"
    Когда я отключаю его статус
    Тогда исключение отмечено как неактивное
    И оно скрывается из списка предстоящих

  Сценарий: Удалить ненужное исключение
    Дано имеется исключение "15.08.2025" в календаре
    Когда я удаляю его
    Тогда запись об исключении отсутствует в системе

  Сценарий: Просмотр списка предстоящих исключений
    Дано создано несколько исключений на будущие даты
    Когда я просматриваю раздел предстоящих исключений
    Тогда список отсортирован по дате возрастания
    И отображается количество дней до события

  Сценарий: Массовая деактивация выбранных исключений
    Дано выбрано несколько исключений из списка
    Когда я нажимаю "Отключить выбранные"
    Тогда все выбранные исключения становятся неактивными
    И система подтверждает массовое действие

  Сценарий: Обнаружение конфликта с существующим праздником
    Дано уже существует праздничное исключение на "08.03.2025"
    Когда я пытаюсь добавить новое исключение на ту же дату
    Тогда система предупреждает о конфликте
    И предлагает изменить дату или тип

  Сценарий: Подсветка дат исключений в календаре
    Дано в календаре есть исключения на текущий месяц
    Когда я открываю календарный вид
    Тогда все даты с исключениями выделены цветом
    И тип исключения отображается в подсказке

  Сценарий: Применить шаблон сезонных исключений
    Дано я выбираю шаблон "Новогодние каникулы"
    Когда применяю его на период с "01.01.2026" по "08.01.2026"
    Тогда создаются соответствующие исключения на каждый день

  Сценарий: Экспортировать список исключений в CSV
    Дано список исключений содержит более десяти записей
    Когда я выбираю опцию "Экспорт в CSV"
    Тогда формируется файл со всеми данными исключений

  Сценарий: Импортировать исключения из CSV
    Дано у меня есть файл с новыми исключениями
    Когда я загружаю его через форму импорта
    Тогда исключения добавляются в систему
    И отображаются в списке предстоящих

  Сценарий: Уведомить сотрудников об изменении исключения
    Дано сотрудникам уже отправлены уведомления об исключении "05.11.2025"
    Когда я изменяю дату этого исключения на "06.11.2025"
    Тогда система повторно отправляет уведомления с обновленной датой

  Сценарий: Просмотр статистики активных исключений
    Дано существует несколько активных и неактивных исключений
    Когда я смотрю сводку статистики
    Тогда отображается общее количество исключений
    И количество активных и предстоящих событий

  Сценарий: Поиск исключений по описанию
    Дано в системе много исключений с разными описаниями
    Когда я ввожу "техобслуживание" в поле поиска
    Тогда отображаются только исключения с этим описанием
