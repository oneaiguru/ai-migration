# features/shared/authentication.feature

Функционал: Аутентификация пользователя
  Как пользователь системы управления персоналом
  Я хочу безопасно входить в систему
  Чтобы получать доступ к назначенным функциям

  Предыстория:
    Дано система доступна
    И отображается страница входа

  Сценарий: Успешный вход с корректными данными
    Дано у меня есть действующие учетные данные
    Когда я ввожу свое имя пользователя и пароль
    И нажимаю кнопку входа
    Тогда я попадаю на главную панель
    И вижу свой аватар в шапке
    И вижу опцию выхода

  Сценарий: Ошибка входа при неверных данных
    Дано у меня недействительные учетные данные
    Когда я ввожу неправильное имя пользователя или пароль
    И нажимаю кнопку входа
    Тогда я вижу сообщение об ошибке
    И остаюсь на странице входа

  @realtime
  Scenario: Establish WebSocket connection after login
    Given I successfully logged into the system
    When аутентификация завершена
    Then WebSocket соединение устанавливается автоматически
    And я вижу уведомление "Connected"

  @realtime
  Scenario: Reconnect WebSocket on session restore
    Given моя сессия была прервана
    When я возвращаюсь на страницу через несколько минут
    Then система повторно подключается к WebSocket
    And недоставленные сообщения загружаются

  @realtime
  Scenario: Display offline indicator when connection lost
    Given я нахожусь на главной странице
    When соединение с сервером прерывается
    Then отображается значок "Offline"
    And система пытается переподключиться

  @realtime
  Scenario: Queue notifications while offline
    Given соединение WebSocket недоступно
    When сервер отправляет уведомления о сменах
    Then они накапливаются локально
    And отображаются после восстановления связи
