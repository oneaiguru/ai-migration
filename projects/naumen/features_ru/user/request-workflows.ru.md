# features/user/request-workflows.feature

Функционал: Расширенные рабочие процессы заявок
  Как сотрудник
  Я хочу управлять сложными заявками
  Чтобы при необходимости корректировать свой график

  Предыстория:
    Дано я вошёл в систему управления персоналом
    И у меня есть права сотрудника
    И я нахожусь на странице заявок

  @self-service
  Сценарий: Отправить многошаговый запрос на отпуск
    Когда я создаю новую заявку на отпуск
    И прохожу все шаги мастера
    Тогда заявка отправляется на утверждение
    И я вижу сообщение с подтверждением

  @self-service
  Сценарий: Сохранить заявку как черновик
    Когда я заполняю часть заявки на смену
    И выбираю "Сохранить как черновик"
    Тогда заявка появляется в списке черновиков

  @approval @notification
  Сценарий: Отслеживание статуса заявки
    Дано я отправил заявку на отпуск
    Когда менеджер её утверждает
    Тогда я получаю уведомление об одобрении
    И статус заявки показывает "Одобрено"

  @self-service
  Сценарий: Изменить ожидающую заявку
    Дано моя заявка на переработку ожидает одобрения
    Когда я редактирую детали заявки
    Тогда обновлённая информация сохраняется
    И процесс утверждения начинается заново

  @self-service
  Сценарий: Отменить несколько заявок
    Дано я выделяю несколько ожидающих заявок
    Когда выбираю "Отменить заявки"
    Тогда все выбранные заявки переходят в статус отменённых

  @analytics
  Сценарий: Просмотр аналитики истории заявок
    Когда я открываю отчёт по своим заявкам
    Тогда вижу статистику одобрений и отказов
    И графики отображают месячный объём заявок

  @error @recovery @offline
  Сценарий: Сохранение данных при потере соединения
    Дано пользователь заполняет заявку на отпуск
    Когда пропадает интернет соединение
    Тогда система сохраняет введённые данные локально
    И отображается индикатор офлайн режима
    И при восстановлении связи предлагается отправить заявку
    И данные не теряются после перезагрузки

  @error @recovery
  Сценарий: Повторная отправка при ошибке сервера
    Дано я отправляю заявку на смену
    И сервер временно недоступен
    Тогда система показывает уведомление о повторной попытке
    И автоматически повторяет отправку через минуту
    И при успехе отображает сообщение об отправке

  @visual @feedback
  Сценарий: Уведомление с действием после отправки
    Дано я успешно отправил заявку
    Тогда появляется всплывающее уведомление с кнопкой "Открыть"
    Когда я нажимаю эту кнопку
    Тогда открывается подробный статус моей заявки

  @error @offline
  Сценарий: Просмотр списка заявок в офлайн режиме
    Дано нет подключения к сети
    Когда я открываю раздел "Мои заявки"
    Тогда отображаются сохранённые локальные данные
    И показывается индикатор офлайн режима
