# features/admin/trend-analysis.feature

Функционал: Анализ трендов
  Как менеджер по персоналу
  Я хочу анализировать тенденции и паттерны загрузки
  Чтобы принимать решения по прогнозированию и штату

  Предыстория:
    Дано я вошёл в систему
    И нахожусь в разделе "Прогнозы"
    И открыта страница "Анализ трендов"
    И выбран контакт-центр "Контакт-центр 1010"

  Сценарий: Переключение уровней анализа
    Когда я нахожусь на странице анализа трендов
    Тогда я вижу три уровня анализа:
      | Level | Label |
      | Strategic | Стратегический |
      | Tactical | Тактический |
      | Operational | Оперативный |
    И по умолчанию выделен "Оперативный"

  Сценарий: Переключиться на стратегический анализ
    Дано я просматриваю оперативный анализ
    Когда я нажимаю "Стратегический"
    Тогда открывается стратегический вид
    И вкладка "Стратегический" становится активной
    И отображаются долгосрочные тренды

  Сценарий: Переключиться на тактический анализ
    Дано я просматриваю оперативный анализ
    Когда я нажимаю "Тактический"
    Тогда открывается тактический вид
    И вкладка "Тактический" становится активной
    И отображаются среднесрочные тренды

  Сценарий: Просмотр графиков операционного анализа
    Дано я нахожусь на странице операционного анализа
    Тогда я вижу несколько графиков:
      | Тип графика | Описание |
      | Прогноз / факт звонков (шт.) | Forecast vs actual calls |
      | Сезонность. Факт (%) | Seasonality actual percentage |
      | Сумма по дню | Daily summary |
    И каждый график интерактивный и отображает реальные данные

  Сценарий: Поиск по имени очереди
    Дано я просматриваю анализ трендов
    Когда я ввожу имя очереди в поле "Поиск"
    Тогда результаты фильтруются по выбранной очереди
    И графики обновляются с учётом фильтра

  Сценарий: Развернуть график для детального просмотра
    Дано я вижу график трендов
    Когда я нажимаю кнопку разворота на графике "Прогноз / факт звонков"
    Тогда график расширяется на весь экран
    И появляются дополнительные элементы управления

  Сценарий: Просмотр данных прогноза и факта
    Дано я просматриваю операционный анализ
    Когда я смотрю график "Прогноз / факт звонков (шт.)"
    Тогда я вижу линию прогноза и фактический объём звонков
    И могу определить расхождения

  Сценарий: Анализ сезонности
    Дано я просматриваю график сезонности
    Когда я изучаю данные "Сезонность. Факт (%)"
    Тогда я вижу сезонные паттерны в процентах
    И могу определить повторяющиеся закономерности

  Сценарий: Просмотр дневных сумм
    Дано я просматриваю график ежедневных итогов
    Когда я смотрю "Сумма по дню"
    Тогда отображаются дневные показатели и тренды
    И видны различия по дням недели

  Сценарий: Просмотр интервалов по 15 минут
    Дано я смотрю таблицу интервалов
    Тогда я вижу интервалы по 15 минут:
      | Time Intervals |
      | 00:00, 00:15, 00:30, 00:45 |
      | 01:00, 01:15, 01:30, 01:45 |
      | ... continuing through 23:45 |
    И каждая строка содержит соответствующие метрики
    И таблица виртуализирована для производительности

  Сценарий: Добавить новый период для анализа
    Дано я просматриваю анализ трендов
    Когда я нажимаю кнопку "Период" для добавления
    Тогда я могу задать параметры нового периода
    И использовать его для сравнения трендов

  Сценарий: Фильтрация анализа по периоду
    Дано настроено несколько периодов анализа
    Когда я выбираю конкретный период в фильтре
    Тогда графики обновляются под выбранный период

  Сценарий: Экспорт данных трендового анализа
    Дано я вижу результаты анализа
    Когда я нажимаю кнопку сохранения/экспорта
    Тогда я могу экспортировать данные с графиками
    И выбрать формат файла

  Сценарий: Анализ трендов выбранной очереди
    Дано я выбрал конкретную очередь через поиск
    Когда я смотрю анализ трендов
    Тогда все графики отображают данные этой очереди
    И я вижу сезонные особенности очереди

  Сценарий: Распределение по часам
    Дано я просматриваю таблицу интервалов
    Когда я изучаю почасовые данные
    Тогда я вижу распределение объёма звонков по 24 часам
    И могу определить пики и провалы

  @performance
  Сценарий: Работа с большими данными в анализе трендов
    Дано имеется большой объём исторических данных
    Когда я загружаю графики анализа трендов
    Тогда графики рендерятся эффективно с использованием Chart.js
    И виртуализированная таблица плавно отображает данные
    И интерактивные элементы остаются отзывчивыми

  @integration
  Сценарий: Использование анализа трендов при построении прогноза
    Дано выявлены тренды и паттерны
    Когда я применяю их для построения прогноза
    Тогда информация из анализа используется в модели прогноза
    И сезонные корректировки доступны при расчёте

  @analytics @patterns
  Сценарий: Выявление сезонных паттернов
    Дано загружены данные за последний год
    Когда система выполняет анализ сезонности
    Тогда обнаруживаются недельные и месячные циклы
    И отображается сила сезонных паттернов

  @analytics @patterns
  Сценарий: Определение долгосрочных трендов
    Дано история звонков за "24 месяца"
    Когда система анализирует общий тренд
    Тогда определяется направление изменения
    И выводится процент по месяцам

  @analytics @patterns
  Сценарий: Определение циклических паттернов
    Дано данные содержат повторяющиеся пики
    Когда запускается модуль распознавания циклов
    Тогда фиксируется периодичность колебаний
    И отображается уровень доверия к найденному циклу

  @analytics @anomaly
  Сценарий: Поиск аномалий по статистическому порогу
    Дано построены графики трендов
    Когда включен режим обнаружения аномалий
    Тогда система выделяет значительные отклонения
    И каждому отклонению присваивается уровень серьёзности

  @analytics @integration
  Сценарий: Корректировка прогноза на основе паттернов
    Дано выявлены устойчивые паттерны спроса
    Когда я применяю их для корректировки прогноза
    Тогда новая версия прогноза учитывает циклы
    И точность прогнозирования улучшается

  @analytics @patterns
  Сценарий: Автоматическая классификация паттернов
    Дано загружены разные временные ряды
    Когда система выполняет классификацию
    Тогда каждому ряду присваивается тип "seasonal, cyclical или trending"
    И результаты доступны для анализа

  @analytics @ui
  Сценарий: Экспорт графика из анализа трендов
    Дано открыт график сезонности
    Когда я нажимаю кнопку экспорта
    Тогда изображение сохраняется как PNG

  @analytics @ui
  Сценарий: Адаптивные графики трендов
    Дано я просматриваю анализ трендов на планшете
    Тогда графики адаптируются под размер экрана
    И элементы управления остаются удобными

  @analytics @ui
  Сценарий: Обновление трендов в реальном времени
    Дано включено автоматическое обновление данных
    Когда поступают новые значения нагрузки
    Тогда графики обновляются без перезагрузки

  @analytics @ui
  Сценарий: Увеличение и перемещение графика
    Дано открыт детальный график тренда
    Когда я масштабирую график
    Тогда я могу прокручивать временной диапазон без задержек
